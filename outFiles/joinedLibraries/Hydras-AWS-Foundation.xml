<?xml version="1.0" encoding="UTF-8"?>
<!--Copyright (c) 2012-2019 Continuum Security.  All rights reserved.The content of this library is the property of Continuum Security SL and may only be used in whole or in part with a valid license for IriusRisk.-->
<project ref='Hydras-AWS-Foundation' name='Hydras-AWS-Foundation' revision='30' type='LIBRARY' status='OPEN' enabled='true' priority='0' tags=''>
  <desc>This library provides a baseline set of risks for anyone implementing an environment on Amazon Web Services
        (AWS). It covers foundation services such as Governance, Identity and Access Management (IAM), Logging,
        Monitoring, Network, EC2 and S3.

        This library has been supplied by Hydras IT LTD (https://hydrasit.com). and by CIS Benchmarks
        (https://www.cisecurity.org/cis-benchmarks/). Please contact Hydras for further
        information.
    </desc>
  <categoryComponents>
    <categoryComponent ref='amazon-web-services' name='Amazon Web Services' />
  </categoryComponents>
  <componentDefinitions>
    <componentDefinition ref='amazon-web-services-environment' name='AWS Account Environment' desc='Amazon Web Services Environment. Only select this if the security of the AWS environment will be managed in this product.' categoryRef='amazon-web-services'>
      <riskPatterns>
        <riskPattern ref='HYDRAS-AWS-IAM' />
        <riskPattern ref='HYDRAS-AWS-MON' />
        <riskPattern ref='HYDRAS-AWS-NET' />
        <riskPattern ref='HYDRAS-AWS-LOG' />
      </riskPatterns>
    </componentDefinition>
    <componentDefinition ref='ec2' name='EC2 - Elastic Compute Cloud' desc='' categoryRef='amazon-web-services'>
      <riskPatterns>
        <riskPattern ref='HYDRAS-AWS-EC2' />
      </riskPatterns>
    </componentDefinition>
    <componentDefinition ref='s3' name='S3 - Simple Storage Service' desc='' categoryRef='amazon-web-services'>
      <riskPatterns>
        <riskPattern ref='HYDRAS-AWS-S3' />
      </riskPatterns>
    </componentDefinition>
    <componentDefinition ref='rds' name='RDS - Relational Database Service' desc='' categoryRef='amazon-web-services'>
      <riskPatterns>
        <riskPattern ref='HYDRAS-AWS-RDS' />
      </riskPatterns>
    </componentDefinition>
    <componentDefinition ref='load-balancer' name='ELB - Elastic Load Balancer' desc='' categoryRef='amazon-web-services'>
      <riskPatterns>
        <riskPattern ref='HYDRAS-AWS-ELB' />
      </riskPatterns>
    </componentDefinition>
    <componentDefinition ref='sns' name='SNS - Simple Notification Service' desc='' categoryRef='amazon-web-services'>
      <riskPatterns>
        <riskPattern ref='HYDRAS-AWS-SNS' />
      </riskPatterns>
    </componentDefinition>
  </componentDefinitions>
  <supportedStandards>
    <supportedStandard ref='cis-amazon-web-services-three-tier-web-architecture-benchmark' name='CIS Amazon Web Services Three-tier Web Architecture Benchmark' />
    <supportedStandard ref='CIS AWS Standard' name='CIS Amazon Web Services Foundations Benchmark' />
  </supportedStandards>
  <udts />
  <components>
<component ref='HYDRAS-AWS-EC2' name='AWS EC2' desc='' groupName='' tags='' position='1' library='' diagramPositionX='0' diagramPositionY='0' componentDefinitionRef=''>
      <weaknesses>
<weakness ref='AWS-NET-02' name='Unauthorised connection attempts are allowed on port 22' state='0' impact='100'>
          <desc>Receiving unauthorized connections to port 22 is most likely to be receiving an SSH attack. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-EC2-6.2' name='The instances are not patched' state='0' impact='100'>
          <desc>The instances are not patched with the last updates for the correspondent Operative System
                        (OS), and the instances have got weaknesses which are solved in the last updates.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-NET-03' name='Unauthorised connection attempts are allowed on port 3389' state='0' impact='100'>
          <desc>Receiving unauthorized connections to port 3389 is most likely to be receiving an RDP attack.
                        To avoid this, access to the network must be as restricted as possible, so that only the
                        necessary ports are open and the minimum inbound traffic is accepted.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-NET-01' name='Unauthorised connection attempts are allowed on open ports' state='0' impact='100'>
          <desc>&lt;div&gt;
                        Receiving unauthorized connections to open ports is most likely to be receiving an attack. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-NET-04' name='Unauthorised connection attempts are allowed on Amazon resources' state='0' impact='100'>
          <desc>Receiving unauthorized connections to Amazon resources is most likely to be receiving an attack. To avoid this, access to the network must be as restricted as possible using Network Access Control Lists for blacklisting.</desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness>
</weaknesses>
<controls>
<control ref='Hydras-AWS-Network-5.5' name='Use security groups to block ingress to all ports from 0.0.0.0/0' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Security groups are analogous to firewalls and therefore provide stateful filtering of
                        ingress/egress network traffic to AWS resources. It is recommended to limit inbound access to
                        ALL TCP or ALL ports to avoid undue server exposure.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Login to the AWS Management Console (with VPC update).&lt;/li&gt;
                        &lt;li&gt;Select VPC from the services menu.&lt;/li&gt;
                        &lt;li&gt;Select Security Groups.&lt;/li&gt;
                        &lt;li&gt;For each security group, perform the following:&amp;nbsp;&lt;/li&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Select the security group.&lt;/li&gt;
                        &lt;li&gt;Click the Inbound tab.&lt;/li&gt;
                        &lt;li&gt;Identify the rules to be removed.&lt;/li&gt;
                        &lt;li&gt;Click the x in the Remove column.&lt;/li&gt;
                        &lt;li&gt;Click Save.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ol&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='4.3' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Login to the AWS Management Console.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Select VPC from the services menu.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Select Security Groups.&lt;/li&gt;
                            &lt;li&gt;For each security group, perform the following:&amp;nbsp;&lt;/li&gt;
                            &lt;ul&gt;
                            &lt;li&gt;Select the security group.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Click the Inbound tab.&lt;/li&gt;
                            &lt;li&gt;Ensure no rule exists that has a port range of 0-1024 of 0-65535 and has a source
                            of 0.0.0.0/0.&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;/ol&gt;
                            &lt;br /&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Network-5.7' name='Use Network Access Control Lists (NACLs) for blacklisting' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Network Access Control Lists (NACLs) act as packet filters across subnets, allowing or deny
                        traffic per pre-created rules. It is recommended to use NACLs as a method of blacklisting IP
                        addresses, denying either inbound or outbound access across your subnets.&amp;nbsp;
                        &lt;div&gt;
                        &amp;nbsp;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Login to the AWS Management Console (with VPC update).&lt;/li&gt;
                        &lt;li&gt;Select VPC from the services menu.&lt;/li&gt;
                        &lt;li&gt;Select Network ACL's.&lt;/li&gt;
                        &lt;li&gt;For each Network ACL ID, perform the following:&lt;/li&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Select the Inbound Rules tab.&lt;/li&gt;
                        &lt;li&gt;Click edit.&lt;/li&gt;
                        &lt;li&gt;add a DENY rule that will restrict inbound access from a blacklisted IP address or
                        range to a designated port or IP range.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ol&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Login to the AWS Management Console.&lt;/li&gt;
                            &lt;li&gt;Select VPC from the services menu.&lt;/li&gt;
                            &lt;li&gt;Select Network ACLs.&lt;/li&gt;
                            &lt;li&gt;For each Network ACL ID, perform the following:&amp;nbsp;&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;ul&gt;
                            &lt;ul&gt;
                            &lt;li&gt;Click the Inbound Rules tab.&lt;/li&gt;
                            &lt;li&gt;Ensure a rule exists the DENY's access from a blacklisted IP or range.&lt;/li&gt;
                            &lt;li&gt;Click the Outbound Rules tab.&lt;/li&gt;
                            &lt;li&gt;Ensure a rule exists the DENY's access to a blacklisted IP or range.&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;/ul&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Network-5.6' name='Restrict all traffic with the default security group' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Security groups are analogous to firewalls and therefore provide stateful filtering of
                        ingress/egress network traffic to AWS resources. It is recommended to limit all traffic
                        (ingress/egress) on the default security group in order to force the use of least privilege via
                        custom created security groups.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Identify AWS resources that exist within the default security group.&lt;/li&gt;
                        &lt;li&gt;Create a set of least privilege security groups for those resources.&lt;/li&gt;
                        &lt;li&gt;Place the resources in those security groups.&lt;/li&gt;
                        &lt;li&gt;Remove the resources noted in 1 from the default security group.&lt;/li&gt;
                        &lt;/ol&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Login to the AWS Management Console.&lt;/li&gt;
                            &lt;li&gt;Select VPC from the services menu.&lt;/li&gt;
                            &lt;li&gt;Select Security Groups.&lt;/li&gt;
                            &lt;li&gt;For each security group, perform the following:&amp;nbsp;&lt;/li&gt;
                            &lt;ul&gt;
                            &lt;li&gt;Select the default security group.&lt;/li&gt;
                            &lt;li&gt;Click the Inbound Rules tab.&lt;/li&gt;
                            &lt;li&gt;Ensure no rule exist.&lt;/li&gt;
                            &lt;li&gt;Click the Outbound Rules tab.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure no rules exist.&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Network-5.3' name='Use security groups to block ingress to port 22 from 0.0.0.0/0' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Security groups are analogous to firewalls and therefore provide stateful filtering of
                        ingress/egress network traffic to AWS resources. It is recommended to limit inbound access to
                        port 22 (SSH) to IP addresses that require this access to avoid undue exposure to risk.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Login to the AWS Management Console (with VPC update)&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Select VPC from the services menu&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Select Security Groups&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;For each security group, perform the following:&amp;nbsp;&lt;/li&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Select the security group.&lt;/li&gt;
                        &lt;li&gt;Click the Inbound tab.&lt;/li&gt;
                        &lt;li&gt;Identify the rules to be removed.&lt;/li&gt;
                        &lt;li&gt;Click the x in the Remove column.&lt;/li&gt;
                        &lt;li&gt;Click Save.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ol&gt; Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='4.1' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Login to the AWS Management Console.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Select VPC from the services menu.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Select Security Groups.&lt;/li&gt;
                            &lt;li&gt;For each security group, perform the following:&amp;nbsp;&lt;/li&gt;
                            &lt;ul&gt;
                            &lt;li&gt;Select the security group.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Click the Inbound tab.&lt;/li&gt;
                            &lt;li&gt;Ensure no rule exists that has a port range that includes port 22 and has a source
                            of 0.0.0.0/0.&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;/ol&gt;NB: Note that if the port range includes 0-1024 or 0-65535 these also include
                            port 22
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-EC2-6.2' name='Maintain a patch policy and patch EC2 systems regularly ' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Patching instances ensures that packages within the Operating System (OS) are updated to the
                        latest version and/or have security fixes applied. It is recommended to patch EC2 instances
                        every 90 days (or immediately if security patches become available) to avoid undue exposure
                        &lt;br /&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;For linux instances ensure your OS is updated as per:
                        http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/managing-software.html&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;For Windows instances ensure your OS is updated as per:
                        http://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/windows-ami-version-history.html#update-windows-instance&lt;/li&gt;
                        &lt;/ol&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                    </desc>
          <implementations />
          <references />
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Ensure you have a documented patching policy.&lt;/li&gt;
                            &lt;li&gt;Ensure your systems have been patched at least every 90 days.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Network-5.4' name='Use security groups to block ingress to port 3389 from 0.0.0.0/0' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Security groups are analogous to firewalls and therefore provide stateful filtering of
                        ingress/egress network traffic to AWS resources. It is recommended to limit inbound access to
                        port 3389 (RDP) to IP addresses that require this access to avoid undue exposure to risk.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Login to the AWS Management Console (with VPC update).&lt;/li&gt;
                        &lt;li&gt;Select VPC from the services menu.&lt;/li&gt;
                        &lt;li&gt;Select Security Groups.&lt;/li&gt;
                        &lt;li&gt;For each security group, perform the following:&lt;/li&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Select the security group.&lt;/li&gt;
                        &lt;li&gt;Click the Inbound tab.&lt;/li&gt;
                        &lt;li&gt;Identify the rules to be removed.&lt;/li&gt;
                        &lt;li&gt;Click the x in the Remove column.&lt;/li&gt;
                        &lt;li&gt;Click Save&amp;nbsp;&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ol&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='4.2' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Login to the AWS Management Console.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Select VPC from the services menu.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Select Security Groups.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;For each security group, perform the following:&amp;nbsp;&lt;/li&gt;
                            &lt;ul&gt;
                            &lt;li&gt;Select the security group.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Click the Inbound tab.&lt;/li&gt;
                            &lt;li&gt;Ensure no rule exists that has a port range that includes port 22 and has a source
                            of 0.0.0.0/0.&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;/ol&gt;NB: Note that if the port range includes 0-1024 or 0-65535 these also include
                            port 3389
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control>
</controls>
<usecases>
<usecase ref='AMAZON-WEB-SERVICES' name='Amazon Web Services' desc='' library=''>
          <threats>
<threat ref='NON-UPDATED-SYSTEMS-AWS' name='Attackers gain unauthorised access to data on EC2 instances' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;p&gt;Attackers cloud gain access to data on EC2 instances through the weaknesses
                                in non-updated systems.&lt;/p&gt;
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AWS-EC2-6.2'>
                  <controls>
                    <control ref='Hydras-AWS-EC2-6.2' mitigation='50' />
                  </controls>
                </weakness>
                <weakness ref='AWS-NET-04'>
                  <controls>
                    <control ref='Hydras-AWS-Network-5.7' mitigation='50' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='Hydras-AWS-EC2-6.2' mitigation='50' />
                <control ref='Hydras-AWS-Network-5.7' mitigation='50' />
              </controls>
            </threat><threat ref='UNAUTHORIZED-CONNECTION' name='Attackers gain access to the systems through direct access' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;div&gt;
                                Attackers gain a unauthorized connection to the system through misconfigured ports or
                                security network configurations.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AWS-NET-01'>
                  <controls>
                    <control ref='Hydras-AWS-Network-5.5' mitigation='25' />
                    <control ref='Hydras-AWS-Network-5.6' mitigation='25' />
                  </controls>
                </weakness>
                <weakness ref='AWS-NET-02'>
                  <controls>
                    <control ref='Hydras-AWS-Network-5.3' mitigation='25' />
                  </controls>
                </weakness>
                <weakness ref='AWS-NET-03'>
                  <controls>
                    <control ref='Hydras-AWS-Network-5.4' mitigation='25' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='Hydras-AWS-Network-5.3' mitigation='25' />
                <control ref='Hydras-AWS-Network-5.4' mitigation='25' />
                <control ref='Hydras-AWS-Network-5.5' mitigation='25' />
                <control ref='Hydras-AWS-Network-5.6' mitigation='25' />
              </controls>
            </threat>
</threats>
</usecase>
</usecases>
</component>
<component ref='HYDRAS-AWS-ELB' name='AWS ELB' desc='' groupName='' tags='' position='2' library='' diagramPositionX='0' diagramPositionY='0' componentDefinitionRef=''>
      <weaknesses>
<weakness ref='AWS-Logging-3.4' name='Non-auditable actions in the resources' state='0' impact='100'>
          <desc>The actions in the resources are not audited and not recorded in the logs.</desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='unknown-resource-status' name='Unknown resource status' state='0' impact='100'>
          <desc>We do not have our resources current status and as a result lose control of some resources,
                        for example, we may believe these resources are inactive when in fact the status has changed and we are unaware. 
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-Network-5.1' name='Non-identify the resources' state='0' impact='100'>
          <desc>Resources are not registered in the safety net systems, and there are more unidentified
                        resources. This can be a problem because these unidentified resources can have unknown
                        weaknesses.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='CWE-326' name='Inadequate Encryption Strength' state='0' impact='100'>
          <desc>The software stores or transmits sensitive data using an encryption scheme that is
                        theoretically sound, but is not strong enough for the level of protection required.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='CWE-311' name='Missing Encryption of Sensitive Data' state='0' impact='100'>
          <desc>The software does not encrypt sensitive or critical information
                        before storage or transmission.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='CWE-295' name='Improper Certificate Validation' state='0' impact='100'>
          <desc>The software does not validate, or incorrectly validates, a
                        certificate.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-Network-5.2' name='Networks for Amazon resources are not properly segmentated.' state='0' impact='100'>
          <desc>&lt;div&gt;
                        Resources in the same VNet are compromised because when one of them is attacked and the
                        attackers gain access, they also gain access to all resources.
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-NET-01' name='Unauthorised connection attempts are allowed on open ports' state='0' impact='100'>
          <desc>&lt;div&gt;
                        Receiving unauthorized connections to open ports is most likely to be receiving an attack. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness>
</weaknesses>
<controls>
<control ref='aws-tier-1.9' name='Add SSL/TLS Certificate to Web Tier ELB' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  When you use HTTPS for your front-end listener, you must deploy an SSL/TLS certificate on your load balancer. The load balancer uses the certificate to terminate the connection and then decrypt requests from clients before sending them to the back-end instances. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The TLS protocol uses an X.509 certificate (SSL/TLS server certificate) to authenticate both the client and the back-end application. An X.509 certificate is a digital form of identification issued by a trusted certificate authority (CA) and contains identification information, a validity period, a public key, a serial number, and the digital signature of the issuer. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  You can create a certificate using a Third Party Certificate Authority or AWS Certificate Manager. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Note: an SSL certificate configured on the ELB is not mandatory if you are terminating SSL connections directly on the Web Tier EC2 instances, and using a TCP listener on the ELB (TCP pass-through) 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  All the application traffic between the clients and the Web Tier ELB nodes should be encrypted using a SSL/TLS certificate. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified command line interface: 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Adding a HTTPS listener configured with a SSL/TLS certificate (the listener forwards traffic to the backend instances on port 80, but this can be modified by editing InstancePort=80):&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws elb create-load-balancer-listeners --load-balancer-name &amp;lt;web_tier_elb&amp;gt; --listeners Protocol=HTTPS,LoadBalancerPort=443,InstanceProtocol=HTTP,InstancePort=80, SSLCertificateId=ssl_certificate_arn 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: describe load balancers' url='http://docs.aws.amazon.com/cli/latest/reference/elb/describe-load-balancers.html' />
            <reference name='Amazon docs: ELB add/delete listeners' url='http://docs.aws.amazon.com/ElasticLoadBalancing/latest/DeveloperGuide/elb-add-or-delete-listeners.html#add-listener-cli' />
          </references>
          <standards>
            <standard ref='1.9' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
  Using the Amazon unified command line interface: 
&lt;/div&gt; 
&lt;div&gt;
  (Note that you should replace &amp;lt;web_tier_elb&amp;gt; with your Web-tier ELB name) 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Note that if the ListenerDescriptions element is empty, the ELB does not have a listener configured with a SSL/TLS certificate, or a TCP listener (TCP pass-through):&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws elb describe-load-balancers --load-balancer-names &amp;lt;web_tier_elb&amp;gt; --query &amp;quot;LoadBalancerDescriptions[*].{LoadBalancerName:LoadBalancerName, DNSName:DNSName, Scheme:Scheme, ListenerDescriptions:ListenerDescriptions[?Listener.SSLCertificateId != null ||&amp;nbsp; Listener.Protocol == 'TCP']}&amp;quot; --output table 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-ELB-01' name='Use the Perfect Forward Secrecy feature' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>For greater communication privacy Elastic Load Balancing allows the use of Perfect Forward
                        Secrecy. This feature provides additional safeguards against eavesdropping on encrypted data,
                        through the use of a unique random session key, and therefore prevents the decoding of captured
                        data, even if the secret long-term key is compromised.
                        &lt;br /&gt;
                        &lt;br /&gt;
                        &lt;b&gt;To begin using Perfect Forward Secrecy: &lt;br /&gt;&lt;/b&gt;Configure your load
                        balancer with the newly added Elliptic Curve Cryptography (ECDHE) cipher suites.
                    </desc>
          <implementations />
          <references />
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>Check that your load balancer is configured with the newly added Elliptic Curve
                            Cryptography (ECDHE) cipher suites.
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-6.5' name='Create subnets for the Web Tier ELB' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        You can create a VPC that spans multiple Availability Zones. After creating a VPC, you can add
                        one or more subnets in each Availability Zone. Each subnet must reside entirely within one
                        Availability Zone and cannot span zones. Availability Zones are distinct locations that are
                        engineered to be isolated from failures in other Availability Zones. By launching instances in
                        separate Availability Zones, you can protect your applications from the failure of a single
                        location. AWS assigns a unique ID to each subnet.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        When you create a subnet, you specify the CIDR block for the subnet. The CIDR block of a subnet
                        shouldn't be the same as the CIDR block for the VPC (for a single subnet in the VPC). The
                        allowed block size is between a /28 netmask and /16 netmask. If you create more than one subnet
                        in a VPC, the CIDR blocks of the subnets must not overlap.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        Some AWS regions have more than 2 availability zones and it is recommended to use more than 2
                        where possible.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        At least 2 subnets in 2 different availability zones (AZ) should be created in order to have
                        fault tolerance and high availability from the perspective of resource deployment.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        Using the Amazon unified command line interface:
                        &lt;/div&gt;
                        &lt;div style=""&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Create subnets for Web tier ELB, and note the subnet id:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        aws ec2 create-subnet --vpc-id application_vpc
                        --cidr-block desired_cidr
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Tag the above subnets with the Web tier ELB tags:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        aws ec2 create-tags --resources web_tier_elb_subnet1
                        web_tier_elb_subnet2 --tags Key=public_tier_tag,Value=public_tier_tag_value
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='Amazon docs: create subnet' url='http://docs.aws.amazon.com/cli/latest/reference/ec2/create-subnet.html' />
            <reference name='Amazon docs: create tags' url='http://docs.aws.amazon.com/cli/latest/reference/ec2/create-tags.html' />
            <reference name='Amazon docs: describe subnets' url='http://docs.aws.amazon.com/cli/latest/reference/ec2/describe-subnets.html' />
          </references>
          <standards>
            <standard ref='6.5' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
  Using the Amazon unified command line interface: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;List the subnets associated with the Web tier ELB:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws elb describe-load-balancers --load-balancer-name &amp;lt;web_tier_elb&amp;gt; --query &amp;quot;LoadBalancerDescriptions[*].Subnets&amp;quot; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  OR 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Using the Amazon unified command line interface: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;List the subnets created for the Web tier ELB:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws ec2 describe-subnets --filters Name=tag:public_tier_tag,Values=public_tier_tag_value --query &amp;quot;Subnets[*].SubnetId&amp;quot; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt;</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-5.2' name='Enable the ELB logging' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  Elastic Load Balancing automatically distributes incoming application traffic across multiple Amazon EC2 instances in the a VPC. It enables you to achieve greater levels of fault tolerance in your applications, seamlessly providing the required amount of load balancing capacity needed to distribute application traffic. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  AWS Elastic Load Balancers (ELBs) can record all incoming requests sent to the load balancer and store within logs on S3. This allows for diagnosing application failures and analyzing web traffic and security analysis of incoming traffic 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified CLI: 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Create a JSON file containing the attributes you want to modify and save it locally as /tmp/ElbLogs.json:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     { 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;quot;AccessLog&amp;quot;: { 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; &amp;quot;Enabled&amp;quot;: true, 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; &amp;quot;S3BucketName&amp;quot;: &amp;quot;string&amp;quot;, 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; &amp;quot;EmitInterval&amp;quot;: integer, 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; &amp;quot;S3BucketPrefix&amp;quot;: &amp;quot;string&amp;quot; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; } 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     } 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Update the Load Balancer attributes:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws elb modify-load-balancer-attributes --load-balancer-name &amp;lt;elb_name&amp;gt; --load-balancer-attributes file:///tmp/ElbLogs.json 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: describe load balancer attributes' url='http://docs.aws.amazon.com/cli/latest/reference/elb/describe-load-balancer-attributes.html' />
            <reference name='Amazon docs: describe load balancers' url='http://docs.aws.amazon.com/cli/latest/reference/elb/describe-load-balancers.html' />
            <reference name='Amazon docs: elb describe tags' url='http://docs.aws.amazon.com/cli/latest/reference/elb/describe-tags.html' />
            <reference name='Amazon docs: enable access logs' url='https://docs.aws.amazon.com/ElasticLoadBalancing/latest/DeveloperGuide/enable-access-logs.html' />
            <reference name='Amazon docs: modify load balancer attributes' url='http://docs.aws.amazon.com/cli/latest/reference/elb/modify-load-balancer-attributes.html' />
          </references>
          <standards>
            <standard ref='5.2' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
  Via Amazon unified CLI: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;List all ELB's:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws elb describe-load-balancers --query 'LoadBalancerDescriptions[*].{LoadBalancerName:LoadBalancerName}' 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Confirm correct ELB is selected by review ELB tags:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws elb describe-tags --load-balancer-names &amp;lt;elb_name&amp;gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Review selected ELB attributes and ensure Access Log is enabled:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws elb describe-load-balancer-attributes --load-balancer-name &amp;lt;elb_name&amp;gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-3.13' name='Associate Web Tier Auto-Scaling Group to ELB' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  Elastic Load Balancing automatically distributes incoming application traffic across multiple Amazon EC2 instances within a VPC. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  It enables greater levels of fault tolerance in your applications, seamlessly providing the required amount of load balancing capacity needed to distribute application traffic across 1 or more Availability Zones within a VPC. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Elastic Load Balancing must be integrated with Auto Scaling Groups to ensure that you have availability of compute resources in the event of a failure. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Integrating Auto Scaling Groups with an Elastic Load Balancer will help provide high availability and back-end EC2 instance scaling. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Through Auto-Scaling Group configuration you can define: 
&lt;/div&gt; 
&lt;div&gt;
  minimum / maximum number of EC2 instances to be launched by the Auto-Scaling Group 
&lt;/div&gt; 
&lt;div&gt;
  Availability Zones / subnets used 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified command line interface: 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;List existing load balancers:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws elb describe-load-balancers --query 'LoadBalancerDescriptions[*].{ELBName:LoadBalancerName}' 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   or 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Create new load balancer:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws elb create-load-balancer --load-balancer-name &amp;lt;web_tier_elb&amp;gt; --listeners &amp;lt;listener_config&amp;gt; --subnets &amp;lt;web_tier_elb_subnet1&amp;gt; &amp;lt;web_tier_elb_subnet2&amp;gt; --security-groups &amp;lt;web_tier_elb_security_group&amp;gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Attached load balancer from previous steps to autoscaling group:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws autoscaling attach-load-balancers --load-balancer-names &amp;lt;web_tier_elb&amp;gt; --auto-scaling-group-name &amp;lt;web_tier_autoscaling_group_name&amp;gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: attach load balancers' url='http://docs.aws.amazon.com/cli/latest/reference/autoscaling/attach-load-balancers.html' />
            <reference name='Amazon docs: create load balancer' url='http://docs.aws.amazon.com/cli/latest/reference/elb/create-load-balancer.html' />
            <reference name='Amazon docs: describe auto-scaling groups' url='http://docs.aws.amazon.com/cli/latest/reference/autoscaling/describe-auto-scaling-groups.html' />
            <reference name='Amazon docs: describe load balancers' url='http://docs.aws.amazon.com/cli/latest/reference/elb/describe-load-balancers.html' />
            <reference name='Amazon docs: describe load balancers auto-scaling' url='http://docs.aws.amazon.com/cli/latest/reference/autoscaling/describe-load-balancers.html' />
          </references>
          <standards>
            <standard ref='3.13' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
  Using the Amazon unified command line interface: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Identify Autoscaling Group Name and associated ELB name:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws autoscaling describe-auto-scaling-groups&amp;nbsp; --query 'AutoScalingGroups[*].{ELB:LoadBalancerNames, ASGName:AutoScalingGroupName}' 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Identify current status of the ELB:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws autoscaling describe-load-balancers --auto-scaling-group-name &amp;lt;web_tier_autoscaling_group_name&amp;gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-1.12' name='Add SSL/TLS Certificate to App Tier ELB' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>When you use HTTPS for your front-end listener, you must deploy an SSL/TLS certificate on your load balancer. The load balancer uses the certificate to terminate the connection and then decrypt requests from clients before sending them to the back-end instances. 
&lt;br /&gt; 
&lt;br /&gt; The SSL\TLS protocol uses an X.509 certificate (SSL\TLS server certificate) to authenticate both the client and the back-end application. An X.509 certificate is a digital form of identification issued by a trusted certificate authority (CA) and contains identification information, a validity period, a public key, a serial number, and the digital signature of the issuer. 
&lt;br /&gt; 
&lt;br /&gt; You can create a certificate using a Third Party Certificate Authority, AWS Certificate Manager or a self signed certificate like OpenSSL. 
&lt;br /&gt; 
&lt;br /&gt; Note: an SSL certificate configured on the ELB is not mandatory if you are terminating SSL connections directly on the App Tier EC2 instances, and using a TCP listener on the ELB (TCP pass-through) 
&lt;br /&gt; 
&lt;br /&gt; All the application traffic between the Web Tier instances and the App Tier ELB nodes should be encrypted using an SSL\TLS certificate. 
&lt;br /&gt; 
&lt;b&gt;Remediation:&lt;/b&gt; 
&lt;br /&gt;
&lt;br /&gt;
Using the Amazon unified command line interface: 
&lt;ul&gt; 
 &lt;li&gt;Adding a HTTPS listener configured with a SSL\TLS certificate (the listener forwards traffic to the backend instances on port 80, but this can be modified by editing InstancePort=80): &lt;br /&gt; 
  &lt;blockquote&gt;
    aws elb create-load-balancer-listeners --load-balancer-name &amp;lt;app_tier_elb&amp;gt; --listeners Protocol=HTTPS,LoadBalancerPort=443,InstanceProtocol=HTTP,InstancePort=80, SSLCertificateId=ssl_certificate_arn 
  &lt;/blockquote&gt; &lt;/li&gt; 
&lt;/ul&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: describe load balancers' url='http://docs.aws.amazon.com/cli/latest/reference/elb/describe-load-balancers.html' />
            <reference name='Amazon docs: ELB add/delete listeners' url='http://docs.aws.amazon.com/ElasticLoadBalancing/latest/DeveloperGuide/elb-add-or-delete-listeners.html#add-listener-cli' />
          </references>
          <standards>
            <standard ref='1.12' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
  Using the Amazon unified command line interface: 
&lt;/div&gt; 
&lt;div&gt;
  (Note that you should replace &amp;lt;app_tier_elb&amp;gt; with your App-tier ELB name) 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Note that if the ListenerDescriptions is empty, the ELB does not have a listener configured with a SSL\TLS certificate, or a TCP listener (TCP pass-through):&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws elb describe-load-balancers --load-balancer-names &amp;lt;app_tier_elb&amp;gt; --query &amp;quot;LoadBalancerDescriptions[*].{LoadBalancerName:LoadBalancerName, DNSName:DNSName, Scheme:Scheme, ListenerDescriptions:ListenerDescriptions[?Listener.SSLCertificateId != null || Listener.Protocol == 'TCP']}&amp;quot; --output table 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-6.26' name='Create the App tier ELB as Internal' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  An internal load balancer routes traffic to your EC2 instances in private subnets using private IP addresses. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Create an internal load balancer and register the database servers with it. The web servers receive requests from the Internet-facing load balancer and send requests for the database servers to the internal load balancer. The database servers receive requests from the internal load balancer. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  When an internal load balancer is created, it receives a public DNS name with the following form: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;div&gt;
   internal-name-123456789.region.elb.amazonaws.com 
 &lt;/div&gt; 
 &lt;div&gt; 
  &lt;br /&gt; 
 &lt;/div&gt; 
&lt;/blockquote&gt; 
&lt;div&gt;
  The DNS servers resolve the DNS name of your load balancer to the private IP addresses of the load balancer nodes for your internal load balancer. Each load balancer node is connected to the private IP addresses of the back-end instances that are in its Availability Zone using elastic network interfaces. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Creating the App tier ELB as internal will prevent access to the app tier from the Internet and will allow access from the Web tier instances. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified command line interface: 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Create new internal ELB for your App tier:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws elb create-load-balancer --load-balancer-name app_tier_elb --scheme internal --listeners listener_config --subnets app_tier_subnet1 app_tier_subnet2 --security-groups app_tier_elb_security_group 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Register App tier instances with the new App tier ELB:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws elb register-instances-with-load-balancer --load-balancer-name app_tier_elb --instances &amp;lt;app_tier_instance1&amp;gt; &amp;lt;app_tier_instance2&amp;gt; &amp;lt;app_tier_instance3&amp;gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: create load balancer' url='http://docs.aws.amazon.com/cli/latest/reference/elb/create-load-balancer.html' />
            <reference name='Amazon docs: describe load balancers' url='http://docs.aws.amazon.com/cli/latest/reference/elb/describe-load-balancers.html' />
            <reference name='Amazon docs: ELB internal load balancers' url='http://docs.aws.amazon.com/ElasticLoadBalancing/latest/DeveloperGuide/elb-internal-load-balancers.html' />
            <reference name='Amazon docs: register instances with load balancer' url='http://docs.aws.amazon.com/cli/latest/reference/elb/register-instances-with-load-balancer.html' />
          </references>
          <standards>
            <standard ref='6.26' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
  Using the Amazon unified command line interface: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Check the Scheme of your App tier ELB, and make sure it is &amp;quot;internal&amp;quot;:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws elb describe-load-balancers --load-balancer-name &amp;lt;app_tier_elb&amp;gt; --query &amp;quot;LoadBalancerDescriptions[*].{LoadBalancerName:LoadBalancerName, Scheme:Scheme}&amp;quot; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt;</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-6.22' name='Create the App tier Security Group to allow inbound connections from App tier ELB Security Group for explicit ports' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        A security group acts as a virtual firewall for your instance to control inbound and outbound
                        traffic. When you launch an instance in the AWS Virtual Private Cloud (VPC), you can assign the
                        instance to up to five security groups. Security groups act at the instance level, not the
                        subnet level. Therefore, each instance in a subnet in your VPC could be assigned to a different
                        set of security groups. If you don't specify a particular group at launch time, the instance is
                        automatically assigned to the default security group for the VPC.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        For each security group, you add rules that control the inbound traffic to instances, and a
                        separate set of rules that control the outbound traffic.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        This is required for both the configured port and protocol for the listener on the back-end
                        instance and the port and protocol used for the health check.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        This protects the App-server tier from unauthorized access, it is recommended to add inbound
                        security group rules that allow traffic for the specific application protocol and ports by
                        referencing as source the security group associated with the App tier ELB.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        Using the Amazon unified command line interface:
                        &lt;/div&gt;
                        &lt;div style=""&gt;
                        &lt;ul&gt;
                        &lt;li&gt;First remove all the ingress rules for the App tier security group (use the &amp;quot;AppTierSecurityGroup&amp;quot;
                        element from Audit procedure):&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        aws ec2 describe-security-groups --group-id app_tier_security_group
                        --query &amp;quot;SecurityGroups[0].IpPermissions&amp;quot; &amp;gt; /tmp/IpPermissions.json
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;div style=""&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        aws ec2 revoke-security-group-ingress --group-id app_tier_security_group
                        --ip-permissions file:///tmp/IpPermissions.json
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Add an ingress rule for a specific port, using --source-group option to specify the
                        App tier ELB security group as the source of the connections:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        aws ec2 authorize-security-group-ingress --group-id app_tier_security_group
                        --protocol tcp --port specific_port
                        --source-group app_tier_elb_security_group
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='Amazon docs: authorize security groups ingress' url='http://docs.aws.amazon.com/cli/latest/reference/ec2/authorize-security-group-ingress.html' />
            <reference name='Amazon docs: describe launch configurations' url='http://docs.aws.amazon.com/cli/latest/reference/autoscaling/describe-launch-configurations.html' />
            <reference name='Amazon docs: describe security groups' url='http://docs.aws.amazon.com/cli/latest/reference/ec2/describe-security-groups.html' />
            <reference name='Amazon docs: revoke security group ingress' url='http://docs.aws.amazon.com/cli/latest/reference/ec2/revoke-security-group-ingress.html' />
          </references>
          <standards>
            <standard ref='6.22' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            Using the Amazon unified command line interface:
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;ul&gt;
                            &lt;li&gt;List the ingress rules for the above security group, and make sure that allows
                            connections only from App tier ELB security group on specific ports:&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;/div&gt;
                            &lt;blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            aws ec2 describe-security-groups --filters Name=tag:app_tier_tag,Values=app_tier_tag_value
                            --query &amp;quot;SecurityGroups[*].{GroupName:GroupName, IpPermissions:IpPermissions,
                            AppTierSecurityGroup:GroupId}&amp;quot; --output table
                            &lt;/div&gt;
                            &lt;/blockquote&gt;
                            &lt;/blockquote&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-1.14' name='Use HTTPS listener for App Tier ELB' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  A load balancer takes requests from clients and distributes them across the EC2 instances that are registered with the load balancer (also known as back-end instances). 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  A listener is a process that checks for connection requests. It is configured with a protocol and a port for front-end (client to load balancer) connections. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Note: an HTTPS listener configured on the ELB is not mandatory if you are terminating SSL connections directly on the App Tier EC2 instances, and using a TCP listener on the ELB (TCP pass-through) 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Using an HTTPS Elastic Load Balancer listener will make sure the application traffic between the client and the App Tier ELB is encrypted over the SSL\TLS channel. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified command line interface: 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;If the ListenerDescription field is missing, add a new HTTPS listener configured with a SSL\TLS certificate (the listener forwards traffic to the backend instances on port 80, but this can be modified by editing InstancePort=80):&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws elb create-load-balancer-listeners --load-balancer-name &amp;lt;app_tier_elb&amp;gt; --listeners Protocol=HTTPS,LoadBalancerPort=443,InstanceProtocol=HTTP,InstancePort=80, SSLCertificateId=ssl_certificate_arn 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: create load balancer listeners' url='http://docs.aws.amazon.com/cli/latest/reference/elb/create-load-balancer-listeners.html' />
            <reference name='Amazon docs: describe load balancers' url='http://docs.aws.amazon.com/cli/latest/reference/elb/describe-load-balancers.html' />
            <reference name='Amazon docs: ELB listener configuration' url='http://docs.aws.amazon.com/ElasticLoadBalancing/latest/DeveloperGuide/elb-listener-config.html' />
          </references>
          <standards>
            <standard ref='1.14' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
  Using the Amazon unified command line interface: 
&lt;/div&gt; 
&lt;div&gt;
  (Note that you should replace &amp;lt;app_tier_elb&amp;gt; with your App tier ELB name) 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Check if the App Tier ELB is using an HTTPS or TCP listener. Note if the ListenerDescription field is missing or not:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws elb describe-load-balancers --load-balancer-names &amp;lt;app_tier_elb&amp;gt; --query &amp;quot;LoadBalancerDescriptions[*].{LoadBalancerName:LoadBalancerName, DNSName:DNSName, Scheme:Scheme, ListenerDescriptions:ListenerDescriptions[?Listener.Protocol == 'HTTPS' || Listener.Protocol == 'TCP']}&amp;quot; --output table 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-ELB-02' name='Select the Server Order Preference option' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Within Elastic Load Balancing ensure the use of newer and stronger cipher suites when
                        establishing a new connection supporting the Server Order Preference option. When this option is
                        selected, the load balancer selects the first cipher in its list that is in the client's list of
                        ciphers.
                        &lt;br /&gt;
                        &lt;br /&gt;
                        &lt;b&gt; &lt;b&gt;Remediation:&lt;/b&gt; &lt;/b&gt;
                        &lt;br /&gt;To enable Server Order Preference:
                        &lt;br /&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Open the Amazon EC2 console.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Under LOAD BALANCING, choose Load Balancers.&lt;br /&gt;&lt;/li&gt;
                        &lt;li&gt;Select your Load Balancer.&lt;br /&gt;&lt;/li&gt;
                        &lt;li&gt;On the Listeners tab, for Cipher, choose Change.&lt;br /&gt;&lt;/li&gt;
                        &lt;li&gt;On the Select a Cipher page, select Custom Security Policy.&lt;br /&gt;&lt;/li&gt;
                        &lt;li&gt;For SSL Options, select Server Order Preference.&lt;br /&gt;&lt;/li&gt;
                        &lt;li&gt;Click Save. &lt;/li&gt;
                        &lt;/ul&gt;
                    </desc>
          <implementations />
          <references />
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ul&gt;
                            &lt;li&gt;Open the Amazon EC2 console.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Under LOAD BALANCING, choose Load Balancers.&lt;br /&gt;&lt;/li&gt;
                            &lt;li&gt;Select your Load Balancer.&lt;br /&gt;&lt;/li&gt;
                            &lt;li&gt;On the Listeners tab, for Cipher, choose Change.&lt;br /&gt;&lt;/li&gt;
                            &lt;li&gt;On the Select a Cipher page, select Custom Security Policy.&lt;br /&gt;&lt;/li&gt;
                            &lt;li&gt;For SSL Options, check that the option Server Order Preference is selected. &lt;/li&gt;
                            &lt;/ul&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-6.17' name='Use a Web-Tier ELB Security Group to accept only HTTP/HTTPS ' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  A security group acts as a virtual firewall for your instance to control inbound and outbound traffic. When you launch an instance in the AWS Virtual Private Cloud (VPC), you can assign the instance up to five security groups. Security groups act at the instance level, not the subnet level. Therefore, each instance in a subnet in your VPC could be assigned to a different set of security groups. If you don't specify a particular group at launch time, the instance is automatically assigned to the default security group for the VPC. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  For each security group, you add rules that control the inbound traffic to instances, and a separate set of rules that control the outbound traffic. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The SG associated with the Web tier ELB should allow connectivity from any source IP (0.0.0.0/0) only for the HTTP (TCP 80) and HTTPS (TCP 443) ports. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified command line interface: 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;First remove all the ingress rules for the security group associated with the Web tier ELB:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws ec2 describe-security-groups --group-id &amp;lt;security_group_id&amp;gt; --query &amp;quot;SecurityGroups[0].IpPermissions&amp;quot; &amp;gt; /tmp/IpPermissions.json 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div style=""&gt; 
   &lt;br /&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws ec2 revoke-security-group-ingress --group-id &amp;lt;security_group_id&amp;gt; --ip-permissions file:///tmp/IpPermissions.json 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;create locally the below json file containing ingress rules for any source IP (0.0.0.0/0) only for the HTTP (TCP 80) and HTTPS (TCP 443) ports and name it IpPermissions.json:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     [ 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; { 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;PrefixListIds&amp;quot;: [], 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;FromPort&amp;quot;: 80, 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;IpRanges&amp;quot;: [ 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; { 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;CidrIp&amp;quot;: &amp;quot;0.0.0.0/0&amp;quot; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; } 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ], 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;ToPort&amp;quot;: 80, 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;IpProtocol&amp;quot;: &amp;quot;tcp&amp;quot;, 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;UserIdGroupPairs&amp;quot;: [] 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; }, 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; { 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;PrefixListIds&amp;quot;: [], 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;FromPort&amp;quot;: 443, 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;IpRanges&amp;quot;: [ 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; { 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;CidrIp&amp;quot;: &amp;quot;0.0.0.0/0&amp;quot; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; } 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ], 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;ToPort&amp;quot;: 443, 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;IpProtocol&amp;quot;: &amp;quot;tcp&amp;quot;, 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;UserIdGroupPairs&amp;quot;: [] 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;nbsp; } 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     ] 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Add to the security group associated with the Web tier ELB the above ingress rules:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws ec2 authorize-security-group-ingress --group-id &amp;lt;security_group_id&amp;gt;&amp;nbsp; --ip-permissions file:///PathTo/IpPermissions.json 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</desc>
          <implementations />
          <references />
          <standards>
            <standard ref='6.17' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
  Using the Amazon unified command line interface: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;List the security group associated with the Web tier ELB:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws elb describe-load-balancers --load-balancer-name &amp;lt;your_web_tier_elb&amp;gt; --query &amp;quot;LoadBalancerDescriptions[*].{DNSName:DNSName, SecurityGroups:SecurityGroups, SourceSecurityGroup:SourceSecurityGroup}&amp;quot; --output table 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;blockquote&gt; 
 &lt;div&gt; 
  &lt;br /&gt; 
 &lt;/div&gt; 
&lt;/blockquote&gt; 
&lt;div&gt;
  note the security group id from the output 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;List the ingress rules for the above security group, and make sure that only HTTP (TCP 80) and HTTPS (TCP 443) traffic is allowed from any source IP (0.0.0.0/0)any source IP (0.0.0.0/0):&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws ec2 describe-security-groups --group-ids&amp;nbsp; &amp;lt;security_group_id&amp;gt; --query &amp;quot;SecurityGroups[*].{GroupName:GroupName, IpPermissions:IpPermissions}&amp;quot; --output table 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-3.14' name='Associate App Tier Auto-Scaling Group to ELB' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  Elastic Load Balancing automatically distributes incoming application traffic across multiple Amazon EC2 instances within a VPC. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  It enables greater levels of fault tolerance in your applications, seamlessly providing the required amount of load balancing capacity needed to distribute application traffic across 1 or more Availability Zones within a VPC. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Elastic Load Balancing must be integrated with Auto Scaling Groups to ensure that you have availability of compute resources in the event of a failure. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Integrating Auto Scaling Groups with an Elastic Load Balancer will help provide high availability and back-end EC2 instance scaling. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Through Auto-Scaling Group configuration you can define: 
&lt;/div&gt; 
&lt;div&gt;
  minimum / maximum number of EC2 instances to be launched by the Auto-Scaling Group 
&lt;/div&gt; 
&lt;div&gt;
  Availability Zones / subnets used 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified command line interface: 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;List existing load balancers:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws elb describe-load-balancers --query 'LoadBalancerDescriptions[*].{ELBName:LoadBalancerName}' 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;div style=""&gt; 
  &lt;br /&gt; 
 &lt;/div&gt; 
 &lt;div style=""&gt;
   or 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Create new load balancer:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws elb create-load-balancer --load-balancer-name &amp;lt;app_tier_elb&amp;gt; --scheme internal --listeners &amp;lt;listener_config&amp;gt; --subnets &amp;lt;app_tier_subnet1&amp;gt; &amp;lt;app_tier_subnet2&amp;gt; --security-groups &amp;lt;app_tier_elb_security_group&amp;gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Attached load balancer from previous steps to autoscaling group:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws autoscaling attach-load-balancers --load-balancer-names &amp;lt;app_tier_elb&amp;gt; --auto-scaling-group-name &amp;lt;app_tier_autoscaling_group_name&amp;gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: attach load balancers' url='http://docs.aws.amazon.com/cli/latest/reference/autoscaling/attach-load-balancers.html' />
            <reference name='Amazon docs: create load balancer' url='http://docs.aws.amazon.com/cli/latest/reference/elb/create-load-balancer.html' />
            <reference name='Amazon docs: describe auto-scaling groups' url='http://docs.aws.amazon.com/cli/latest/reference/autoscaling/describe-auto-scaling-groups.html' />
            <reference name='Amazon docs: describe load balancers' url='http://docs.aws.amazon.com/cli/latest/reference/elb/describe-load-balancers.html' />
            <reference name='Amazon docs: describe load balancers auto-scaling' url='http://docs.aws.amazon.com/cli/latest/reference/autoscaling/describe-load-balancers.html' />
          </references>
          <standards>
            <standard ref='3.14' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
  Using the Amazon unified command line interface: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Identify Autoscaling Group Name and associated ELB name:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws autoscaling describe-auto-scaling-groups&amp;nbsp; --query 'AutoScalingGroups[*].{ELB:LoadBalancerNames, ASGName:AutoScalingGroupName}' 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Identify current status of the ELB:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws autoscaling describe-load-balancers --auto-scaling-group-name &amp;lt;app_tier_autoscaling_group_name&amp;gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-6.21' name='Create the App tier ELB Security Group to only accept HTTP/HTTPS' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        A security group acts as a virtual firewall for your instance to control inbound and outbound
                        traffic. When you launch an instance in the AWS Virtual Private Cloud (VPC), you can assign the
                        instance to up to five security groups. Security groups act at the instance level, not the
                        subnet level. Therefore, each instance in a subnet in your VPC could be assigned to a different
                        set of security groups. If you don't specify a particular group at launch time, the instance is
                        automatically assigned to the default security group for the VPC.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        For each security group, you add rules that control the inbound traffic to instances, and a
                        separate set of rules that control the outbound traffic.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        The SG associated with the App tier ELB should allow connectivity from the security group
                        associated with Web tier instances only for the HTTP (TCP 80) and HTTPS (TCP 443) ports.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        The defaults for HTTP and HTTPS are used as an example, any other ports would apply depending on
                        the application design.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        Using the Amazon unified command line interface:
                        &lt;/div&gt;
                        &lt;div style=""&gt;
                        &lt;ul&gt;
                        &lt;li&gt;First remove all the ingress rules for the security group associated with the App tier
                        ELB:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        aws ec2 describe-security-groups --group-id app_tier_elb_security_group
                        --query &amp;quot;SecurityGroups[0].IpPermissions&amp;quot; &amp;gt; /tmp/IpPermissions.json
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;div style=""&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        aws ec2 revoke-security-group-ingress --group-id app_tier_elb_security_group
                        --ip-permissions file:///tmp/IpPermissions.json
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &lt;ul&gt;
                        &lt;li&gt;create locally the below json file containing ingress rules for HTTP (TCP 80) and
                        HTTPS (TCP 443) ports only from and name it IpPermissions.json:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        [
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; {
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;PrefixListIds&amp;quot;: [],
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;FromPort&amp;quot;: 80,
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;IpRanges&amp;quot;: [],
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;ToPort&amp;quot;: 80,
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;IpProtocol&amp;quot;: &amp;quot;tcp&amp;quot;,
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;UserIdGroupPairs&amp;quot;: [
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; {
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;UserId&amp;quot;:
                        &amp;quot;&amp;lt;&amp;lt;em&amp;gt;aws_account_number&amp;gt;&amp;lt;/em&amp;gt;&amp;quot;,
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;GroupId&amp;quot;:
                        &amp;quot;&amp;lt;span style=&amp;quot;font-style: italic;&amp;quot;&amp;gt;&amp;lt;&amp;lt;/span&amp;gt;&amp;lt;span
                        style=&amp;quot;font-style: italic;&amp;quot;&amp;gt;web_tier_security_group&amp;quot;
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ]
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; },
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; {
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;PrefixListIds&amp;quot;: [],
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;FromPort&amp;quot;: 443,
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;IpRanges&amp;quot;: [],
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;ToPort&amp;quot;: 443,
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;IpProtocol&amp;quot;: &amp;quot;tcp&amp;quot;,
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;UserIdGroupPairs&amp;quot;: [
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; {
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;UserId&amp;quot;:
                        &amp;quot;&amp;lt;&amp;lt;em&amp;gt;aws_account_number&amp;gt;&amp;lt;/em&amp;gt;&amp;quot;,
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;quot;GroupId&amp;quot;:
                        &amp;quot;&amp;lt;span style=&amp;quot;font-style: italic;&amp;quot;&amp;gt;&amp;lt;&amp;lt;/span&amp;gt;&amp;lt;span
                        style=&amp;quot;font-style: italic;&amp;quot;&amp;gt;web_tier_security_group&amp;lt;/span&amp;gt;&amp;gt;&amp;quot;
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ]
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &amp;nbsp; &amp;nbsp; }
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        ]
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Add to the security group associated with the App tier ELB the above ingress rules:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div style=""&gt;
                        aws ec2 authorize-security-group-ingress --group-id app_tier_elb_security_group&amp;nbsp;
                        --ip-permissions file:///PathTo/IpPermissions.json
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='Amazon docs: authorize security group ingress' url='http://docs.aws.amazon.com/cli/latest/reference/ec2/authorize-security-group-ingress.html' />
            <reference name='Amazon docs: describe load balancers' url='http://docs.aws.amazon.com/cli/latest/reference/elb/describe-load-balancers.html' />
            <reference name='Amazon docs: describe security groups' url='http://docs.aws.amazon.com/cli/latest/reference/ec2/describe-security-groups.html' />
            <reference name='Amazon docs: revoke seucrity group ingress' url='http://docs.aws.amazon.com/cli/latest/reference/ec2/revoke-security-group-ingress.html' />
          </references>
          <standards>
            <standard ref='6.21' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
  Using the Amazon unified command line interface: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;List the security group associated with the App tier ELB:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws elb describe-load-balancers --load-balancer-name &amp;lt;app_tier_elb&amp;gt; --query &amp;quot;LoadBalancerDescriptions[*].{DNSName:DNSName, AppTierELBSecurityGroups:SecurityGroups, SourceSecurityGroup:SourceSecurityGroup}&amp;quot; --output table&amp;nbsp; 
  &lt;/div&gt; 
  &lt;div&gt; 
   &lt;br /&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt;
  note the &amp;quot;AppTierELBSecurityGroups&amp;quot; from the output 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;List the ingress rules for the above security group, and make sure that only HTTP (TCP 80) and HTTPS (TCP 443) traffic is allowed from Web tier Security Group:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws ec2 describe-security-groups --group-ids&amp;nbsp; &amp;lt;app_tier_elb_security_group&amp;gt; --query &amp;quot;SecurityGroups[*].{GroupName:GroupName, IpPermissions:IpPermissions}&amp;quot; --output table 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt;</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-6.13' name='Allow connectivity to the VPC Internet Gateway (IGW) and associate the Routing Table with Web tier ELB subnet (by default route (0.0.0.0/0))' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  A route table contains a set of rules, called routes, that are used to determine where network traffic is directed. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Each subnet in your VPC must be associated with a route table; the table controls the routing for the subnet. A subnet can only be associated with one route table at a time, but you can associate multiple subnets with the same route table. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The default route (0.0.0.0/0) should be pointing to the Internet Gateway in order to provide internet connectivity for the Web tier ELB. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified command line interface: 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;For the above route tables, if the default route (0.0.0.0/0) exists but it doesn't have an IGW configured as gateway:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws ec2 replace-route --route-table-id &amp;lt;route_table_id&amp;gt; --destination-cidr-block 0.0.0.0/0 --gateway-id &amp;lt;vpc_igw&amp;gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;For the above route tables, if the default route (0.0.0.0/0) doesn't exist:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws ec2 create-route --route-table-id &amp;lt;route_table_id&amp;gt; --destination-cidr-block 0.0.0.0/0 --gateway-id &amp;lt;vpc_igw&amp;gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon dccs: EC2 create route' url='http://docs.aws.amazon.com/cli/latest/reference/ec2/create-route.html' />
            <reference name='Amazon docs: describe load balancers' url='http://docs.aws.amazon.com/cli/latest/reference/elb/describe-load-balancers.html' />
            <reference name='Amazon docs: EC2 describe routes' url='http://docs.aws.amazon.com/cli/latest/reference/ec2/describe-route-tables.html' />
            <reference name='Amazon docs: EC2 replace route' url='http://docs.aws.amazon.com/cli/latest/reference/ec2/replace-route.html' />
          </references>
          <standards>
            <standard ref='6.13' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
  Using the Amazon unified command line interface: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;List the subnets associated with the Web tier ELB:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws elb describe-load-balancers --load-balancer-name &amp;lt;web_tier_elb&amp;gt; --query &amp;quot;LoadBalancerDescriptions[*].Subnets&amp;quot; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;List the routes of the route tables associated with the above subnets, and check if the default route (0.0.0.0/0) has an IGW configured as gateway:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws ec2 describe-route-tables --filters Name=association.subnet-id,Values=&amp;lt;web_tier_elb_subnet1&amp;gt;,&amp;lt;web_tier_elb_subnet2&amp;gt; --query &amp;quot;RouteTables[*].{RouteTableId:RouteTableId, Routes:Routes}&amp;quot; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-1.1' name='Use HTTPS listener for Web Tier ELB' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  A load balancer takes requests from clients and distributes them across the EC2 instances that are registered with the load balancer (also known as back-end instances). 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  A listener is a process that checks for connection requests. It is configured with a protocol and a port for front-end (client to load balancer) connections 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Note: an HTTPS listener configured on the ELB is not mandatory if you are terminating SSL connections directly on the Web Tier EC2 instances, and using a TCP listener on the ELB (TCP pass-through) 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Using an HTTPS Elastic Load Balancer listener will make sure the application traffic between the client and the Web Tier ELB is encrypted over the SSL\TLS channel. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt; 
  &lt;div&gt;
    Using the Amazon unified command line interface: 
  &lt;/div&gt; 
  &lt;div&gt; 
   &lt;ul&gt; 
    &lt;li&gt;If the ListenerDescription field is missing, add a new HTTPS listener configured with a SSL\TLS certificate (the listener forwards traffic to the backend instances on port 80, but this can be modified by editing InstancePort=80):&lt;/li&gt; 
   &lt;/ul&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt; 
    &lt;div&gt;
      aws elb create-load-balancer-listeners --load-balancer-name &amp;lt;web_tier_elb&amp;gt; --listeners Protocol=HTTPS,LoadBalancerPort=443,InstanceProtocol=HTTP,InstancePort=80, SSLCertificateId=ssl_certificate_arn 
    &lt;/div&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: create load balancer listeners' url='http://docs.aws.amazon.com/cli/latest/reference/elb/create-load-balancer-listeners.html' />
            <reference name='Amazon docs: describe load balancers' url='http://docs.aws.amazon.com/cli/latest/reference/elb/describe-load-balancers.html' />
            <reference name='Amazon docs: ELB listener configuration' url='http://docs.aws.amazon.com/ElasticLoadBalancing/latest/DeveloperGuide/elb-listener-config.html' />
          </references>
          <standards>
            <standard ref='1.1' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
  Using the Amazon unified command line interface: 
&lt;/div&gt; 
&lt;div&gt;
  (Note that you should replace &amp;lt;web_tier_elb&amp;gt; with your Web-tier ELB name) 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Check if the Web Tier ELB is using an HTTPS or TCP listener. Note if the ListenerDescription field is missing or not:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws elb describe-load-balancers --load-balancer-names &amp;lt;web_tier_elb&amp;gt; --query &amp;quot;LoadBalancerDescriptions[*].{LoadBalancerName:LoadBalancerName, DNSName:DNSName, Scheme:Scheme, ListenerDescriptions:ListenerDescriptions[?Listener.Protocol == 'HTTPS' || Listener.Protocol = 'TCP']}&amp;quot; --output table 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt;</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-3.8' name='Configure Health Check for Web Tier ELB' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  By default, an Auto-Scaling Group periodically uses the results of the EC2 instance status checks to determine the health status of each instance. If an instance fails the EC2 instance status checks, Auto-Scaling marks the instance as unhealthy and replaces the instance. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  However, if you have attached one or more Elastic Load Balancing (ELB) load balancers to your Auto-Scaling Group and the instance fails the ELB health checks, Auto-Scaling does not replace the instance. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Amazon ELB will periodically sends pings, attempt connections, or sends requests to test the EC2 instances, these tests are called health checks. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The status of the instances that are healthy at the time of the health check is InService. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The status of any instances that are unhealthy at the time of the health check is OutOfService. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The load balancer performs health checks on all registered instances, whether the instance is in a healthy state or an unhealthy state. The load balancer routes requests only to the healthy instances. When the load balancer determines that an instance is unhealthy, it stops routing requests to that instance. The load balancer resumes routing requests to the instance when it has been restored to a healthy state 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Ensure availability of back-end EC2 instances associated with an Amazon ELB through application layer health check (ex: http) instead of TCP health checks. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified CLI: 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Create a JSON file containing the attributes you want to modify and save it locally as /tmp/ELBhealthcheck.json:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     { 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;quot;Target&amp;quot;: &amp;quot;&amp;lt;string&amp;gt;&amp;quot;, 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;quot;Interval&amp;quot;: &amp;lt;integer&amp;gt;, 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;quot;Timeout&amp;quot;: &amp;lt;integer&amp;gt;, 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;quot;UnhealthyThreshold&amp;quot;: &amp;lt;integer&amp;gt;, 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;quot;HealthyThreshold&amp;quot;: &amp;lt;integer&amp;gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     } 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Modify Web tier ELB to include appropriate health check:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws elb configure-health-check --load-balancer-name &amp;lt;web_tier_elb&amp;gt; --health-check file:///tmp/ELBhealthcheck.json 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: configure health check' url='http://docs.aws.amazon.com/cli/latest/reference/elb/configure-health-check.html' />
            <reference name='Amazon docs: describe auto scaling groups' url='http://docs.aws.amazon.com/cli/latest/reference/autoscaling/describe-auto-scaling-groups.html' />
            <reference name='Amazon docs: describe load balancers' url='http://docs.aws.amazon.com/cli/latest/reference/elb/describe-load-balancers.html' />
          </references>
          <standards>
            <standard ref='3.8' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
  Using the Amazon unified CLI: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Identify if health check is in place on the Web tier ELB:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws elb describe-load-balancers --load-balancer-names &amp;lt;web_tier_elb&amp;gt; --query 'LoadBalancerDescriptions[*].{ELBName:LoadBalancerName,HealthCheck:HealthCheck}' 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-1.13' name='Configure the latest SSL Security Policies for App Tier ELB' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  Elastic Load Balancing uses an Secure Socket Layer (SSL) negotiation configuration, known as a security policy, to negotiate SSL/TLS connections between a client and the load balancer. A security policy is a combination of SSL/TLS protocols, ciphers, and the Server Order Preference option. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Elastic Load Balancing supports configuring your load balancer to use either predefined or custom security policies. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Secure Sockets Layer (SSL) and Transport Layer Security (TLS) are cryptographic protocols that are used to encrypt confidential data over insecure networks such as the Internet. The TLS protocol is a newer version of the SSL protocol. In the Elastic Load Balancing documentation, we refer to both SSL and TLS protocols as the SSL protocol. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Note: an SSL certificate configured on the ELB and an SSL Security Policy is not mandatory if you are terminating SSL connections directly on the App Tier EC2 instances, and using a TCP listener on the ELB (TCP pass-through) 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Making sure the latest ELB SSL Security Policy is used will ensure the SSL/TLS connection will be negotiated using only the appropriate cryptographic protocols deemed safe with no proven vulnerabilities. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified command line interface: 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div style=""&gt; 
 &lt;ul&gt; 
  &lt;li&gt;(Note that you should replace &amp;lt;app\_tier\_elb&amp;gt; with your App-tier ELB name, and &amp;lt;latest\_ssl\_policy&amp;gt; with the proper policy name)&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws elb set-load-balancer-policies-of-listener --load-balancer-name &amp;lt;app_tier_elb&amp;gt; --load-balancer-port 443 --policy-names&amp;nbsp; &amp;lt;latest_ssl_policy&amp;gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: describe load balancer policies' url='http://docs.aws.amazon.com/cli/latest/reference/elb/describe-load-balancer-policies.html' />
            <reference name='Amazon docs: describe load balancers' url='http://docs.aws.amazon.com/cli/latest/reference/elb/describe-load-balancers.html' />
            <reference name='Amazon docs: ELB listener policy' url='https://aws.amazon.com/premiumsupport/knowledge-center/elb-listener-policy-cli/' />
            <reference name='Amazon docs: ELB security policy options' url='http://docs.aws.amazon.com/ElasticLoadBalancing/latest/DeveloperGuide/elb-security-policy-options.html' />
            <reference name='Amazon docs: set load balancer policies of listener' url='http://docs.aws.amazon.com/cli/latest/reference/elb/set-load-balancer-policies-of-listener.html' />
          </references>
          <standards>
            <standard ref='1.13' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
  Using the Amazon unified command line interface: 
&lt;/div&gt; 
&lt;div&gt;
  (Note that you should replace &amp;lt;app_tier_elb&amp;gt; with your App-tier ELB name) 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Find all the SSL security policies associated with your load balancer listener:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws elb describe-load-balancer-policies --load-balancer-name &amp;lt;app_tier_elb&amp;gt; --query 'PolicyDescriptions[?PolicyTypeName==`SSLNegotiationPolicyType`].{PolicyName:PolicyName,ReferenceSecurityPolicy:PolicyAttributeDescriptions[0].AttributeValue}' --output table 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Find which of the above policies is currently active, and check on AWS documentation if it is the latest (note that for the TCP listeners the PolicyNames element will be empty, but the TCP listener is still compliant when using SSL certificates on the back-end EC2 instances):&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws elb describe-load-balancers --load-balancer-name &amp;lt;app_tier_elb&amp;gt; --query &amp;quot;LoadBalancerDescriptions[*].{CompliantListeners:ListenerDescriptions[?Listener.SSLCertificateId != null || Listener.Protocol == 'TCP']}&amp;quot; --output table 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-6.1' name='Set Root Domain Alias Record to ELB' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  Amazon Route 53 translates friendly domains names like www.example.com into IP addresses like 192.0.2.1. Amazon Route 53 responds to DNS queries using a global network of authoritative DNS servers, which reduces latency. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  When someone enters your domain name in a browser, a DNS request is forwarded to the nearest Amazon Route 53 DNS server in a global network of authoritative DNS servers. Amazon Route 53 responds with the IP address that you specified. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Each domain has an associated hosted zone which contains the resource records pointing to each layer of the application. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  A private hosted zone is a container that holds information about how you want to route traffic for a domain and its subdomains within the Amazon Virtual Private Cloud (Amazon VPC). To begin, you create a private hosted zone and specify the Amazon VPCs that you want to associate with the hosted zone. You then create resource record sets that determine how Amazon Route 53 responds to queries for your domain and subdomains within and among your Amazon VPCs. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Route53 provides special record type called Alias that allows creation of an A record for the root domain and points it to the fully qualified domain of the Elastic Load Balancer (ELB) associated with the web-server layer or Amazon CloudFront. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  In the same way records for all other layers should be created in order to allow flexibility in the application design and not hard-code the FQDN of a resource. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified command line interface: 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Create a hosted zone for YourDomain.com:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws route53 create-hosted-zone --name &amp;lt;your_domain.com&amp;gt; --caller-reference &amp;lt;any_string&amp;gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: about hosted zones' url='http://docs.aws.amazon.com/Route53/latest/DeveloperGuide/AboutHostedZones.html' />
            <reference name='Amazon docs: create hosted zones' url='http://docs.aws.amazon.com/cli/latest/reference/route53/create-hosted-zone.html' />
            <reference name='Amazon docs: list hosted zones' url='http://docs.aws.amazon.com/cli/latest/reference/route53/list-hosted-zones.html' />
          </references>
          <standards>
            <standard ref='6.1' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            Using the Amazon unified command line interface:
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;ul&gt;
                            &lt;li&gt;List all the hosted zones and check if the domain name used by the application is
                            present among them:&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;/div&gt;
                            &lt;blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            aws route53 list-hosted-zones --query 'HostedZones[*].{Name:Name, Id:Id}' --output table
                            &lt;/div&gt;
                            &lt;/blockquote&gt;
                            &lt;/blockquote&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-1.10' name='Configure the latest SSL Security Policies for Web Tier ELB' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  Elastic Load Balancing uses an Secure Socket Layer (SSL) negotiation configuration, known as a security policy, to negotiate SSL/TLS connections between a client and the load balancer. A security policy is a combination of SSL/TLS protocols, ciphers, and the Server Order Preference option. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Elastic Load Balancing supports configuring your load balancer to use either predefined or custom security policies. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Secure Sockets Layer (SSL) and Transport Layer Security (TLS) are cryptographic protocols that are used to encrypt confidential data over insecure networks such as the Internet. The TLS protocol is a newer version of the SSL protocol. In the Elastic Load Balancing documentation, we refer to both SSL and TLS protocols as the SSL protocol. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Note: an SSL certificate configured on the ELB and an SSL Security Policy is not mandatory if you are terminating SSL connections directly on the Web Tier EC2 instances, and using a TCP listener on the ELB (TCP pass-through) 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Making sure the latest ELB SSL Security Policy is used will ensure the SSL/TLS connection will be negotiated using only the appropriate cryptographic protocols deemed safe with no proven vulnerabilities. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified command line interface: 
 &lt;/div&gt; 
 &lt;div style=""&gt;
   (Note that you should replace &amp;lt;web\_tier\_elb&amp;gt; with your Web-tier ELB name, and _&amp;lt;latest\_ssl\_policy&amp;gt;_ with the proper policy name) 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;br /&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;div&gt; 
  &lt;div style=""&gt;
    aws elb set-load-balancer-policies-of-listener --load-balancer-name &amp;lt;web_tier_elb&amp;gt; --load-balancer-port 443 --policy-names&amp;nbsp; &amp;lt;latest_ssl_policy&amp;gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/blockquote&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: describe load balancer policies' url='http://docs.aws.amazon.com/cli/latest/reference/elb/describe-load-balancer-policies.html' />
            <reference name='Amazon docs: describe load balancers' url='http://docs.aws.amazon.com/cli/latest/reference/elb/describe-load-balancers.html' />
            <reference name='Amazon docs: ELB listener policy' url='https://aws.amazon.com/premiumsupport/knowledge-center/elb-listener-policy-cli/' />
            <reference name='Amazon docs: ELB security policy options' url='http://docs.aws.amazon.com/ElasticLoadBalancing/latest/DeveloperGuide/elb-security-policy-options.html' />
            <reference name='Amazon docs: set load balancer policies of listener' url='http://docs.aws.amazon.com/cli/latest/reference/elb/set-load-balancer-policies-of-listener.html' />
          </references>
          <standards>
            <standard ref='1.10' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
  Using the Amazon unified command line interface: 
&lt;/div&gt; 
&lt;div&gt;
  (Note that you should replace &amp;lt;web_tier_elb&amp;gt; with your Web-tier ELB name) 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Find all the SSL security policies associated with your load balancer listener:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws elb describe-load-balancer-policies --load-balancer-name &amp;lt;web_tier_elb&amp;gt; --query 'PolicyDescriptions[?PolicyTypeName==`SSLNegotiationPolicyType`].{PolicyName:PolicyName,ReferenceSecurityPolicy:PolicyAttributeDescriptions[0].AttributeValue}' --output table 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Find which of the above policies is currently active, and check on AWS documentation if it is the latest (note that for the TCP listeners the PolicyNames element will be empty, but the TCP listener is still compliant when using SSL certificates on the back-end EC2 instances):&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws elb describe-load-balancers --load-balancer-name &amp;lt;web_tier_elb&amp;gt; --query &amp;quot;LoadBalancerDescriptions[*].{CompliantListeners:ListenerDescriptions[?Listener.SSLCertificateId != null || Listener.Protocol == 'TCP']}&amp;quot; --output table 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-3.12' name='Set a HTTPS connection from all CloudFront Distributions to the Web Tier ELB origin' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  Configure the Origin Protocol Policy for the Web tier ELB origin either to require that CloudFront fetches objects from your origin by using HTTPS or to require that CloudFront uses the protocol that the viewer used to request the objects. For example, if you choose Match Viewer for the Origin Protocol Policy and the viewer uses HTTPS to request an object from CloudFront, CloudFront also uses HTTPS to forward the request to your origin. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  In order to use HTTPS, an SSL\TLS certificate must be attached. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  To ensure that objects are encrypted from edge locations to the Web-Tier ELB origin according to the data classification policy, use Match Viewer. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified command line interface: 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;For configuring &amp;quot;OriginProtocolPolicy&amp;quot;first save locally the current distribution config:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws cloudfront get-distribution-config --id application_cfn_distribution_id&amp;nbsp; --query &amp;quot;DistributionConfig&amp;quot; &amp;gt; /tmp/cf-distribution.json 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;div style=""&gt; 
  &lt;br /&gt; 
 &lt;/div&gt; 
 &lt;div style=""&gt;
   Edit and replace &amp;quot;OriginProtocolPolicy&amp;quot;element in /tmp/cf-distribution.json with the below section: 
 &lt;/div&gt; 
 &lt;div style=""&gt;
   &amp;quot;OriginProtocolPolicy&amp;quot;: &amp;quot;https-only&amp;quot;, 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Retrieve the current ETag of your CloudFront distribution:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws cloudfront get-distribution-config --id &amp;lt;application_cfn_distribution_id&amp;gt;&amp;nbsp; --query &amp;quot;ETag&amp;quot; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Update the CloudFront distribution using the edited config and the above Etag:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws cloudfront update-distribution --id &amp;lt;application_cfn_distribution_id&amp;gt; --distribution-config file:///tmp/cf-distribution.json --if-match &amp;lt;application_cfn_distribution_etag&amp;gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: CloudFront get streaming configuration' url='http://docs.aws.amazon.com/cli/latest/reference/cloudfront/get-streaming-distribution-config.html' />
            <reference name='Amazon docs: CloudFront list distributions' url='http://docs.aws.amazon.com/cli/latest/reference/cloudfront/list-distributions.html' />
            <reference name='Amazon docs: secure connections - CloudFront' url='http://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/SecureConnections.html' />
            <reference name='Amazon docs: update CloudFront distribution' url='http://docs.aws.amazon.com/cli/latest/reference/cloudfront/update-distribution.html' />
          </references>
          <standards>
            <standard ref='3.12' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            Using the Amazon unified command line interface:
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;ul&gt;
                            &lt;li&gt;Check the &amp;quot;OriginProtocolPolicy&amp;quot; used by application Cloudfront
                            distributions (it should be set as https-only):&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;/div&gt;
                            &lt;blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            aws cloudfront list-distributions --query &amp;quot;DistributionList.Items[*].{Id:Id,
                            OriginProtocolPolicy:Origins.Items[*].CustomOriginConfig.OriginProtocolPolicy}&amp;quot;
                            &lt;/div&gt;
                            &lt;/blockquote&gt;
                            &lt;/blockquote&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-3.9' name='Configure Health Check for App Tier ELB' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  By default, an Auto-Scaling Group periodically uses the results of the EC2 instance status checks to determine the health status of each instance. If an instance fails the EC2 instance status checks, Auto-Scaling marks the instance as unhealthy and replaces the instance. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  However, if you have attached one or more Elastic Load Balancing (ELB) load balancers to your Auto-Scaling Group and the instance fails the ELB health checks, Auto-Scaling does not replace the instance. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Amazon ELB will periodically sends pings, attempts connections, or sends requests to test the EC2 instances, these tests are called health checks. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The status of the instances that are healthy at the time of the health check is InService. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The status of any instances that are unhealthy at the time of the health check is OutOfService. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The load balancer performs health checks on all registered instances, whether the instance is in a healthy state or an unhealthy state. The load balancer routes requests only to the healthy instances. When the load balancer determines that an instance is unhealthy, it stops routing requests to that instance. The load balancer resumes routing requests to the instance when it has been restored to a healthy state 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Ensures availability of back-end EC2 instances associated with an Amazon ELB through application layer health check (ex: http) instead of TCP health checks. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified CLI: 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Create a JSON file containing the attributes you want to modify and save it locally as /tmp/ELBhealthcheck.json:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     { 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;quot;Target&amp;quot;: &amp;quot;&amp;lt;string&amp;gt;&amp;quot;, 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;quot;Interval&amp;quot;: &amp;lt;integer&amp;gt;, 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;quot;Timeout&amp;quot;: &amp;lt;integer&amp;gt;, 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;quot;UnhealthyThreshold&amp;quot;: &amp;lt;integer&amp;gt;, 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     &amp;nbsp; &amp;quot;HealthyThreshold&amp;quot;: &amp;lt;integer&amp;gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     } 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Modify App tier ELB to include appropriate health check:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws elb configure-health-check --load-balancer-name &amp;lt;app_tier_elb&amp;gt; --health-check file:///tmp/ELBhealthcheck.json 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: configure health check' url='http://docs.aws.amazon.com/cli/latest/reference/elb/configure-health-check.html' />
            <reference name='Amazon docs: describe auto-scaling groups' url='http://docs.aws.amazon.com/cli/latest/reference/autoscaling/describe-auto-scaling-groups.html' />
            <reference name='Amazon docs: describe load balancers' url='http://docs.aws.amazon.com/cli/latest/reference/elb/describe-load-balancers.html' />
            <reference name='Amazon docs: ELB healthchecks' url='http://docs.aws.amazon.com/ElasticLoadBalancing/latest/DeveloperGuide/elb-healthchecks.html' />
          </references>
          <standards>
            <standard ref='3.9' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
  Using the Amazon unified CLI: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Identify if health check is in place on the App tier ELB:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws elb describe-load-balancers --load-balancer-names &amp;lt;app_tier_elb&amp;gt; --query 'LoadBalancerDescriptions[*].{ELBName:LoadBalancerName,HealthCheck:HealthCheck}' 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-3.1' name='Associate each Auto-Scaling Group to ELB' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  Elastic Load Balancing automatically distributes incoming application traffic across multiple Amazon EC2 instances within a VPC. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  It enables greater levels of fault tolerance in your applications, seamlessly providing the required amount of load balancing capacity needed to distribute application traffic across 1 or more Availability Zones within a VPC. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Elastic Load Balancing must be integrated with Auto Scaling Groups to ensure that you have availability of compute resources in the event of a failure. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Integrating Auto Scaling Groups with an Elastic Load Balancer will help provide high availability and back-end EC2 instance scaling. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Through Auto-Scaling Group configuration you can define: 
&lt;/div&gt; 
&lt;div&gt;
  minimum / maximum number of EC2 instances to be launched by the Auto-Scaling Group 
&lt;/div&gt; 
&lt;div&gt;
  Availability Zones / subnets used 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified command line interface: 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;List existing load balancers:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws elb describe-load-balancers --query 'LoadBalancerDescriptions[*].{ELBName:LoadBalancerName}' 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;div style=""&gt; 
  &lt;br /&gt; 
 &lt;/div&gt; 
 &lt;div style=""&gt;
   or 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Create new load balancer:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws elb create-load-balancer --load-balancer-name &amp;lt;elb_name&amp;gt; --listeners &amp;lt;listener_config&amp;gt; --subnets &amp;lt;application_subnet&amp;gt; --security-groups &amp;lt;application_security_groups&amp;gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Attached load balancer from previous steps to autoscaling group:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws autoscaling attach-load-balancers --load-balancer-names &amp;lt;elb_name&amp;gt; --auto-scaling-group-name &amp;lt;autoscaling_group_name&amp;gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: attach load balancers' url='http://docs.aws.amazon.com/cli/latest/reference/autoscaling/attach-load-balancers.html' />
            <reference name='Amazon docs: create load balancer' url='http://docs.aws.amazon.com/cli/latest/reference/elb/create-load-balancer.html' />
            <reference name='Amazon docs: describe auto-scaling groups' url='http://docs.aws.amazon.com/cli/latest/reference/autoscaling/describe-auto-scaling-groups.html' />
            <reference name='Amazon docs: describe autoscaling load balancers' url='http://docs.aws.amazon.com/cli/latest/reference/autoscaling/describe-load-balancers.html' />
            <reference name='Amazon docs: describe load balancers' url='http://docs.aws.amazon.com/cli/latest/reference/elb/describe-load-balancers.html' />
          </references>
          <standards>
            <standard ref='3.1' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
  Using the Amazon unified command line interface: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Identify Autoscaling Group Name and associated ELB name:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws autoscaling describe-auto-scaling-groups&amp;nbsp; --query 'AutoScalingGroups[*].{ELB:LoadBalancerNames, ASGName:AutoScalingGroupName}' 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Identify current status of the ELB:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws autoscaling describe-load-balancers --auto-scaling-group-name &amp;lt;autoscaling_group_name&amp;gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-6.18' name='Do not use Web tier ELB Security Group in the Auto Scaling launch configuration of any other tier (Web, App)' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  When you use the AWS Management Console to create a load balancer in a VPC, you can choose an existing security group for the VPC or create a new security group for the VPC. If you choose an existing security group, it must allow traffic in both directions to the listener and health check ports for the load balancer. If you choose to create a security group, the console automatically adds rules to allow all traffic on these ports. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Be sure to review the security group rules to ensure that they allow traffic on the listener and health check ports for the new load balancer. When you delete your load balancer, this security group is not deleted automatically. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  If you add a listener to an existing load balancer, you must review your security groups to ensure they allow traffic on the new listener port in both directions. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The web-tier ELB is the only one that is public facing and should have rules to allow inbound traffic to the application ports (ex: HTTP and HTTPS) from any IP source (0.0.0.0/0). 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The outbound security group rules for the web-tier ELB should be restricted to only the backend web-server instances for the appropriate application ports. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Associating the web-tier ELB security group to any other instances that shouldn't be publicly accessible exposes them to unauthorized access. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified command line interface: 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Create new launch configuration using the correct security groups for Web and/or App tier:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws autoscaling create-launch-configuration --launch-configuration-name &amp;lt;web_tier_launch_config&amp;gt; --image-id &amp;lt;web_tier_ami&amp;gt; --key-name &amp;lt;your_key_pair&amp;gt; --security-groups &amp;lt;web_tier_security_group&amp;gt;/&amp;lt;app_tier_security_group --instance-type &amp;lt;desired_instance_type&amp;gt; --iam-instance-profile &amp;lt;web_tier_instance_profile&amp;gt;/&amp;lt;app_tier_instance_profile&amp;gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: autoscaling create launch configuration' url='http://docs.aws.amazon.com/cli/latest/reference/autoscaling/create-launch-configuration.html' />
            <reference name='Amazon docs: describe launch configuration' url='http://docs.aws.amazon.com/cli/latest/reference/autoscaling/describe-launch-configurations.html' />
            <reference name='Amazon docs: describe load balancers' url='http://docs.aws.amazon.com/cli/latest/reference/elb/describe-load-balancers.html' />
          </references>
          <standards>
            <standard ref='6.18' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
  Using the Amazon unified command line interface: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;List the security group associated with the Web tier ELB:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws elb describe-load-balancers --load-balancer-name &amp;lt;web_tier_elb&amp;gt; --query &amp;quot;LoadBalancerDescriptions[*].{DNSName:DNSName, WebTierELBSecurityGroups:SecurityGroups, SourceSecurityGroup:SourceSecurityGroup}&amp;quot; --output table 
  &lt;/div&gt; 
  &lt;div&gt; 
   &lt;br /&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt;
  note the &amp;quot;WebTierELBSecurityGroups&amp;quot; from the output 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;List the security groups associated with all Autoscaling launch configurations and make sure that the above Web tier ELB security group is not present:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws autoscaling describe-launch-configurations --query &amp;quot;LaunchConfigurations[*].{SecurityGroups:SecurityGroups, LaunchConfigurationName:LaunchConfigurationName}&amp;quot; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control>
</controls>
<usecases>
<usecase ref='AMAZON WEB SERVICES' name='Amazon Web Services' desc='' library=''>
          <threats>
<threat ref='EAVESDROPPING-COMMUNICATIONS' name='An attacker eavesdrops on the communication between the client and server and decrypts the data.' state='Expose' source='MANUAL' owner='' library=''>
              <desc>Eavesdropping on communication is a network attack that captures small packets
                                transmitted by other computers and reads the data content. This type of network attack
                                is most effective when weak encryption services are used. An attacker could eavesdrop on
                                the communication between the client and server and decrypt the encrypted data.
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='CWE-295'>
                  <controls>
                    <control ref='aws-tier-1.12' mitigation='11' />
                    <control ref='aws-tier-1.9' mitigation='11' />
                  </controls>
                </weakness>
                <weakness ref='CWE-326'>
                  <controls>
                    <control ref='Hydras-AWS-ELB-01' mitigation='11' />
                    <control ref='Hydras-AWS-ELB-02' mitigation='11' />
                    <control ref='aws-tier-1.10' mitigation='11' />
                    <control ref='aws-tier-1.13' mitigation='11' />
                  </controls>
                </weakness>
                <weakness ref='CWE-311'>
                  <controls>
                    <control ref='aws-tier-1.1' mitigation='11' />
                    <control ref='aws-tier-1.14' mitigation='11' />
                    <control ref='aws-tier-3.12' mitigation='12' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='Hydras-AWS-ELB-01' mitigation='11' />
                <control ref='Hydras-AWS-ELB-02' mitigation='11' />
                <control ref='aws-tier-1.1' mitigation='11' />
                <control ref='aws-tier-1.10' mitigation='11' />
                <control ref='aws-tier-1.12' mitigation='11' />
                <control ref='aws-tier-1.13' mitigation='11' />
                <control ref='aws-tier-1.14' mitigation='11' />
                <control ref='aws-tier-1.9' mitigation='11' />
                <control ref='aws-tier-3.12' mitigation='12' />
              </controls>
            </threat><threat ref='UNAUTHORIZED-CONECTIONS-AWS' name='Attackers gain unauthorized connection to the resources' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;p&gt;Attackers could gain an unauthorized connection to the resources through
                                misconfigured ports or security network configurations.&lt;/p&gt;
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AWS-Network-5.2'>
                  <controls>
                    <control ref='aws-tier-3.1' mitigation='9' />
                    <control ref='aws-tier-3.13' mitigation='9' />
                    <control ref='aws-tier-3.14' mitigation='9' />
                    <control ref='aws-tier-6.18' mitigation='9' />
                    <control ref='aws-tier-6.26' mitigation='9' />
                    <control ref='aws-tier-6.5' mitigation='10' />
                  </controls>
                </weakness>
                <weakness ref='AWS-Network-5.1'>
                  <controls>
                    <control ref='aws-tier-6.1' mitigation='9' />
                  </controls>
                </weakness>
                <weakness ref='AWS-NET-01'>
                  <controls>
                    <control ref='aws-tier-6.13' mitigation='9' />
                    <control ref='aws-tier-6.17' mitigation='9' />
                    <control ref='aws-tier-6.21' mitigation='9' />
                    <control ref='aws-tier-6.22' mitigation='9' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='aws-tier-3.1' mitigation='9' />
                <control ref='aws-tier-3.13' mitigation='9' />
                <control ref='aws-tier-3.14' mitigation='9' />
                <control ref='aws-tier-6.1' mitigation='9' />
                <control ref='aws-tier-6.13' mitigation='9' />
                <control ref='aws-tier-6.17' mitigation='9' />
                <control ref='aws-tier-6.18' mitigation='9' />
                <control ref='aws-tier-6.21' mitigation='9' />
                <control ref='aws-tier-6.22' mitigation='9' />
                <control ref='aws-tier-6.26' mitigation='9' />
                <control ref='aws-tier-6.5' mitigation='10' />
              </controls>
            </threat><threat ref='UNAUDITABLE-CHANGES-RESOURCES-AWS' name='Attackers make undetected and unaudited changes in the resources' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;div&gt;
                                If audit trails in the resources are not enabled or not protected, attackers could gain
                                access to the system and modify or delete data from the resources and the changes are
                                not detected.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AWS-Logging-3.4'>
                  <controls>
                    <control ref='aws-tier-5.2' mitigation='34' />
                  </controls>
                </weakness>
                <weakness ref='unknown-resource-status'>
                  <controls>
                    <control ref='aws-tier-3.8' mitigation='33' />
                    <control ref='aws-tier-3.9' mitigation='33' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='aws-tier-3.8' mitigation='33' />
                <control ref='aws-tier-3.9' mitigation='33' />
                <control ref='aws-tier-5.2' mitigation='34' />
              </controls>
            </threat>
</threats>
</usecase>
</usecases>
</component>
<component ref='HYDRAS-AWS-SNS' name='AWS SNS' desc='' groupName='' tags='' position='9' library='' diagramPositionX='0' diagramPositionY='0' componentDefinitionRef=''>
      <weaknesses>
<weakness ref='AWS-SNS-01' name='Notifications are not centralized' state='0' impact='100'>
          <desc>The notifications are not centralized; therefore, the control of these notifications and who
                        receives them is not easily managed.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-S3-7.3' name='Sensitive data is exposed in transit' state='0' impact='100'>
          <desc>Sensitive data is not encrypted in transit with HTTPS or SSL, and this data is accessible
                        whilst traversing the network.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='no-access-control-subscribe-sns-topics' name='No access control to subscribe on SNS topics' state='0' impact='100'>
          <desc>The notifications are not centralized; therefore, the control of these notifications and who
                        receives them is not easily managed.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='no-access-control-publish-sns-topics' name='No access control to publish on SNS topics' state='0' impact='100'>
          <desc>The notifications are not centralized; therefore, the control of these notifications and who
                        receives them is not easily managed.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='log-actions-sending-out-notifications' name='Log the actions to send out notifications' state='0' impact='100'>
          <desc>The sensitive data is not encrypted in transit with HTTPS or SSL, and the data is accessible
                        in the canal.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness>
</weaknesses>
<controls>
<control ref='aws-tier-2.10' name='Do not permit &apos;Everyone&apos; to subscribe on SNS topics' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  Amazon Simple Notification Service (Amazon SNS) is a web service that coordinates and manages the delivery or sending of messages to subscribing endpoints or clients. In Amazon SNS, there are two types of clients - publishers and subscribers - also referred to as producers and consumers. Publishers communicate asynchronously with subscribers by producing and sending a message to a topic, which is a logical access point and communication channel. Subscribers (i.e., web servers, email addresses, Amazon SQS queues, AWS Lambda functions) consume or receive the message or notification over one of the supported protocols (i.e., Amazon SQS, HTTP/S, email, SMS, Lambda) when they are subscribed to the topic. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The entities who can subscribe to a SNS topic can be controlled by modifying the topic policy, and they can be: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;The topic owner&lt;/li&gt; 
  &lt;li&gt;Everyone&lt;/li&gt; 
  &lt;li&gt;Specific AWS users or resources&lt;/li&gt; 
  &lt;li&gt;Users whose endpoint URL,protocol, email address, or ARN from a Subscribe request match a specified value&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;div&gt;
  From the above topic subscribers, you should make sure that &amp;quot;Everyone&amp;quot; is not used with any SNS topic in the AWS account. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  If a SNS topic policy allows &amp;quot;Everyone&amp;quot; to subscribe to a specific topic, this could pose a security risk as any unauthenticated entity could subscribe and receive messages from the topic publishers, messages that should be destined only to specific, known subscribers. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Edit your existing policy by deleting the above snippet or replacing &amp;quot;Principal&amp;quot;:{&amp;quot;AWS&amp;quot; : &amp;quot;*&amp;quot;} with &amp;quot;Principal&amp;quot;:{&amp;quot;AWS&amp;quot; : &amp;quot;&amp;quot;}, and save it locally as a .json file named policy.json. 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;br /&gt; 
 &lt;/div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified command line interface: 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Set the new policy to the SNS topic&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws sns set-topic-attributes --topic-arn sns_topic_arn --attribute-name Policy --attribute-value file://policy.json 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: sns get topic attributes' url='http://docs.aws.amazon.com/cli/latest/reference/sns/get-topic-attributes.html' />
            <reference name='Amazon docs: sns list topics' url='http://docs.aws.amazon.com/cli/latest/reference/sns/list-topics.html' />
            <reference name='Amazon docs: sns set topic attributes' url='http://docs.aws.amazon.com/cli/latest/reference/sns/set-topic-attributes.html' />
            <reference name='Amazon docs: using IAM with SNS' url='http://docs.aws.amazon.com/sns/latest/dg/UsingIAMwithSNS.html#ExamplePolicies_SNS' />
          </references>
          <standards>
            <standard ref='2.10' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
  Using the Amazon unified command line interface: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;List all the SNS topics from your AWS account:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws sns list-topics 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;For each topic in step 1, list the topic attributes:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws sns get-topic-attributes --topic-arn &amp;lt;sns_topic_arn&amp;gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Check the Policy field for the presence of:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    { 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    &amp;quot;Effect&amp;quot;:&amp;quot;Allow&amp;quot;, 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    &amp;quot;Principal&amp;quot;:{ 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;blockquote&gt; 
   &lt;blockquote&gt; 
    &lt;div&gt;
      &amp;quot;AWS&amp;quot;:&amp;quot;*&amp;quot; 
    &lt;/div&gt; 
   &lt;/blockquote&gt; 
  &lt;/blockquote&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;blockquote&gt; 
   &lt;blockquote&gt; 
    &lt;div&gt;
      }, 
    &lt;/div&gt; 
   &lt;/blockquote&gt; 
  &lt;/blockquote&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    &amp;quot;Action&amp;quot;: [ 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;blockquote&gt; 
   &lt;blockquote&gt; 
    &lt;div&gt;
      &amp;quot;SNS:Subscribe&amp;quot;, 
    &lt;/div&gt; 
   &lt;/blockquote&gt; 
  &lt;/blockquote&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;blockquote&gt; 
   &lt;blockquote&gt; 
    &lt;div&gt;
      &amp;quot;SNS:Receive&amp;quot; 
    &lt;/div&gt; 
   &lt;/blockquote&gt; 
  &lt;/blockquote&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;blockquote&gt; 
   &lt;blockquote&gt; 
    &lt;div&gt;
      ], 
    &lt;/div&gt; 
   &lt;/blockquote&gt; 
  &lt;/blockquote&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    &amp;quot;Resource&amp;quot;:&amp;quot;&amp;lt;sns_topic_arn&amp;gt;&amp;quot; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    } 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-SNS-01' name='Use Amazon SNS to centralize notifications' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Configure all alerts from the Amazon environment with the Amazon Simple Notification Service
                        (SNS) to have centralized notifications and control over who receives these notifications, in
                        the same place.
                        &lt;br /&gt;
                        &lt;br /&gt;
                        &lt;b&gt; &lt;b&gt;Remediation:&lt;/b&gt; &lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to CoudWatch alarms.&lt;/li&gt;
                        &lt;li&gt;Edit each alarm and change the notification configuration to the SNS service.&lt;/li&gt;
                        &lt;/ol&gt;
                    </desc>
          <implementations />
          <references />
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>Check that all alerts from the Amazon environment are configured with the Amazon Simple
                            Notification Service (SNS).
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-4.2' name='Create a SNS topic for sending out notifications from RDS events' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  For the RDS event subscriptions to be able to send out notifications, a SNS topic should be created. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Amazon Simple Notification Service (Amazon SNS) is a web service that coordinates and manages the delivery or sending of messages to subscribing endpoints or clients. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  When using Amazon SNS, you (as the owner) create a topic and control access to it by defining policies that determine which publishers and subscribers can communicate with the topic. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  RDS events generated through defined RDS event subscriptions needs to be sent out to administrators, in order to be acted upon. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified CLI: 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Create a new topic, and note the topic-arn value:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws sns create-topic --name &amp;lt;sns_topic_name&amp;gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Create a subscription to the new topic:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws sns subscribe --topic-arn &amp;lt;sns_topic_arn&amp;gt; --protocol &amp;lt;protocol_for_sns&amp;gt; --notification-endpoint &amp;lt;sns_subscription_endpoints&amp;gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: sns get topic attributes' url='http://docs.aws.amazon.com/cli/latest/reference/sns/get-topic-attributes.html' />
            <reference name='Amazon docs: sns list subscriptions by topic' url='http://docs.aws.amazon.com/cli/latest/reference/sns/list-subscriptions-by-topic.html' />
            <reference name='Amazon docs: sns set topic attributes' url='http://docs.aws.amazon.com/cli/latest/reference/sns/create-topic.html' />
            <reference name='Amazon docs: sns subscribe' url='http://docs.aws.amazon.com/cli/latest/reference/sns/subscribe.html' />
          </references>
          <standards>
            <standard ref='4.2' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
  Using the Amazon unified CLI: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;List all RDS event subscriptions in order to capture the topic-arn:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws rds describe-event-subscriptions --query 'EventSubscriptionsList[*].{SourceType:SourceType, SourceIdsList:SourceIdsList, EventCategoriesList:EventCategoriesList}' 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;List SNS topic attributes:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws sns list-topic-attributes --topic-arn &amp;lt;sns_topic_arn&amp;gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;List SNS topic subscriptions (endpoint which receives messages captured by the SNS topic):&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws sns list-subscriptions-by-topic --topic-arn &amp;lt;sns_topic_arn&amp;gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-SNS-02' name='Enforce HTTPS to encrypt notifications' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>To send messages to an HTTPS endpoint through a topic, you must subscribe the endpoint to the
                        Amazon SNS topic. You specify the endpoint using its URL. To subscribe to a topic, you can use
                        the Amazon SNS console, the sns-subscribe command, or the Subscribe API action.
                        &lt;br /&gt;
                        &lt;br /&gt;
                        &lt;b&gt; &lt;b&gt;Remediation:&lt;/b&gt; &lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Sign in to the AWS Management Console and open the Amazon SNS console at
                        https://console.aws.amazon.com/sns/v2/home.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;In the left navigation pane, click Topics and then select the topic.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Click the Other actions drop-down list and select Subscribe to topic.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;In the Protocol drop-down list, select HTTPS.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;In the Endpoint box, paste in the URL for the endpoint that you want the topic to send
                        messages to and then click Create subscription.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;For the Subscription request received! message, click Close.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Your new subscription's Subscription ID displays PendingConfirmation. When you confirm
                        the subscription, Subscription ID will display the subscription ID.&amp;nbsp;&lt;/li&gt;
                        &lt;/ol&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;.
                    </desc>
          <implementations />
          <references />
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Sign in to the AWS Management Console and open the Amazon SNS console at
                            https://console.aws.amazon.com/sns/v2/home.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;In the left navigation panel, click Topics and then select the topic.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Click the Other actions drop-down list and select Subscribe to topic.I&lt;/li&gt;
                            &lt;li&gt;In the Protocol drop-down list, check that the protocol HTTPS is selected.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-2.9' name='Do not permit &apos;Everyone&apos; to publish SNS topics' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  Amazon Simple Notification Service (Amazon SNS) is a web service that coordinates and manages the delivery or sending of messages to subscribing endpoints or clients. In Amazon SNS, there are two types of clients - publishers and subscribers - also referred to as producers and consumers. Publishers communicate asynchronously with subscribers by producing and sending a message to a topic, which is a logical access point and communication channel. Subscribers (i.e., web servers, email addresses, Amazon SQS queues, AWS Lambda functions) consume or receive the message or notification over one of the supported protocols (i.e., Amazon SQS, HTTP/S, email, SMS, Lambda) when they are subscribed to the topic. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The entities who can publish messages to a SNS topic can be controlled by modifying the topic policy, and they can be: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;The topic owner&lt;/li&gt; 
  &lt;li&gt;Everyone&lt;/li&gt; 
  &lt;li&gt;Specific AWS users or resources&lt;/li&gt; 
 &lt;/ul&gt;From the above message publisher options you should make sure that &amp;quot;Everyone&amp;quot; is not used with any SNS topic in the AWS account. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  If an SNS topic policy allows &amp;quot;Everyone&amp;quot; to publish messages to a specific topic, this could pose a security risk as any unauthenticated entity could send malicious messages to all the topic subscribers. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Edit your existing policy by deleting the above snippet or replacing &amp;quot;Principal&amp;quot;:{&amp;quot;AWS&amp;quot; : &amp;quot;*&amp;quot;} with &amp;quot;Principal&amp;quot;:{&amp;quot;AWS&amp;quot; : &amp;quot;&amp;quot;}, and save it locally as a .json file named policy.json. 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;br /&gt; 
 &lt;/div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified command line interface: 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Set the new policy to the SNS topic&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws sns set-topic-attributes --topic-arn sns_topic_arn --attribute-name Policy --attribute-value file://policy.json 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;b&gt;&lt;br /&gt;&lt;/b&gt; 
&lt;/div&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: sns get topic attributes' url='http://docs.aws.amazon.com/cli/latest/reference/sns/get-topic-attributes.html' />
            <reference name='Amazon docs: sns list topics' url='http://docs.aws.amazon.com/cli/latest/reference/sns/list-topics.html' />
            <reference name='Amazon docs: sns set topic attributes' url='http://docs.aws.amazon.com/cli/latest/reference/sns/set-topic-attributes.html' />
            <reference name='Amazon docs: Using IAM with SNS' url='http://docs.aws.amazon.com/sns/latest/dg/UsingIAMwithSNS.html#ExamplePolicies_SNS' />
          </references>
          <standards>
            <standard ref='2.9' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
  Using the Amazon unified command line interface: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;List all the SNS topics from your AWS account:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws sns list-topics 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;For each topic in step 1, list the topic attributes:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws sns get-topic-attributes --topic-arn &amp;lt;sns_topic_arn&amp;gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Check the Policy field for the presence of:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    { 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    &amp;quot;Effect&amp;quot;:&amp;quot;Allow&amp;quot;, 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    &amp;quot;Principal&amp;quot;:{ 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;blockquote&gt; 
   &lt;blockquote&gt; 
    &lt;div&gt;
      &amp;quot;AWS&amp;quot;:&amp;quot;*&amp;quot; 
    &lt;/div&gt; 
   &lt;/blockquote&gt; 
  &lt;/blockquote&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;blockquote&gt; 
   &lt;blockquote&gt; 
    &lt;div&gt;
      }, 
    &lt;/div&gt; 
   &lt;/blockquote&gt; 
  &lt;/blockquote&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    &amp;quot;Action&amp;quot;:&amp;quot;SNS:Publish&amp;quot;, 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    &amp;quot;Resource&amp;quot;:&amp;quot;&amp;lt;sns_topic_arn&amp;gt;&amp;quot; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    } 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-4.1' name='Create a SNS topic for sending out notifications from Cloudtwatch Alarms' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  For the Cloudwatch alarms and Auto-Scaling Groups to be able to send out notifications, a SNS topic should be created. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Amazon Simple Notification Service (Amazon SNS) is a web service that coordinates and manages the delivery or sending of messages to subscribing endpoints or clients. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  When using Amazon SNS, you (as the owner) create a topic and control access to it by defining policies that determine which publishers and subscribers can communicate with the topic. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Cloudwatch alarms and certain actions inside Auto-Scaling Groups needs to be sent out to administrators, in order to be acted upon. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified CLI: 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Create a new topic, and note the topic-arn value:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws sns create-topic --name &amp;lt;sns_topic_name&amp;gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Create a subscription to the new topic:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws sns subscribe --topic-arn &amp;lt;sns_topic_arn&amp;gt; --protocol &amp;lt;protocol_for_sns&amp;gt; --notification-endpoint &amp;lt;sns_subscription_endpoints&amp;gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: sns get topic attributes' url='http://docs.aws.amazon.com/cli/latest/reference/sns/get-topic-attributes.html' />
            <reference name='Amazon docs: sns list subscriptions' url='http://docs.aws.amazon.com/cli/latest/reference/sns/list-subscriptions-by-topic.html' />
            <reference name='Amazon docs: sns set topic attributes' url='http://docs.aws.amazon.com/cli/latest/reference/sns/create-topic.html' />
            <reference name='Amazon docs: sns subscribe' url='http://docs.aws.amazon.com/cli/latest/reference/sns/subscribe.html' />
          </references>
          <standards>
            <standard ref='4.1' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
  Using the Amazon unified CLI: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;List all cloudwatch alarms and filter by alarm action (review &amp;quot;AlarmActions&amp;quot;: []):&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws cloudwatch describe-alarms --query 'MetricAlarms[*].{AlarmName:AlarmName, AlarmActions:AlarmActions, Dimensions:Dimensions}' 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;List SNS topic attributes:&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws sns list-topic-attributes --topic-arn &amp;lt;sns_topic_arn&amp;gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;List SNS topic subscriptions (endpoint which receives messages captured by the SNS topic):&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt;
    aws sns list-subscriptions-by-topic --topic-arn &amp;lt;sns_topic_arn&amp;gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control>
</controls>
<usecases>
<usecase ref='VIRTUAL-PRIVATE-CLOUD-VPC-NETWORK' name='Virtual Private Cloud (VPC) Network' desc='' library=''>
          <threats>
<threat ref='ACCESS-TO-DATA-AWS' name='Sensitive data is compromised through unauthorized access to data' state='Expose' source='MANUAL' owner='' library=''>
              <desc>Attackers can gain access to sensitive data when the data is in transit in clear text,
                                or when the data is stored without encryption.
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='no-access-control-publish-sns-topics'>
                  <controls>
                    <control ref='aws-tier-2.9' mitigation='34' />
                  </controls>
                </weakness>
                <weakness ref='no-access-control-subscribe-sns-topics'>
                  <controls>
                    <control ref='aws-tier-2.10' mitigation='33' />
                  </controls>
                </weakness>
                <weakness ref='AWS-S3-7.3'>
                  <controls>
                    <control ref='Hydras-AWS-SNS-02' mitigation='33' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='Hydras-AWS-SNS-02' mitigation='33' />
                <control ref='aws-tier-2.10' mitigation='33' />
                <control ref='aws-tier-2.9' mitigation='34' />
              </controls>
            </threat>
</threats>
</usecase>
<usecase ref='CLOUDWATCH-METRIC-ALERTS' name='Cloudwatch Metric Alerts' desc='' library=''>
          <threats>
<threat ref='AWS-LOST-CONTROL-NOTIFICATION' name='Sensitive data is compromised through notifications' state='Expose' source='MANUAL' owner='' library=''>
              <desc>Attackers can gain access to the resources sensitive data if the system notifications
                                and alerts are not configured properly and the notifications are not received by the
                                appropriate personnel.
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='log-actions-sending-out-notifications'>
                  <controls>
                    <control ref='aws-tier-4.1' mitigation='33' />
                    <control ref='aws-tier-4.2' mitigation='34' />
                  </controls>
                </weakness>
                <weakness ref='AWS-SNS-01'>
                  <controls>
                    <control ref='Hydras-AWS-SNS-01' mitigation='33' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='Hydras-AWS-SNS-01' mitigation='33' />
                <control ref='aws-tier-4.1' mitigation='33' />
                <control ref='aws-tier-4.2' mitigation='34' />
              </controls>
            </threat>
</threats>
</usecase>
</usecases>
</component>
<component ref='HYDRAS-AWS-MON' name='AWS Monitoring' desc='' groupName='' tags='' position='5' library='' diagramPositionX='0' diagramPositionY='0' componentDefinitionRef=''>
      <weaknesses>
<weakness ref='AWS-Monitoring-4.3' name='Lack of 2FA' state='0' impact='100'>
          <desc>Login to the console without using the Multi-factor Authentication (MFA) and they are not
                        detected. The connection without the MFA must be audited and monitored, the correct security
                        group must be informed and they must validate this connection.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-Monitoring-4.10' name='Changes in the security groups cannot be detected' state='0' impact='100'>
          <desc>The changes in the security groups must be audited and monitored and the correspondent
                        personnel must approve these changes. If the situation is not the correct, attackers can access
                        to security systems.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-Monitoring-4.5' name='Brute force attempts on the Amazon management console cannot be detected' state='0' impact='100'>
          <desc>The failure connection attempts (brute force) must be audited and monitored and the
                        correspondent personnel must be alerted and informed.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-Monitoring-4.4' name='Changes in the security configurations can be not detected' state='0' impact='100'>
          <desc>&lt;div&gt;
                        Monitoring and alerting for security configurations are not configured and changes cannot be
                        detected.&amp;nbsp;
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-Monitoring-4.7' name='Changes in the data encryption configuration cannot be detected' state='0' impact='100'>
          <desc>The changes on the database encryption must be audited and monitored. When there are changes
                        on the database encryption, the security group must be alerted.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-Monitoring-4.2' name='Excessive use of administrator accounts' state='0' impact='100'>
          <desc>The administrator accounts are used for all actions, not only for administrative actions. This
                        is because these users have not got a personal or a user account to do the daily actions.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-Monitoring-4.12' name='Changes in the network configuration cannot be detected' state='0' impact='100'>
          <desc>&lt;div&gt;
                        The changes in the network configurations (NACLs, route and gateway tables) are not detected
                        because the monitorization and alerts of the network configuration are not configured to detect
                        these changes.
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness>
</weaknesses>
<controls>
<control ref='Hydras-AWS-Monitoring-4.8' name='Create s3 bucket policy change alerts' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>When cloudtrail is configured and sending alerts to cloudwatch logs these logs can be queried
                        to identify suspicious API activity. One such activity that should be monitored is S3 bucket
                        policy changes. S3 bucket policies are a resource based policy that provide authorizations on S3
                        buckets.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        Making sure that their integrity remains intact is vital in ensuring the data within the S3
                        bucket remains secure and authorizations intact. Therefore s3 bucket policy changes should be
                        alerted upon
                        &lt;br /&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Create a metric filter that checks for S3 Bucket policy changes:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        aws logs put-metric-filter --log-group-name &amp;lt;group&amp;gt; --filter-name &amp;lt;value&amp;gt;
                        --metric- transformations &amp;lt;value&amp;gt; --filter-pattern '{ ($.eventSource =
                        s3.amazonaws.com) &amp;amp;&amp;amp; (($.eventName = PutBucketAcl) || ($.eventName =
                        PutBucketPolicy) || ($.eventName = PutBucketCors) || ($.eventName = PutBucketLifecycle) ||
                        ($.eventName = PutBucketReplication) || ($.eventName = DeleteBucketPolicy) || ($.eventName =
                        DeleteBucketCors) || ($.eventName = DeleteBucketLifecycle) || ($.eventName =
                        DeleteBucketReplication)) }'
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Create an SNS topic for notifications:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        aws sns create-topic --name &amp;lt;topic_name&amp;gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Create an SNS subscription to the topic created above&amp;nbsp;&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        aws sns subscribe --topic-arn &amp;lt;topic_arn&amp;gt; --protocol email --notification-endpoint
                        &amp;lt;email@example.com&amp;gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Create an alarm based on the above steps:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        aws cloudwatch put-metric-alarm --alarm-name &amp;lt;value&amp;gt; --metric-name &amp;lt;metric_filter_name&amp;gt;
                        --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold
                        --evaluation-periods 1 --namespace &amp;lt;CloudTrailMetrics&amp;gt; --alarm-actions &amp;lt;topic_arn&amp;gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;div&gt;
                        Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='3.8' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Identify the log group name: aws cloudtrail describe-trails&lt;/li&gt;
                            &lt;li&gt;Note the &amp;lt;group&amp;gt; value associated with CloudWatchLogsLogGroupArn.&lt;/li&gt;
                            &lt;li&gt;Get a list of all associated metric filters for this &amp;lt;group&amp;gt;:&amp;nbsp;
                            aws logs describe-metric-filters --log-group-name &amp;quot;&amp;lt;group&amp;gt;&amp;quot;&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure the output contains the following: &amp;quot;filterPattern&amp;quot;: &amp;quot;{
                            ($.eventSource = s3.amazonaws.com) &amp;amp;&amp;amp; (($.eventName = PutBucketAcl) ||
                            ($.eventName = PutBucketPolicy) || ($.eventName = PutBucketCors) || ($.eventName =
                            PutBucketLifecycle) || ($.eventName = PutBucketReplication) || ($.eventName =
                            DeleteBucketPolicy) || ($.eventName = DeleteBucketCors) || ($.eventName =
                            DeleteBucketLifecycle) || ($.eventName = DeleteBucketReplication)) }&amp;quot;&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Note the metricName value associated with the filterPattern found in step 4.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Get a list of CloudWatch alarms and filter on the metricName captured in step 4:
                            aws cloudwatch describe-alarms --query 'MetricAlarms[?MetricName==`&amp;lt;metricName&amp;gt;`]'&lt;/li&gt;
                            &lt;li&gt;Note the AlarmActions value - this will provide the SNS topic ARN value.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure there is at least one subscriber to the SNS topic: aws sns
                            list-subscriptions-by-topic --topic-arn &amp;lt;topic_arm&amp;gt;&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Monitoring-4.3' name='Create management console login alerts when MFA is not used' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>When cloudtrail is configured and sending alerts to cloudwatch logs these logs can be queried
                        to identify suspicious API activity. One such activity that should be monitored is login on the
                        console without MFA. Since logging on at the console should be restricted to only those users
                        with an active MFA this alert will highlight those with password only access. This helps to
                        capture weaker login procedures (password only) as they occur.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Create a metric filter that checks for console login without MFA: aws logs
                        put-metric-filter --log-group-name &amp;lt;cloudwatch-logs-group&amp;gt; --filter-name &amp;lt;name&amp;gt;
                        --metric- transformations &amp;lt;value&amp;gt; --filter-pattern '{
                        $.userIdentity.sessionContext.attributes.mfaAuthenticated != &amp;quot;true&amp;quot; }'&lt;/li&gt;
                        &lt;li&gt;Create an SNS topic for notifications: aws sns create-topic --name &amp;lt;topic_name&amp;gt;&lt;/li&gt;
                        &lt;li&gt;Create an SNS subscription to the topic created above: aws sns subscribe --topic-arn
                        &amp;lt;topic_arn&amp;gt; --protocol email --notification-endpoint &amp;lt;email@example.com&amp;gt;&lt;/li&gt;
                        &lt;li&gt;Create an alarm based on the above steps: aws cloudwatch put-metric-alarm --alarm-name
                        &amp;lt;value&amp;gt; --metric-name &amp;lt;metric_filter_name&amp;gt; --statistic Sum --period
                        300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1
                        --namespace &amp;lt;CloudTrailMetrics&amp;gt; --alarm-actions &amp;lt;topic_arn&amp;gt;&lt;/li&gt;
                        &lt;/ol&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='3.2' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Identify the log group name: aws cloudtrail describe-trails&lt;/li&gt;
                            &lt;li&gt;Note the &amp;lt;group&amp;gt; value associated with CloudWatchLogsLogGroupArn&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Get a list of all associated metric filters for this &amp;lt;group&amp;gt;:&amp;nbsp;
                            aws logs describe-metric-filters --log-group-name &amp;quot;&amp;lt;group&amp;gt;&amp;quot;&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure the output contains the following:&amp;nbsp;&amp;quot;filterPattern&amp;quot;:
                            &amp;quot;{ $.userIdentity.sessionContext.attributes.mfaAuthenticated != &amp;quot;true&amp;quot;
                            }&amp;quot;&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Note the metricName value associated with the filterPattern found in step 4.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Get a list of CloudWatch alarms and filter on the metricName captured in step 4:&amp;nbsp;aws
                            cloudwatch describe-alarms --query 'MetricAlarms[?MetricName==`&amp;lt;metricName&amp;gt;`]'&lt;/li&gt;
                            &lt;li&gt;Note the AlarmActions value - this will provide the SNS topic ARN value.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure there is at least one subscriber to the SNS topic: aws sns
                            list-subscriptions-by-topic --topic-arn &amp;lt;topic_arm&amp;gt;&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Monitoring-4.11' name='Create VPC NACL change alerts' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>When cloudtrail is configured and sending alerts to cloudwatch logs these logs can be queried
                        to identify suspicious API activity. One such activity that should be monitored is VPC NACL
                        changes. Network Access Control Lists (NACLS) control inbound and outbound access to &amp;amp;
                        from AWS subnets and work like packet filters to protect the network. Therefore alerting on
                        changes to NACLS helps ensure that the subnets protected by them are not exposed.&amp;nbsp;
                        &lt;div&gt;
                        &amp;nbsp;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Create a metric filter that checks for NACL changes: aws logs put-metric-filter
                        --log-group-name &amp;lt;group&amp;gt; --filter-name &amp;lt;name&amp;gt; --metric-
                        transformations &amp;lt;value&amp;gt; --filter-pattern '{ ($.eventName = CreateNetworkAcl) ||
                        ($.eventName = CreateNetworkAclEntry) || ($.eventName = DeleteNetworkAcl) || ($.eventName =
                        DeleteNetworkAclEntry) || ($.eventName = ReplaceNetworkAclEntry) || ($.eventName =
                        ReplaceNetworkAclAssociation) }'&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Create an SNS topic for notifications: aws sns create-topic --name &amp;lt;topic_name&amp;gt;&lt;/li&gt;
                        &lt;li&gt;Create an SNS subscription to the topic created above: aws sns subscribe --topic-arn
                        &amp;lt;topic_arn&amp;gt; --protocol email --notification-endpoint &amp;lt;email@example.com&amp;gt;&lt;/li&gt;
                        &lt;li&gt;Create an alarm based on the above steps: aws cloudwatch put-metric-alarm --alarm-name
                        &amp;lt;value&amp;gt; --metric-name &amp;lt;metric_filter_name&amp;gt; --statistic Sum --period
                        300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1
                        --namespace &amp;lt;CloudTrailMetrics&amp;gt; --alarm-actions &amp;lt;topic_arn&amp;gt;&lt;/li&gt;
                        &lt;/ol&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='3.11' supportedStandardRef='CIS AWS Standard' />
            <standard ref='3.14' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Identify the log group name: aws cloudtrail describe-trails&lt;/li&gt;
                            &lt;li&gt;Note the &amp;lt;group&amp;gt; value associated with CloudWatchLogsLogGroupArn.&lt;/li&gt;
                            &lt;li&gt;Get a list of all associated metric filters for this &amp;lt;group&amp;gt;: aws
                            logs describe-metric-filters --log-group-name &amp;quot;&amp;lt;group&amp;gt;&amp;quot;&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure the output contains the following:&amp;nbsp;&amp;quot;filterPattern&amp;quot;:
                            &amp;quot;{ ($.eventName = CreateNetworkAcl) || ($.eventName = CreateNetworkAclEntry) ||
                            ($.eventName = DeleteNetworkAcl) || ($.eventName = DeleteNetworkAclEntry) || ($.eventName =
                            ReplaceNetworkAclEntry) || ($.eventName = ReplaceNetworkAclAssociation) }&amp;quot;&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Note the metricName value associated with the filterPattern found in step 4.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Get a list of CloudWatch alarms and filter on the metricName captured in step 4:
                            aws cloudwatch describe-alarms --query 'MetricAlarms[?MetricName==`&amp;lt;metricName&amp;gt;`]'&lt;/li&gt;
                            &lt;li&gt;Note the AlarmActions value - this will provide the SNS topic ARN value.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure there is at least one subscriber to the SNS topic: aws sns
                            list-subscriptions-by-topic --topic-arn &amp;lt;topic_arm&amp;gt;&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Monitoring-4.10' name='Create security group change alerts' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>When cloudtrail is configured and sending alerts to cloudwatch logs these logs can be queried
                        to identify suspicious API activity. One such activity that should be monitored is security
                        group changes. Security groups are analogous to firewalls and therefore protect inbound and
                        outbound access to &amp;amp; from AWS resources such as ec2 instances and RDS databases (amongst
                        other things. Therefore alerting on changes to security groups helps ensure that the resources
                        protected by them are not exposed.&amp;nbsp;
                        &lt;div&gt;
                        &amp;nbsp;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Create a metric filter that checks for security group changes: aws logs
                        put-metric-filter --log-group-name &amp;lt;group&amp;gt; --filter-name &amp;lt;name&amp;gt;
                        --metric- transformations &amp;lt;value&amp;gt; --filter-pattern '{ ($.eventName =
                        AuthorizeSecurityGroupIngress) || ($.eventName = AuthorizeSecurityGroupEgress) || ($.eventName =
                        RevokeSecurityGroupIngress) || ($.eventName = RevokeSecurityGroupEgress) || ($.eventName =
                        CreateSecurityGroup) || ($.eventName = DeleteSecurityGroup)}'&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Create an SNS topic for notifications: aws sns create-topic --name &amp;lt;topic_name&amp;gt;&lt;/li&gt;
                        &lt;li&gt;Create an SNS subscription to the topic created above: aws sns subscribe --topic-arn
                        &amp;lt;topic_arn&amp;gt; --protocol email --notification-endpoint &amp;lt;email@example.com&amp;gt;&lt;/li&gt;
                        &lt;li&gt;Create an alarm based on the above steps: aws cloudwatch put-metric-alarm --alarm-name
                        &amp;lt;value&amp;gt; --metric-name &amp;lt;metric_filter_name&amp;gt; --statistic Sum --period
                        300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1
                        --namespace &amp;lt;CloudTrailMetrics&amp;gt; --alarm-actions &amp;lt;topic_arn&amp;gt;&lt;/li&gt;
                        &lt;/ol&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='3.10' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Identify the log group name: aws cloudtrail describe-trails&lt;/li&gt;
                            &lt;li&gt;Note the &amp;lt;group&amp;gt; value associated with CloudWatchLogsLogGroupArn.&lt;/li&gt;
                            &lt;li&gt;Get a list of all associated metric filters for this &amp;lt;group&amp;gt;: aws
                            logs describe-metric-filters --log-group-name &amp;quot;&amp;lt;group&amp;gt;&amp;quot;&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure the output contains the following: &amp;quot;filterPattern&amp;quot;: &amp;quot;{
                            ($.eventName = AuthorizeSecurityGroupIngress) || ($.eventName =
                            AuthorizeSecurityGroupEgress) || ($.eventName = RevokeSecurityGroupIngress) || ($.eventName
                            = RevokeSecurityGroupEgress) || ($.eventName = CreateSecurityGroup) || ($.eventName =
                            DeleteSecurityGroup)}&amp;quot;&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Note the metricName value associated with the filterPattern found in step 4.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Get a list of CloudWatch alarms and filter on the metricName captured in step 4:
                            aws cloudwatch describe-alarms --query 'MetricAlarms[?MetricName==`&amp;lt;metricName&amp;gt;`]'&lt;/li&gt;
                            &lt;li&gt;Note the AlarmActions value - this will provide the SNS topic ARN value.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure there is at least one subscriber to the SNS topic: aws sns
                            list-subscriptions-by-topic --topic-arn &amp;lt;topic_arm&amp;gt;&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Monitoring-4.7' name='Create KMS CMK Deletion alerts' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>When cloudtrail is configured and sending alerts to cloudwatch logs these logs can be queried
                        to identify suspicious API activity. One such activity that should be monitored is KMS CMK
                        deletions or deactivation. KMS CMK can be used as the master keys for encrypting data and these
                        keys are stored within AWS. However if these keys are disabled or deactivated then the data that
                        was encrypted with them cannot be accessed. Therefore any scheduled deletions or deactivation of
                        keys should be monitored.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Create a metric filter that checks for KMS CMK disables or deletions: aws logs
                        put-metric-filter --log-group-name &amp;lt;group&amp;gt; --filter-name &amp;lt;name&amp;gt;
                        --metric- transformations &amp;lt;value&amp;gt; --filter-pattern '{($.eventSource =
                        kms.amazonaws.com) &amp;amp;&amp;amp;
                        (($.eventName=DisableKey)||($.eventName=ScheduleKeyDeletion))}'&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Create an SNS topic for notifications: aws sns create-topic --name &amp;lt;topic_name&amp;gt;&lt;/li&gt;
                        &lt;li&gt;Create an SNS subscription to the topic created above: aws sns subscribe --topic-arn
                        &amp;lt;topic_arn&amp;gt; --protocol email --notification-endpoint &amp;lt;email@example.com&amp;gt;&lt;/li&gt;
                        &lt;li&gt;Create an alarm based on the above steps: aws cloudwatch put-metric-alarm --alarm-name
                        &amp;lt;value&amp;gt; --metric-name &amp;lt;metric_filter_name&amp;gt; --statistic Sum --period
                        300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1
                        --namespace &amp;lt;CloudTrailMetrics&amp;gt; --alarm-actions &amp;lt;topic_arn&amp;gt;&amp;nbsp;&lt;/li&gt;
                        &lt;/ol&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='3.7' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Identify the log group name: aws cloudtrail describe-trails&lt;/li&gt;
                            &lt;li&gt;Note the &amp;lt;group&amp;gt; value associated with CloudWatchLogsLogGroupArn.&lt;/li&gt;
                            &lt;li&gt;Get a list of all associated metric filters for this &amp;lt;group&amp;gt;: aws
                            logs describe-metric-filters --log-group-name &amp;quot;&amp;lt;group&amp;gt;&amp;quot;&lt;/li&gt;
                            &lt;li&gt;Ensure the output contains the following:&amp;nbsp;&amp;quot;filterPattern&amp;quot;:
                            &amp;quot;{($.eventSource = kms.amazonaws.com) &amp;amp;&amp;amp;
                            (($.eventName=DisableKey)||($.eventName=ScheduleKeyDeletion))} }&amp;quot;&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Note the metricName value associated with the filterPattern found in step 4.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Get a list of CloudWatch alarms and filter on the metricName captured in step 4:&amp;nbsp;aws
                            cloudwatch describe-alarms --query 'MetricAlarms[?MetricName==`&amp;lt;metricName&amp;gt;`]'&lt;/li&gt;
                            &lt;li&gt;Note the AlarmActions value - this will provide the SNS topic ARN value.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure there is at least one subscriber to the SNS topic:&amp;nbsp; aws sns
                            list-subscriptions-by-topic --topic-arn &amp;lt;topic_arm&amp;gt;&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Monitoring-4.4' name='Create cloudtrail configuration changes alerts' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>When cloudtrail is configured and sending alerts to cloudwatch logs these logs can be queried
                        to identify suspicious API activity. One such activity that should be monitored is changes to
                        cloudtrail. Since cloudtrail is the actual utility logging API calls it's security is paramount
                        to ensuring that this continues. Therefore alerting on changes to cloudtrail activity can
                        prevent a malicious user switching off the logging in order to carry out untracked activities.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&amp;nbsp;&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Identify the log group name: aws cloudtrail describe-trails&lt;/li&gt;
                        &lt;li&gt;Note the &amp;lt;group&amp;gt; value associated with CloudWatchLogsLogGroupArn&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Get a list of all associated metric filters for this &amp;lt;group&amp;gt;:&amp;nbsp;aws
                        logs describe-metric-filters --log-group-name &amp;quot;&amp;lt;group&amp;gt;&amp;quot;&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Ensure the output contains the following: &amp;quot;filterPattern&amp;quot;: &amp;quot;{
                        ($.eventName = CreateTrail) || ($.eventName = UpdateTrail) || ($.eventName = DeleteTrail) ||
                        ($.eventName = StartLogging) || ($.eventName = StopLogging) }&amp;quot;&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Note the metricName value associated with the filterPattern found in step 4.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Get a list of CloudWatch alarms and filter on the metricName captured in step 4: aws
                        cloudwatch describe-alarms --query 'MetricAlarms[?MetricName==`&amp;lt;metricName&amp;gt;`]'&lt;/li&gt;
                        &lt;li&gt;Note the AlarmActions value - this will provide the SNS topic ARN value.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Ensure there is at least one subscriber to the SNS topic: aws sns
                        list-subscriptions-by-topic --topic-arn &amp;lt;topic_arm&amp;gt;&amp;nbsp;&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;br /&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='3.1' supportedStandardRef='CIS AWS Standard' />
            <standard ref='3.5' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Identify the log group name: aws cloudtrail describe-trails&lt;/li&gt;
                            &lt;li&gt;Note the &amp;lt;group&amp;gt; value associated with CloudWatchLogsLogGroupArn.&lt;/li&gt;
                            &lt;li&gt;Get a list of all associated metric filters for this &amp;lt;group&amp;gt;: aws
                            logs describe-metric-filters --log-group-name &amp;quot;&amp;lt;group&amp;gt;&amp;quot;&lt;/li&gt;
                            &lt;li&gt;Ensure the output contains the following:&amp;nbsp;&amp;quot;filterPattern&amp;quot;:
                            &amp;quot;{ ($.eventName = CreateTrail) || ($.eventName = UpdateTrail) || ($.eventName =
                            DeleteTrail) || ($.eventName = StartLogging) || ($.eventName = StopLogging) }&amp;quot;&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Note the metricName value associated with the filterPattern found in step 4.&lt;/li&gt;
                            &lt;li&gt;Get a list of CloudWatch alarms and filter on the metricName captured in step 4:
                            aws cloudwatch describe-alarms --query 'MetricAlarms[?MetricName==`&amp;lt;metricName&amp;gt;`]'&lt;/li&gt;
                            &lt;li&gt;Note the AlarmActions value - this will provide the SNS topic ARN value.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure there is at least one subscriber to the SNS topic: aws sns
                            list-subscriptions-by-topic --topic-arn &amp;lt;topic_arm&amp;gt;&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Monitoring-4.12' name='Create VPC route table change alerts' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>When cloudtrail is configured and sending alerts to cloudwatch logs these logs can be queried
                        to identify suspicious API activity. One such activity that should be monitored is VPC route
                        table changes. VPC route tables provide a means of routing network traffic between subnets and
                        via gateways and ensures traffic flows via the correct path. Therefore alerting on changes to
                        route tables ensuring traffic continues to flow as expected.&amp;nbsp;
                        &lt;div&gt;
                        &amp;nbsp;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;br /&gt;&lt;/b&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Create a metric filter that checks for VPC route table changes: aws logs
                        put-metric-filter --log-group-name &amp;lt;group&amp;gt; --filter-name &amp;lt;name&amp;gt;
                        --metric- transformations &amp;lt;value&amp;gt; --filter-pattern '{ ($.eventName = CreateRoute)
                        || ($.eventName = CreateRouteTable) || ($.eventName = ReplaceRoute) || ($.eventName =
                        ReplaceRouteTableAssociation) || ($.eventName = DeleteRouteTable) || ($.eventName = DeleteRoute)
                        || ($.eventName = DisassociateRouteTable) }'&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Create an SNS topic for notifications: aws sns create-topic --name &amp;lt;topic_name&amp;gt;&lt;/li&gt;
                        &lt;li&gt;Create an SNS subscription to the topic created above: aws sns subscribe --topic-arn
                        &amp;lt;topic_arn&amp;gt; --protocol email --notification-endpoint &amp;lt;email@example.com&amp;gt;&lt;/li&gt;
                        &lt;li&gt;Create an alarm based on the above steps: aws cloudwatch put-metric-alarm --alarm-name
                        &amp;lt;value&amp;gt; --metric-name &amp;lt;metric_filter_name&amp;gt; --statistic Sum --period
                        300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1
                        --namespace &amp;lt;CloudTrailMetrics&amp;gt; --alarm-actions &amp;lt;topic_arn&amp;gt;&lt;/li&gt;
                        &lt;/ol&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='3.13' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Identify the log group name: aws cloudtrail describe-trails&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Note the &amp;lt;group&amp;gt; value associated with CloudWatchLogsLogGroupArn.&lt;/li&gt;
                            &lt;li&gt;Get a list of all associated metric filters for this &amp;lt;group&amp;gt;: aws
                            logs describe-metric-filters --log-group-name &amp;quot;&amp;lt;group&amp;gt;&amp;quot;&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure the output contains the following:&amp;nbsp;&amp;quot;filterPattern&amp;quot;:
                            &amp;quot;{ ($.eventName = CreateRoute) || ($.eventName = CreateRouteTable) || ($.eventName
                            = ReplaceRoute) || ($.eventName = ReplaceRouteTableAssociation) || ($.eventName =
                            DeleteRouteTable) || ($.eventName = DeleteRoute) || ($.eventName = DisassociateRouteTable) }&amp;quot;&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Note the metricName value associated with the filterPattern found in step 4.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Get a list of CloudWatch alarms and filter on the metricName captured in step 4:&amp;nbsp;aws
                            cloudwatch describe-alarms --query 'MetricAlarms[?MetricName==`&amp;lt;metricName&amp;gt;`]'&lt;/li&gt;
                            &lt;li&gt;Note the AlarmActions value - this will provide the SNS topic ARN value.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure there is at least one subscriber to the SNS topic: aws sns
                            list-subscriptions-by-topic --topic-arn &amp;lt;topic_arm&amp;gt;&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Monitoring-4.6' name='Create IAM Policy change alerts' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>When cloudtrail is configured and sending alerts to cloudwatch logs these logs can be queried
                        to identify suspicious API activity. One such activity that should be monitored is management
                        IAM policy changes. IAM manages authorization and authentication controls with AWS and
                        therefore it is vital that unauthorised changes are detected. Enabling monitoring of these
                        changes ensures that these policies remain intact and as desired.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Create a metric filter that checks for IAM policy changes: aws logs put-metric-filter
                        --log-group-name &amp;lt;group&amp;gt; --filter-name &amp;lt;name&amp;gt; --metric-
                        transformations &amp;lt;value&amp;gt; --filter-pattern
                        '{($.eventName=DeleteGroupPolicy)||($.eventName=DeleteRolePolicy)||($.eventName=Delete
                        UserPolicy)||($.eventName=PutGroupPolicy)||($.eventName=PutRolePolicy)||($.eventName=P
                        utUserPolicy)||($.eventName=CreatePolicy)||($.eventName=DeletePolicy)||($.eventName=Cr
                        eatePolicyVersion)||($.eventName=DeletePolicyVersion)||($.eventName=AttachRolePolicy)|
                        |($.eventName=DetachRolePolicy)||($.eventName=AttachUserPolicy)||($.eventName=DetachUs
                        erPolicy)||($.eventName=AttachGroupPolicy)||($.eventName=DetachGroupPolicy)}'&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Create an SNS topic for notifications: aws sns create-topic --name &amp;lt;topic_name&amp;gt;&lt;/li&gt;
                        &lt;li&gt;Create an SNS subscription to the topic created above:aws sns subscribe --topic-arn
                        &amp;lt;topic_arn&amp;gt; --protocol email --notification-endpoint &amp;lt;email@example.com&amp;gt;&lt;/li&gt;
                        &lt;li&gt;Create an alarm based on the above steps: aws cloudwatch put-metric-alarm --alarm-name
                        &amp;lt;value&amp;gt; --metric-name &amp;lt;metric_filter_name&amp;gt; --statistic Sum --period
                        300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1
                        --namespace &amp;lt;CloudTrailMetrics&amp;gt; --alarm-actions &amp;lt;topic_arn&amp;gt;&lt;/li&gt;
                        &lt;/ol&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;br /&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='3.4' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Identify the log group name: aws cloudtrail describe-trails&lt;/li&gt;
                            &lt;li&gt;Note the &amp;lt;group&amp;gt; value associated with CloudWatchLogsLogGroupArn.&lt;/li&gt;
                            &lt;li&gt;Get a list of all associated metric filters for this &amp;lt;group&amp;gt;: aws
                            logs describe-metric-filters --log-group-name &amp;quot;&amp;lt;group&amp;gt;&amp;quot;&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure the output contains the following: &amp;quot;filterPattern&amp;quot;: &amp;quot;{($.eventSource
                            = kms.amazonaws.com) &amp;amp;&amp;amp;
                            (($.eventName=DisableKey)||($.eventName=ScheduleKeyDeletion))} }&amp;quot;&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Note the metricName value associated with the filterPattern found in step 4.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Get a list of CloudWatch alarms and filter on the metricName captured in step 4:
                            aws cloudwatch describe-alarms --query 'MetricAlarms[?MetricName==`&amp;lt;metricName&amp;gt;`]'&lt;/li&gt;
                            &lt;li&gt;Note the AlarmActions value - this will provide the SNS topic ARN value.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure there is at least one subscriber to the SNS topic: aws sns
                            list-subscriptions-by-topic --topic-arn &amp;lt;topic_arm&amp;gt;&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Monitoring-4.5' name='Create management console login failure alerts' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>When cloudtrail is configured and sending alerts to cloudwatch logs these logs can be queried
                        to identify suspicious API activity. One such activity that should be monitored is management
                        console login failures. The management console is the AWS account GUI where administration
                        activity is performed and is therefore a primary target for brute force attempts. To identify
                        these attempts alerts for login failures should be enabled as this can highlight suspicious
                        activity.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;br /&gt;&lt;/b&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Create a metric filter that checks for console login failures: aws logs
                        put-metric-filter --log-group-name &amp;lt;group&amp;gt; --filter-name &amp;lt;name&amp;gt;
                        --metric- transformations &amp;lt;value&amp;gt; --filter-pattern '{ ($.eventName = ConsoleLogin)
                        &amp;amp;&amp;amp; ($.errorMessage = &amp;quot;Failed authentication&amp;quot;) }'&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Create an SNS topic for notifications: aws sns create-topic --name &amp;lt;topic_name&amp;gt;&lt;/li&gt;
                        &lt;li&gt;Create an SNS subscription to the topic created above: aws sns subscribe --topic-arn
                        &amp;lt;topic_arn&amp;gt; --protocol email --notification-endpoint &amp;lt;email@example.com&amp;gt;&lt;/li&gt;
                        &lt;li&gt;Create an alarm based on the above steps: aws cloudwatch put-metric-alarm --alarm-name
                        &amp;lt;value&amp;gt; --metric-name &amp;lt;metric_filter_name&amp;gt; --statistic Sum --period
                        300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1
                        --namespace &amp;lt;CloudTrailMetrics&amp;gt; --alarm-actions &amp;lt;topic_arn&amp;gt;&lt;/li&gt;
                        &lt;/ol&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='3.6' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Identify the log group name: aws cloudtrail describe-trails&lt;/li&gt;
                            &lt;li&gt;Note the &amp;lt;group&amp;gt; value associated with CloudWatchLogsLogGroupArn.&lt;/li&gt;
                            &lt;li&gt;Get a list of all associated metric filters for this &amp;lt;group&amp;gt;: aws
                            logs describe-metric-filters --log-group-name &amp;quot;&amp;lt;group&amp;gt;&amp;quot;&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure the output contains the following:&amp;nbsp;&amp;quot;filterPattern&amp;quot;:
                            &amp;quot;{ ($.eventName = ConsoleLogin) &amp;amp;&amp;amp; ($.errorMessage = \&amp;quot;Failed
                            authentication\&amp;quot;) }&amp;quot;&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Note the metricName value associated with the filterPattern found in step 4.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Get a list of CloudWatch alarms and filter on the metricName captured in step 4:
                            aws cloudwatch describe-alarms --query 'MetricAlarms[?MetricName==`&amp;lt;metricName&amp;gt;`]'&lt;/li&gt;
                            &lt;li&gt;Note the AlarmActions value - this will provide the SNS topic ARN value.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure there is at least one subscriber to the SNS topic: aws sns
                            list-subscriptions-by-topic --topic-arn &amp;lt;topic_arm&amp;gt;&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Monitoring-4.9' name='Create AWS Config configuration change alerts' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>When cloudtrail is configured and sending alerts to cloudwatch logs these logs can be queried
                        to identify suspicious API activity. One such activity that should be monitored is AWS Config
                        changes. AWS config tracks configuration changes within the environment and is a useful change
                        management tool. Therefore alerting on config changes ensures the continued visibility of AWS
                        configuration items.
                        &lt;div&gt;
                        &amp;nbsp;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Create a metric filter that checks for AWS Config changes:&amp;nbsp;&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        aws logs put-metric-filter&amp;nbsp;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        --log-group-name &amp;lt;group&amp;gt;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        --filter-name &amp;lt;name&amp;gt;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        --metric- transformations &amp;lt;value&amp;gt;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        --filter-pattern '{($.eventSource = config.amazonaws.com) &amp;amp;&amp;amp;
                        (($.eventName=StopConfigurationRecorder)||($.eventName=DeleteDeliveryChannel)||($.even
                        tName=PutDeliveryChannel)||($.eventName=PutConfigurationRecorder))}'&amp;nbsp;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Create an SNS topic for notifications: aws sns create-topic --name &amp;lt;topic_name&amp;gt;&lt;/li&gt;
                        &lt;li&gt;Create an SNS subscription to the topic created above: aws sns subscribe --topic-arn
                        &amp;lt;topic_arn&amp;gt; --protocol email --notification-endpoint &amp;lt;email@example.com&amp;gt;&lt;/li&gt;
                        &lt;li&gt;Create an alarm based on the above steps:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        aws cloudwatch put-metric-alarm&amp;nbsp;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        --alarm-name &amp;lt;value&amp;gt;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        --metric-name &amp;lt;metric_filter_name&amp;gt;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        --statistic Sum&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        --period 300&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        --threshold 1&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        --comparison-operator GreaterThanOrEqualToThreshold&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        --evaluation-periods 1&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        --namespace &amp;lt;CloudTrailMetrics&amp;gt;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        --alarm-actions &amp;lt;topic_arn&amp;gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;div&gt;
                        Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='3.9' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ul&gt;
                            &lt;li&gt;Identify the log group name: aws cloudtrail describe-trails&lt;/li&gt;
                            &lt;li&gt;Note the &amp;lt;group&amp;gt; value associated with CloudWatchLogsLogGroupArn.&lt;/li&gt;
                            &lt;li&gt;Get a list of all associated metric filters for this &amp;lt;group&amp;gt;: aws
                            logs describe-metric-filters --log-group-name &amp;quot;&amp;lt;group&amp;gt;&amp;quot;&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure the output contains the following:&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;blockquote&gt;
                            &lt;blockquote&gt;
                            &amp;quot;filterPattern&amp;quot;: &amp;quot;{($.eventSource = config.amazonaws.com) &amp;amp;&amp;amp;
                            (($.eventName=StopConfigurationRecorder)||($.eventName=DeleteDeliveryChannel)||($.even
                            tName=PutDeliveryChannel)||($.eventName=PutConfigurationRecorder))}&amp;quot;&amp;nbsp;
                            &lt;/blockquote&gt;
                            &lt;/blockquote&gt;
                            &lt;ul&gt;
                            &lt;li&gt;Note the metricName value associated with the filterPattern found in step 4.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Get a list of CloudWatch alarms and filter on the metricName captured in step 4:
                            aws cloudwatch describe-alarms --query 'MetricAlarms[?MetricName==`&amp;lt;metricName&amp;gt;`]'&lt;/li&gt;
                            &lt;li&gt;Note the AlarmActions value - this will provide the SNS topic ARN value.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure there is at least one subscriber to the SNS topic: aws sns
                            list-subscriptions-by-topic --topic-arn &amp;lt;topic_arm&amp;gt;&lt;/li&gt;
                            &lt;/ul&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Monitoring-4.13' name='Create VPC gateway change alerts' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>When cloudtrail is configured and sending alerts to cloudwatch logs these logs can be queried
                        to identify suspicious API activity. One such activity that should be monitored is VPC gateway
                        changes. VPC gateways are used as a means of sending traffic outside of a VPC (ie to the
                        internet) and are vital in ensuring traffic flows to the correct destination. Therefore alerting
                        on changes to VPC gateways ensuring traffic continues to flow as expected via the correct
                        gateway.&amp;nbsp;
                        &lt;div&gt;
                        &amp;nbsp;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Create a metric filter that checks for VPC gateway changes: aws logs put-metric-filter
                        --log-group-name &amp;lt;group&amp;gt; --filter-name &amp;lt;name&amp;gt; --metric-
                        transformations &amp;lt;value&amp;gt; --filter-pattern '{ ($.eventName = CreateCustomerGateway)
                        || ($.eventName = DeleteCustomerGateway) || ($.eventName = AttachInternetGateway) ||
                        ($.eventName = CreateInternetGateway) || ($.eventName = DeleteInternetGateway) || ($.eventName =
                        DetachInternetGateway) }'&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Create an SNS topic for notifications: aws sns create-topic --name &amp;lt;topic_name&amp;gt;&lt;/li&gt;
                        &lt;li&gt;Create an SNS subscription to the topic created above: aws sns subscribe --topic-arn
                        &amp;lt;topic_arn&amp;gt; --protocol email --notification-endpoint &amp;lt;email@example.com&amp;gt;&lt;/li&gt;
                        &lt;li&gt;Create an alarm based on the above steps: aws cloudwatch put-metric-alarm --alarm-name
                        &amp;lt;value&amp;gt; --metric-name &amp;lt;metric_filter_name&amp;gt; --statistic Sum --period
                        300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1
                        --namespace &amp;lt;CloudTrailMetrics&amp;gt; --alarm-actions &amp;lt;topic_arn&amp;gt;&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='3.12' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Identify the log group name: aws cloudtrail describe-trails&lt;/li&gt;
                            &lt;li&gt;Note the &amp;lt;group&amp;gt; value associated with CloudWatchLogsLogGroupArn&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Get a list of all associated metric filters for this &amp;lt;group&amp;gt;: aws
                            logs describe-metric-filters --log-group-name &amp;quot;&amp;lt;group&amp;gt;&amp;quot;&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure the output contains the following: &amp;quot;filterPattern&amp;quot;: &amp;quot;{
                            ($.eventName = CreateCustomerGateway) || ($.eventName = DeleteCustomerGateway) ||
                            ($.eventName = AttachInternetGateway) || ($.eventName = CreateInternetGateway) ||
                            ($.eventName = DeleteInternetGateway) || ($.eventName = DetachInternetGateway) }&amp;quot;&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Note the metricName value associated with the filterPattern found in step 4.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Get a list of CloudWatch alarms and filter on the metricName captured in step 4:
                            aws cloudwatch describe-alarms --query 'MetricAlarms[?MetricName==`&amp;lt;metricName&amp;gt;`]'&lt;/li&gt;
                            &lt;li&gt;Note the AlarmActions value - this will provide the SNS topic ARN value.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure there is at least one subscriber to the SNS topic: aws sns
                            list-subscriptions-by-topic --topic-arn &amp;lt;topic_arm&amp;gt;&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Monitoring-4.2' name='Create root account usage alerts' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>When cloudtrail is configured and sending alerts to cloudwatch logs these logs can be queried
                        to identify suspicious API activity. One such activity that should be monitored is usage of the
                        root account. This account should not be used on a day to day basis due to its full unrestricted
                        privilege therefore usage should be by exception. Monitoring this usage should capture any
                        suspicious activity used on the account.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Identify the log group name: aws cloudtrail describe-trails&lt;/li&gt;
                        &lt;li&gt;Note the &amp;lt;group&amp;gt; value associated with CloudWatchLogsLogGroupArn.&lt;/li&gt;
                        &lt;li&gt;Get a list of all associated metric filters for this &amp;lt;group&amp;gt;: aws logs
                        describe-metric-filters --log-group-name &amp;quot;&amp;lt;group&amp;gt;&amp;quot;&lt;/li&gt;
                        &lt;li&gt;Ensure the output contains the following: &amp;quot;filterPattern&amp;quot;: &amp;quot;{
                        $.userIdentity.type = \&amp;quot;Root\&amp;quot; &amp;amp;&amp;amp; $.userIdentity.invokedBy NOT
                        EXISTS &amp;amp;&amp;amp; $.eventType != \&amp;quot;AwsServiceEvent\&amp;quot; } &amp;quot;&lt;/li&gt;
                        &lt;li&gt;Note the metricName value associated with the filterPattern found in step 4.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Get a list of CloudWatch alarms and filter on the metricName captured in step 4: aws
                        cloudwatch describe-alarms --query 'MetricAlarms[?MetricName==`&amp;lt;metricName&amp;gt;`]'&lt;/li&gt;
                        &lt;li&gt;Note the AlarmActions value - this will provide the SNS topic ARN value.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Ensure there is at least one subscriber to the SNS topic: aws sns
                        list-subscriptions-by-topic --topic-arn &amp;lt;topic_arm&amp;gt;&amp;nbsp;&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='3.3' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Identify the log group name: aws cloudtrail describe-trails&lt;/li&gt;
                            &lt;li&gt;Note the &amp;lt;group&amp;gt; value associated with CloudWatchLogsLogGroupArn.&lt;/li&gt;
                            &lt;li&gt;Get a list of all associated metric filters for this &amp;lt;group&amp;gt;: aws
                            logs describe-metric-filters --log-group-name &amp;quot;&amp;lt;group&amp;gt;&amp;quot;&lt;/li&gt;
                            &lt;li&gt;Ensure the output contains the following: &amp;quot;filterPattern&amp;quot;: &amp;quot;{
                            $.userIdentity.type = \&amp;quot;Root\&amp;quot; &amp;amp;&amp;amp; $.userIdentity.invokedBy
                            NOT EXISTS &amp;amp;&amp;amp; $.eventType != \&amp;quot;AwsServiceEvent\&amp;quot; } &amp;quot;&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Note the metricName value associated with the filterPattern found in step 4.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Get a list of CloudWatch alarms and filter on the metricName captured in step 4:&amp;nbsp;aws
                            cloudwatch describe-alarms --query 'MetricAlarms[?MetricName==`&amp;lt;metricName&amp;gt;`]'&lt;/li&gt;
                            &lt;li&gt;Note the AlarmActions value - this will provide the SNS topic ARN value.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure there is at least one subscriber to the SNS topic: aws sns
                            list-subscriptions-by-topic --topic-arn &amp;lt;topic_arm&amp;gt;&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Monitoring-4.1' name='Create billing alerts to identify unusual spend' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>By setting billing alarms you can monitor your AWS spend and be alerted if it exceeds certain
                        thresholds thus protecting you from accruing unnecessary charges.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Sign in to the AWS Management Console and open the Billing and Cost Management console
                        at https://console.aws.amazon.com/billing/home#/.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;On the navigation pane, choose Preferences.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Select the Receive Billing Alerts check box.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Choose Save preferences.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Open the CloudWatch console at https://console.aws.amazon.com/cloudwatch/.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;If necessary, change the region on the navigation bar to US East (N. Virginia). The
                        billing metric data is stored in this region, even for resources in other regions.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;On the navigation pane, under &amp;quot;Metrics&amp;quot;, choose &amp;quot;Billing&amp;quot;.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;In the list of billing metrics, select the check box next to Currency USD, for the
                        metric named EstimatedCharges. Define the alarm as follows:&lt;/li&gt;
                        &lt;ul&gt;
                        &lt;li&gt;If you want the alarm to trigger as soon as you go over the free tier, set &amp;quot;When
                        my total AWS charges for the month exceed&amp;quot; to $.01. This means that you'll receive a
                        notification as soon as you incur a charge. Otherwise, set it to the amount you want to trigger
                        the alarm, and you will be notified when you go over that amount.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Choose the &amp;quot;New list&amp;quot; link next to the &amp;quot;send a notification
                        to&amp;quot; box.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;When prompted, enter your email address or choose your Amazon SNS notification from
                        the drop down.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Choose &amp;quot;Create Alarm&amp;quot;.&amp;nbsp;&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;li&gt;In the &amp;quot;Confirm new email addresses&amp;quot; dialog box, confirm the email
                        address or choose &amp;quot;I will do it later&amp;quot;. If you don't confirm the email address
                        now, the alarm remains in the Pending confirmation status until you do so, and does not send an
                        alert. To view the status of your alarm, choose &amp;quot;Alarms&amp;quot; in the navigation
                        panel.&lt;/li&gt;
                        &lt;/ol&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;br /&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Sign in to the AWS Management Console and open the Billing and Cost Management
                            console at https://console.aws.amazon.com/billing/home#/.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;On the navigation pane, choose Preferences.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure the &amp;quot;Receive Billing Alerts&amp;quot; check box is checked.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Open the CloudWatch console at https://console.aws.amazon.com/cloudwatch/.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;If necessary, change the region on the navigation bar to US East (N. Virginia).
                            The billing metric data is stored in this region, even for resources in other regions.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;On the navigation pane, under &amp;quot;Alarms&amp;quot;, check for one called
                            &amp;quot;Billing&amp;quot;.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Click on the alert if it exists and select the checkbox in the first column.&lt;/li&gt;
                            &lt;li&gt;In the preview pane check that the &amp;quot;EstimatedCharges&amp;quot; threshold
                            is set to the correct value and that the &amp;quot;Actions&amp;quot; is send an alarm to a
                            valid email address.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control>
</controls>
<usecases>
<usecase ref='CLOUDWATCH METRIC ALERTS' name='Cloudwatch Metric Alerts' desc='' library=''>
          <threats>
<threat ref='UNAUTHORIZED-ACCESS-NETWORK-AWS' name='Sensitive data is compromised through undetected network access' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;div&gt;
                                Attackers gain undetected access to the network systems and the changes of the attackers
                                could not be audited or detected.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AWS-Monitoring-4.12'>
                  <controls>
                    <control ref='Hydras-AWS-Monitoring-4.11' mitigation='33' />
                    <control ref='Hydras-AWS-Monitoring-4.12' mitigation='33' />
                    <control ref='Hydras-AWS-Monitoring-4.13' mitigation='34' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='Hydras-AWS-Monitoring-4.11' mitigation='33' />
                <control ref='Hydras-AWS-Monitoring-4.12' mitigation='33' />
                <control ref='Hydras-AWS-Monitoring-4.13' mitigation='34' />
              </controls>
            </threat><threat ref='UNAUTHORIZED_ACCESS_SYSTEMS_AWS' name='Attackers access to the systems without being detected' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;div&gt;
                                Attackers gain access to the systems and they are not detected and the changes of the
                                attackers could not be detected and audited.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AWS-Monitoring-4.5'>
                  <controls>
                    <control ref='Hydras-AWS-Monitoring-4.5' mitigation='17' />
                  </controls>
                </weakness>
                <weakness ref='AWS-Monitoring-4.4'>
                  <controls>
                    <control ref='Hydras-AWS-Monitoring-4.1' mitigation='16' />
                    <control ref='Hydras-AWS-Monitoring-4.4' mitigation='17' />
                    <control ref='Hydras-AWS-Monitoring-4.9' mitigation='17' />
                  </controls>
                </weakness>
                <weakness ref='AWS-Monitoring-4.2'>
                  <controls>
                    <control ref='Hydras-AWS-Monitoring-4.2' mitigation='16' />
                  </controls>
                </weakness>
                <weakness ref='AWS-Monitoring-4.3'>
                  <controls>
                    <control ref='Hydras-AWS-Monitoring-4.3' mitigation='17' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='Hydras-AWS-Monitoring-4.1' mitigation='16' />
                <control ref='Hydras-AWS-Monitoring-4.2' mitigation='16' />
                <control ref='Hydras-AWS-Monitoring-4.3' mitigation='17' />
                <control ref='Hydras-AWS-Monitoring-4.4' mitigation='17' />
                <control ref='Hydras-AWS-Monitoring-4.5' mitigation='17' />
                <control ref='Hydras-AWS-Monitoring-4.9' mitigation='17' />
              </controls>
            </threat><threat ref='UNAUTHORIZED-ACCESS-SECURITY-SYSTEMS-AWS' name='Attackers gain undetected access to the security system configurations' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;div&gt;
                                Attackers could gain undetected access to the security configurations and the changes of
                                the attackers could not be detected and audited.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AWS-Monitoring-4.7'>
                  <controls>
                    <control ref='Hydras-AWS-Monitoring-4.7' mitigation='25' />
                  </controls>
                </weakness>
                <weakness ref='AWS-Monitoring-4.4'>
                  <controls>
                    <control ref='Hydras-AWS-Monitoring-4.6' mitigation='25' />
                    <control ref='Hydras-AWS-Monitoring-4.8' mitigation='25' />
                  </controls>
                </weakness>
                <weakness ref='AWS-Monitoring-4.10'>
                  <controls>
                    <control ref='Hydras-AWS-Monitoring-4.10' mitigation='25' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='Hydras-AWS-Monitoring-4.10' mitigation='25' />
                <control ref='Hydras-AWS-Monitoring-4.6' mitigation='25' />
                <control ref='Hydras-AWS-Monitoring-4.7' mitigation='25' />
                <control ref='Hydras-AWS-Monitoring-4.8' mitigation='25' />
              </controls>
            </threat>
</threats>
</usecase>
</usecases>
</component>
<component ref='HYDRAS-AWS-S3' name='AWS S3' desc='' groupName='' tags='' position='8' library='' diagramPositionX='0' diagramPositionY='0' componentDefinitionRef=''>
      <weaknesses>
<weakness ref='AWS-S3-7.3' name='Sensitive data is exposed in transit' state='0' impact='100'>
          <desc>Sensitive data is not encrypted in transit with HTTPS or SSL, and this data is accessible
                        whilst traversing the network.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-S3-7.1' name='Backup is not created' state='0' impact='100'>
          <desc>The sensitive data cannot be recovered because there is not any method to do a backup or to do
                        versions of the data.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-S3-7.4' name='Sensitive data is accessible' state='0' impact='100'>
          <desc>Sensitive data is not encrypted and is exposed.</desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-S3-7.2' name='Data is easily removed' state='0' impact='100'>
          <desc>Someone without credentials can remove sensitive data, the remove function is not protected
                        for an MFA.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness>
</weaknesses>
<controls>
<control ref='Hydras-AWS-S3-7.3' name='Enforce HTTPS for sensitive information' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Amazon Simple Storage Service is storage for the Internet. It is designed to make web-scale
                        computing easier for developers.
                        &lt;br /&gt;
                        &lt;br /&gt;Amazon S3 has a simple web services interface that you can use to store and retrieve
                        any amount of data, at any time, from anywhere on the web. It gives any developer access to the
                        same highly scalable, reliable, fast, inexpensive data storage infrastructure that Amazon uses
                        to run its own global network of web sites.
                        &lt;br /&gt;
                        &lt;br /&gt;To ensure that data is only accessible via HTTPS (as opposed to both HTTP and HTTPS)
                        it is possible to add a condition to the S3 bucket policy. It is recommended to enable this for
                        any bucket containing sensitive data to ensure that data is encrypted in transit.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;br /&gt;&lt;/b&gt;The following is an example of how to create an S3
                        bucket policy that enforces HTTPS/SSL only
                        &lt;br /&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Sign in to the AWS Management Console (with S3 update privileges)&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Go to the S3 Service on the AWS Console&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Select a bucket under &amp;quot;All buckets&amp;quot;&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Click the properties tab&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Under the permissions select &amp;quot;Add a bucket policy&amp;quot;&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Add the following policy to ensure all objects are accessed via https only&amp;nbsp;&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;i&gt; {&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;i&gt; &amp;quot;Statement&amp;quot;:[&lt;/i&gt;
                        &lt;i&gt;{&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;i&gt; &amp;quot;Action&amp;quot;: &amp;quot;s3:*&amp;quot;,&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;i&gt;&amp;quot;Effect&amp;quot;:&amp;quot;Allow&amp;quot;,&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;i&gt;&amp;quot;Principal&amp;quot;: &amp;quot;*&amp;quot;,&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;i&gt;&amp;quot;Resource&amp;quot;:&amp;quot;arn:aws:s3:::bucketname/*&amp;quot;,&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;i&gt;&amp;quot;Condition&amp;quot;:{&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;i&gt;&amp;quot;Bool&amp;quot;:&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;i&gt;{&amp;nbsp;&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;i&gt;&amp;quot;aws:SecureTransport&amp;quot;: true&amp;nbsp;&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;i&gt;}&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;i&gt;}&lt;/i&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;i&gt; }&lt;/i&gt;
                        &lt;i&gt;]&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;i&gt;} &lt;/i&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Click &amp;quot;&amp;quot;Save&amp;quot;&amp;nbsp;&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;p&gt;Content provided by &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;&lt;/p&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>The following checks that HTTPS is forced on a bucket policy:&amp;nbsp;
                            &lt;br /&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Sign in to the AWS Management Console (with S3 update privileges).&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Go to the S3 Service on the AWS Console.&lt;/li&gt;
                            &lt;li&gt;Select the S3 bucket under &amp;quot;All buckets&amp;quot;.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Click the &amp;quot;properties&amp;quot; tab.&lt;/li&gt;
                            &lt;li&gt;Click &amp;quot;edit bucket policy&amp;quot;.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;In the policy document check for the presence of the line &amp;quot;Condition&amp;quot;:
                            {&amp;quot;Bool&amp;quot;: {&amp;quot;aws:SecureTransport&amp;quot;: &amp;quot;true&amp;quot;}}&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;In the same statement as &amp;quot;Effect&amp;quot;:&amp;quot;Allow&amp;quot;,&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-S3-7.2' name='Use S3 MFA to delete sensitive information' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Amazon Simple Storage Service is storage for the Internet. It is designed to make web-scale
                        computing easier for developers.
                        &lt;br /&gt;
                        &lt;br /&gt;Amazon S3 has a simple web services interface that you can use to store and retrieve
                        any amount of data, at any time, from anywhere on the web. It gives any developer access to the
                        same highly scalable, reliable, fast, inexpensive data storage infrastructure that Amazon uses
                        to run its own global network of web sites.
                        &lt;br /&gt;
                        &lt;br /&gt;To add an extra layer of security to data stored within S3 the account owner (root)
                        can enable MFA Delete which means that buckets and the objects within them can only be deleted
                        with the use of Multi-factor authentication device. It is recommended to enable MFA Delete on
                        any buckets containing sensitive data to protect against accidental deletion
                        &lt;br /&gt;Remediation
                        &lt;br /&gt;1. aws s3api put-bucket-versioning --bucket my-bucket --versioning-configuration
                        Status=Enabled,MFADelete=Enabled
                        &lt;br /&gt;
                        &lt;p&gt;Content provided by &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;&lt;/p&gt;
                    </desc>
          <implementations />
          <references />
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;blockquote&gt;
                            aws s3api get-bucket-versioning --bucket my-bucket&amp;nbsp;
                            &lt;/blockquote&gt;
                            &lt;div&gt;
                            If you don't see &amp;quot;MFADelete&amp;quot;: &amp;quot;Enabled&amp;quot; then your bucket
                            has no MFA delete enabled.
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-S3-7.1' name='Configure S3 bucket versioning for sensitive data' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Amazon Simple Storage Service is storage for the Internet. It is designed to make web-scale
                        computing easier for developers.
                        &lt;br /&gt;
                        &lt;br /&gt;Amazon S3 has a simple web services interface that you can use to store and retrieve
                        any amount of data, at any time, from anywhere on the web. It gives any developer access to the
                        same highly scalable, reliable, fast, inexpensive data storage infrastructure that Amazon uses
                        to run its own global network of web sites.
                        &lt;br /&gt;
                        &lt;br /&gt;To add an extra layer of security to data stored within S3 it is possible to enable
                        object versioning. Object versioning enables the recovery of objects from accidental overwrite
                        or accidental deletion. If an object is deleted, instead of being removed, S3 write a delete
                        marker which becomes the current version that means previous versions can always be recovered.
                        It is recommended that versioning be enabled for buckets storing sensitive data.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;br /&gt;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        aws s3api put-bucket-versioning --bucket my-bucket --versioning-configuration Status=Enabled
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;div&gt;
                        &lt;p&gt;Content provided by &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;&lt;/p&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;blockquote&gt;
                            aws s3api get-bucket-versioning --bucket my-bucket&amp;nbsp;
                            &lt;/blockquote&gt;If you don't see &amp;quot;Status&amp;quot;: &amp;quot;Enabled&amp;quot;
                            then your bucket has no versioning enabled.
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-S3-7.4' name='Encrypt sensitive data at rest with KMS' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Amazon Simple Storage Service is storage for the Internet. It is designed to make web-scale
                        computing easier for developers.
                        &lt;br /&gt;
                        &lt;br /&gt;Amazon S3 has a simple web services interface that you can use to store and retrieve
                        any amount of data, at any time, from anywhere on the web. It gives any developer access to the
                        same highly scalable, reliable, fast, inexpensive data storage infrastructure that Amazon uses
                        to run its own global network of web sites.
                        &lt;br /&gt;
                        &lt;br /&gt;To ensure that sensitive data is encrypted at rest you can use AWS KMS–managed
                        keys (SSE-KMS). This provides several advantages:&amp;nbsp;
                        &lt;ul&gt;
                        &lt;li&gt;You can create and manage the CMK encryption keys yourself.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;You can use a single CMK to encrypt and decrypt log files for multiple accounts across
                        all regions.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;You have control over who can use your key for encrypting and decrypting CloudTrail
                        log files. You can assign permissions for the key to the users in your organization according to
                        your requirements.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;You have enhanced security. With this feature, in order to read log files, you now
                        need to meet two conditions: 1) you must have S3 read permission on the bucket, and 2) you must
                        be granted decrypt permission by the CMK policy.&amp;nbsp;&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;br /&gt;It is recommended to encrypt all sensitive data with SSE-KMS to avoid undue
                        disclosure of information and provide an extra layer of security.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;The following example shows how to upload data using AWS KMS Encryption:
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        aws s3api put-object --bucket &amp;lt;my_bucket&amp;gt; --server-side-encryption aws:kms
                        --ssekms-key-id &amp;lt;kms_key_id&amp;gt; --key &amp;lt;object_to_upload&amp;gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;div&gt;
                        &lt;p&gt;Content provided by &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;&lt;/p&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;blockquote&gt;
                            aws s3api head-object --bucket &amp;lt;my_bucket&amp;gt; --key &amp;lt;my_key&amp;gt;
                            &lt;/blockquote&gt;Look for the line &amp;quot;ServerSideEncryption&amp;quot; and verify
                            that it is set to &amp;quot;aws:kms&amp;quot; which indicates KMS Encryption.
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control>
</controls>
<usecases>
<usecase ref='AMAZON-WEB-SERVICES' name='Amazon Web Services' desc='' library=''>
          <threats>
<threat ref='ACCESS-TO-DATA-AWS' name='Sensitive data is compromised through unauthorized access to data' state='Expose' source='MANUAL' owner='' library=''>
              <desc>Attackers can gain access to sensitive data when the data is in transit in clear text,
                                or when the data is stored without encryption.
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AWS-S3-7.4'>
                  <controls>
                    <control ref='Hydras-AWS-S3-7.4' mitigation='50' />
                  </controls>
                </weakness>
                <weakness ref='AWS-S3-7.3'>
                  <controls>
                    <control ref='Hydras-AWS-S3-7.3' mitigation='50' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='Hydras-AWS-S3-7.3' mitigation='50' />
                <control ref='Hydras-AWS-S3-7.4' mitigation='50' />
              </controls>
            </threat><threat ref='DATA-DELETED-EASY-AWS' name='Data is intentionally or accidentally deleted' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;p&gt;Data can be deleted intentionally or accidentally, and the data cannot be
                                recovered as there are no recovery systems and the data is easy
                                to delete it.&lt;/p&gt;
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AWS-S3-7.1'>
                  <controls>
                    <control ref='Hydras-AWS-S3-7.1' mitigation='50' />
                  </controls>
                </weakness>
                <weakness ref='AWS-S3-7.2'>
                  <controls>
                    <control ref='Hydras-AWS-S3-7.2' mitigation='50' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='Hydras-AWS-S3-7.1' mitigation='50' />
                <control ref='Hydras-AWS-S3-7.2' mitigation='50' />
              </controls>
            </threat>
</threats>
</usecase>
</usecases>
</component>
<component ref='HYDRAS-AWS-NET' name='AWS Networking' desc='' groupName='' tags='' position='6' library='' diagramPositionX='0' diagramPositionY='0' componentDefinitionRef=''>
      <weaknesses>
<weakness ref='AWS-Network-5.1' name='Non-identify the resources' state='0' impact='100'>
          <desc>Resources are not registered in the safety net systems, and there are more unidentified
                        resources. This can be a problem because these unidentified resources can have unknown
                        weaknesses.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-Network-5.8' name='The access to the routing tables are not restricted' state='0' impact='100'>
          <desc>&lt;div&gt;
                        Being highly selective in peering routing tables is a very effective way of minimizing the
                        impact of breach as resources outside of these routes are inaccessible to the peered VPC.
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-Network-5.2' name='Networks for Amazon resources are not properly segmentated.' state='0' impact='100'>
          <desc>&lt;div&gt;
                        Resources in the same VNet are compromised because when one of them is attacked and the
                        attackers gain access, they also gain access to all resources.
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness>
</weaknesses>
<controls>
<control ref='Hydras-AWS-EC2-6.1' name='Launch EC2 instances into a VPC' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>AWS virtual private cloud is the de-facto standard for networking AWS as it provides
                        additional security controls such as Security Groups, Network Access Control Lists (NACL's) and
                        routing. However the use of VPC is not compulsory and resources such as EC2 can be created
                        outside of VPC (usingEC2 Classic). It is the recommendation to make all resources a member of
                        a VPC if possible to benefit from the increased security controls they offer and reduce undue
                        network exposure.&amp;nbsp;
                        &lt;div&gt;
                        &amp;nbsp;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Login to the AWS Management Console.&lt;/li&gt;
                        &lt;li&gt;Select EC2 from the services menu.&lt;/li&gt;
                        &lt;li&gt;Select &amp;quot;Launch Instance&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Complete the wizard until step 3 at which point ensure a VPC ID is selected for the
                        &amp;quot;Network&amp;quot; option, choose an appropriate &amp;quot;Subnet&amp;quot; and &amp;quot;Auto-assign
                        Public IP&amp;quot; option.&amp;nbsp;&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Complete the wizard to launch the instance.&lt;/li&gt;
                        &lt;/ol&gt;NB: If you want to migrate an already running instance you will need to convert the
                        image into an AMI and then launch a new instance using the AMI and placing in a VPC as per the
                        steps above
                        &lt;br /&gt;
                        &lt;p&gt;Content provided by &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;&lt;/p&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Login to the AWS Management Console.&lt;/li&gt;
                            &lt;li&gt;Select EC2 from the services menu.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Instances&amp;quot; from the left hand menu.&lt;/li&gt;
                            &lt;li&gt;For each instance in the list:&lt;/li&gt;
                            &lt;ul&gt;
                            &lt;li&gt;select the instance&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;in the preview pane confirm the instance has a &amp;quot;VPC ID&amp;quot;. If a
                            hyphen &amp;quot;-&amp;quot; is shown then your instance is running in EC2-Classic mode.&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Network-5.1' name='Use AWS VPC for networking' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>AWS virtual private cloud is the de-facto standard for networking AWS as it provides
                        additional security controls such as Security Groups, Network Access Control Lists (NACL's) and
                        routing.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        However the use of VPC is not compulsory and resources such as EC2 can be created outside of VPC
                        (usingEC2 Classic). It is the recommendation to make all resources a member of a VPC if
                        possible to benefit from the increased security controls they offer and reduce undue network
                        exposure.&amp;nbsp;
                        &lt;div&gt;
                        &amp;nbsp;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;br /&gt;&lt;/b&gt;Move or migrate the resources to a VPC.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt; Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>Ensure that each AWS resource you own that is able to exist in a VPC does so.</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Network-5.2' name='Seperate VPC into zones  by function' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>AWS virtual private cloud is the de-facto standard for networking AWS as it provides
                        additional security controls such as Security Groups, Network Access Control Lists (NACL's) and
                        routing. It is recommended that resources be placed into VPC's according to use case (ie
                        dev/test/prod) and that appropriate security levels be set on these VPC's. Placing such
                        resources accordingly ensures that a resource of a higher security level is not exposed by the
                        security settings of a lower labeled VPC.&amp;nbsp;
                        &lt;div&gt;
                        &amp;nbsp;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Identify the resources that exist within an incorrect VPC.&lt;/li&gt;
                        &lt;li&gt;Migrate or move them to the correct VPC.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;br /&gt;
                        &lt;br /&gt;
                        &lt;br /&gt;
                        &lt;br /&gt;
                        &lt;br /&gt;
                        &lt;br /&gt;
                        &lt;br /&gt;
                        &lt;br /&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>Ensure that each AWS resource added to a VPC is isolated according to its designation (ie
                            test/dev/prod).
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Network-5.8' name='Ensure routing tables for VPC peering are "least access"' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Once a VPC peering connection is established, routing tables must be updated to establish any
                        connections between the peered VPCs. These routes can be as specific as desired - even peering a
                        VPC to only a single host on the other side of the connection.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt; Rationale: &lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        Being highly selective in peering routing tables is a very effective way of minimizing the
                        impact of breach as resources outside of these routes are inaccessible to the peered VPC.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt; Remediation: &lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        Remove and add route table entries to ensure that the least number of subnets or hosts as is
                        required to accomplish the purpose for peering are routable.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        Via CLI:
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;li&gt;For each &amp;lt;route_table_id&amp;gt; containing routes non compliant with your
                        routing policy (which grants more than desired &amp;quot;&amp;quot;least access&amp;quot;&amp;quot;),
                        delete the non compliant route:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        aws ec2 delete-route --route-table-id &amp;lt;route_table_id&amp;gt; --destination-cidr-block
                        &amp;lt;non_compliant_destination_CIDR&amp;gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Create a new compliant route:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        aws ec2 create-route --route-table-id &amp;lt;route_table_id&amp;gt; --destination-cidr-block
                        &amp;lt;compliant_destination_CIDR&amp;gt; --vpc-peering-connection-id &amp;lt;peering_connection_id&amp;gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='Configurations with Specific Routes' url='https://docs.aws.amazon.com/AmazonVPC/latest/PeeringGuide/peering-configurations-partial-access.html' />
          </references>
          <standards>
            <standard ref='4.4' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>Review routing tables of peered VPCs for whether they route
                            all subnets of each VPC and whether that is necessary to accomplish the intended purposes
                            for peering the VPCs.&lt;br /&gt;&lt;br /&gt;&lt;b&gt;Via CLI:&lt;/b&gt;&lt;br /&gt;List all
                            the route tables from a VPC and check if &amp;quot;GatewayId&amp;quot; is pointing to a
                            &amp;lt;peering_connection_id&amp;gt; (e.g. pcx-1a2b3c4d) and if &amp;quot;DestinationCidrBlock&amp;quot;
                            is as specific as desired.&lt;br /&gt;
                            &lt;blockquote&gt;
                            aws ec2 describe-route-tables --filter &amp;quot;Name=vpc-id,Values=&amp;lt;vpc_id&amp;gt;&amp;quot;
                            --query &amp;quot;RouteTables[*].{RouteTableId:RouteTableId, VpcId:VpcId, Routes:Routes,
                            AssociatedSubnets:Associations[*].SubnetId}&amp;quot;
                            &lt;/blockquote&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control>
</controls>
<usecases>
<usecase ref='VIRTUAL PRIVATE CLOUD (VPC) NETWORK' name='Virtual Private Cloud (VPC) Network' desc='' library=''>
          <threats>
<threat ref='UNAUTHORIZED-CONECTIONS-AWS' name='Attackers gain unauthorized connection to the resources' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;p&gt;Attackers could gain an unauthorized connection to the resources through
                                misconfigured ports or security network configurations.&lt;/p&gt;
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AWS-Network-5.2'>
                  <controls>
                    <control ref='Hydras-AWS-EC2-6.1' mitigation='25' />
                    <control ref='Hydras-AWS-Network-5.2' mitigation='25' />
                  </controls>
                </weakness>
                <weakness ref='AWS-Network-5.1'>
                  <controls>
                    <control ref='Hydras-AWS-Network-5.1' mitigation='25' />
                  </controls>
                </weakness>
                <weakness ref='AWS-Network-5.8'>
                  <controls>
                    <control ref='Hydras-AWS-Network-5.8' mitigation='25' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='Hydras-AWS-EC2-6.1' mitigation='25' />
                <control ref='Hydras-AWS-Network-5.1' mitigation='25' />
                <control ref='Hydras-AWS-Network-5.2' mitigation='25' />
                <control ref='Hydras-AWS-Network-5.8' mitigation='25' />
              </controls>
            </threat>
</threats>
</usecase>
</usecases>
</component>
<component ref='HYDRAS-AWS-LOG' name='AWS Logging' desc='' groupName='' tags='' position='4' library='' diagramPositionX='0' diagramPositionY='0' componentDefinitionRef=''>
      <weaknesses>
<weakness ref='AWS-Logging-3.4' name='Non-auditable actions in the resources' state='0' impact='100'>
          <desc>The actions in the resources are not audited and not recorded in the logs.</desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-Logging-3.1' name='Non-auditable API calls in all regions' state='0' impact='100'>
          <desc>The API call to the resources is not audited and the actions are not recorded into the logs.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-Logging-3.9' name='Unaudited resources changes' state='0' impact='100'>
          <desc>The changes in the applications and in the databases and these changes are not detected and
                        not audited.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-Logging-3.7' name='Unaudited connections with the resources' state='0' impact='100'>
          <desc>The connections with the applications and with the databases cannot be audited and not
                        detected.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-Logging-3.8' name='Non-centrality audit logs' state='0' impact='100'>
          <desc>The audit logs are not stored in a central system. Therefore, the audit logs cannot be
                        exploited correctly by the security personnel.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-Logging-3.3' name='Audit logs are accesible' state='0' impact='100'>
          <desc>&lt;div&gt;
                        The audit logs are not encrypted and they can be accessed by attackers and obtain sensitive data
                        in clear text.
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness>
</weaknesses>
<controls>
<control ref='Hydras-AWS-Logging-3.4' name='Integrate the CloudTail logs into Cloudwatch logs' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>One way to work with cloudtrail logs is to send them to cloudwatch logs which allows you to
                        define metric filters for alerting and monitoring. This allows you to take immediate action if a
                        certain threshold has been met. Enabling this provides the opportunity to monitor for sensitive
                        account activity.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Sign in to the AWS Management Console (with cloudtrail update permission).&lt;/li&gt;
                        &lt;li&gt;Select Cloudtrail from the services list.&lt;/li&gt;
                        &lt;li&gt;Under All Buckets select the target bucket you want to check.&lt;/li&gt;
                        &lt;li&gt;Select &amp;quot;Properties&amp;quot; then &amp;quot;Trails&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Click on each trail where no CloudWatch Logs are defined.&lt;/li&gt;
                        &lt;li&gt;Go to the &amp;quot;CloudWatch Logs&amp;quot; section and click on &amp;quot;Configure&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Define a new or select an existing log group and click &amp;quot;Continue&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Configure the IAM Role which will deliver CloudTrail events to CloudWatch Logs.&lt;/li&gt;
                        &lt;li&gt;Create/Select an IAM Role and Policy Name.&lt;/li&gt;
                        &lt;li&gt;Click Allow.&lt;/li&gt;
                        &lt;/ol&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;br /&gt;&amp;nbsp;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='2.4' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;blockquote&gt;
                            aws cloudtrail get-trail-status --name &amp;lt;trail_name&amp;gt;
                            &lt;/blockquote&gt;Ensure the &amp;quot;LatestcloudwatchLogdDeliveryTime&amp;quot; property
                            is set to a recent time (ie within the latest day or so).
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Logging-3.2' name='Enable CloudTrail log file validation' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Enabling log file validation will provide additional integrity checking of CloudTrail as it
                        creates a digest for each log file it writes to S3. These digests can then be used to determine
                        if a log has been modified since being written
                        &lt;br /&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;br /&gt;&lt;/b&gt;
                        &lt;blockquote&gt;
                        aws cloudtrail update-trail --name &amp;lt;trail_name&amp;gt; --enable-log-file-validation
                        &lt;/blockquote&gt;
                        &lt;br /&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='2.2' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;blockquote&gt;
                            aws cloudtrail describe-trails&amp;nbsp;
                            &lt;/blockquote&gt;Ensure LogFileValidationEnabled = true (for each trail)
                            &lt;ol&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Logging-3.9' name='Enable AWS Config across all regions' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>AWS Config tracks configuration changes to resources as they occur and is therefore a good
                        source of identifying whether unintentional or malicious changes have occurred to resources with
                        the AWS account.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Sign in to the AWS Management Console (with Config update permissions).&lt;/li&gt;
                        &lt;li&gt;Select Config from the services menu.&lt;/li&gt;
                        &lt;li&gt;Define which resources you want to record in the selected region.&lt;/li&gt;
                        &lt;li&gt;Choose to include global resources (IAM resources).&lt;/li&gt;
                        &lt;li&gt;Specify an S3 bucket.&lt;/li&gt;
                        &lt;li&gt;Create an SNS Topic&amp;nbsp;&amp;nbsp;&lt;/li&gt;
                        &lt;/ol&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;br /&gt;&amp;nbsp;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='2.5' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Sign in to the AWS Management Console (with Config update permissions)&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Select Config from the services menu&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;If presented with Setup AWS Config follow the procedure highlighted in the
                            remediation section&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;On the Resource inventory page, Click on &amp;quot;edit&amp;quot;&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure 1 or both check-boxes under &amp;quot;All Resources&amp;quot; is checked.&amp;nbsp;&lt;/li&gt;
                            &lt;ul&gt;
                            &lt;li&gt;Include global resources related to IAM resources&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;which needs to be enabled in 1 region only.&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;li&gt;Ensure the correct S3 bucket has been defined.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Ensure the correct SNS topic has been defined.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Repeat steps 2 to 7 for each region (you'll need to change region in the top right
                            corner of the AWS management console to do this).&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Logging-3.7' name='Enable VPC flow logs' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>VPC Flow logs enable the capture of IP traffic that traverses the network interfaces within a
                        VPC. These logs are captured and sent to cloudtrail logs enabling you to detect security
                        incidents that may be occurring across the network.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Sign into the management console.&lt;/li&gt;
                        &lt;li&gt;Select VPC from the services menu.&lt;/li&gt;
                        &lt;li&gt;In the left pane click &amp;quot;Your VPCs&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Select a VPC.&lt;/li&gt;
                        &lt;li&gt;Select the Flow Logs tab from the preview panel.&lt;/li&gt;
                        &lt;li&gt;Select &amp;quot;Create Flow Log&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Choose a role (note this must be pre-created. Follow the link provided in the text
                        underneath &amp;quot;Role&amp;quot; for help).&lt;/li&gt;
                        &lt;li&gt;Select a &amp;quot;Destination Log Group&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Click &amp;quot;Create flow Log&amp;quot;.&lt;/li&gt;
                        &lt;/ol&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;br /&gt;
                        &lt;br /&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='2.9' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Sign into the management console.&lt;/li&gt;
                            &lt;li&gt;Select VPC from the services menu.&lt;/li&gt;
                            &lt;li&gt;In the left pane click &amp;quot;Your VPCs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select a VPC.&lt;/li&gt;
                            &lt;li&gt;Select the Flow Logs tab from the preview panel.&lt;/li&gt;
                            &lt;li&gt;Ensure a Log Flow exists that has Active in the Status column.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Logging-3.5' name='Encrypt CloudTrail logs using KMS' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>By default, the log files delivered by CloudTrail to your bucket are encrypted by Amazon
                        server-side encryption with Amazon S3-managed encryption keys (SSE-S3). To provide a security
                        layer that is directly manageable, you can instead use server-side encryption with AWS
                        KMS–managed
                        keys (SSE-KMS) for your CloudTrail log files. This provides several advantages:
                        &lt;br /&gt;
                        &lt;ul&gt;
                        &lt;li&gt;You can create and manage the CMK encryption keys yourself.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;You can use a single CMK to encrypt and decrypt log files for multiple accounts across
                        all regions.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;You have control over who can use your key for encrypting and decrypting CloudTrail
                        log files.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;You can assign permissions for the key to the users in your organization according to
                        your requirements.&lt;/li&gt;
                        &lt;li&gt;You have enhanced security. With this feature, in order to read log files, you now
                        need to meet two conditions:&amp;nbsp;&lt;/li&gt;
                        &lt;ol&gt;
                        &lt;li&gt;you must have S3 read permission on the bucket, and&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;you must be granted decrypt permission by the CMK policy.&amp;nbsp;&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/ul&gt;Because S3 automatically decrypts the log files for requests from users authorized to
                        use the CMK, SSE-KMS encryption for CloudTrail log files is backward compatible with existing
                        applications that read CloudTrail log data.&amp;nbsp;
                        &lt;br /&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;&amp;nbsp;&amp;nbsp;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Sign in to the AWS Management Console (with cloudtrail update permissions).&lt;/li&gt;
                        &lt;li&gt;Select CloudTrail from the services menu.&lt;/li&gt;
                        &lt;li&gt;Select &amp;quot;Trails&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Click on a Trail.&lt;/li&gt;
                        &lt;li&gt;Under the S3 section click on the edit button.&lt;/li&gt;
                        &lt;li&gt;Click Advanced.&lt;/li&gt;
                        &lt;li&gt;Set &amp;quot;Encrypt Log Files&amp;quot; to &amp;quot;Yes&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Set &amp;quot;Create a new KMS key&amp;quot; to &amp;quot;Yes&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;KMS key&amp;quot; type a name for your key.&lt;/li&gt;
                        &lt;li&gt;Click &amp;quot;Save&amp;quot;.&lt;/li&gt;
                        &lt;/ol&gt; Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;br /&gt;
                        &lt;br /&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='2.7' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;blockquote&gt;
                            aws cloudtrail describe-trails
                            &lt;/blockquote&gt;Check that KMS is enabled if the &amp;quot;KmsKeyId&amp;quot; property is
                            set.
                            &lt;ol&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Logging-3.6' name='Enable S3 Bucket logging' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>S3 Bucket Access Logging generates log files that contain access records for each request made
                        to an S3 bucket. By enabling this it is possible to capture events relating to the objects
                        within that bucket thus helping to capture potential security issues or identifying threats. It
                        is recommended to enable S3 bucket logging on any S3 bucket that contains sensitive data and
                        stored the logs in a separate bucket for security analysis.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;br /&gt;&lt;/b&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Sign in to the AWS Management Console (with S3 update access).&lt;/li&gt;
                        &lt;li&gt;Select S3 from the services menu.&lt;/li&gt;
                        &lt;li&gt;Under All Buckets click on the S3 bucket you wish to enable logging.&lt;/li&gt;
                        &lt;li&gt;Click on Properties in the top right of the console.&lt;/li&gt;
                        &lt;li&gt;Under Bucket:&amp;lt;bucket_name&amp;gt; click on Logging.&lt;/li&gt;
                        &lt;li&gt;Click on the &amp;quot;Enabled&amp;quot; checkbox.&lt;/li&gt;
                        &lt;li&gt;Select a &amp;quot;Target Bucket&amp;quot; to store the logs.&lt;/li&gt;
                        &lt;li&gt;Select a &amp;quot;Target Prefix&amp;quot; for the logs.&lt;/li&gt;
                        &lt;li&gt;Click &amp;quot;Save&amp;quot;.&lt;/li&gt;
                        &lt;/ol&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='2.6' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Sign in to the AWS Management Console (with S3 update access).&lt;/li&gt;
                            &lt;li&gt;Select S3 from the services menu.&lt;/li&gt;
                            &lt;li&gt;Under All Buckets click on the S3 bucket you wish to enable logging.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Click on Properties in the top right of the console.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Under Bucket:&amp;lt;bucket_name&amp;gt; click on Logging.&lt;/li&gt;
                            &lt;li&gt;Ensure &amp;quot;Enabled&amp;quot; is checked.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Logging-3.3' name='Ensure CloudTrail logs are not publically available' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Since cloudtrail logs capture all API calls for the AWS account they should be stored in an S3
                        bucket that is not accessible to the public. Applying the correct bucket policy helps ensure the
                        confidentiality of the data.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Sign in to the AWS Management Console (with s3 update privileges).&lt;/li&gt;
                        &lt;li&gt;Select s3 from the services list.&lt;/li&gt;
                        &lt;li&gt;Right-click on the bucket you have used for &amp;quot;cloudtrail&amp;quot; and click
                        &amp;quot;Properties&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;In the Properties pane, click the Permissions tab.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Select the row that grants permission to &amp;quot;Everyone&amp;quot; or &amp;quot;Any
                        Authenticated User&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Uncheck all the permissions granted to Everyone or Any Authenticated User.&lt;/li&gt;
                        &lt;li&gt;Click Save to save the ACL.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;If the Edit bucket policy button is present, click it.&lt;/li&gt;
                        &lt;li&gt;Remove any Statement having an Effect set to Allow and a Principal set to *.&amp;nbsp;&lt;/li&gt;
                        &lt;/ol&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='2.3' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Obtain the bucket name of the cloudtrail:&amp;nbsp;aws cloudtrail describe-trails
                            --query 'trailList[*].S3BucketName'&lt;/li&gt;
                            &lt;li&gt;Ensure &amp;quot;AllUsers&amp;quot; is not granted access to the bucket:&amp;nbsp;aws
                            s3api get-bucket-acl --bucket &amp;lt;bucket_name&amp;gt; --query
                            'Grants[?Grantee.URI==`http://acs.amazonaws.com/groups/global/AllUsers`]'&lt;/li&gt;
                            &lt;li&gt;Ensure &amp;quot;Authenticated Users&amp;quot; is not granted access to the
                            bucket: aws s3api get-bucket-acl --bucket &amp;lt;bucket_name&amp;gt; --query
                            'Grants[?Grantee.URI==`http://acs.amazonaws.com/groups/global/Authenticated Users`]'&lt;/li&gt;
                            &lt;li&gt;Validate the bucket policy does not grant access to all:&amp;nbsp;aws s3api
                            get-bucket-policy --bucket &amp;lt;bucket_name&amp;gt;&lt;/li&gt;
                            &lt;li&gt;Check that the above command does not provide a principal of *, with EFFECT set to
                            ALLOW.&amp;nbsp;&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Logging-3.8' name='Export EC2 OS logs to cloudwatch logs' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Cloudwatch logs is an AWS service that allows you to send logs from an EC2 instance to
                        cloudwatch via an agent installed locally on the machine. The logs are then stored centrally
                        within cloudwatch logs and metric alerts can be configured so that security incidents can be
                        reported to the security team. It is recommended to enable cloudwatch log monitoring on all EC2
                        servers.
                        &lt;br /&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;br /&gt;&lt;/b&gt;Follow the directions provided in &amp;quot;http://docs.aws.amazon.com/AmazonCloudWatch/latest/DeveloperGuide/EC2NewInstanceCWL.html&amp;quot;
                        to install and enable Cloudwatch Logs on a new EC2 instance.
                        &lt;br /&gt;
                        &lt;br /&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                    </desc>
          <implementations />
          <references />
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Sign into the management console.&lt;/li&gt;
                            &lt;li&gt;Select Cloudwatch from the services menu.&amp;nbsp;&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;In the left pane click &amp;quot;Logs&amp;quot;.&amp;nbsp;&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Click on your log group.&lt;/li&gt;
                            &lt;li&gt;Click on your log stream.&lt;/li&gt;
                            &lt;li&gt;Ensure event data is being captured as per the logs on your machine.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Logging-3.1' name='Enable Cloudtrail in all regions' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Cloudtrail records events of all API calls made within a AWS account. This enables security
                        analysis, resource change tracking, and compliance auditing. Cloudtrail should be enabled in all
                        regions, even if they are not being used, to identify unintended or accidental changes.
                        &lt;br /&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation&lt;/b&gt;:
                        &lt;br /&gt;Create a global trail using a previously created S3 bucket:
                        &lt;br /&gt;
                        &lt;blockquote&gt;
                        aws cloudtrail create-trail --name &amp;lt;trail_name&amp;gt; --s3-bucket-name &amp;lt;s3-bucket-name&amp;gt;
                        --is-multi-region-trail
                        &lt;/blockquote&gt;
                        &lt;br /&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;br /&gt;
                        &lt;br /&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='2.1' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Run: aws cloudtrail describe-trails&lt;/li&gt;
                            &lt;li&gt;Ensure &amp;quot;IsMultiRegionTrail&amp;quot; = TRUE&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control>
</controls>
<usecases>
<usecase ref='API LOGGING AND AUDITING' name='API Logging and Auditing' desc='' library=''>
          <threats>
<threat ref='UNAUDITABLE-CHANGES-AWS' name='Attackers make undetected and unaudited changes to system configurations' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;div&gt;
                                If audit trails are not properly protected, an attacker could gain access to the system,
                                modify the status of the resources or exfiltrate sensitive data without being noticed.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AWS-Logging-3.3'>
                  <controls>
                    <control ref='Hydras-AWS-Logging-3.3' mitigation='20' />
                    <control ref='Hydras-AWS-Logging-3.5' mitigation='20' />
                  </controls>
                </weakness>
                <weakness ref='AWS-Logging-3.1'>
                  <controls>
                    <control ref='Hydras-AWS-Logging-3.1' mitigation='20' />
                  </controls>
                </weakness>
                <weakness ref='AWS-Logging-3.4'>
                  <controls>
                    <control ref='Hydras-AWS-Logging-3.2' mitigation='20' />
                    <control ref='Hydras-AWS-Logging-3.4' mitigation='20' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='Hydras-AWS-Logging-3.1' mitigation='20' />
                <control ref='Hydras-AWS-Logging-3.2' mitigation='20' />
                <control ref='Hydras-AWS-Logging-3.3' mitigation='20' />
                <control ref='Hydras-AWS-Logging-3.4' mitigation='20' />
                <control ref='Hydras-AWS-Logging-3.5' mitigation='20' />
              </controls>
            </threat>
</threats>
</usecase>
<usecase ref='AWS RESOURCE LOGGING' name='AWS Resource Logging' desc='' library=''>
          <threats>
<threat ref='UNAUDITABLE-CHANGES-RESOURCES-AWS' name='Attackers make undetected and unaudited changes in the resources' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;div&gt;
                                If audit trails in the resources are not enabled or not protected, attackers could gain
                                access to the system and modify or delete data from the resources and the changes are
                                not detected.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AWS-Logging-3.4'>
                  <controls>
                    <control ref='Hydras-AWS-Logging-3.6' mitigation='25' />
                  </controls>
                </weakness>
                <weakness ref='AWS-Logging-3.8'>
                  <controls>
                    <control ref='Hydras-AWS-Logging-3.8' mitigation='25' />
                  </controls>
                </weakness>
                <weakness ref='AWS-Logging-3.7'>
                  <controls>
                    <control ref='Hydras-AWS-Logging-3.7' mitigation='25' />
                  </controls>
                </weakness>
                <weakness ref='AWS-Logging-3.9'>
                  <controls>
                    <control ref='Hydras-AWS-Logging-3.9' mitigation='25' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='Hydras-AWS-Logging-3.6' mitigation='25' />
                <control ref='Hydras-AWS-Logging-3.7' mitigation='25' />
                <control ref='Hydras-AWS-Logging-3.8' mitigation='25' />
                <control ref='Hydras-AWS-Logging-3.9' mitigation='25' />
              </controls>
            </threat>
</threats>
</usecase>
</usecases>
</component>
<component ref='HYDRAS-AWS-IAM' name='AWS Identity and Access Management' desc='' groupName='' tags='' position='3' library='' diagramPositionX='0' diagramPositionY='0' componentDefinitionRef=''>
      <weaknesses>
<weakness ref='AWS-IAM-2.12' name='The rotation keys is not configured' state='0' impact='100'>
          <desc>The rotation keys are not configured to avoid to use old keys.</desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-IAM-2.9' name='The security policies are exposed in the resources' state='0' impact='100'>
          <desc>The security policies are not configured and the security configurations are exposed for the
                        attackers.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-IAM-2.8' name='Lack of 2FA' state='0' impact='100'>
          <desc>Access to sensitive systems without using MFA to log into the systems.</desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='LOST-ACCESS-ROOT-01' name='The Root Account is misconfigured' state='0' impact='100'>
          <desc>The administrator account is misconfigured. The security question to recover or reset the
                        password and the authentication method are not configured.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-24T14:48:26.301'>
              <output />
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-EXPIRATION-DATE' name='The password expiration is not established' state='0' impact='100'>
          <desc>The password expiration is not configured and users are not obliged to change their passwords.
                        Not change frequently the passwords gives facilities to attackers to obtain them.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-IAM-2.7' name='The credentials for the groups and roles are not configured' state='0' impact='100'>
          <desc>&lt;div&gt;
                        The credentials for the groups and roles are not correctly configured and there are user
                        accounts with more privileges than the necessary.
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-IAM-1.21' name='The access keys are generated when the setup of the users is started' state='0' impact='100'>
          <desc>&lt;div&gt;
                        The system doesn't require additional steps to create access keys, the access keys are
                        generating when the process to create an user is starting. The problem is that these keys can be
                        in use somewhere in the organization and maybe these keys are not necessary for the user.
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-IAM-2.1' name='The Authentication Method for Administrator Accounts is not configured' state='0' impact='100'>
          <desc>&lt;div&gt;
                        The authentication method &amp;quot;Multi-factor Authentication&amp;quot; for the Administrator
                        accounts are not configured.
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-IAM-2.6' name='The User Account is not configured' state='0' impact='100'>
          <desc>Key security settings such as resetting the password and other password controls are not
                        configured.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-IAM-2.2' name='Excessive use of administrator accounts' state='0' impact='100'>
          <desc>&lt;div&gt;
                        The administrator accounts are used for all actions, not only for administrative actions. This
                        is because these users have not got a personal or a user account to do the daily actions.
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='LOST-SECURITY-ALERTS' name='The Security Contact details are not configured' state='0' impact='100'>
          <desc>The security contact details for the Amazon subscription are not properly configured.</desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-24T14:48:15.193'>
              <output />
            </source>
            <references />
            <udts />
          </test>
        </weakness>
</weaknesses>
<controls>
<control ref='Hydras-AWS-IAM-2.8' name='Apply RBAC with pre-defined policies added into groups or roles' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Instead of defining permissions for individual IAM users, it's usually more convenient to
                        create groups that relate to job functions (administrators, developers, accounting, etc.),
                        define the relevant permissions for each group, and then assign IAM users to those groups. All
                        the users in an IAM group inherit the permissions assigned to the group. That way, you can make
                        changes for everyone in a group in just one place. As people move around in your company, you
                        can simply change what IAM group their IAM user belongs to. This method is know as Role Based
                        Access Control (RBAC).
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;br /&gt;&lt;/b&gt;Remove privilege granted directly to a user:
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Sign in to the AWS Management Console (with IAM update privileges).&lt;/li&gt;
                        &lt;li&gt;Go to IAM Service on the AWS Console.&lt;/li&gt;
                        &lt;li&gt;Click on Users.&lt;/li&gt;
                        &lt;li&gt;For each user complete the following:&lt;/li&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Select the user.&lt;/li&gt;
                        &lt;li&gt;Click on the Permissions tab.&lt;/li&gt;
                        &lt;li&gt;Expand &amp;quot;Managed Policies&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Click &amp;quot;Detach Policy&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Expand &amp;quot;Inline Policies&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Click &amp;quot;Remove Policy&amp;quot;.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ol&gt;Create a Group and add a user:
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Sign in to the AWS Management Console (with IAM update privileges).&lt;/li&gt;
                        &lt;li&gt;Go to IAM Service on the AWS Console.&lt;/li&gt;
                        &lt;li&gt;Select Groups and click Create New Group.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;In the Group Name box, type the name of the group and click Next Step.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;In the list of policies, select the check box for each policy that you want to apply
                        to all members of the group. Click Next Step.&lt;/li&gt;
                        &lt;li&gt;Click Create Group.&lt;/li&gt;
                        &lt;li&gt;Click the new Group and select the &amp;quot;Users&amp;quot; tab.&lt;/li&gt;
                        &lt;li&gt;Click &amp;quot;Add Users to Group&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Select the users and click &amp;quot;Add Users&amp;quot;.&lt;/li&gt;
                        &lt;/ol&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='1.16' supportedStandardRef='CIS AWS Standard' />
            <standard ref='1.22' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Obtain a list of IAM users by: aws iam list-users --query 'Users[*].UserName'
                            --output text&lt;/li&gt;
                            &lt;li&gt;Run the following to determine if they have policies directly attached:&amp;nbsp;&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            aws iam list-attached-user-policies --user-name user
                            &lt;/div&gt;
                            &lt;/blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            &lt;br /&gt;
                            &lt;/div&gt;
                            &lt;/blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            aws iam list-user-policies --user-name user
                            &lt;/div&gt;
                            &lt;/blockquote&gt;
                            &lt;/blockquote&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-IAM-2.6' name='Create a Password Policy enforcing strong passwords' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Enforcing a strong password policy increases resiliency and reduces the chances of the password
                        being compromised either through brute force attempts, keystroke logging tools or stolen
                        credentials amongst others.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Login to AWS Console (ensure you have permissions to update IAM).&lt;/li&gt;
                        &lt;li&gt;Go to IAM Service on the AWS Console.&lt;/li&gt;
                        &lt;li&gt;Click on Account Settings.&lt;/li&gt;
                        &lt;li&gt;Set &amp;quot;Minimum password length&amp;quot; to 8 or greater.&lt;/li&gt;
                        &lt;li&gt;Check &amp;quot;Require at least one uppercase letter&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Check &amp;quot;Require at least one lowercase letter&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Check &amp;quot;Require at least one number&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Check &amp;quot;Require at least one non-alphanumeric character&amp;quot;&lt;/li&gt;
                        &lt;li&gt;Check &amp;quot;Enable password expiration&amp;quot; and set the period to at least 90
                        days.&lt;/li&gt;
                        &lt;li&gt;Check &amp;quot;Prevent password reuse&amp;quot; and set the number to at least 10.&lt;/li&gt;
                        &lt;/ol&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='1.10' supportedStandardRef='CIS AWS Standard' />
            <standard ref='1.11' supportedStandardRef='CIS AWS Standard' />
            <standard ref='1.4' supportedStandardRef='CIS AWS Standard' />
            <standard ref='1.5' supportedStandardRef='CIS AWS Standard' />
            <standard ref='1.6' supportedStandardRef='CIS AWS Standard' />
            <standard ref='1.7' supportedStandardRef='CIS AWS Standard' />
            <standard ref='1.8' supportedStandardRef='CIS AWS Standard' />
            <standard ref='1.9' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>Check that exists a mechanisms to ensure that the created passwords are enough strong.
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-IAM-2.3' name='Create Individual Accounts' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>By creating individual IAM users for people accessing your account, you can give each IAM user a unique set of security credentials. You can also grant different permissions to each IAM user. If necessary, you can change or revoke an IAM user's permissions any time. (If you give out your AWS root credentials, it can be difficult to revoke them, and it is impossible to restrict their permissions.). 
&lt;div&gt; 
 &lt;br /&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
 &lt;br /&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Login to the AWS Management Console as an administrator.&lt;/li&gt; 
  &lt;li&gt;Select IAM.&lt;/li&gt; 
  &lt;li&gt;Select Users.&lt;/li&gt; 
  &lt;li&gt;Click &amp;quot;Create New Users&amp;quot;.&lt;/li&gt; 
  &lt;li&gt;Complete the required information.&lt;/li&gt; 
  &lt;li&gt;Uncheck &amp;quot;Create access key for users&amp;quot;.&lt;/li&gt; 
  &lt;li&gt;Click &amp;quot;Create&amp;quot;.&lt;/li&gt; 
  &lt;li&gt;Select the user.&lt;/li&gt; 
  &lt;li&gt;Click &amp;quot;Manage Password&amp;quot;.&lt;/li&gt; 
  &lt;li&gt;Select the required options and click &amp;quot;apply&amp;quot;.&lt;/li&gt; 
  &lt;li&gt;Select &amp;quot;Show User Security Credentials&amp;quot;.&lt;/li&gt; 
  &lt;li&gt;Securely supply the password to your user.&lt;/li&gt; 
 &lt;/ol&gt;Content provided by 
 &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt; 
&lt;/div&gt;</desc>
          <implementations />
          <references />
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>Check that each user has got the corresponding account with the corresponding
                            credentials.
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Gov-1.2' name='Register a Security contact for your AWS account.' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>AWS will occasionally send security advisories and alerts to the account holder. By default this will go to the email address that the account is registered under. However if a security contact is specified these alerts will be sent here instead. Therefore this provides the means of ensuring these advisories are routed to the security team, especially if a distribution email address is used.&amp;nbsp; 
&lt;div&gt;
  &amp;nbsp; 
 &lt;br /&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
 &lt;br /&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Login to the AWS Account as root.&lt;/li&gt; 
  &lt;li&gt;Click account name on the top right of the management console.&lt;/li&gt; 
  &lt;li&gt;Select &amp;quot;My Account&amp;quot;.&lt;/li&gt; 
  &lt;li&gt;Scroll down to &amp;quot;Alternate Contacts&amp;quot; section.&lt;/li&gt; 
  &lt;li&gt;Click on Edit.&lt;/li&gt; 
  &lt;li&gt;In the &amp;quot;Security&amp;quot; section complete the requested contact information.&lt;/li&gt; 
  &lt;li&gt;Click update when complete.&lt;/li&gt; 
 &lt;/ol&gt;Content provided by 
 &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt; 
&lt;/div&gt;</desc>
          <implementations />
          <references />
          <standards>
            <standard ref='1.17' supportedStandardRef='CIS AWS Standard' />
            <standard ref='1.18' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Login to the AWS Account as root.&lt;/li&gt;
                            &lt;li&gt;Click account name on the top right of the management console.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;My Account&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Scroll down to &amp;quot;Alternate Contacts&amp;quot; section.&lt;/li&gt;
                            &lt;li&gt;Confirm whether a contact has been set for &amp;quot;Security&amp;quot;.&amp;nbsp;&lt;/li&gt;
                            &lt;/ol&gt;Content provided by
                            &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-IAM-2.5' name='Ensure root does not have API keys' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>You use an access key (an access key ID and secret access key) to make programmatic requests to AWS. However, do not use your AWS account (root) access key. The access key for your AWS account gives full access to all your resources for all AWS services, including your billing information. You cannot restrict the permissions associated with your AWS account access key.&amp;nbsp; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
 &lt;br /&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Sign in to the AWS Management Console as Root.&lt;/li&gt; 
  &lt;li&gt;Click on Account Name at the top left and select Security Credentials.&lt;/li&gt; 
  &lt;li&gt;On the pop up screen Click on Continue to Security Credentials.&lt;/li&gt; 
  &lt;li&gt;Click on Access Keys.&lt;/li&gt; 
  &lt;li&gt;Under the Status column if there are any Keys which are &amp;quot;Active&amp;quot;.&lt;/li&gt; 
  &lt;li&gt;Click on &amp;quot;Make Inactive&amp;quot; and click &amp;quot;Delete&amp;quot;.&lt;/li&gt; 
 &lt;/ol&gt;Content provided by 
 &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt; 
&lt;/div&gt;</desc>
          <implementations />
          <references />
          <standards>
            <standard ref='1.12' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Generate a credential report with the command: aws iam generate-credential-report&lt;/li&gt;
                            &lt;li&gt;Run the following command: aws iam get-credential-report --query 'Content'
                            --output text | base64 -D | egrep &amp;quot;root|access&amp;quot; | awk -F, '{print
                            $1,$9,$14}'&lt;/li&gt;
                            &lt;li&gt;For the &amp;lt;root_account&amp;gt; user ensure access_key_1_active and
                            access_key_2_active are false.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-IAM-2.7' name='Enforce Least Privilege' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Granting least privilege ensures that users only have the permissions required to complete
                        their jobs rather than additional privileges that are not required. Following this model ensures
                        that, should an account be compromised, the blast radius of damage is limited.
                        &lt;br /&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Allocate privileges via groups or roles via the recommendation in &amp;quot;Use RBAC
                        with pre-defined policies added into groups or roles&amp;quot;.&lt;/li&gt;
                        &lt;/ul&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='1.22' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Follow the audit check in &amp;quot;Use RBAC with pre-defined policies added into
                            groups or roles&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Ensure the privileges granted to these groups or roles only give the user the
                            ability to perform their and no more.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-IAM-2.1' name='Avoid the use of the root account unless absolutely necessary' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>The root account is the one which was used to open the AWS account with Amazon. Therefore it has full unrestricted access to all resources within the account including billing information. Reducing the use of this account and instead using personalized accounts with restricted permissions ensures the principles of least privilege and can help prevent accidental disclosure of credentials or unintended changes. 
&lt;br /&gt; 
&lt;b&gt;&lt;br /&gt;&lt;/b&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
 &lt;br /&gt;Follow the remediation in &amp;quot;Create Individual Accounts&amp;quot;. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt;Content provided by 
 &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;. 
&lt;/div&gt;</desc>
          <implementations />
          <references />
          <standards>
            <standard ref='1.1' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;blockquote&gt;
                            aws iam create-credential-report
                            &lt;/blockquote&gt;
                            &lt;blockquote&gt;
                            aws iam get-credential-report --query 'Content' --output text | base64 -D | cut -d,
                            -f1,5,11,16 | grep -B1 '&amp;lt;root_account&amp;gt;'&amp;nbsp;
                            &lt;/blockquote&gt;
                            &lt;ol&gt;
                            &lt;/ol&gt;From the above determine the &amp;quot;password_last_used&amp;quot; time In
                            addition to the above set up a metric filter as described elsewhere in this library to
                            determine ad-hoc use of root.
                            &lt;div&gt;
                            &lt;br /&gt;Content provided by
                            &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-IAM-2.10' name='Enable setting MFA for sensitive API calls' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>To the extent that it is practical consider enforcing MFA access for sensitive API calls. For
                        example, you can require that a user has authenticated with an MFA device in order to be allowed
                        to terminate an Amazon EC2 instance. This ensures that such high level changes to your AWS
                        environment are protected with an extra layer of security thus helping to prevent accidental or
                        malicious damage.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;The following is an example of how to create a policy that enforces MFA to terminate
                        EC2 instances:
                        &lt;br /&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Sign in to the AWS Management Console (with IAM update privileges).&lt;/li&gt;
                        &lt;li&gt;Go to IAM Service on the AWS Console.&lt;/li&gt;
                        &lt;li&gt;Select &amp;quot;Policies&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Select &amp;quot;Create Policy&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Select &amp;quot;Create your own policy&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Provide a policy name and description.&lt;/li&gt;
                        &lt;li&gt;In the policy document add the following:&amp;nbsp;&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;i&gt; {&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;i&gt; &amp;quot;Version&amp;quot;: &amp;quot;2012-10-17&amp;quot;,&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;i&gt; &amp;quot;Statement&amp;quot;: [{&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;i&gt; &amp;quot;Effect&amp;quot;: &amp;quot;Allow&amp;quot;,&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;i&gt; &amp;quot;Action&amp;quot;: [&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;i&gt; &amp;quot;ec2:StopInstances&amp;quot;,&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;i&gt; &amp;quot;ec2:TerminateInstances&amp;quot;&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;i&gt; ],&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;i&gt; &amp;quot;Resource&amp;quot;: [&amp;quot;*&amp;quot;],&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;i&gt; &amp;quot;Condition&amp;quot;: {&amp;quot;Bool&amp;quot;: {&amp;quot;aws:MultiFactorAuthPresent&amp;quot;:
                        &amp;quot;true&amp;quot;}}&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;i&gt; }]&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;i&gt;}&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Click &amp;quot;Create policy&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;The policy may now be added to a group by following the outlines in &amp;quot;Use RBAC
                        with pre-defined policies added into groups or roles&amp;quot;.&lt;/li&gt;
                        &lt;/ul&gt; Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>The following checks that MFA is forced on a policy:
                            &lt;br /&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Sign in to the AWS Management Console (with IAM update privileges).&lt;/li&gt;
                            &lt;li&gt;Go to IAM Service on the AWS Console.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Policies&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;In the filter select &amp;quot;Customer Managed Policies&amp;quot;.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Select the policy to check.&lt;/li&gt;
                            &lt;li&gt;In the policy document check for the presence of the line: &amp;quot;Condition&amp;quot;:
                            {&amp;quot;Bool&amp;quot;: {&amp;quot;aws:MultiFactorAuthPresent&amp;quot;: &amp;quot;true&amp;quot;}}&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-IAM-2.11' name='Configure password expiration' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Change access keys regularly, and make sure that all IAM users in your account do as well.
                        That way, if an access key is compromised without your knowledge, you limit how long the
                        credentials can be used to access your resources. Credential reports can be used to determine
                        how long access keys have been active for.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Sign in to the AWS Management Console (with IAM update privileges).&lt;/li&gt;
                        &lt;li&gt;Go to IAM Service on the AWS Console.&lt;/li&gt;
                        &lt;li&gt;Click on Users.&lt;/li&gt;
                        &lt;li&gt;Select the user you wish to rotate the key for.&lt;/li&gt;
                        &lt;li&gt;Under access keys click &amp;quot;Create Access Key&amp;quot; (do not touch the
                        existing key yet).&lt;/li&gt;
                        &lt;li&gt;Click &amp;quot;Download credentials&amp;quot; or &amp;quot;Show credentials&amp;quot;
                        so that you have a record of them.&lt;/li&gt;
                        &lt;li&gt;Update any applications with the new credentials and test (we recommend to leave a few
                        days or a week for testing).&lt;/li&gt;
                        &lt;li&gt;Once complete complete 1-4 above and for the key which needs rotating click &amp;quot;Make
                        Inactive | Delete&amp;quot; and click &amp;quot;Deactive&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Once you are confident you will no longer need the key (wait several more days) repeat
                        1-4 and select &amp;quot;Delete&amp;quot; for the inactive key.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='1.3' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Generate a credential report: aws iam generate-credential-report&lt;/li&gt;
                            &lt;li&gt;Check the access keys created time: aws iam get-credential-report --query
                            'Content' --output text | base64 -D | awk -F, '{print $1,$9,$10,$14,$15}'&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;For each access_key_1_active and access_key_9_active that is set to True ensure
                            the created date is within the last 90 days.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-IAM-2.4' name='Enable MFA for IAM console users' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Using a multi-factor authentication (MFA) device enhances the security of the login process.
                        With MFA, users have a device that generates a unique authentication code (a one-time password,
                        or OTP) and users must provide both their normal credentials (like their user name and password)
                        and the OTP.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        The MFA device can either be a special piece of hardware, or it can be a virtual device. The
                        recommendation for all console login accounts is to use MFA to increase the level of security of
                        the login process.
                        &lt;div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Login to the AWS Management Console as an administrator.&lt;/li&gt;
                        &lt;li&gt;Select IAM.&lt;/li&gt;
                        &lt;li&gt;Select Users.&lt;/li&gt;
                        &lt;li&gt;For each user:&lt;/li&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Select the user.&lt;/li&gt;
                        &lt;li&gt;Under &amp;quot;Sign-In Credentials&amp;quot; if &amp;quot;Password&amp;quot; is set
                        to &amp;quot;Yes&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Select &amp;quot;Manage MFA Device&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Choose the type of MFA.&lt;/li&gt;
                        &lt;li&gt;Either scan the code or enter your device secret key.&lt;/li&gt;
                        &lt;li&gt;Enter the Authentication code in &amp;quot;Authentication Code 1&amp;quot; box.&lt;/li&gt;
                        &lt;li&gt;Wait for the code to change and enter the next code in &amp;quot;Authentication Code 2&amp;quot;
                        box.&lt;/li&gt;
                        &lt;li&gt;Click Activate MFA.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ol&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='1.2' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Generate a credential report with the command: aws iam generate-credential-report&lt;/li&gt;
                            &lt;li&gt;The following command displays a list of all IAM users along with their password
                            and MFA status: aws iam get-credential-report --output text | base64 -D | cut - d, -f1,4,8&lt;/li&gt;
                            &lt;li&gt;For any column having password_enabled set to true ensure mfa_active is also set
                            to true.&amp;nbsp;&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-EC2-6.3' name='Apply IAM roles for EC2 instances IAM roles for EC2 instances' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Applications that run on an Amazon EC2 instance need credentials in order to access other AWS
                        services. To provide credentials to the application in a secure way, use IAM roles. A role is an
                        entity that has its own set of permissions, but that isn't a user or group. Roles also don't
                        have their own permanent set of credentials the way IAM users do. In the case of Amazon EC2, IAM
                        dynamically provides temporary credentials to the EC2 instance, and these credentials are
                        automatically rotated for you.
                        &lt;br /&gt;
                        &lt;br /&gt;When you launch an EC2 instance, you can specify a role for the instance as a launch
                        parameter. Applications that run on the EC2 instance can use the role's credentials when they
                        access AWS resources. The role's permissions determine what the application is allowed to do. It
                        is recommended that all EC2 instances be launched with a role, even if the role has no
                        permissions (as they can be added later if desired).
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Login to the AWS Management Console.&lt;/li&gt;
                        &lt;li&gt;Select EC2 from the services menu.&lt;/li&gt;
                        &lt;li&gt;Select &amp;quot;Launch Instance&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Complete the wizard until step 3 at which point ensure an IAM role is selected for the
                        &amp;quot;IAM role&amp;quot; option (note the role must already exist).&lt;/li&gt;
                        &lt;li&gt;Complete the wizard to launch the instance.&lt;/li&gt;
                        &lt;/ol&gt;NB: You cannot add a role to an instance that has been launched without one. In these
                        cases create an AMI from an existing instance and launch a new instance, assigning an IAM role
                        as detailed above.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='1.19' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Login to the AWS Management Console.&lt;/li&gt;
                            &lt;li&gt;Select EC2 from the services menu.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Instances&amp;quot; from the left hand menu.&lt;/li&gt;
                            &lt;li&gt;For each instance in the list:&lt;/li&gt;
                            &lt;ul&gt;
                            &lt;li&gt;select the instance&lt;/li&gt;
                            &lt;li&gt;in the preview pane confirm the instance has an &amp;quot;IAM Role&amp;quot;
                            assigned (if a hyphen &amp;quot;-&amp;quot; is shown then your instance has no role
                            assigned).&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-IAM-2.2' name='Enable MFA for root accounts' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Root is highly privileged and therefore using a multi-factor authentication (MFA) device enhances the security of the login process. With MFA, users have a device that generates a unique authentication code (a one-time password, or OTP) and users must provide both their normal credentials (like their user name and password) and the OTP. The MFA device can either be a special piece of hardware, or it can be a virtual device. The recommendation for the root account is to use a hardware based device as it has a smaller attack surface and cannot be duplicated. 
&lt;div&gt; 
 &lt;br /&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
 &lt;br /&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Login to the AWS Management Console as root.&lt;/li&gt; 
  &lt;li&gt;Select &amp;quot;Dashboard&amp;quot; and under &amp;quot;Security Status&amp;quot; choose &amp;quot;Activate MFA&amp;quot; on your root account.&lt;/li&gt; 
  &lt;li&gt;Select Activate MFA&amp;quot;.&lt;/li&gt; 
  &lt;li&gt;In the wizard, choose &amp;quot;A hardware MFA&amp;quot; device and then select Next Step.&lt;/li&gt; 
  &lt;li&gt;In the Serial Number box, enter the serial number that is found on the back of the MFA device.&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;In the Authentication Code 1 box, enter the six-digit number displayed by the MFA device.&lt;/li&gt; 
  &lt;li&gt;Wait until the device refreshes the code, and then enter the next six-digit number into the Authentication Code 2 box.&lt;/li&gt; 
  &lt;li&gt;Select &amp;quot;Next Step&amp;quot;.&amp;nbsp;&lt;/li&gt; 
 &lt;/ol&gt;The MFA device is now associated with the AWS account.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt;
  &amp;nbsp; 
 &lt;br /&gt;Content provided by 
 &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt; 
&lt;/div&gt;</desc>
          <implementations />
          <references />
          <standards>
            <standard ref='1.13' supportedStandardRef='CIS AWS Standard' />
            <standard ref='1.14' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Run: aws iam get-account-summary&lt;/li&gt;
                            &lt;li&gt;Ensure the AccountMFAEnabled property is 1.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-IAM-2.12' name='Rotate KMS CMK Keys at least every year' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Rotating keys regularly reduces the impact of a compromised key being used to access data
                        since old keys cannot be used once rotated.&amp;nbsp;
                        &lt;div&gt;
                        &amp;nbsp;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;br /&gt;
                        &lt;ol&gt;
                        &lt;li&gt;List keys with:&amp;nbsp; &amp;quot;aws kms list-keys&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;For each key enable rotation: &amp;quot;aws kms enable-key-rotation --key-id &amp;lt;key_id&amp;gt;&amp;quot;.&amp;nbsp;&amp;nbsp;&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='2.8' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;List keys with: aws kms list-keys&lt;/li&gt;
                            &lt;li&gt;For each key check for rotation:&amp;nbsp;aws kms get-key-rotation-status --key-id
                            &amp;lt;key_id&amp;gt;&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-IAM-1.20' name='Create an IAM role for managing incidents with AWS' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>WS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support. 
          &lt;br /&gt; 
          &lt;br /&gt; 
          &lt;b&gt;Remediation:&lt;/b&gt; 
          &lt;br /&gt;Using the Amazon unified command line interface, create an IAM role for managing incidents with AWS: 
          &lt;br /&gt; 
          &lt;br /&gt;Create a trust relationship policy document that allows &amp;lt;iam_user&amp;gt; to manage AWS incidents, and save it locally as /tmp/TrustPolicy.json: 
          &lt;br /&gt; 
          &lt;br /&gt;{ 
          &lt;br /&gt;&amp;quot;Version&amp;quot;: &amp;quot;2012-10-17&amp;quot;, 
          &lt;br /&gt;&amp;quot;Statement&amp;quot;: [{ 
          &lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;quot;Effect&amp;quot;: &amp;quot;Allow&amp;quot;, 
          &lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;quot;Principal&amp;quot;: { 
          &lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;quot;AWS&amp;quot;: &amp;quot;&amp;lt;iam_user&amp;gt;&amp;quot; 
          &lt;br /&gt;&amp;nbsp; }, 
          &lt;br /&gt;&amp;nbsp; &amp;quot;Action&amp;quot;: &amp;quot;sts:AssumeRole&amp;quot; 
          &lt;br /&gt;&amp;nbsp; }] 
          &lt;br /&gt;} 
          &lt;br /&gt; 
          &lt;br /&gt;Create the IAM role using the above trust policy: 
          &lt;br /&gt; 
          &lt;br /&gt;aws iam create-role --role-name &amp;lt;aws_support_iam_role&amp;gt; --assume-role-policy-document file:///tmp/TrustPolicy.json 
          &lt;br /&gt; 
          &lt;br /&gt;Attach 'AWSSupportAccess' managed policy to the created IAM role: 
          &lt;br /&gt; 
          &lt;br /&gt;aws iam attach-role-policy --policy-arn &amp;lt;iam_policy_arn&amp;gt; --role-name &amp;lt;aws_support_iam_role&amp;gt; 
          &lt;br /&gt;
          </desc>
          <implementations />
          <references>
            <reference name='Amazon docs: attach role policy' url='https://docs.aws.amazon.com/cli/latest/reference/iam/attach-role-policy.html' />
            <reference name='Amazon docs: list entities for policy' url='https://docs.aws.amazon.com/cli/latest/reference/iam/list-entities-for-policy.html' />
            <reference name='Amazon docs: list policies' url='https://docs.aws.amazon.com/cli/latest/reference/iam/list-policies.html' />
            <reference name='Amazon docs: managed policies and inline policies' url='https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html' />
          </references>
          <standards>
            <standard ref='1.20' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>
            Using the Amazon unified command line interface: 
            &lt;br /&gt; 
            &lt;div&gt; 
             &lt;ul&gt; 
              &lt;li&gt;List IAM policies, filter for the 'AWSSupportAccess' managed policy, and note the &amp;quot;Arn&amp;quot; element value: &lt;/li&gt; 
             &lt;/ul&gt; 
            &lt;/div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; aws iam list-policies --query &amp;quot;Policies[?PolicyName == 'AWSSupportAccess']&amp;quot; 
            &lt;br /&gt; 
            &lt;div&gt; 
             &lt;ul&gt; 
              &lt;li&gt;Check if the 'AWSSupportAccess' is attached to any IAM user, group or role: &lt;/li&gt; 
             &lt;/ul&gt; 
            &lt;/div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; aws iam list-entities-for-policy --policy-arn &amp;lt;iam_policy_arn&amp;gt; 
            &lt;span style=" , Arial;"&gt;&lt;/span&gt;
            </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-IAM-1.21' name='Do not setup access keys during initial user setup for all IAM users that have a console password' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>
          AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. 
          &lt;br /&gt; 
          &lt;br /&gt; 
          &lt;b&gt;Remediation: &lt;/b&gt; 
          &lt;br /&gt;Perform the following to delete access keys that do not pass the audit. 
          &lt;br /&gt; 
          &lt;div&gt; 
           &lt;br /&gt; 
          &lt;/div&gt; 
          &lt;ol&gt; 
           &lt;li&gt;Login to the AWS Management Console.Click Services.&lt;/li&gt; 
           &lt;li&gt;Click IAM&lt;/li&gt; 
           &lt;li&gt;Click on Users.Click on Security Credentials.&lt;/li&gt; 
           &lt;li&gt;As an Administrator.&lt;/li&gt; 
           &lt;ul&gt; 
            &lt;li&gt;Click on Delete for keys that were created at the same time as the user profile but have not been used.&lt;br /&gt;&lt;/li&gt; 
           &lt;/ul&gt; 
           &lt;li&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; As an IAM User&lt;/li&gt; 
           &lt;ul&gt; 
            &lt;li&gt;Click on Delete for keys that were created at the same time as the user profile but have not been used.&lt;/li&gt; 
           &lt;/ul&gt; 
           &lt;li&gt;Via CLI:&lt;/li&gt; 
           &lt;ul&gt; 
            &lt;li&gt;aws iam delete-access-key&lt;/li&gt; 
           &lt;/ul&gt; 
          &lt;/ol&gt; 
          &lt;span style="font-weight: bold;"&gt;&lt;/span&gt;
          </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='1.21' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>
            Perform the following to determine if access keys are rotated as prescribed: 
            &lt;br /&gt; 
            &lt;ol&gt; 
             &lt;li&gt;Login to the AWS Management Console&lt;/li&gt; 
             &lt;li&gt;Click Services&lt;/li&gt; 
             &lt;li&gt;Click IAM&lt;/li&gt; 
             &lt;li&gt;Click on a User&lt;/li&gt; 
             &lt;li&gt;Compare the user creation date to the key 1 creation date.&lt;/li&gt; 
             &lt;li&gt;For any that match, the key was created during initial user setup.&lt;/li&gt; 
            &lt;/ol&gt;Keys that were created at the same time as the user profile and do not have a last used date should be deleted. 
            &lt;br /&gt; 
            &lt;br /&gt;Via the CLI: 
            &lt;br /&gt; 
            &lt;ul&gt; 
             &lt;li&gt;Run the following command (OSX/Linux/UNIX) to generate a list of all IAM users along with their access keys utilization:&lt;/li&gt; 
            &lt;/ul&gt; 
            &lt;blockquote&gt; 
             &lt;blockquote&gt;
               aws iam generate-credential-report 
             &lt;/blockquote&gt; 
            &lt;/blockquote&gt; 
            &lt;br /&gt; 
            &lt;blockquote&gt; 
             &lt;blockquote&gt;
               aws iam get-credential-report --query 'Content' --output text | base64 -d | cut -d, -f1,4,9,11,14,16 
             &lt;/blockquote&gt; 
            &lt;/blockquote&gt; 
            &lt;ul&gt; 
             &lt;li&gt;The output of this command will produce a table similar to the following:&amp;nbsp;&lt;/li&gt; 
            &lt;/ul&gt; 
            &lt;blockquote&gt; 
             &lt;blockquote&gt;
               user,password_enabled,access_key_1_active,access_key_1_last_used_date,access_ 
             &lt;/blockquote&gt; 
             &lt;blockquote&gt;
               key_2_active,access_key_2_last_used_date 
             &lt;/blockquote&gt; 
             &lt;blockquote&gt;
               elise,false,true,2015-04-16T15:14:00+00:00,false,N/A 
             &lt;/blockquote&gt; 
             &lt;blockquote&gt;
               brandon,true,true,N/A,false,N/A 
             &lt;/blockquote&gt; 
             &lt;blockquote&gt;
               rakesh,false,false,N/A,false,N/A 
             &lt;/blockquote&gt; 
             &lt;blockquote&gt;
               helene,false,true,2015-11-18T17:47:00+00:00,false,N/A 
             &lt;/blockquote&gt; 
             &lt;blockquote&gt;
               paras,true,true,2016-08-28T12:04:00+00:00,true,2016-03-04T10:11:00+00:00 
             &lt;/blockquote&gt; 
             &lt;blockquote&gt;
               anitha,true,true,2016-06-08T11:43:00+00:00,true,N/A 
             &lt;/blockquote&gt; 
            &lt;/blockquote&gt; 
            &lt;ul&gt; 
             &lt;li&gt;For any user having access_key_last_used_date set to N/A , ensure that access key is deleted&lt;/li&gt; 
            &lt;/ul&gt;
            </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-Gov-1.1' name='Configure the security challenge questions within the AWS Account' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>When an AWS account is initially created it is configured with a top level account known as the &amp;quot;root&amp;quot; account that has full administration access to all resources. In the event that the password or MFA device associated with this account is lost AWS support may recover it by asking you to answer the security questions. 
&lt;div&gt; 
 &lt;br /&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
 &lt;br /&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Login to the AWS Account as root.&lt;/li&gt; 
  &lt;li&gt;Click account name on the top right of the management console.&lt;/li&gt; 
  &lt;li&gt;Select &amp;quot;My Account&amp;quot;.&lt;/li&gt; 
  &lt;li&gt;Scroll down to &amp;quot;Configure Security Challenge Questions&amp;quot;.&lt;/li&gt; 
  &lt;li&gt;Click on Edit.&lt;/li&gt; 
  &lt;li&gt;For each question:&lt;/li&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Select an appropriate question.&lt;/li&gt; 
   &lt;li&gt;Enter an appropriate answer.&lt;/li&gt; 
   &lt;li&gt;Follow the above process for all 3 questions.&lt;/li&gt; 
  &lt;/ul&gt; 
  &lt;li&gt;Click Update when complete.&lt;/li&gt; 
  &lt;li&gt;We recommend to store the questions and answers in a secure location such as a safe where they can be used in case recovery is required.&lt;/li&gt; 
 &lt;/ol&gt;Content provided by 
 &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt; 
&lt;/div&gt;</desc>
          <implementations />
          <references />
          <standards>
            <standard ref='1.15' supportedStandardRef='CIS AWS Standard' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Login to the AWS Account as root.&lt;/li&gt;
                            &lt;li&gt;Click account name on the top right of the management console.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;My Account&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Scroll down to &amp;quot;Configure Security Challenge Questions&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Confirm whether questions and answers have been saved.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-IAM-2.9' name='Enforce employee lifecycle policies' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Regular reviews of accounts on the system should be conducted to ensure that stale accounts
                        cannot be abused either by those former employees using them or compromised by attackers.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;&amp;nbsp;&amp;nbsp;
                        &lt;br /&gt;At least every 90 days complete the following:
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Sign in to the AWS Management Console (with IAM update privileges).&lt;/li&gt;
                        &lt;li&gt;Go to IAM Service on the AWS Console.&lt;/li&gt;
                        &lt;li&gt;Click on Users.&lt;/li&gt;
                        &lt;li&gt;For any user that should no longer exist:&lt;/li&gt;
                        &lt;ul&gt;
                        &lt;li&gt;select the user,&lt;/li&gt;
                        &lt;li&gt;click &amp;quot;User Actions&amp;quot;,&lt;/li&gt;
                        &lt;li&gt;click &amp;quot;Delete&amp;quot;.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ol&gt;Content provided by
                        &lt;a href="https://hydrasit.com" target="_blank"&gt; Hydras IT LTD&lt;/a&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references />
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Obtain a list of IAM users by: aws iam list-users --query 'Users[*].UserName'
                            --output text&lt;/li&gt;
                            &lt;li&gt;Ensure all users are valid users.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control>
</controls>
<usecases>
<usecase ref='AUTHORIZATION' name='Authorization' desc='' library=''>
          <threats>
<threat ref='AWS-LOSS-CONTROL-ENV' name='Attackers gain unauthorized access to the control of the environment' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;div&gt;
                                Attackers could gain unauthorized access to the control of the environment, due of the
                                user accounts or role groups are not well defined and configured. Therefore, attackers
                                can make changes without the root approval.&amp;nbsp;
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AWS-IAM-2.8'>
                  <controls>
                    <control ref='Hydras-AWS-IAM-2.10' mitigation='12' />
                  </controls>
                </weakness>
                <weakness ref='AWS-IAM-1.21'>
                  <controls>
                    <control ref='Hydras-AWS-IAM-1.21' mitigation='12' />
                  </controls>
                </weakness>
                <weakness ref='AWS-IAM-2.7'>
                  <controls>
                    <control ref='Hydras-AWS-EC2-6.3' mitigation='12' />
                    <control ref='Hydras-AWS-IAM-1.20' mitigation='12' />
                    <control ref='Hydras-AWS-IAM-2.7' mitigation='13' />
                    <control ref='Hydras-AWS-IAM-2.8' mitigation='13' />
                  </controls>
                </weakness>
                <weakness ref='AWS-EXPIRATION-DATE'>
                  <controls>
                    <control ref='Hydras-AWS-IAM-2.11' mitigation='13' />
                  </controls>
                </weakness>
                <weakness ref='AWS-IAM-2.12'>
                  <controls>
                    <control ref='Hydras-AWS-IAM-2.12' mitigation='13' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='Hydras-AWS-EC2-6.3' mitigation='12' />
                <control ref='Hydras-AWS-IAM-1.20' mitigation='12' />
                <control ref='Hydras-AWS-IAM-1.21' mitigation='12' />
                <control ref='Hydras-AWS-IAM-2.10' mitigation='12' />
                <control ref='Hydras-AWS-IAM-2.11' mitigation='13' />
                <control ref='Hydras-AWS-IAM-2.12' mitigation='13' />
                <control ref='Hydras-AWS-IAM-2.7' mitigation='13' />
                <control ref='Hydras-AWS-IAM-2.8' mitigation='13' />
              </controls>
            </threat>
</threats>
</usecase>
<usecase ref='AUTHENTICATION' name='Authentication' desc='' library=''>
          <threats>
<threat ref='AWS-LOST-ACCESS-USER' name='Attackers gain unauthorized access to the user account due to the lack of configuration of the account' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;div&gt;
                                Attackers could gain unauthorized access to the user account due to the lack of
                                configuration of the account, like the security question to reset the password was
                                configured incorrectly.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AWS-IAM-2.8'>
                  <controls>
                    <control ref='Hydras-AWS-IAM-2.4' mitigation='33' />
                  </controls>
                </weakness>
                <weakness ref='AWS-IAM-2.6'>
                  <controls>
                    <control ref='Hydras-AWS-IAM-2.6' mitigation='33' />
                  </controls>
                </weakness>
                <weakness ref='AWS-IAM-2.9'>
                  <controls>
                    <control ref='Hydras-AWS-IAM-2.9' mitigation='34' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='Hydras-AWS-IAM-2.4' mitigation='33' />
                <control ref='Hydras-AWS-IAM-2.6' mitigation='33' />
                <control ref='Hydras-AWS-IAM-2.9' mitigation='34' />
              </controls>
            </threat><threat ref='AWS-LOST-ACCESS-ROOT' name='Attackers gain unauthorized access to the root account due to the lack of configuration of the account' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;div&gt;
                                Attackers could gain unauthorized access to the administrator account due to the lack of
                                the account and its security mechanisms, like modifying credentials and adding/removing
                                user accounts.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AWS-IAM-2.2'>
                  <controls>
                    <control ref='Hydras-AWS-IAM-2.1' mitigation='17' />
                    <control ref='Hydras-AWS-IAM-2.3' mitigation='17' />
                  </controls>
                </weakness>
                <weakness ref='AWS-IAM-2.1'>
                  <controls>
                    <control ref='Hydras-AWS-IAM-2.2' mitigation='17' />
                    <control ref='Hydras-AWS-IAM-2.5' mitigation='17' />
                  </controls>
                </weakness>
                <weakness ref='LOST-ACCESS-ROOT-01'>
                  <controls>
                    <control ref='Hydras-AWS-Gov-1.1' mitigation='16' />
                  </controls>
                </weakness>
                <weakness ref='LOST-SECURITY-ALERTS'>
                  <controls>
                    <control ref='Hydras-AWS-Gov-1.2' mitigation='16' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='Hydras-AWS-Gov-1.1' mitigation='16' />
                <control ref='Hydras-AWS-Gov-1.2' mitigation='16' />
                <control ref='Hydras-AWS-IAM-2.1' mitigation='17' />
                <control ref='Hydras-AWS-IAM-2.2' mitigation='17' />
                <control ref='Hydras-AWS-IAM-2.3' mitigation='17' />
                <control ref='Hydras-AWS-IAM-2.5' mitigation='17' />
              </controls>
            </threat>
</threats>
</usecase>
</usecases>
</component>
<component ref='HYDRAS-AWS-RDS' name='AWS RDS' desc='' groupName='' tags='' position='7' library='' diagramPositionX='0' diagramPositionY='0' componentDefinitionRef=''>
      <weaknesses>
<weakness ref='database-publically-accesible' name='Database is publically accesible' state='0' impact='100'>
          <desc>Everyone can access the RDS database and obtain the data.</desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-S3-7.3' name='Sensitive data is exposed in transit' state='0' impact='100'>
          <desc>Sensitive data is not encrypted in transit with HTTPS or SSL, and this data is accessible
                        whilst traversing the network.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='NOT_BACKUP_POLICIES' name='Not backup retention policies' state='0' impact='100'>
          <desc>There are no data backup retention policies.</desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-IAM-2.7' name='The credentials for the groups and roles are not configured' state='0' impact='100'>
          <desc>&lt;div&gt;
                        The credentials for the groups and roles are not correctly configured and there are user
                        accounts with more privileges than the necessary.
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-EC2-6.2' name='The instances are not patched' state='0' impact='100'>
          <desc>The instances are not patched with the last updates for the correspondent Operative System
                        (OS), and the instances have got weaknesses which are solved in the last updates.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='no-access-control-onrds' name='Not access control on RDS databases' state='0' impact='100'>
          <desc>There are no access control mechanisms on the RDS database resources and any user can gain access
                        to them and exfiltrate the data.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='no-notification-incident' name='No notification when an incident occurs' state='0' impact='100'>
          <desc>There are no notifications when a security incident occurs. Therefore, we do not know when an
                        attacker gains access to our systems and/or security systems
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-Network-5.2' name='Networks for Amazon resources are not properly segmentated.' state='0' impact='100'>
          <desc>&lt;div&gt;
                        Resources in the same VNet are compromised because when one of them is attacked and the
                        attackers gain access, they also gain access to all resources.
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AWS-S3-7.4' name='Sensitive data is accessible' state='0' impact='100'>
          <desc>Sensitive data is not encrypted and is exposed.</desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness>
</weaknesses>
<controls>
<control ref='aws-tier-1.4' name='Enable encryption at rest for Databases running on RDS' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Amazon RDS instances and snapshots can be encrypted at rest by enabling the encryption option on
                        the Amazon RDS DB instance. Data that is encrypted at rest includes the underlying storage for a
                        DB instance, its automated backups, read replicas, and snapshots. Encryption at rest should
                        be enabled.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        Using the Amazon unified CLI:
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Perform a snapshot of the DB instance:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        aws rds create-db-snapshot --db-snapshot-identifier db_snapshot
                        --db-instance-identifier your_db_instance
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Confirm created snapshot is available (once snapshot process has completed):&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        aws rds describe-db-snapshots --query
                        'DBSnapshots[*].{DBSnapshotIdentifier:DBSnapshotIdentifier,
                        DBInstanceIdentifier:DBInstanceIdentifier, Snapshotstatus:Status}'
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;li&gt;List all KMS Customer Managed Keys:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        aws kms list-aliases
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Copy to source RDS snapshot (from previous step) to a destination snapshot which will
                        be encrypted:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        aws rds copy-db-snapshot --source-db-snapshot-identifier db_snapshot&amp;nbsp;
                        --target-db-snapshot-identifier encrypted_db_snapshot
                        --kms-key-id data_tier_kms_key
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Restore a snapshot to the target DB instance(from previous step) with the same values as
                        original db instance with additional encrypted storage values:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        aws rds restore-db-instance-from-db-snapshot --db-instance-identifier your_db_instance
                        --db-snapshot-identifier encrypted_db_snapshot
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='Amazon docs: copy db snapshot' url='http://docs.aws.amazon.com/cli/latest/reference/rds/copy-db-snapshot.html' />
            <reference name='Amazon docs: copy snapshot' url='http://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_CopySnapshot.html' />
            <reference name='Amazon docs: create db instances' url='http://docs.aws.amazon.com/cli/latest/reference/rds/create-db-instance.html' />
            <reference name='Amazon docs: create db snapshots' url='http://docs.aws.amazon.com/cli/latest/reference/rds/create-db-snapshot.html' />
            <reference name='Amazon docs: describe db instances' url='http://docs.aws.amazon.com/cli/latest/reference/rds/describe-db-instances.html' />
            <reference name='Amazon docs: describe db snapshots' url='http://docs.aws.amazon.com/cli/latest/reference/rds/describe-db-snapshots.html' />
            <reference name='Amazon docs: encryption' url='http://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html' />
            <reference name='Amazon docs: list aliases' url='http://docs.aws.amazon.com/cli/latest/reference/kms/list-aliases.html' />
          </references>
          <standards>
            <standard ref='1.4' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;p&gt;Using the Amazon unified CLI:&lt;/p&gt;
                            &lt;ul&gt;
                            &lt;li&gt;List all current RDS instances and review the encryption status of the DB
                            instance:&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;blockquote&gt;
                            &lt;blockquote&gt;
                            aws rds describe-db-instances --query 'DBInstances[*].{DBName:DBName,
                            EncryptionEnabled:StorageEncrypted, CMK:KmsKeyId}'
                            &lt;/blockquote&gt;
                            &lt;/blockquote&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-4.4' name='Enable event subscriptions for DataBase security on RDS' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;p&gt;AWS Relational Database Services offers customers a managed database engine solution
                        for hosting customer created databases which can allow for a reduction in operational burden on
                        customers.&lt;/p&gt;
                        &lt;p&gt;RDS event subscriptions provide notification of selected event changes at a DB security
                        group level.&lt;/p&gt;
                        &lt;p&gt;Event subscriptions are designed to provide incident notification of events which may
                        affect the network availability of the RDS instance.&lt;/p&gt;
                        &lt;p&gt;&lt;b&gt;Remediation:&lt;/b&gt;&lt;/p&gt;
                        &lt;p&gt;Using the Amazon unified CLI:&lt;/p&gt;
                        &lt;p&gt;&lt;/p&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Create a new event subscription for DB Security Group events:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;p&gt;&lt;/p&gt;
                        &lt;p&gt;&lt;/p&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;p&gt;aws rds create-event-subscription --subscription-name rds_event_subscription
                        --sns-topic-arn
                        sns_topic_arn
                        --source-type db-security-group --event-categories rds_events
                        --source-ids events_source_ids --enabled&lt;/p&gt;
                        &lt;/blockquote&gt;
                        &lt;/blockquote&gt;
                    </desc>
          <implementations />
          <references />
          <standards>
            <standard ref='4.4' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            Using the Amazon unified CLI:
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;ul&gt;
                            &lt;li&gt;List all present event subscriptions and review the value of &amp;quot;db-security-group&amp;quot;
                            associated with &amp;quot;SourceType&amp;quot; element:&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;/div&gt;
                            &lt;blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            aws rds describe-event-subscriptions --query
                            'EventSubscriptionsList[*].{SourceType:SourceType, SourceIdsList:SourceIdsList,
                            EventCategoriesList:EventCategoriesList}'
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;br /&gt;
                            &lt;/div&gt;
                            &lt;/blockquote&gt;
                            &lt;/blockquote&gt;
                            &lt;div&gt;
                            &amp;quot;EventCategoriesList&amp;quot; will list all event categories which will be
                            reported on
                            &lt;/div&gt;
                            &lt;div&gt;
                            &amp;quot;SourceIdsList&amp;quot; will list all RDS DB instances included (null=all
                            instances)
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-3.5' name='Enable Multi-AZ on RDS' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  Amazon Relational Database Service (RDS) is a managed relational database service which handles routine database tasks such as provisioning, patching, backup, recovery, failure detection, and repair. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  There are 6 database engines available for customer to run their database workloads on: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Amazon Aurora (MySQL Compatible)&lt;/li&gt; 
  &lt;li&gt;MySQL&lt;/li&gt; 
  &lt;li&gt;MariaDB&lt;/li&gt; 
  &lt;li&gt;Oracle&lt;/li&gt; 
  &lt;li&gt;Microsoft SQL Server&lt;/li&gt; 
  &lt;li&gt;PostgreSQL&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div&gt;
   Provides AWS managed high availability of the Database Tier across 2 availability zones within a region through asynchronous replication at the data layer. 
 &lt;/div&gt; 
 &lt;div&gt; 
  &lt;br /&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified command line interface: 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Modify each no-multi-az DB instance, and make it Multi-AZ enabled:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws rds modify-db-instance --db-instance-identifier &amp;lt;your_db_instance&amp;gt; --multi-az 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: describe db instances' url='http://docs.aws.amazon.com/cli/latest/reference/rds/describe-db-instances.html' />
            <reference name='Amazon docs: modify db instances' url='http://docs.aws.amazon.com/cli/latest/reference/rds/modify-db-instance.html' />
          </references>
          <standards>
            <standard ref='3.5' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            Using the Amazon unified command line interface:
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;ul&gt;
                            &lt;li&gt;Check if your application DB instances are Multi-AZ enabled:&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;/div&gt;
                            &lt;blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            aws rds describe-db-instances --filters Name=tag:data_tier_tag,Values=data_tier_tag_value
                            --query &amp;quot;DBInstances[*].{MultiAZ:MultiAZ,
                            DBInstanceIdentifier:DBInstanceIdentifier}&amp;quot;
                            &lt;/div&gt;
                            &lt;/blockquote&gt;
                            &lt;/blockquote&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-3.7' name='Set Backup retention policy on RDS' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  Amazon Relational Database Service (RDS) is a managed relational database service which handles routine database tasks such as provisioning, patching, backup, recovery, failure detection, and repair. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  There are 6 database engines available for customer to run their database workloads on: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Amazon Aurora (MySQL Compatible)&lt;/li&gt; 
  &lt;li&gt;MySQL&lt;/li&gt; 
  &lt;li&gt;MariaDB&lt;/li&gt; 
  &lt;li&gt;Oracle&lt;/li&gt; 
  &lt;li&gt;Microsoft SQL Server&lt;/li&gt; 
  &lt;li&gt;PostgreSQL&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div&gt;
   Provides a managed backup function of the RDS Database, it is possible to define the backup window and retention period of the backup. Each customer should have a retention policy set for the type of data being stored. It is recommended to set this to at least 7. 
 &lt;/div&gt; 
 &lt;div&gt; 
  &lt;br /&gt; 
 &lt;/div&gt; 
 &lt;div&gt;
   Possible values are from 0 to 35 days. 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified command line interface: 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Modify each DB instance with a Backup Retention Period of 0, and set a desired Backup Retention Period in days (recommended value = 7):&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws rds modify-db-instance --db-instance-identifier &amp;lt;your_db_instance&amp;gt; --backup-retention-period &amp;lt;backup_retention_period&amp;gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: describe db instances' url='http://docs.aws.amazon.com/cli/latest/reference/rds/describe-db-instances.html' />
            <reference name='Amazon docs: modify db instances' url='http://docs.aws.amazon.com/cli/latest/reference/rds/modify-db-instance.html' />
          </references>
          <standards>
            <standard ref='3.7' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            Using the Amazon unified command line interface:
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;ul&gt;
                            &lt;li&gt;Check if your application DB instances have a Backup Retention Period set (0 =
                            there is no backup retention in place, 7 = there are 7 daily backups retained):&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;/div&gt;
                            &lt;blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            aws rds describe-db-instances --filters Name=tag:data_tier_tag,Values=data_tier_tag_value
                            --query &amp;quot;DBInstances[*].{BackupRetentionPeriod:BackupRetentionPeriod,
                            DBInstanceIdentifier:DBInstanceIdentifier}&amp;quot;
                            &lt;/div&gt;
                            &lt;/blockquote&gt;
                            &lt;/blockquote&gt;
                            &lt;div&gt;
                            &lt;br /&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-4.3' name='Enable Event subscriptions for Instance level events on RDS' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  AWS Relational Database Services offers customers a managed database engine solution for hosting customer created databases which can allow for a reduction in operational burden on customers. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  RDS event subscriptions provide notification of selected event changes at DataBase engine level such as: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Deletion&lt;/li&gt; 
  &lt;li&gt;Failure&lt;/li&gt; 
  &lt;li&gt;Failover&lt;/li&gt; 
  &lt;li&gt;Low Storage&lt;/li&gt; 
  &lt;li&gt;Maintenance&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Event subscriptions are designed to provide incident notification of events which may affect the availability of a RDS database instance. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified CLI: 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Create a new event subscription for DB instance level events:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws rds create-event-subscription --subscription-name &amp;lt;rds_event_subscription&amp;gt; --sns-topic-arn sns_topic_arn --source-type &amp;lt;db-instance&amp;gt; --event-categories &amp;lt;rds_events&amp;gt; --source-ids &amp;lt;events_source_ids&amp;gt; --enabled 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: create event subscription' url='http://docs.aws.amazon.com/cli/latest/reference/rds/create-event-subscription.html' />
            <reference name='Amazon docs: describe event subcriptions' url='http://docs.aws.amazon.com/cli/latest/reference/rds/describe-event-subscriptions.html' />
            <reference name='Amazon docs: user event messages' url='http://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Events.html#USER_Events.Messages' />
          </references>
          <standards>
            <standard ref='4.3' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            Using the Amazon unified CLI:
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;ul&gt;
                            &lt;li&gt;List all present event subscriptions and review the value of &amp;quot;db-instance&amp;quot;
                            associated with &amp;quot;SourceType&amp;quot; element:&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;/div&gt;
                            &lt;blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            aws rds describe-event-subscriptions --query
                            'EventSubscriptionsList[*].{SourceType:SourceType, SourceIdsList:SourceIdsList,
                            EventCategoriesList:EventCategoriesList}'
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;br /&gt;
                            &lt;/div&gt;
                            &lt;/blockquote&gt;
                            &lt;/blockquote&gt;
                            &lt;div&gt;
                            &amp;quot;EventCategoriesList&amp;quot; will list all event categories which will be
                            reported on
                            &lt;/div&gt;
                            &lt;div&gt;
                            &amp;quot;SourceIdsList&amp;quot; will list all RDS DB instances included (null=all
                            instances)
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;br /&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-3.6' name='Enable Auto Minor Version Upgrade on RDS' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;p&gt;Amazon Relational Database Service (RDS) is a managed relational database service which handles routine database tasks such as provisioning, patching, backup, recovery, failure detection, and repair.&lt;/p&gt; 
&lt;p&gt;There are 6 database engines available for customers to run their database workloads on:&lt;/p&gt; 
&lt;ul&gt; 
 &lt;li&gt;Amazon Aurora (MySQL Compatible)&lt;/li&gt; 
 &lt;li&gt;MySQL&lt;/li&gt; 
 &lt;li&gt;MariaDB&lt;/li&gt; 
 &lt;li&gt;Oracle&lt;/li&gt; 
 &lt;li&gt;Microsoft SQL Server&lt;/li&gt; 
 &lt;li&gt;PostgreSQL&lt;/li&gt; 
&lt;/ul&gt; 
&lt;p&gt;If the database engine used by your application supports it, ensure that the RDS Instances have Auto Minor Version Upgrade Enabled.&lt;/p&gt; 
&lt;p&gt;&lt;b&gt;Remediation:&lt;/b&gt;&lt;/p&gt; 
&lt;p&gt;Using the Amazon unified command line interface:&lt;/p&gt; 
&lt;p&gt;&lt;/p&gt; 
&lt;ul&gt; 
 &lt;li&gt;Modify each DB instance with auto-minor-version-upgrade set to False, and enable auto-minor-version-upgrade:&lt;/li&gt; 
&lt;/ul&gt; 
&lt;p&gt;&lt;/p&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;p&gt;aws rds modify-db-instance --db-instance-identifier &amp;lt;your_db_instance&amp;gt; --auto-minor-version-upgrade&lt;/p&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: describe db instances' url='http://docs.aws.amazon.com/cli/latest/reference/rds/describe-db-instances.html' />
            <reference name='Amazon docs: modify db instances' url='http://docs.aws.amazon.com/cli/latest/reference/rds/modify-db-instance.html' />
          </references>
          <standards>
            <standard ref='3.6' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            Using the Amazon unified command line interface:
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;ul&gt;
                            &lt;li&gt;Check if your application DB instances have Auto Minor Version Upgrade enabled:&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;/div&gt;
                            &lt;blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            aws rds describe-db-instances --filters Name=tag:data_tier_tag,Values=data_tier_tag_value
                            --query &amp;quot;DBInstances[*].{AutoMinorVersionUpgrade:AutoMinorVersionUpgrade,
                            DBInstanceIdentifier:DBInstanceIdentifier}&amp;quot;
                            &lt;/div&gt;
                            &lt;/blockquote&gt;
                            &lt;/blockquote&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-RDS-02' name='Assign to IAM roles the permissions for RDS instances' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>The following AWS managed policies, which you can attach to users in your account, are
                        specific to Amazon RDS:
                        &lt;br /&gt;
                        &lt;ul&gt;
                        &lt;li&gt;&lt;b&gt;AmazonRDSReadOnlyAccess:&lt;/b&gt; Grants read-only access to all Amazon RDS
                        resources for the root AWS account.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;&lt;b&gt;AmazonRDSFullAccess:&lt;/b&gt; Grants full access to all Amazon RDS resources
                        for the root AWS account.&lt;/li&gt;
                        &lt;/ul&gt;You can also create custom IAM policies that allow users to access the required
                        Amazon RDS API actions and resources. You can attach these custom policies to the IAM users or
                        groups that require those permissions.
                        &lt;br /&gt;
                        &lt;br /&gt;The permissions above shall be assigned to roles or groups:
                        &lt;br /&gt;
                        &lt;ul&gt;
                        &lt;li&gt;The roles or groups only do calls to the API to get information, the
                        AmazonRDSReadOnlyAccess permission shall be assigned.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;The roles or groups who are responsible of managing the RDS instances shall be
                        assigned the AmazonRDSFullAccess permission.&lt;/li&gt;
                        &lt;/ul&gt;
                    </desc>
          <implementations />
          <references />
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ul&gt;
                            &lt;li&gt;Review the IAM roles and groups.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Check that all roles or groups have got the AmazonRDSReadOnlyAccess permission.&lt;/li&gt;
                            &lt;li&gt;Check that only the appropriate personnel have got AmazonRDSFullAccess permissions
                            to manage the RDS instances.&lt;/li&gt;
                            &lt;/ul&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-6.34' name='Configure RDS database to leverage the Data Tier Security Group' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  Amazon Relational Database Service (RDS) is a managed relational database service which handles routine database tasks such as provisioning, patching, backup, recovery, failure detection, and repair. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  There are 6 database engines available for customer to run their database workloads on: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Amazon Aurora (MySQL Compatible)&lt;/li&gt; 
  &lt;li&gt;MySQL&lt;/li&gt; 
  &lt;li&gt;MariaDB&lt;/li&gt; 
  &lt;li&gt;Oracle&lt;/li&gt; 
  &lt;li&gt;Microsoft SQL Server&lt;/li&gt; 
  &lt;li&gt;PostgreSQL&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Customers can deploy RDS databases within a VPC through the configuration of: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Subnet Group for RDS, this group will be used for deployment of single or Multi-AZ RDS instances.&lt;/li&gt; 
  &lt;li&gt;Network access through configuration of Security Groups for RDS&lt;/li&gt; 
  &lt;li&gt;Access from outside the VPC hosting the DB instance by enabling/disabling a Public IP address&lt;/li&gt; 
  &lt;li&gt;Network access to the managed Data-Tier must be tightly controlled using Security Groups for RDS and non local accessibility of the DB instance.&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation: &lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified command line interface: 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Modify each non-compliant DB instance, and configure it to use the Data Tier Security Group:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws rds modify-db-instance --db-instance-identifier &amp;lt;your_db_instance&amp;gt; --vpc-security-group-ids &amp;lt;data_tier_security_group&amp;gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: describe db instances' url='http://docs.aws.amazon.com/cli/latest/reference/rds/describe-db-instances.html' />
            <reference name='Amazon docs: modify db instances' url='http://docs.aws.amazon.com/cli/latest/reference/rds/modify-db-instance.html' />
          </references>
          <standards>
            <standard ref='6.34' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            Using the Amazon unified command line interface:
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;ul&gt;
                            &lt;li&gt;Check if your application DB instances are configured to use the Data Tier
                            Security Group:&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;/div&gt;
                            &lt;blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            aws rds describe-db-instances --filters Name=tag:data_tier_tag,Values=data_tier_tag_value
                            --query &amp;quot;DBInstances[*].{VpcSecurityGroups:VpcSecurityGroups,
                            DBInstanceIdentifier:DBInstanceIdentifier}&amp;quot;
                            &lt;/div&gt;
                            &lt;/blockquote&gt;
                            &lt;/blockquote&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='Hydras-AWS-RDS-01' name='Use SSL to Encrypt the connection to a DB Instance' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Use SSL from your application to encrypt a connection to a DB instance running MySQL, MariaDB,
                        Amazon Aurora, SQL Server, Oracle, or PostgreSQL. Each DB engine has its own process for
                        implementing SSL. To learn how to implement SSL for your particular DB instance, please see link
                        provided in &amp;quot;References&amp;quot; section.
                    </desc>
          <implementations />
          <references />
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>Check that the SSL protocol is used to encrypt the data in transit.</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='aws-tier-6.30' name='Do not allow the  RDS database to be publically accessible' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  Amazon Relational Database Service (RDS) is a managed relational database service which handles routine database tasks such as provisioning, patching, backup, recovery, failure detection, and repair. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  There are 6 database engines available for customer to run their database workloads on: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Amazon Aurora (MySQL Compatible)&lt;/li&gt; 
  &lt;li&gt;MySQL&lt;/li&gt; 
  &lt;li&gt;MariaDB&lt;/li&gt; 
  &lt;li&gt;Oracle&lt;/li&gt; 
  &lt;li&gt;Microsoft SQL Server&lt;/li&gt; 
  &lt;li&gt;PostgreSQL&lt;/li&gt; 
 &lt;/ul&gt;Customers can deploy RDS databases within a VPC through the configuration of: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Subnet Group for RDS, this group will be used for deployment of single or Multi-AZ RDS instances.&lt;/li&gt; 
  &lt;li&gt;Network access through configuration of Security Groups for RDS&lt;/li&gt; 
  &lt;li&gt;Access from outside the VPC hosting the DB instance by enabling/disabling a Public IP address&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div style=""&gt;
   Using the Amazon unified command line interface: 
 &lt;/div&gt; 
 &lt;div style=""&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Modify each publicly accessible DB instance, and make it private:&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;blockquote&gt; 
 &lt;blockquote&gt; 
  &lt;div&gt; 
   &lt;div style=""&gt;
     aws rds modify-db-instance --db-instance-identifier &amp;lt;your_db_instance&amp;gt; --no-publicly-accessible 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/blockquote&gt; 
&lt;/blockquote&gt;</desc>
          <implementations />
          <references>
            <reference name='Amazon docs: describe db instances' url='http://docs.aws.amazon.com/cli/latest/reference/rds/describe-db-instances.html' />
            <reference name='Amazon docs: modify db instance' url='http://docs.aws.amazon.com/cli/latest/reference/rds/modify-db-instance.html' />
          </references>
          <standards>
            <standard ref='6.30' supportedStandardRef='cis-amazon-web-services-three-tier-web-architecture-benchmark' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            Using the Amazon unified command line interface:
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;ul&gt;
                            &lt;li&gt;Check if your application DB instances are publicly available:&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;/div&gt;
                            &lt;blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            aws rds describe-db-instances --filters Name=tag:data_tier_tag,Values=data_tier_tag_value
                            --query &amp;quot;DBInstances[*].{PubliclyAccessible:PubliclyAccessible,
                            DBInstanceIdentifier:DBInstanceIdentifier}&amp;quot;
                            &lt;/div&gt;
                            &lt;/blockquote&gt;
                            &lt;/blockquote&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-01T07:51:15.000'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control>
</controls>
<usecases>
<usecase ref='AMAZON WEB SERVICES' name='Amazon Web Services' desc='' library=''>
          <threats>
<threat ref='NON-UPDATED-SYSTEMS-AWS' name='Attackers gain unauthorised access to data on EC2 instances' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;p&gt;Attackers cloud gain access to data on EC2 instances through the weaknesses
                                in non-updated systems.&lt;/p&gt;
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AWS-EC2-6.2'>
                  <controls>
                    <control ref='aws-tier-3.6' mitigation='100' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='aws-tier-3.6' mitigation='100' />
              </controls>
            </threat><threat ref='ACCESS-TO-DATA-AWS' name='Sensitive data is compromised through unauthorized access to data' state='Expose' source='MANUAL' owner='' library=''>
              <desc>Attackers can gain access to sensitive data when the data is in transit in clear text,
                                or when the data is stored without encryption.
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AWS-S3-7.4'>
                  <controls>
                    <control ref='aws-tier-1.4' mitigation='50' />
                  </controls>
                </weakness>
                <weakness ref='AWS-S3-7.3'>
                  <controls>
                    <control ref='Hydras-AWS-RDS-01' mitigation='50' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='Hydras-AWS-RDS-01' mitigation='50' />
                <control ref='aws-tier-1.4' mitigation='50' />
              </controls>
            </threat><threat ref='DATA-DELETED-EASY-AWS' name='Data is intentionally or accidentally deleted' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;p&gt;Data can be deleted intentionally or accidentally, and the data cannot be
                                recovered as there are no recovery systems and the data is easy
                                to delete it.&lt;/p&gt;
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='NOT_BACKUP_POLICIES'>
                  <controls>
                    <control ref='aws-tier-3.7' mitigation='100' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='aws-tier-3.7' mitigation='100' />
              </controls>
            </threat><threat ref='UNAUTHORIZED-ACCESS-SECURITY-SYSTEMS-AWS' name='Attackers gain undetected access to the security system configurations' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;div&gt;
                                Attackers could gain undetected access to the security configurations and the changes of
                                the attackers could not be detected and audited.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='no-notification-incident'>
                  <controls>
                    <control ref='aws-tier-4.3' mitigation='50' />
                    <control ref='aws-tier-4.4' mitigation='50' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='aws-tier-4.3' mitigation='50' />
                <control ref='aws-tier-4.4' mitigation='50' />
              </controls>
            </threat><threat ref='UNAUTHORIZED-CONECTIONS-AWS' name='Attackers gain unauthorized connection to the resources' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;p&gt;Attackers could gain an unauthorized connection to the resources through
                                misconfigured ports or security network configurations.&lt;/p&gt;
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='database-publically-accesible'>
                  <controls>
                    <control ref='aws-tier-6.30' mitigation='33' />
                  </controls>
                </weakness>
                <weakness ref='AWS-Network-5.2'>
                  <controls>
                    <control ref='aws-tier-3.5' mitigation='33' />
                  </controls>
                </weakness>
                <weakness ref='no-access-control-onrds'>
                  <controls>
                    <control ref='aws-tier-6.34' mitigation='34' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='aws-tier-3.5' mitigation='33' />
                <control ref='aws-tier-6.30' mitigation='33' />
                <control ref='aws-tier-6.34' mitigation='34' />
              </controls>
            </threat><threat ref='AWS-LOSS-CONTROL-ENV' name='Attackers gain unauthorized access to the control of the environment' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;div&gt;
                                Attackers could gain unauthorized access to the control of the environment, due of the
                                user accounts or role groups are not well defined and configured. Therefore, attackers
                                can make changes without the root approval.&amp;nbsp;
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AWS-IAM-2.7'>
                  <controls>
                    <control ref='Hydras-AWS-RDS-02' mitigation='100' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='Hydras-AWS-RDS-02' mitigation='100' />
              </controls>
            </threat>
</threats>
</usecase>
</usecases>
</component>
</components>
<rules>
<rule name='Risk Pattern: AWS - EC2' module='component' generatedByGui='true'>
    <condition name='Question is answered' type='Question' field='id' value='aws.ec2'>
      <pattern name='Condition with answer' pattern='${type}(${field} == "${value}", answer == true);' />
    </condition>
    <action project='Hydras-AWS-Foundation' value='Hydras-AWS-Foundation_::_HYDRAS-AWS-EC2' name='Import Risk Pattern' type='drools-without-variable-type'>
      <pattern name='Action of import a risk pattern' pattern='insertLogical(ImportRiskPatternFactory.importRiskPattern("${value-1}", "${value-2}", 50));' />
    </action>
    <content />
  </rule>
<rule name='Q: AWS - SNS - *' module='component' generatedByGui='true'>
    <condition name='Question Group exists' type='drools-without-variable-type' field='id' value='deployment.publicCloud.aws.useSNS'>
      <pattern name='Question group exists' pattern='$group : QuestionGroup(id == "${value}") @Watch(!*);' />
    </condition>
    <action project='' value='aws.sns.no_::_No_::_' name='Insert Question' type='drools-without-variable-type'>
      <pattern name='Action of insert question' pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));' />
    </action>
    <action project='' value='aws.sns.yes_::_Yes_::_' name='Insert Question' type='drools-without-variable-type'>
      <pattern name='Action of insert question' pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));' />
    </action>
    <content />
  </rule>
<rule name='Risk Pattern: AWS - ELB' module='component' generatedByGui='true'>
    <condition name='Question is answered' type='Question' field='id' value='aws.elb'>
      <pattern name='Condition with answer' pattern='${type}(${field} == "${value}", answer == true);' />
    </condition>
    <action project='Hydras-AWS-Foundation' value='Hydras-AWS-Foundation_::_HYDRAS-AWS-ELB' name='Import Risk Pattern' type='drools-without-variable-type'>
      <pattern name='Action of import a risk pattern' pattern='insertLogical(ImportRiskPatternFactory.importRiskPattern("${value-1}", "${value-2}", 50));' />
    </action>
    <content />
  </rule>
<rule name='Q: AWS - SNS' module='component' generatedByGui='true'>
    <condition name='Is specific component definition' type='drools-without-variable-type' field='id' value='amazon-web-services-environment'>
      <pattern name='Is specific component definition' pattern='ComponentDefinitionProperties(ref == "${value}");' />
    </condition>
    <action project='' value='deployment.publicCloud.aws.useSNS_::_Amazon Web Services_::_Do you use Amazon Simple Notification Services (SNS) for the notifications?_::_6510_::_true_::_false_::_' name='Insert Question Group' type='drools-without-variable-type'>
      <pattern name='Action of insert question group' pattern='QuestionGroup group = new QuestionGroup("${value-1}","${value-2}","${value-3}", ${value-4}, "${value-7}"); group.setFlags(${value-5}, ${value-6}); insertLogical(group);' />
    </action>
    <content />
  </rule>
<rule name='Q: Deployed - Public Cloud &amp; AWS &amp; Datastore - *' module='component' generatedByGui='true'>
    <condition name='Question Group exists' type='drools-without-variable-type' field='id' value='deployment.publicCloud.aws.'>
      <pattern name='Question group exists' pattern='$group : QuestionGroup(id == "${value}") @Watch(!*);' />
    </condition>
    <condition name='Risk pattern exists' type='drools-without-variable-type' field='id' value='CS-Default_::_DATASTORE'>
      <pattern name='Risk pattern exists' pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");' />
    </condition>
    <action project='' value='aws.ec2_::_Elastic Compute Cloud - EC2_::_' name='Insert Question' type='drools-without-variable-type'>
      <pattern name='Action of insert question' pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));' />
    </action>
    <content />
  </rule>
<rule name='Q: Deployed - Public Cloud &amp; AWS &amp; Client' module='component' generatedByGui='true'>
    <condition name='Question is answered' type='Question' field='id' value='aws'>
      <pattern name='Condition with answer' pattern='${type}(${field} == "${value}", answer == true);' />
    </condition>
    <condition name='Risk pattern exists' type='drools-without-variable-type' field='id' value='CS-Default_::_GENERIC-CLIENT'>
      <pattern name='Risk pattern exists' pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");' />
    </condition>
    <action project='' value='deployment.publicCloud.aws._::_Deployment_::_Which AWS Services?_::_6509_::_true_::_true_::_' name='Insert Question Group' type='drools-without-variable-type'>
      <pattern name='Action of insert question group' pattern='QuestionGroup group = new QuestionGroup("${value-1}","${value-2}","${value-3}", ${value-4}, "${value-7}"); group.setFlags(${value-5}, ${value-6}); insertLogical(group);' />
    </action>
    <content />
  </rule>
<rule name='Q: Deployed - Public Cloud &amp; AWS &amp; Datastore' module='component' generatedByGui='true'>
    <condition name='Question is answered' type='Question' field='id' value='aws'>
      <pattern name='Condition with answer' pattern='${type}(${field} == "${value}", answer == true);' />
    </condition>
    <condition name='Risk pattern exists' type='drools-without-variable-type' field='id' value='CS-Default_::_DATASTORE'>
      <pattern name='Risk pattern exists' pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");' />
    </condition>
    <action project='' value='deployment.publicCloud.aws._::_Deployment_::_Which AWS Services?_::_6509_::_true_::_true_::_' name='Insert Question Group' type='drools-without-variable-type'>
      <pattern name='Action of insert question group' pattern='QuestionGroup group = new QuestionGroup("${value-1}","${value-2}","${value-3}", ${value-4}, "${value-7}"); group.setFlags(${value-5}, ${value-6}); insertLogical(group);' />
    </action>
    <content />
  </rule>
<rule name='Q: Deployed - Public Cloud &amp; AWS &amp; Service' module='component' generatedByGui='true'>
    <condition name='Question is answered' type='Question' field='id' value='aws'>
      <pattern name='Condition with answer' pattern='${type}(${field} == "${value}", answer == true);' />
    </condition>
    <condition name='Risk pattern exists' type='drools-without-variable-type' field='id' value='CS-Default_::_GENERIC-SERVICE'>
      <pattern name='Risk pattern exists' pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");' />
    </condition>
    <action project='' value='deployment.publicCloud.aws._::_Deployment_::_Which AWS Services?_::_6509_::_true_::_true_::_' name='Insert Question Group' type='drools-without-variable-type'>
      <pattern name='Action of insert question group' pattern='QuestionGroup group = new QuestionGroup("${value-1}","${value-2}","${value-3}", ${value-4}, "${value-7}"); group.setFlags(${value-5}, ${value-6}); insertLogical(group);' />
    </action>
    <content />
  </rule>
<rule name='Q: Deployed - Public Cloud &amp; AWS &amp; Client - *' module='component' generatedByGui='true'>
    <condition name='Question Group exists' type='drools-without-variable-type' field='id' value='deployment.publicCloud.aws.'>
      <pattern name='Question group exists' pattern='$group : QuestionGroup(id == "${value}") @Watch(!*);' />
    </condition>
    <condition name='Risk pattern exists' type='drools-without-variable-type' field='id' value='CS-Default_::_GENERIC-CLIENT'>
      <pattern name='Risk pattern exists' pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");' />
    </condition>
    <action project='' value='aws.ec2_::_Elastic Compute Cloud - EC2_::_' name='Insert Question' type='drools-without-variable-type'>
      <pattern name='Action of insert question' pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));' />
    </action>
    <content />
  </rule>
<rule name='Q: Deployed - Public Cloud &amp; AWS &amp; Datastore other - Cloud Storage' module='component' generatedByGui='true'>
    <condition name='Question Group exists' type='drools-without-variable-type' field='id' value='deployment.publicCloud.aws.'>
      <pattern name='Question group exists' pattern='$group : QuestionGroup(id == "${value}") @Watch(!*);' />
    </condition>
    <condition name='Risk pattern exists' type='drools-without-variable-type' field='id' value='CS-Default_::_CLOUD-STORAGE'>
      <pattern name='Risk pattern exists' pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");' />
    </condition>
    <action project='' value='aws.s3_::_Simple Storage Service - S3_::_' name='Insert Question' type='drools-without-variable-type'>
      <pattern name='Action of insert question' pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));' />
    </action>
    <content />
  </rule>
<rule name='Set Answer: Set Public Cloud when AWS S3 is selected' module='component' generatedByGui='true'>
    <condition name='Is specific component definition' type='drools-without-variable-type' field='id' value='s3'>
      <pattern name='Is specific component definition' pattern='ComponentDefinitionProperties(ref == "${value}");' />
    </condition>
    <action project='' value='Public Cloud_::_true_::_true' name='Answer Question' type='drools-without-variable-type'>
      <pattern name='Action of answer question' pattern='$questionToAnswer : Question(id == "${value-1}", answer != ${value-2}); eval(!${value-3} || !$questionToAnswer.isManuallyModified());_:::_modify($questionToAnswer) { setAnswer(${value-2}), setCanBeManuallyModified(${value-3}) };' />
    </action>
    <content />
  </rule>
<rule name='Risk Pattern: AWS - SNS' module='component' generatedByGui='true'>
    <condition name='Question is answered' type='Question' field='id' value='aws.sns.yes'>
      <pattern name='Condition with answer' pattern='${type}(${field} == "${value}", answer == true);' />
    </condition>
    <action project='Hydras-AWS-Foundation' value='Hydras-AWS-Foundation_::_HYDRAS-AWS-SNS' name='Import Risk Pattern' type='drools-without-variable-type'>
      <pattern name='Action of import a risk pattern' pattern='insertLogical(ImportRiskPatternFactory.importRiskPattern("${value-1}", "${value-2}", 50));' />
    </action>
    <content />
  </rule>
<rule name='Set Answer: Set Public Cloud when AWS EC2 is selected' module='component' generatedByGui='true'>
    <condition name='Is specific component definition' type='drools-without-variable-type' field='id' value='ec2'>
      <pattern name='Is specific component definition' pattern='ComponentDefinitionProperties(ref == "${value}");' />
    </condition>
    <action project='' value='Public Cloud_::_true_::_true' name='Answer Question' type='drools-without-variable-type'>
      <pattern name='Action of answer question' pattern='$questionToAnswer : Question(id == "${value-1}", answer != ${value-2}); eval(!${value-3} || !$questionToAnswer.isManuallyModified());_:::_modify($questionToAnswer) { setAnswer(${value-2}), setCanBeManuallyModified(${value-3}) };' />
    </action>
    <content />
  </rule>
<rule name='Q: Deployed - Public Cloud &amp; AWS &amp; Load Balancer' module='component' generatedByGui='true'>
    <condition name='Is specific component definition' type='drools-without-variable-type' field='id' value='load-balancer'>
      <pattern name='Is specific component definition' pattern='ComponentDefinitionProperties(ref == "${value}");' />
    </condition>
    <condition name='Question is answered' type='Question' field='id' value='aws'>
      <pattern name='Condition with answer' pattern='${type}(${field} == "${value}", answer == true);' />
    </condition>
    <action project='' value='deployment.publicCloud.aws._::_Deployment_::_Which AWS Services?_::_6509_::_true_::_true_::_' name='Insert Question Group' type='drools-without-variable-type'>
      <pattern name='Action of insert question group' pattern='QuestionGroup group = new QuestionGroup("${value-1}","${value-2}","${value-3}", ${value-4}, "${value-7}"); group.setFlags(${value-5}, ${value-6}); insertLogical(group);' />
    </action>
    <content />
  </rule>
<rule name='Set Answer: Amazon Environment --&gt; Public Cloud' module='component' generatedByGui='true'>
    <condition name='Is specific component definition' type='drools-without-variable-type' field='id' value='amazon-web-services-environment'>
      <pattern name='Is specific component definition' pattern='ComponentDefinitionProperties(ref == "${value}");' />
    </condition>
    <action project='' value='Public Cloud_::_true_::_true' name='Answer Question' type='drools-without-variable-type'>
      <pattern name='Action of answer question' pattern='$questionToAnswer : Question(id == "${value-1}", answer != ${value-2}); eval(!${value-3} || !$questionToAnswer.isManuallyModified());_:::_modify($questionToAnswer) { setAnswer(${value-2}), setCanBeManuallyModified(${value-3}) };' />
    </action>
    <content />
  </rule>
<rule name='Q: Deployed - Public Cloud &amp; AWS &amp; Service - *' module='component' generatedByGui='true'>
    <condition name='Question Group exists' type='drools-without-variable-type' field='id' value='deployment.publicCloud.aws.'>
      <pattern name='Question group exists' pattern='$group : QuestionGroup(id == "${value}") @Watch(!*);' />
    </condition>
    <condition name='Risk pattern exists' type='drools-without-variable-type' field='id' value='CS-Default_::_GENERIC-SERVICE'>
      <pattern name='Risk pattern exists' pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");' />
    </condition>
    <action project='' value='aws.ec2_::_Elastic Compute Cloud - EC2_::_' name='Insert Question' type='drools-without-variable-type'>
      <pattern name='Action of insert question' pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));' />
    </action>
    <content />
  </rule>
<rule name='Set Answer: Set Public Cloud when AWS SNS is selected' module='component' generatedByGui='true'>
    <condition name='Is specific component definition' type='drools-without-variable-type' field='id' value='sns'>
      <pattern name='Is specific component definition' pattern='ComponentDefinitionProperties(ref == "${value}");' />
    </condition>
    <action project='' value='Public Cloud_::_true_::_true' name='Answer Question' type='drools-without-variable-type'>
      <pattern name='Action of answer question' pattern='$questionToAnswer : Question(id == "${value-1}", answer != ${value-2}); eval(!${value-3} || !$questionToAnswer.isManuallyModified());_:::_modify($questionToAnswer) { setAnswer(${value-2}), setCanBeManuallyModified(${value-3}) };' />
    </action>
    <content />
  </rule>
<rule name='Q: Deployed - Public Cloud - Add AWS' module='component' generatedByGui='true'>
    <condition name='Question Group exists' type='drools-without-variable-type' field='id' value='publicCloud'>
      <pattern name='Question group exists' pattern='$group : QuestionGroup(id == "${value}") @Watch(!*);' />
    </condition>
    <condition name='Question is answered' type='Question' field='id' value='Public Cloud'>
      <pattern name='Condition with answer' pattern='${type}(${field} == "${value}", answer == true);' />
    </condition>
    <action project='' value='aws_::_Amazon Web Services_::_' name='Insert Question' type='drools-without-variable-type'>
      <pattern name='Action of insert question' pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));' />
    </action>
    <content />
  </rule>
<rule name='Risk Pattern: AWS - RDS' module='component' generatedByGui='true'>
    <condition name='Question is answered' type='Question' field='id' value='aws.rds'>
      <pattern name='Condition with answer' pattern='${type}(${field} == "${value}", answer == true);' />
    </condition>
    <action project='Hydras-AWS-Foundation' value='Hydras-AWS-Foundation_::_HYDRAS-AWS-RDS' name='Import Risk Pattern' type='drools-without-variable-type'>
      <pattern name='Action of import a risk pattern' pattern='insertLogical(ImportRiskPatternFactory.importRiskPattern("${value-1}", "${value-2}", 50));' />
    </action>
    <content />
  </rule>
<rule name='Risk Pattern: AWS - S3' module='component' generatedByGui='true'>
    <condition name='Question is answered' type='Question' field='id' value='aws.s3'>
      <pattern name='Condition with answer' pattern='${type}(${field} == "${value}", answer == true);' />
    </condition>
    <action project='Hydras-AWS-Foundation' value='Hydras-AWS-Foundation_::_HYDRAS-AWS-S3' name='Import Risk Pattern' type='drools-without-variable-type'>
      <pattern name='Action of import a risk pattern' pattern='insertLogical(ImportRiskPatternFactory.importRiskPattern("${value-1}", "${value-2}", 50));' />
    </action>
    <content />
  </rule>
<rule name='Q: Deployed - Public Cloud &amp; AWS &amp; Datastore SQL - *' module='component' generatedByGui='true'>
    <condition name='Question Group exists' type='drools-without-variable-type' field='id' value='deployment.publicCloud.aws.'>
      <pattern name='Question group exists' pattern='$group : QuestionGroup(id == "${value}") @Watch(!*);' />
    </condition>
    <condition name='Risk pattern exists' type='drools-without-variable-type' field='id' value='CS-Default_::_DATABASE-SQL'>
      <pattern name='Risk pattern exists' pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");' />
    </condition>
    <action project='' value='aws.rds_::_Relational Database Service - RDS_::_' name='Insert Question' type='drools-without-variable-type'>
      <pattern name='Action of insert question' pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));' />
    </action>
    <content />
  </rule>
<rule name='Q: Deployed - Public Cloud &amp; AWS &amp; Web UI - *' module='component' generatedByGui='true'>
    <condition name='Question is answered' type='Question' field='id' value='aws'>
      <pattern name='Condition with answer' pattern='${type}(${field} == "${value}", answer == true);' />
    </condition>
    <condition name='Risk pattern exists' type='drools-without-variable-type' field='id' value='CS-Default_::_BROWSER'>
      <pattern name='Risk pattern exists' pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");' />
    </condition>
    <action project='' value='deployment.publicCloud.aws._::_Deployment_::_Which AWS Services?_::_6509_::_true_::_true_::_' name='Insert Question Group' type='drools-without-variable-type'>
      <pattern name='Action of insert question group' pattern='QuestionGroup group = new QuestionGroup("${value-1}","${value-2}","${value-3}", ${value-4}, "${value-7}"); group.setFlags(${value-5}, ${value-6}); insertLogical(group);' />
    </action>
    <content />
  </rule>
<rule name='Q: Deployed - Public Cloud &amp; AWS &amp; Load Balancer - *' module='component' generatedByGui='true'>
    <condition name='Is specific component definition' type='drools-without-variable-type' field='id' value='load-balancer'>
      <pattern name='Is specific component definition' pattern='ComponentDefinitionProperties(ref == "${value}");' />
    </condition>
    <condition name='Question Group exists' type='drools-without-variable-type' field='id' value='deployment.publicCloud.aws.'>
      <pattern name='Question group exists' pattern='$group : QuestionGroup(id == "${value}") @Watch(!*);' />
    </condition>
    <action project='' value='aws.ec2_::_Elastic Compute Cloud - EC2_::_' name='Insert Question' type='drools-without-variable-type'>
      <pattern name='Action of insert question' pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));' />
    </action>
    <action project='' value='aws.elb_::_Elastic Load Balancing - ELB_::_' name='Insert Question' type='drools-without-variable-type'>
      <pattern name='Action of insert question' pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));' />
    </action>
    <content />
  </rule>
<rule name='Set Answer: Set Public Cloud when AWS RDS is selected' module='component' generatedByGui='true'>
    <condition name='Is specific component definition' type='drools-without-variable-type' field='id' value='rds'>
      <pattern name='Is specific component definition' pattern='ComponentDefinitionProperties(ref == "${value}");' />
    </condition>
    <action project='' value='Public Cloud_::_true_::_true' name='Answer Question' type='drools-without-variable-type'>
      <pattern name='Action of answer question' pattern='$questionToAnswer : Question(id == "${value-1}", answer != ${value-2}); eval(!${value-3} || !$questionToAnswer.isManuallyModified());_:::_modify($questionToAnswer) { setAnswer(${value-2}), setCanBeManuallyModified(${value-3}) };' />
    </action>
    <content />
  </rule>
<rule name='Q: Deployed - Public Cloud &amp; AWS &amp; Web UI' module='component' generatedByGui='true'>
    <condition name='Question is answered' type='Question' field='id' value='aws'>
      <pattern name='Condition with answer' pattern='${type}(${field} == "${value}", answer == true);' />
    </condition>
    <condition name='Risk pattern exists' type='drools-without-variable-type' field='id' value='CS-Default_::_BROWSER'>
      <pattern name='Risk pattern exists' pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");' />
    </condition>
    <action project='' value='deployment.publicCloud.aws._::_Deployment_::_Which AWS Services?_::_6509_::_true_::_true_::_' name='Insert Question Group' type='drools-without-variable-type'>
      <pattern name='Action of insert question group' pattern='QuestionGroup group = new QuestionGroup("${value-1}","${value-2}","${value-3}", ${value-4}, "${value-7}"); group.setFlags(${value-5}, ${value-6}); insertLogical(group);' />
    </action>
    <content />
  </rule>
<rule name='Set Answer: Set Public Cloud when AWS ELB is selected' module='component' generatedByGui='true'>
    <condition name='Is specific component definition' type='drools-without-variable-type' field='id' value='load-balancer'>
      <pattern name='Is specific component definition' pattern='ComponentDefinitionProperties(ref == "${value}");' />
    </condition>
    <action project='' value='Public Cloud_::_true_::_true' name='Answer Question' type='drools-without-variable-type'>
      <pattern name='Action of answer question' pattern='$questionToAnswer : Question(id == "${value-1}", answer != ${value-2}); eval(!${value-3} || !$questionToAnswer.isManuallyModified());_:::_modify($questionToAnswer) { setAnswer(${value-2}), setCanBeManuallyModified(${value-3}) };' />
    </action>
    <content />
  </rule>

</rules>

</project>