<?xml version="1.0" encoding="UTF-8"?>
<!--Copyright (c) 2012-2019 Continuum Security.  All rights reserved.The content of this library is the property of Continuum Security SL and may only be used in whole or in part with a valid license for IriusRisk.-->
<project ref='Microsoft-Azure' name='Microsoft-Azure' revision='26' type='LIBRARY' status='OPEN' enabled='true' priority='0' tags=''>
  <desc></desc>
  <categoryComponents>
    <categoryComponent ref='microsoft-azure' name='Microsoft Azure' />
  </categoryComponents>
  <componentDefinitions>
    <componentDefinition ref='microsoft-azure-environment' name='Microsoft Azure Environment' desc='Microsoft Azure. Only select this if the security of the Microsoft Azure environment will be managed in this product.' categoryRef='microsoft-azure'>
      <riskPatterns>
        <riskPattern ref='AZURE-IDENTITY-AND-ACCESS' />
        <riskPattern ref='AZURE-NETWORKING-VNETS' />
        <riskPattern ref='AZURE-MONITORING' />
        <riskPattern ref='AZURE-LOGS' />
      </riskPatterns>
    </componentDefinition>
    <componentDefinition ref='azure-virtual-machines' name='Microsoft Azure Virtual Machines' desc='' categoryRef='microsoft-azure'>
      <riskPatterns>
        <riskPattern ref='AZURE-VIRTUAL-MACHINES' />
      </riskPatterns>
    </componentDefinition>
    <componentDefinition ref='azure-storage' name='Microsoft Azure Storage' desc='' categoryRef='microsoft-azure'>
      <riskPatterns>
        <riskPattern ref='AZURE-STORAGE' />
      </riskPatterns>
    </componentDefinition>
    <componentDefinition ref='azure-sql' name='Microsoft Azure SQL' desc='' categoryRef='microsoft-azure'>
      <riskPatterns>
        <riskPattern ref='AZURE-SQL' />
      </riskPatterns>
    </componentDefinition>
  </componentDefinitions>
  <supportedStandards />
  <udts />
  <components>
<component ref='AZURE-NETWORKING-VNETS' name='Azure Networking VNets' desc='' groupName='' tags='' position='3' library='' diagramPositionX='0' diagramPositionY='0' componentDefinitionRef=''>
      <weaknesses>
<weakness ref='AZURE-VNET01' name='Networks for Azure resources are not properly segmentated.' state='0' impact='100'>
          <desc>&lt;div&gt;
                        Resources in the same VNet are compromised because when one of them is attacked and the
                        attackers gain access, they also gain access to all resources.
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            Identify the resources and the Microsoft Azure instances.
                            &lt;/div&gt;
                            &lt;div&gt;
                            Check that the resources are in the correct VNet.
                            &lt;/div&gt;
                            &lt;div&gt;
                            Check that the Microsoft Azure instances&amp;nbsp;are into different VNets.
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-10T09:26:52.732'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness>
</weaknesses>
<controls>
<control ref='AZ-N08' name='Isolate Azure resources into separate VNets by function' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Place the resources into separate VNets according to their use (production, development, test).
                        Placing such resources accordingly ensures that a resource of a higher security level is not
                        exposed by the security settings of a lower labeled VNet.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Identify the resources that exist in an incorrect VNet.&lt;/li&gt;
                        &lt;li&gt;Migrate or move it to the correct Vnet.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Azure Virtual Network' url='https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-overview' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Identify the resources that exist in an incorrect VNet.&lt;/li&gt;
                            &lt;li&gt;Check that the resources are into the correct Vnet.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-10T09:27:57.171'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-N09' name='Isolate Azure instances into different VNets' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Specify a VNet for the Azure instance as a launch parameter. Applications that run on the Cloud
                        instance can use the VNet security configuration when they access Azure resources.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        You can configure an Azure cloud service from Solution Explorer in Visual Studio.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;div&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Create a virtual network with multiple subnets' url='https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-create-vnet-arm-pportal' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>Check that the Azure instances are into different VNets.</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-10T09:30:39.292'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control>
</controls>
<usecases>
<usecase ref='NETWORKING' name='Networking' desc='' library=''>
          <threats>
<threat ref='UNAUTHORIZED-CONNECTION' name='Attackers gain unauthorized connection to the resources' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;div&gt;
                                Attackers could gain unauthorized connection to the resources through misconfigured
                                ports or security network configurations.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality='50' integrity='50' availability='50' easeOfExploitation='50' />
              <references />
              <weaknesses>
                <weakness ref='AZURE-VNET01'>
                  <controls>
                    <control ref='AZ-N08' mitigation='50' />
                    <control ref='AZ-N09' mitigation='50' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='AZ-N08' mitigation='50' />
                <control ref='AZ-N09' mitigation='50' />
              </controls>
            </threat>
</threats>
</usecase>
</usecases>
</component>
<component ref='AZURE-IDENTITY-AND-ACCESS' name='Azure Identity &amp; Access' desc='' groupName='' tags='' position='1' library='' diagramPositionX='0' diagramPositionY='0' componentDefinitionRef=''>
      <weaknesses>
<weakness ref='LOST-ACCESS-ROOT-01' name='The Root Account is mis-configured' state='0' impact='100'>
          <desc>The administrator account is not configured. The security question to recover or reset the
                        password and the authentication method are not configured.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps />
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-09-13T08:49:31.106'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AZ-W04' name='Misconfigured Authentication Method for Administrator Accounts' state='0' impact='100'>
          <desc>The authentication method &amp;quot;Multi-factor Authentication&amp;quot; for the
                        Administrator accounts are not configured
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Multi-Factor Authentication&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check all Administrator accounts have got the MFA flag enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-09-13T08:57:34.981'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AZURE-IDENTITY-03' name='Misconfigured User Account' state='0' impact='100'>
          <desc>&lt;div&gt;
                        Key security settings such as resetting the password and other password controls are not
                        configured.
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log in to the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each user has got an assigned account.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Password reset&amp;quot; &amp;gt; &amp;quot;Authentication Method&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that the security confirmation measures and the security criteria are well
                            filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-10T07:55:18.508'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AZURE-EXPIRATION-DATE' name='Misconfigured password expiration' state='0' impact='100'>
          <desc>The password expiration is not configured and users are not obliged to change their passwords.
                        Not change frequently the passwords gives facilities to attackers to obtain them.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            Check that the password expiration has got the correct values. Therefore, we can obtain the
                            values using the Get-MsolPasswordPolicy cmdlet from the Azure Active Directory Module for
                            Windows PowerShell. With the following command:
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;br /&gt;
                            &lt;/div&gt;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            PS C:\&amp;gt; Get-MsolPasswordPolicy -DomainName contoso.com
                            &lt;/div&gt;
                            &lt;/blockquote&gt;
                            &lt;div&gt;
                            &lt;br /&gt;
                            &lt;/div&gt;
                            &lt;div&gt;
                            More information: Doc MS Azure
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-09-13T09:19:48.459'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AZURE-ACCESS-01' name='Misconfigured credentials for groups and roles' state='0' impact='100'>
          <desc>&lt;div&gt;
                        The credentials for the groups and roles are not correctly configured and there are user
                        accounts with more privileges than the necessary.
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each user has got assigned the correct groups.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each group has got assigned the correct roles to achieve principle of
                            least privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the roles for the Cloud Service are well assigned.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;div&gt;
                            &lt;/div&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-10T08:20:28.020'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='LOST-SECURITY-ALERTS' name='Misconfigured Security contact details' state='0' impact='100'>
          <desc>The security contact details for the Azure subscription are not properly configured.</desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Access &amp;quot;Azure Security Center&amp;quot;.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;In the &amp;quot;Recommendations&amp;quot; tab choose &amp;quot;Provide security
                            contact details&amp;quot;.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Check that all fields are filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2019-04-24T15:56:01.547'>
              <output />
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AZURE-MON02' name='Excessive use of administrator accounts' state='0' impact='100'>
          <desc>The administrator accounts are used for all actions, not only for administrative actions.&amp;nbsp;</desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each user has got a user account assigned.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-09-13T09:07:28.144'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness>
</weaknesses>
<controls>
<control ref='AZ-A08' name='Configure a strong security challenge questions for the user account.' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        &lt;div&gt;
                        &lt;div&gt;
                        Activate and configure the security challenge question and the possibility of resetting the
                        password by confirming the user's identity is allowed. Make sure that the security confirmation
                        measures match the security criteria. Otherwise, it could make a weak confirmation and allow the&amp;nbsp;password
                        reset to malicious users.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation: &amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log in to the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                        &lt;li&gt;Select &amp;quot;Password reset&amp;quot; &amp;gt; &amp;quot;Authentication Method&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Choose the security confirmation measures that match the security criteria and click
                        &amp;quot;Save&amp;quot;.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;ol&gt;
                        &lt;/ol&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Azure AD self-service password reset' url='https://docs.microsoft.com/en-us/azure/active-directory/active-directory-passwords-getting-started' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log in to the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Password reset&amp;quot; &amp;gt; &amp;quot;Authentication Method&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that the security confirmation measures and the security criteria are well
                            filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-10T13:30:33.210'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-A09' name='Apply RBAC with pre-defined policies added into groups or roles' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Define and create groups that relate to job functions (administrators, developers, accounting,
                        etc.) and assign the relevant permissions for each group, and then assign IAM users to those
                        groups.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &amp;nbsp;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        All the users in an IAM group inherit the permissions assigned to the group. That way, you can
                        make changes for everyone in a group in just one place. As people move around in your company,
                        you can simply change what IAM group their IAM user belongs to. This method is known as Role
                        Based Access Control (RBAC).&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Remove a user from a group:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;ol&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                        &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Click on the user name. All the groups the user belongs are there.&lt;/li&gt;
                        &lt;li&gt;Choose the group and &amp;quot;Remove&amp;quot;.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/ol&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Create a group and add user:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;ol&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                        &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All groups&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Click &amp;quot;New Group&amp;quot; and fill the information.&lt;/li&gt;
                        &lt;li&gt;Search and add the user.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Create a group and add members in Azure Active Directory' url='https://docs.microsoft.com/en-us/azure/active-directory/active-directory-groups-create-azure-portal' />
            <reference name='MS Azure - Use Role-Based Access Control to manage access to your Azure subscription resources' url='https://docs.microsoft.com/en-us/azure/active-directory/role-based-access-control-configure' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each user has got assigned the correct groups.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each group has got assigned the correct roles.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-10T08:23:01.996'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-A07' name='Recertify user access' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Do regular reviews of accounts on the system and verify that it doesn't exist stoled or fake
                        accounts. With this process is ensured that there are not compromised accounts by former
                        employees or by attackers.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        At least every 90 days complete the following:&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log in to the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                        &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;For any user that should not exist:&lt;/li&gt;
                        &lt;li&gt;Select the user.&lt;/li&gt;
                        &lt;li&gt;Click &amp;quot;Delete&amp;quot;.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Assign a user or group to an enterprise app in Azure Active Directory' url='https://docs.microsoft.com/en-us/azure/active-directory/active-directory-coreapps-assign-user-azure-portal' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log in to the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each user has got an assigned account.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-10T13:29:14.343'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-A10' name='Create mechanisms to ensure the principle of least privilege is applied' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Create the mechanisms to review periodically the group and user permissions to ensure the least
                        privilege for the user accounts. Granting least privilege ensures that users only have the
                        permissions required to complete their jobs rather than additional privileges that are not
                        required.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        Following this model ensures that, should an account be compromised, the blast radius of damage
                        is limited&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Allocate privileges via groups or roles via the recommendation in &amp;quot;Use RBAC
                        with pre-defined policies added into groups or roles&amp;quot;.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Create a group and add members in Azure Active Directory' url='https://docs.microsoft.com/en-us/azure/active-directory/active-directory-groups-create-azure-portal' />
            <reference name='MS Azure - Use Role-Based Access Control to manage access to your Azure subscription resources' url='https://docs.microsoft.com/en-us/azure/active-directory/role-based-access-control-configure' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>Check that the principle of least privilege is achieved in the assignation of roles and
                            groups to the users.
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-10T08:23:55.572'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-A04' name='Enable MFA for Administrator &amp; Co Administrator accounts' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  Enable multi-factor authentication (MFA) device enhances the security of the login process for the Administrator accounts. With MFA, users have a device that generates a unique authentication code (a one-time password, or OTP) and users must provide both their normal credentials (like their username and password) and the OTP. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The MFA device can either be a special piece of hardware, or it can be a virtual device. The recommendation for the Service Administrator &amp;amp; Co Administrator accounts is to use MFA to increase the level of security of the login process. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt; 
  &lt;li&gt;Select Azure Active Directory.&lt;/li&gt; 
  &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt; 
  &lt;li&gt;Select &amp;quot;Multi-Factor Authentication&amp;quot;.&lt;/li&gt; 
  &lt;li&gt;Choose all the Service Administrator &amp;amp; Co Administrator accounts and enable MFA.&amp;nbsp;&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div&gt; 
 &lt;/div&gt; 
&lt;/div&gt;</desc>
          <implementations />
          <references>
            <reference name='MS Azure - How to require two-step verification for a user or group' url='https://docs.microsoft.com/en-us/azure/multi-factor-authentication/multi-factor-authentication-get-started-user-states' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Multi-Factor Authentication&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check all Administrator accounts have got the MFA flag enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-10T13:26:09.437'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-A11' name='Configure roles for the Cloud Service' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Define and create the roles for the Azure Cloud Service. For each role, define the permissions
                        and also configure how that role runs. When you launch an Azure instance, you shall specify a
                        role for the instance as a launch parameter. Applications that run on the Cloud instance use the
                        role's credentials when they access Azure resources. This role's permissions determine what the
                        application is allowed to do.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Configure an Azure cloud service from Solution Explorer in Visual Studio.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Use Role-Based Access Control to manage access to your Azure subscription resources' url='https://docs.microsoft.com/en-us/azure/active-directory/role-based-access-control-configure' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>Check that the roles for the Cloud Service are well assigned.</steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-10T08:26:33.585'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-A02' name='Configure the security challenge questions for the administrator account' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  Activate and configure the security challenge question and the possibility of resetting the password by confirming the user's identity is allowed. In case of being an owner account of the subscription that has full administration access, it is necessary to do this, as a security measure that this password is lost. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The security confirmation measures will depend on those specified by the Active Directory administrator. Make sure that the security confirmation measures match the security criteria. Otherwise, it could make a weak confirmation and allow the password reset to malicious users. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Using the console:&amp;nbsp;&lt;/li&gt; 
 &lt;/ul&gt; 
 &lt;ol&gt; 
  &lt;ol&gt; 
   &lt;li&gt;Open https://aka.ms/ssprsetup and Log into the account.&lt;/li&gt; 
   &lt;li&gt;Respond to security measures.&amp;nbsp;&lt;/li&gt; 
   &lt;li&gt;Once all needed controls are finished, click on accept.&lt;/li&gt; 
  &lt;/ol&gt; 
 &lt;/ol&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Using the portal:&lt;/li&gt; 
  &lt;ol&gt; 
   &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt; 
   &lt;li&gt;Select Azure Active Directory.&lt;/li&gt; 
   &lt;li&gt;Select &amp;quot;Password reset&amp;quot; &amp;gt; &amp;quot;Authentication Method&amp;quot;.&lt;/li&gt; 
   &lt;li&gt;Choose the security confirmation measures that match the security criteria and click &amp;quot;Save&amp;quot;.&lt;/li&gt; 
  &lt;/ol&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt;</desc>
          <implementations />
          <references>
            <reference name='MS Azure - Azure AD self-service password reset' url='https://docs.microsoft.com/en-us/azure/active-directory/active-directory-passwords-getting-started' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>Using the portal:
                            &lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Password reset&amp;quot; &amp;gt; &amp;quot;Authentication Method&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that the security confirmation measures and the security criteria are filled
                            and enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-10T07:35:06.480'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-A01' name='Register a Security contact for your Azure account' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  Provide the security contact details for the Azure subscription. Microsoft Security Response Center (MSRC) performs security monitoring of the Azure network and infrastructure and receives threat intelligence and abuse complaints from third parties. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Microsoft will use this information provided to contact if the MSRC discovers that customer data has been accessed by an unlawful or unauthorized party. Also, this provides the means of ensuring these advisories are routed to the security team, especially if a distribution email address is used.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Access &amp;quot;Azure Security Center&amp;quot;.&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;In the &amp;quot;Recommendations&amp;quot; tab choose &amp;quot;Provide security contact details&amp;quot;.&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;Once filled, save changes.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt;</desc>
          <implementations />
          <references>
            <reference name='MS Azure - Provide security contact details in Azure Security Center' url='https://docs.microsoft.com/en-us/azure/security-center/security-center-provide-security-contact-details' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Access &amp;quot;Azure Security Center&amp;quot;.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;In the &amp;quot;Recommendations&amp;quot; tab choose &amp;quot;Provide security
                            contact details&amp;quot;.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Check that all fields are filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-10T07:38:50.596'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-A12' name='Configure password expiration' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        &lt;div&gt;
                        Configure the password expiration to force after a determinate time, the password code shall be
                        changed for the users.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Configure password management to match security criteria. This value is configurable
                        using the Set-MsolPasswordPolicy cmdlet from the Azure Active Directory Module for Windows
                        PowerShell. With the following command as the example:&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div&gt;
                        Set-MsolPasswordPolicy -ValidityPeriod 60 -NotificationDays 14&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;This command updates the tenant so that all users passwords expire after 60
                        days. The users receive notification 14 days prior to that expiry.
                        &lt;/blockquote&gt;
                        &lt;div&gt;
                        &lt;div&gt;
                        More information:&amp;nbsp;
                        &lt;a
                        href="https://docs.microsoft.com/en-us/powershell/module/msonline/set-msolpasswordpolicy?view=azureadps-1.0"&gt;Doc
                        MS Azure&lt;/a&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;ul&gt;
                        &lt;/ul&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Password policies and restrictions in Azure Active Directory' url='https://docs.microsoft.com/en-us/azure/active-directory/active-directory-passwords-policy' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            Check that the password expiration has got the correct values. Therefore, we can obtain the
                            values using the Get-MsolPasswordPolicy cmdlet from the Azure Active Directory Module for
                            Windows PowerShell. With the following command:
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;br /&gt;
                            &lt;/div&gt;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            PS C:\&amp;gt; Get-MsolPasswordPolicy -DomainName contoso.com
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;br /&gt;
                            &lt;/div&gt;
                            &lt;/blockquote&gt;More information:
                            &lt;a
                            href="https://docs.microsoft.com/en-us/powershell/module/msonline/get-msolpasswordpolicy?view=azureadps-1.0"&gt;Doc
                            MS Azure&lt;/a&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-10T08:27:37.696'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-A03' name='Create Individual Accounts for the administrator users' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
  Create an individual account for the administrator users and with this new accounts By creating individual Azure users for people accessing your account, you can give each Azure user a unique set of security credentials.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The administrator accounts shall be used for the administrative actions and for giving or revoke credentials to the user's account. The administrator account shall be not used as a normal user account. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt; 
  &lt;li&gt;Select Azure Active Directory.&lt;/li&gt; 
  &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt; 
  &lt;li&gt;Select &amp;quot;Add New User&amp;quot;.&lt;/li&gt; 
  &lt;li&gt;Fill the required information and click &amp;quot;Create&amp;quot;.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt; 
&lt;div&gt; 
&lt;/div&gt;</desc>
          <implementations />
          <references>
            <reference name='MS Azure - Add new users to Azure Active Directory' url='https://docs.microsoft.com/en-us/azure/active-directory/add-users-azure-active-directory' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each user has got a user account assigned.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-10T13:23:15.049'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control>
</controls>
<usecases>
<usecase ref='AUTHORIZATION' name='Authorization' desc='' library=''>
          <threats>
<threat ref='LOSS-CONTROL_ENV' name='Attackers gain unauthorized access to the control of the environment' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;div&gt;
                                Attackers could gain unauthorized access to the control of the environment, due of the
                                user accounts or role groups are not well defined and configured. Therefore, attackers
                                can make changes without the root approval.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality='75' integrity='75' availability='75' easeOfExploitation='50' />
              <references />
              <weaknesses>
                <weakness ref='AZURE-ACCESS-01'>
                  <controls>
                    <control ref='AZ-A09' mitigation='20' />
                    <control ref='AZ-A10' mitigation='30' />
                    <control ref='AZ-A11' mitigation='30' />
                  </controls>
                </weakness>
                <weakness ref='AZURE-EXPIRATION-DATE'>
                  <controls>
                    <control ref='AZ-A12' mitigation='20' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='AZ-A09' mitigation='20' />
                <control ref='AZ-A10' mitigation='30' />
                <control ref='AZ-A11' mitigation='30' />
                <control ref='AZ-A12' mitigation='20' />
              </controls>
            </threat>
</threats>
</usecase>
<usecase ref='AUTHENTICATION' name='Authentication' desc='' library=''>
          <threats>
<threat ref='AZURE-LOST-ACCESS-USER' name='Attackers gain unauthorized access to the user account due to the lack of configuration of the account' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;div&gt;
                                Attackers could gain unauthorized access to the user account due to the lack of
                                configuration of the account, like the security question to reset the password was
                                configured incorrectly.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality='50' integrity='50' availability='50' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AZURE-IDENTITY-03'>
                  <controls>
                    <control ref='AZ-A07' mitigation='50' />
                    <control ref='AZ-A08' mitigation='50' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='AZ-A07' mitigation='50' />
                <control ref='AZ-A08' mitigation='50' />
              </controls>
            </threat><threat ref='AZURE-LOST-ACCESS-ROOT' name='Attackers gain unauthorized access to the root account due to the lack of configuration of the account' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;div&gt;
                                Attackers could gain unauthorized access to the administrator account due to the lack of
                                configuration of the account and its security mechanisms, like modifying credentials and
                                adding/removing user accounts.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality='100' integrity='100' availability='100' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AZURE-MON02'>
                  <controls>
                    <control ref='AZ-A03' mitigation='25' />
                  </controls>
                </weakness>
                <weakness ref='AZ-W04'>
                  <controls>
                    <control ref='AZ-A04' mitigation='25' />
                  </controls>
                </weakness>
                <weakness ref='LOST-SECURITY-ALERTS'>
                  <controls>
                    <control ref='AZ-A01' mitigation='25' />
                  </controls>
                </weakness>
                <weakness ref='LOST-ACCESS-ROOT-01'>
                  <controls>
                    <control ref='AZ-A02' mitigation='25' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='AZ-A01' mitigation='25' />
                <control ref='AZ-A02' mitigation='25' />
                <control ref='AZ-A03' mitigation='25' />
                <control ref='AZ-A04' mitigation='25' />
              </controls>
            </threat>
</threats>
</usecase>
</usecases>
</component>
<component ref='AZURE-SQL' name='Azure SQL' desc='' groupName='' tags='' position='5' library='' diagramPositionX='0' diagramPositionY='0' componentDefinitionRef=''>
      <weaknesses>
<weakness ref='AZURE-LOGS01' name='Undetected changes in the SQL database information and configuration' state='0' impact='100'>
          <desc>&lt;div&gt;
                        The changes in the SQL database information and configuration are not detected and audited, due
                        of the Azure mechanisms to notify the changes are disabled.
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Select SQL databases from the left-hand menu, and click your database on the SQL
                            databases page.&lt;/li&gt;
                            &lt;li&gt;In the Settings blade, select Auditing &amp;amp; Threat Detection.&lt;/li&gt;
                            &lt;li&gt;Check that the Database Threat Detection and the Database Auditing are enabled and
                            correctly configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-06-09T12:45:00.149'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AZURE-ACCESS-DATA-01' name='Sensitive data is accessible' state='0' impact='100'>
          <desc>Sensitive data is not encrypted and could be exposed.</desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Select SQL databases from the left-hand menu, and click your database on the SQL
                            databases page.&lt;/li&gt;
                            &lt;li&gt;Click on Transparent data encryption to open the configuration page for TDE.&lt;/li&gt;
                            &lt;li&gt;Check that the Data encryption is enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-06-09T12:42:48.531'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AZURE-NET-21' name='Unauthorised connection between the client and the SQL database' state='0' impact='100'>
          <desc>&lt;div&gt;
                        All connections to SQL Database are allowed and the firewall and other security networks methods
                        are not configured to deny the connections.
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log in to the Azure portal.&lt;/li&gt;
                            &lt;li&gt;Select SQL databases from the left-hand menu, and click your database on the SQL
                            databases page.&lt;/li&gt;
                            &lt;li&gt;On the Overview page for your database, click Show database connection strings.&lt;/li&gt;
                            &lt;li&gt;Check that the complete ADO.NET connection string is correctly configured.&lt;/li&gt;
                            &lt;li&gt;Click SQL databases from the left-hand menu and click the database you would like
                            to configure the firewall rule for on the SQL databases page.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Click Set server firewall on the toolbar as shown in the previous image.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Check that the firewall for the Database SQL is correctly configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-06-12T10:17:38.451'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness>
</weaknesses>
<controls>
<control ref='AZ-Q03' name='Enable Transparent Data Encryption (TDE) for the SQL database' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Enable the Azure SQL Database transparent data encryption (TDE) and encrypt automatically your
                        data at rest, without requiring any changes to the application accessing the encrypted database.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Select SQL databases from the left-hand menu, and click your database on the SQL
                        databases page.&lt;/li&gt;
                        &lt;li&gt;Click on Transparent data encryption to open the configuration page for TDE.&lt;/li&gt;
                        &lt;li&gt;Set Data encryption to ON and click Save.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Transparent Data Encryption for Azure SQL Database and Data Warehouse' url='https://docs.microsoft.com/en-us/sql/relational-databases/security/encryption/transparent-data-encryption-azure-sql' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Select SQL databases from the left-hand menu, and click your database on the SQL
                            databases page.&lt;/li&gt;
                            &lt;li&gt;Click on Transparent data encryption to open the configuration page for TDE.&lt;/li&gt;
                            &lt;li&gt;Check that the Data encryption is enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-29T17:12:58.221'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-Q05' name='Enable SQL Database threat detection' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Enable SQL Database Threat Detection to provide a new layer of security, which enables customers
                        to detect and respond to potential threats as they occur by providing security alerts on
                        anomalous activities. Users can explore the suspicious events using SQL Database Auditing to
                        determine if the results from an attempt to access, breach or exploit data in the database.
                        Threat Detection makes it simple to address potential threats to the database without the need
                        to be a security expert or manage advanced security monitoring systems. For example, Threat
                        Detection detects certain anomalous database activities indicating potential SQL injection
                        attempts. SQL injection is one of the common Web application security issues on the Internet,
                        used to attack data-driven applications. Attackers take advantage of application vulnerabilities
                        to inject malicious SQL statements into application entry fields, for breaching or modifying
                        data in the database.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Navigate to the configuration blade of the SQL database you want to monitor. In the
                        Settings blade, select Auditing &amp;amp; Threat Detection.&lt;/li&gt;
                        &lt;li&gt;In the Auditing &amp;amp; Threat Detection configuration blade turn ON auditing, which
                        will display the threat detection settings.&lt;/li&gt;
                        &lt;li&gt;Turn ON threat detection.&lt;/li&gt;
                        &lt;li&gt;Configure the list of emails that will receive security alerts upon detection of
                        anomalous database activities.&lt;/li&gt;
                        &lt;li&gt;Click Save in the Auditing &amp;amp; Threat detection blade to save the new or updated
                        auditing and threat detection policy.&lt;/li&gt;
                        &lt;li&gt;In the email, click on the Azure SQL Auditing Log link, which will launch the Azure
                        portal and show the relevant auditing records around the time of the suspicious event.&lt;/li&gt;
                        &lt;li&gt;Click on the audit records to view more details on the suspicious database activities
                        such as SQL statement, failure reason, and client IP.&lt;/li&gt;
                        &lt;li&gt;In the Auditing Records blade, click Open in Excel to open a pre-configured excel
                        template to import and run a deeper analysis of the audit log around the time of the suspicious
                        event.&lt;/li&gt;
                        &lt;li&gt;To configure the Fast Combine setting - In the POWER QUERY ribbon tab, select Options
                        to display the Options dialog. Select the Privacy section and choose the second option - 'Ignore
                        the Privacy Levels and potentially improve performance'.&lt;/li&gt;
                        &lt;li&gt;To load SQL audit logs, ensure that the parameters in the settings tab are set
                        correctly and then select the 'Data' ribbon and click the 'Refresh All' button.&lt;/li&gt;
                        &lt;li&gt;The results appear in the SQL Audit Logs sheet which enables you to run a deeper
                        analysis of the anomalous activities that were detected, and mitigate the impact of the security
                        event in your application.&amp;quot;&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - SQL Database Threat Detection' url='https://docs.microsoft.com/en-us/azure/sql-database/sql-database-threat-detection' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Select SQL databases from the left-hand menu, and click your database on the SQL
                            databases page.&lt;/li&gt;
                            &lt;li&gt;In the Settings blade, select Auditing &amp;amp; Threat Detection.&lt;/li&gt;
                            &lt;li&gt;Check that the Database Threat Detection is enabled and correct configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-06-12T10:16:31.412'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-Q02' name='Encrypt the communication channel to your database' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Configure and encrypt the string connection between the client and SQL Database with the
                        following configuration:&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;li&gt;request an encrypted connection&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;to not trust the server certificate&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        This established connection usesTransport Layer Security (TLS) and reduces the risk of
                        man-in-the-middle attacks. Obtain the correctly configured connection strings for your SQL
                        Database for supported client drivers from the Azure portal as shown for ADO.net in this
                        screenshot.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Select SQL databases from the left-hand menu, and click your database on the SQL
                        databases page.&lt;/li&gt;
                        &lt;li&gt;On the Overview page for your database, click Show database connection strings.&lt;/li&gt;
                        &lt;li&gt;Review the complete ADO.NET connection string.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Securing your SQL Database' url='https://docs.microsoft.com/en-us/azure/sql-database/sql-database-security-overview' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Select SQL databases from the left-hand menu, and click your database on the SQL
                            databases page.&lt;/li&gt;
                            &lt;li&gt;On the Overview page for your database, click Show database connection strings.&lt;/li&gt;
                            &lt;li&gt;Check that the complete ADO.NET connection string is correctly configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-06-12T10:19:03.406'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-Q01' name='Restrict network access to the database' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Set up the firewall rules for the SQL databases in Azure. By default, all connections to the
                        server and the databases inside the server are rejected except for connections from other Azure
                        services. Set the secure configuration 'Allow access to Azure services' to OFF. To connect to
                        the database from an Azure VM or cloud service, create a Reserved IP and allow only the reserved
                        IP address access through the firewall.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;&lt;br /&gt;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log in to the Azure portal.&lt;/li&gt;
                        &lt;li&gt;Click SQL databases from the left-hand menu and click the database you would like to
                        configure the firewall rule for on the SQL databases page. The overview page for your database
                        opens, showing you the fully qualified server name (such as
                        mynewserver-20170313.database.windows.net) and provides options for further configuration.&lt;/li&gt;
                        &lt;li&gt;Click Set server firewall on the toolbar as shown in the previous image. The Firewall
                        settings page for the SQL Database server opens.&lt;/li&gt;
                        &lt;li&gt;Click Add client IP on the toolbar to add the public IP address of the computer
                        connected to the portal with or enter the firewall rule manually and then click Save.&lt;/li&gt;
                        &lt;li&gt;Click OK and then click the X to close the Firewall settings page.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Azure SQL Database server-level and database-level firewall rules' url='https://docs.microsoft.com/en-us/azure/sql-database/sql-database-firewall-configure' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log in to the Azure portal.&lt;/li&gt;
                            &lt;li&gt;Click SQL databases from the left-hand menu and click the database you would like
                            to configure the firewall rule for on the SQL databases page. The overview page for your
                            database opens, showing you the fully qualified server name (such as
                            mynewserver-20170313.database.windows.net) and provides options for further configuration.&lt;/li&gt;
                            &lt;li&gt;Click Set server firewall on the toolbar as shown in the previous image.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Check that the firewall for the Database SQL is correctly configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-06-12T10:18:20.292'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-Q04' name='Enable SQL Database auditing' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Enable Azure SQL Database Auditing to audit the database events into the audit log in your Azure
                        Storage account. Auditing can help you maintain regulatory compliance, understand database
                        activity, and gain insight into discrepancies and anomalies that could indicate potential
                        security violations.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Select SQL databases from the left-hand menu, and click your database on the SQL
                        databases page.&lt;/li&gt;
                        &lt;li&gt;In the Settings blade, select Auditing &amp;amp; Threat Detection.&lt;/li&gt;
                        &lt;li&gt;In the database auditing configuration blade, you can check the Inherit settings from
                        server checkbox to designate that this database will be audited according to its server's
                        settings. If this option is checked, you will see a View server auditing settings link that
                        allows you to view or modify the server auditing settings from this context.&lt;/li&gt;
                        &lt;li&gt;If you prefer to enable an Audit type (or location?) different from the one specified
                        at the server level, uncheck the Inherit Auditing settings from server option, turn ON Auditing,
                        and choose the Blob Auditing Type.&lt;/li&gt;
                        &lt;li&gt;Select Storage Details to open the Audit Logs Storage Blade. Select the Azure storage
                        account where logs will be saved, and the retention period, after which the old logs will be
                        deleted, then click OK at the bottom. Tip: Use the same storage account for all audited
                        databases to get the most out of the auditing reports templates.&lt;/li&gt;
                        &lt;li&gt;If you want to customize the audited events, you can do this via PowerShell or REST
                        API - see the Automation (PowerShell / REST API) section for more details.&lt;/li&gt;
                        &lt;li&gt;Click Save.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Get started with SQL database auditing' url='https://docs.microsoft.com/en-us/azure/sql-database/sql-database-auditing' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Select SQL databases from the left-hand menu, and click your database on the SQL
                            databases page.&lt;/li&gt;
                            &lt;li&gt;In the Settings blade, select Auditing &amp;amp; Threat Detection.&lt;/li&gt;
                            &lt;li&gt;Check that the Database Auditing is enabled and correct configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;ol&gt;&lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-06-12T10:15:07.584'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control>
</controls>
<usecases>
<usecase ref='ACCESS DATA' name='Access Data' desc='' library=''>
          <threats>
<threat ref='ACCESS-TO-DATA' name='Sensitive data is compromised through unauthorized access to SQL databases' state='Expose' source='MANUAL' owner='' library=''>
              <desc>Attackers gain unauthorized connection to the SQL database resources through
                                misconfigured ports or security network configurations.
                            </desc>
              <riskRating confidentiality='75' integrity='25' availability='50' easeOfExploitation='50' />
              <references />
              <weaknesses>
                <weakness ref='AZURE-ACCESS-DATA-01'>
                  <controls>
                    <control ref='AZ-Q03' mitigation='100' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='AZ-Q03' mitigation='100' />
              </controls>
            </threat>
</threats>
</usecase>
<usecase ref='API LOGGING AND AUDITING' name='API Logging and Auditing' desc='' library=''>
          <threats>
<threat ref='UNAUDITABLE-CHANGES-AZURE' name='Attackers make undetected and unaudited changes to system configurations' state='Expose' source='MANUAL' owner='' library=''>
              <desc>If audit trails are not properly protected, an attacker could gain access to the
                                system, modify the status of resources or exfiltrate sensitive data without being
                                noticed.
                            </desc>
              <riskRating confidentiality='50' integrity='75' availability='25' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AZURE-LOGS01'>
                  <controls>
                    <control ref='AZ-Q04' mitigation='50' />
                    <control ref='AZ-Q05' mitigation='50' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='AZ-Q04' mitigation='50' />
                <control ref='AZ-Q05' mitigation='50' />
              </controls>
            </threat>
</threats>
</usecase>
<usecase ref='NETWORKING' name='Networking' desc='' library=''>
          <threats>
<threat ref='UNAUTHORIZED-CONNECTION' name='Sensitive data is compromised by unauthorized access to Virtual Machines' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;div&gt;
                                Attackers can gain unauthorized connection to the Virtual Machines through misconfigured
                                ports or security network configurations.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality='75' integrity='25' availability='50' easeOfExploitation='50' />
              <references />
              <weaknesses>
                <weakness ref='AZURE-NET-21'>
                  <controls>
                    <control ref='AZ-Q01' mitigation='50' />
                    <control ref='AZ-Q02' mitigation='50' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='AZ-Q01' mitigation='50' />
                <control ref='AZ-Q02' mitigation='50' />
              </controls>
            </threat>
</threats>
</usecase>
</usecases>
</component>
<component ref='AZURE-STORAGE' name='Azure Storage' desc='' groupName='' tags='' position='6' library='' diagramPositionX='0' diagramPositionY='0' componentDefinitionRef=''>
      <weaknesses>
<weakness ref='AZURE-LOGS01' name='Unaudited resources changes' state='0' impact='100'>
          <desc>&lt;div&gt;
                        The Diagnostic Logs are not activated and not configured. Changes in the applications and in the
                        data bases could not be detected and audited.
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Navigate to your storage account.&lt;/li&gt;
                            &lt;li&gt;Select Diagnostics on the Menu blade.&lt;/li&gt;
                            &lt;li&gt;Check that the Status is enabled.&lt;/li&gt;
                            &lt;li&gt;Select the metrics for the services you wish to monitor.&lt;/li&gt;
                            &lt;li&gt;Check that all fields are correctly configured and filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-06-09T12:50:28.965'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AZURE-ACCESS-DATA-01' name='Sensitive data are accessible' state='0' impact='100'>
          <desc>Sensitive data are not encrypted and the sensitive data is exposed.</desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal and select a storage account. On the Settings blade,
                            look for the Blob Service section as shown in this screenshot and click Encryption.&lt;/li&gt;
                            &lt;li&gt;After you click the Encryption setting, check that the Storage Service Encryption
                            is enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-06-12T10:06:30.788'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness>
</weaknesses>
<controls>
<control ref='AZ-S02' name='Enable Azure Storage metrics' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Enable Storage Metrics to configure the monitoring alerts via the Azure portal or Windows
                        PowerShell, or programmatically via one of the storage client libraries. Configure a retention
                        period for the metrics data: this period determines for how long the storage service keeps the
                        metrics and charges you for the space required to store them.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Navigate to your storage account.&lt;/li&gt;
                        &lt;li&gt;Select Diagnostics on the Menu blade.&lt;/li&gt;
                        &lt;li&gt;Ensure that Status is set to On.&lt;/li&gt;
                        &lt;li&gt;Select the metrics for the services you wish to monitor.&lt;/li&gt;
                        &lt;li&gt;Specify a retention policy to indicate how long to retain metrics and log data.&lt;/li&gt;
                        &lt;li&gt;Select Save.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Enabling Azure Storage metrics and viewing metrics data' url='https://docs.microsoft.com/en-us/azure/storage/common/storage-enable-and-view-metrics' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Navigate to your storage account.&lt;/li&gt;
                            &lt;li&gt;Select Diagnostics on the Menu blade.&lt;/li&gt;
                            &lt;li&gt;Check that the Status is enabled.&lt;/li&gt;
                            &lt;li&gt;Select the metrics for the services you wish to monitor.&lt;/li&gt;
                            &lt;li&gt;Check that all fields are correctly configured and filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-06-12T10:04:36.427'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-S01' name='Enable the Storage Service Encryption (SSE) for data at Rest' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Enable Azure Storage Service Encryption (SSE) for Data at Rest to protect and safeguard the
                        data. With this feature, Azure Storage automatically encrypts the data prior to persisting to
                        storage and decrypts prior to retrieval. The encryption, decryption, and key management are
                        totally transparent to users.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal and select a storage account. On the Settings blade, look
                        for the Blob Service section as shown in this screenshot and click Encryption.&lt;/li&gt;
                        &lt;li&gt;After you click the Encryption setting, you can enable or disable Storage Service
                        Encryption.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Azure Storage Service Encryption for Data at Rest' url='https://docs.microsoft.com/en-us/azure/storage/common/storage-service-encryption' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal and select a storage account. On the Settings blade,
                            look for the Blob Service section as shown in this screenshot and click Encryption.&lt;/li&gt;
                            &lt;li&gt;After you click the Encryption setting, check that the Storage Service Encryption
                            is enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-06-12T10:07:04.687'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control>
</controls>
<usecases>
<usecase ref='ACCESS DATA' name='Access Data' desc='' library=''>
          <threats>
<threat ref='ACCESS-TO-DATA' name='Sensitive data is compromised  thorough unauthorized access to data storage' state='Expose' source='MANUAL' owner='' library=''>
              <desc></desc>
              <riskRating confidentiality='75' integrity='25' availability='50' easeOfExploitation='50' />
              <references />
              <weaknesses>
                <weakness ref='AZURE-ACCESS-DATA-01'>
                  <controls>
                    <control ref='AZ-S01' mitigation='100' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='AZ-S01' mitigation='100' />
              </controls>
            </threat>
</threats>
</usecase>
<usecase ref='API LOGGING AND AUDITING' name='API Logging and Auditing' desc='' library=''>
          <threats>
<threat ref='UNAUDITABLE-CHANGES-AZURE' name='Attackers make undetected and unaudited changes to system configurations' state='Expose' source='MANUAL' owner='' library=''>
              <desc>If audit trails are not properly protected, an attacker could gain access to the
                                system, modify the status of resources or exfiltrate sensitive data without being
                                noticed.
                            </desc>
              <riskRating confidentiality='75' integrity='50' availability='75' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AZURE-LOGS01'>
                  <controls>
                    <control ref='AZ-S02' mitigation='100' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='AZ-S02' mitigation='100' />
              </controls>
            </threat>
</threats>
</usecase>
</usecases>
</component>
<component ref='AZURE-MONITORING' name='Azure Monitoring' desc='' groupName='' tags='' position='4' library='' diagramPositionX='0' diagramPositionY='0' componentDefinitionRef=''>
      <weaknesses>
<weakness ref='AZURE-MON01' name='Undetected changes in security configurations' state='0' impact='100'>
          <desc>&lt;div&gt;
                        Monitoring and alerting for security configurations are not configured and changes cannot be
                        detected.&amp;nbsp;
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to alert when the Activity Logs configuration
                            changes.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to alert when the security policy changes.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to alert when the recommended configuration changes.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when activity alerts changes.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:19:05.728'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AZURE-MON03' name='Lack of 2FA' state='0' impact='100'>
          <desc>Log into the console without using the Multi-factor Authentication (MFA) and they are not
                        detected. The connection without the MFA must be audited and monitored, the correct security
                        group must be informed and they must validate this connection.&amp;nbsp;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when someone tries to login into the
                            console without MFA.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:36:05.857'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AZURE-MON04' name='Undetected changes in security groups' state='0' impact='100'>
          <desc>The changes in security groups must be traced and monitored and the correspondent personnel
                        must approve these changes. If the situation is not the correct, attackers can access to
                        security systems.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when the security groups or security group
                            configurations change.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:37:22.342'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AZURE-MON06' name='Undetected brute force attempts on MS Azure management console' state='0' impact='100'>
          <desc>The failure connection attempts (brute force) must be audited and monitored and correspondent
                        personnel must be alerted and informed.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when several console login failure attempts
                            occur.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:40:48.165'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AZURE-MON07' name='Undetected changes in network configuration' state='0' impact='100'>
          <desc>&lt;div&gt;
                        Changes in network configurations (NACLs, route and gateway tables) are not detected because
                        monitoring and alerting on the network is not configured to detect these changes.
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when the VPC NACL changes.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when the VPC route table changes.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when the VPC gateway changes.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:42:51.476'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AZURE-MON05' name='Undetected changes in data encryption configuration' state='0' impact='100'>
          <desc>The changes on the database encryption must be audited and monitored. When there are changes
                        on the database encryption, the security group must be alerted.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to alert when the Transparent Data Encryption is
                            disabled.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:39:26.331'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AZURE-MON02' name='Excessive use of administrator accounts' state='0' impact='100'>
          <desc>The administrator accounts are used for all actions, not only for administrative actions. This
                        is because these users have not got a personal or a user account to do the daily actions.&amp;nbsp;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when there is a bad usage of the root
                            account.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:27:55.757'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness>
</weaknesses>
<controls>
<control ref='AZ-M09' name='Create alerts to detect changes on activity alerts' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the alert
                        modifications to the correspondent personnel. It's vital that these unauthorized changes are
                        detected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Add activity log alert&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Filling the fields with the corresponding values.&lt;/li&gt;
                        &lt;li&gt;Select in actions the personnel should be received this information.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Create activity log alerts' url='https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when activity alerts&amp;nbsp;changes.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:25:43.898'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-M12' name='Create alerts for changes in security groups and in security groups configurations' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the changes in
                        the security groups or in security groups configurations to the correspondent personnel. It's
                        vital that these unauthorized changes are detected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Add activity log alert&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Filling the fields with the corresponding values.&lt;/li&gt;
                        &lt;li&gt;Select in actions the personnel should be received this information.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Create activity log alerts' url='https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when the security groups or security group
                            configurations change.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:39:00.761'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-M11' name='Create alerts to notify about the console login without MFA' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Create alerts for Activity Log changes to monitor, audit and notify about the user's login into
                        the console without Multi-factor Authentication to the correspondent personnel. It's vital that
                        these unauthorized changes are detected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Add activity log alert&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Filling the fields with the corresponding values.&lt;/li&gt;
                        &lt;li&gt;Select in actions the personnel should be received this information.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Create activity log alerts' url='https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when someone tries to login into the
                            console without MFA.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:36:58.175'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-M06' name='Create alerts for VPC NACL changes' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the changes in
                        the Network Access Control Lists (NACLs) to the correspondent personnel. It's vital that these
                        unauthorized changes are detected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        The Network Access Control Lists (NACLs) control inbound and outbound access to &amp;amp; from
                        MS Azure subnets and work like packet filters to protect the network. Therefore alerting on
                        changes to NACLs help ensure that the subnets protected by them are not exposed.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Add activity log alert&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Filling the fields with the corresponding values.&lt;/li&gt;
                        &lt;li&gt;Select in actions the personnel should be received this information.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Create activity log alerts' url='https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when the VPC NACL changes.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:44:08.029'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-M01' name='Create alerts for changes on Activity Logs configuration' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the changes to
                        the correspondent personnel. It's vital that these unauthorized changes are detected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Add activity log alert&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Filling the fields with the corresponding values.&lt;/li&gt;
                        &lt;li&gt;Select in actions the personnel should be received this information.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Create activity log alerts' url='https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to alert when the Activity Logs configuration
                            changes.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:20:22.214'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-M05' name='Create alerts to notify the console login failure attempts' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the console login
                        failure attempts to the correspondent personnel. It's vital that these unauthorized changes are
                        detected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Add activity log alert&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Filling the fields with the corresponding values.&lt;/li&gt;
                        &lt;li&gt;Select in actions the personnel should be received this information.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Create activity log alerts' url='https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when several&amp;nbsp;console login failure
                            attempts occur.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:41:37.008'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-M08' name='Create alerts for VPC gateway changes' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the changes in
                        the VPC gateway tables to the correspondent personnel. It's vital that these unauthorized
                        changes are detected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &amp;nbsp;VPC gateways are used as a means of sending traffic outside of VPC (ie to the
                        internet) and are vital in ensuring traffic flows to correct destination. Therefore alerting on
                        changes to VPC gateways ensuring traffic continues to flow as expected via the correct gateway.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Add activity log alert&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Filling the fields with the corresponding values.&lt;/li&gt;
                        &lt;li&gt;Select in actions the personnel should be received this information.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Create activity log alerts' url='https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when the VPC gateway changes.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:46:28.755'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-M07' name='Create alerts for VPC route table changes' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the changes in
                        the VPC route tables to the correspondent personnel. It's vital that these unauthorized changes
                        are detected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        VPC route table provides a means of routing network traffic between subnets and via gateways and
                        ensures traffic flows via the correct path. Therefore alerting on changes to route tables
                        ensuring the traffic continues to flow as expected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Add activity log alert&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Filling the fields with the corresponding values.&lt;/li&gt;
                        &lt;li&gt;Select in actions the personnel should be received this information.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Create activity log alerts' url='https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when the VPC route table changes.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:45:10.259'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-M02' name='Create alerts for security policy changes' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the Management
                        Security Policies changes to the correspondent personnel. It's vital that these unauthorized
                        changes are detected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Add activity log alert&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Filling the fields with the corresponding values.&lt;/li&gt;
                        &lt;li&gt;Select in actions the personnel should be received this information.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Create activity log alerts' url='https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to alert when the security policy changes.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:21:30.303'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-M04' name='Create alerts due of Transparent Data Encryption Deletion' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the changes of
                        Transparent Data Encryption to the correspondent personnel. It's vital that these unauthorized
                        changes are detected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Add activity log alert&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Filling the fields with the corresponding values.&lt;/li&gt;
                        &lt;li&gt;Select in actions the personnel should be received this information.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Create activity log alerts' url='https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to alert when the Transparent Data Encryption is
                            disabled.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:40:22.033'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-M03' name='Create alerts to detect changes in the recommendation configurations' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the changes in
                        the recommendation configurations to the correspondent personnel. It's vital that these
                        unauthorized changes are detected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Add activity log alert&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Filling the fields with the corresponding values.&lt;/li&gt;
                        &lt;li&gt;Select in actions the personnel should be received this information.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Create activity log alerts' url='https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to alert when the recommended configuration changes.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:23:03.099'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-M10' name='Create alerts to notify a bad usage of the root account' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the usage of the
                        root accounts to the correspondent personnel. It's vital that these unauthorized changes are
                        detected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Add activity log alert&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Filling the fields with the corresponding values.&lt;/li&gt;
                        &lt;li&gt;Select in actions the personnel should be received this information.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Create activity log alerts' url='https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when there is a bad usage of the root
                            account.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:35:42.316'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control>
</controls>
<usecases>
<usecase ref='LOG ACTIVITY ALERTS' name='Log Activity alerts' desc='' library=''>
          <threats>
<threat ref='UNAUTHORIZED-ACCESS-SYSTEMS' name='Attackers access to the systems without being detected' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;div&gt;
                                Attackers gain access to the systems and they are not detected and the changes of the
                                attackers couldn't be audited or detected.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality='50' integrity='25' availability='25' easeOfExploitation='50' />
              <references />
              <weaknesses>
                <weakness ref='AZURE-MON02'>
                  <controls>
                    <control ref='AZ-M10' mitigation='20' />
                  </controls>
                </weakness>
                <weakness ref='AZURE-MON03'>
                  <controls>
                    <control ref='AZ-M11' mitigation='20' />
                  </controls>
                </weakness>
                <weakness ref='AZURE-MON06'>
                  <controls>
                    <control ref='AZ-M05' mitigation='20' />
                  </controls>
                </weakness>
                <weakness ref='AZURE-MON05'>
                  <controls>
                    <control ref='AZ-M04' mitigation='20' />
                  </controls>
                </weakness>
                <weakness ref='AZURE-MON04'>
                  <controls>
                    <control ref='AZ-M12' mitigation='20' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='AZ-M04' mitigation='20' />
                <control ref='AZ-M05' mitigation='20' />
                <control ref='AZ-M10' mitigation='20' />
                <control ref='AZ-M11' mitigation='20' />
                <control ref='AZ-M12' mitigation='20' />
              </controls>
            </threat><threat ref='UNAUTHORIZED-ACCESS-NETWORK' name='Sensitive data is compromised through network access' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;div&gt;
                                Attackers gain undetected access to network systems and produced changes cannot be
                                audited or detected.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality='50' integrity='50' availability='50' easeOfExploitation='50' />
              <references />
              <weaknesses>
                <weakness ref='AZURE-MON07'>
                  <controls>
                    <control ref='AZ-M06' mitigation='40' />
                    <control ref='AZ-M07' mitigation='30' />
                    <control ref='AZ-M08' mitigation='30' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='AZ-M06' mitigation='40' />
                <control ref='AZ-M07' mitigation='30' />
                <control ref='AZ-M08' mitigation='30' />
              </controls>
            </threat><threat ref='UNAUTHORIZED-ACCESS-SECURITY-SYSTEMS' name='Attackers gain undetected access to security system configurations' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;div&gt;
                                Attackers could gain undetected access to security system configurations and the changes
                                of the attackers couldn't be audited or detected.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality='50' integrity='50' availability='50' easeOfExploitation='50' />
              <references />
              <weaknesses>
                <weakness ref='AZURE-MON01'>
                  <controls>
                    <control ref='AZ-M01' mitigation='25' />
                    <control ref='AZ-M02' mitigation='25' />
                    <control ref='AZ-M03' mitigation='25' />
                    <control ref='AZ-M09' mitigation='25' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='AZ-M01' mitigation='25' />
                <control ref='AZ-M02' mitigation='25' />
                <control ref='AZ-M03' mitigation='25' />
                <control ref='AZ-M09' mitigation='25' />
              </controls>
            </threat>
</threats>
</usecase>
</usecases>
</component>
<component ref='AZURE-VIRTUAL-MACHINES' name='Azure Virtual Machines' desc='' groupName='' tags='' position='7' library='' diagramPositionX='0' diagramPositionY='0' componentDefinitionRef=''>
      <weaknesses>
<weakness ref='AZURE-NET-01' name='Unauthorised connection attempts on open ports' state='0' impact='100'>
          <desc>&lt;div&gt;
                        Receiving unauthorized connections to open ports is most likely to be receiving an attack. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Check that each Azure resources have got their Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Check that a set of these groups achieve with the principle of the least
                            privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the inbound/outbound security rules are enabled and correctly
                            configured.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that all the traffic from
                            0.0.0.0/0&amp;nbsp;is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-06-12T09:54:46.719'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AZURE-VM-NOT_LICENSE' name='Unlicensed Virtual Machines' state='0' impact='100'>
          <desc>Azure is a system formed by Microsoft machines, therefore, it is necessary that Microsoft
                        perform periodic verification of the licenses of the products.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic outbound
                            through the port 1688 is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-06-09T12:52:33.178'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AZURE-NET-05' name='Communication is not allowed from/to Virtual Machines' state='0' impact='100'>
          <desc>IP allocation of virtual machines, DNS resolution, and node monitorization is performed by a
                        Microsoft host node. It is necessary to allow the communication with this virtual IP to be able
                        to make the communication from/to the virtual machine of Azure.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the IP 168.63.129.16
                            inbound traffic is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-06-12T09:54:46.861'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AZURE-VM01' name='Exposed security policies for the resources' state='0' impact='100'>
          <desc>The security policies are not configured and the security configurations are exposed for the
                        attackers.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;On the Security Center dashboard, select Security policy, and then select your
                            subscription.&lt;/li&gt;
                            &lt;li&gt;Select Prevention policy.&lt;/li&gt;
                            &lt;li&gt;Check that the required policy items are enabled.&amp;nbsp;&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-06-12T09:58:41.671'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AZURE-LOGS03' name='Undetected changes in audit logs' state='0' impact='100'>
          <desc>Changes in audit logs are not detected. Therefore, audit logs should be exported each a
                        determinate number of days to another place. The exporting of the audit files can help to fix
                        security fails when these logs are analyzed.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;On the Security Center dashboard, click Security policy, and then select your
                            subscription.&lt;/li&gt;
                            &lt;li&gt;Check that the Data collection is enabled and correctly configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-06-12T09:56:32.936'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AZURE-NET-02' name='Unauthorised connection attempts on port 22' state='0' impact='100'>
          <desc>Receiving unauthorized connections to port 22 is most likely to be receiving an SSH attack. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Login&amp;nbsp;into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 22 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-06-12T09:54:46.776'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AZURE-NET-03' name='Unauthorised connection attempts on port 3389' state='0' impact='100'>
          <desc>Receiving unauthorized connections to port 3389 is most likely to be receiving an RDP attack.
                        To avoid this, access to the network must be as restricted as possible, so that only the
                        necessary ports are open and the minimum inbound traffic is accepted.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Login&amp;nbsp;into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 3389 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-06-12T09:54:46.804'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AZURE-NET-04' name='Unauthorised connection attempts on Azure resources' state='0' impact='100'>
          <desc>Receiving unauthorized connections to Azure resources is most likely to be receiving an
                        attack. To avoid this, access to the network must be as restricted as possible using Network
                        Access Control Lists for blacklisting.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on
                            &amp;quot;Inbound security rules&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is a rule to deny the inbound access from a blacklisted IP
                            address or range to a designated port or port range.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-06-12T09:54:46.827'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AZURE-VM02' name='Undetected changes in Virtual Machine configurations' state='0' impact='100'>
          <desc>The changes in virtual machines configurations are not detected because the monitorization and
                        alerts of the security configuration are not configured.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then
                            select myVM in the resource list.&lt;/li&gt;
                            &lt;li&gt;Click Alert rules on the VM blade.&lt;/li&gt;
                            &lt;li&gt;Check there are some metric alerts and they are correctly configured and enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-06-12T10:00:54.642'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness>
</weaknesses>
<controls>
<control ref='AZ-N02' name='Use Network Security Groups to block inbound port traffic from 0.0.0.0/0' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
                        resources. Set the limit inbound access to all TCP or all ports to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;:&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;ul&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Remove all rules that allow port traffic.&lt;/li&gt;
                        &lt;li&gt;Add a rule to deny port traffic&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - How to open ports to a virtual machine with the Azure portal' url='https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that all the traffic from
                            0.0.0.0/0 is are blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-10T08:37:28.289'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-N07' name='Use Network Access Control Lists (NACLs) for blacklisting' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Use Network Access Control Lists (NACLs) as a method of blacklisting IP addresses to filters the
                        traffic across endpoints to allow or deny traffic per pre-created rules.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation: &amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on &amp;quot;Inbound
                        security rules&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Add a DENY rule that will restrict inbound access from a blacklisted IP address or
                        range to a designated port or port range.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;ol&gt;
                        &lt;ul&gt;
                        &lt;/ul&gt;
                        &lt;/ol&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - How to open ports to a virtual machine with the Azure portal' url='https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on
                            &amp;quot;Inbound security rules&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is a rule to deny the inbound access from a blacklisted IP
                            address or range to a designated port or port range.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-10T08:45:53.680'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-N04' name='Use Network Security Groups to block ingress to port 22 from 0.0.0.0/0' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
                        resources. Set the limit inbound access to port 22 (Secure Desk) to IP addresses that require
                        this access to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;:&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Allow SSH port traffic just to/from IPs that require the access.&lt;/li&gt;
                        &lt;li&gt;Otherwise, remove all rules that allow port 22 traffic.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - How to open ports to a virtual machine with the Azure portal' url='https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 22 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-10T08:39:40.398'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-N06' name='Allow Key Management Service request' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Allow Key Management Service host server to handle the periodic request to ensure Microsoft
                        licensing. Set the limit outbound access to port 1688 (Service Request) in the Network Security
                        Groups to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Outbound security rules&amp;quot;: Allow port 1688 outbound traffic.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - How to open ports to a virtual machine with the Azure portal' url='https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic outbound
                            through the port 1688 is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-10T09:22:02.680'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-V01' name='Set up data collection' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Set up the Security Center Data Collection to create an Azure storage account to hold the
                        collected data.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;On the Security Center dashboard, click Security policy, and then select your
                        subscription.&lt;/li&gt;
                        &lt;li&gt;For Data collection, select On.&lt;/li&gt;
                        &lt;li&gt;To create a storage account, select Choose a storage account. Then, select OK.&lt;/li&gt;
                        &lt;li&gt;On the Security Policy blade, select Save.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Data collection in Azure Security Center' url='https://docs.microsoft.com/en-us/azure/security-center/security-center-enable-data-collection' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;On the Security Center dashboard, click Security policy, and then select your
                            subscription.&lt;/li&gt;
                            &lt;li&gt;Check that the Data collection is enabled and correctly configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-06-12T09:57:14.196'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-N01' name='Set Network Security Groups to be as restrictive as possible' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
                        resources. Set the limit all the traffic (ingress/egress) on the NSG in order to force the use
                        of least privilege into the NSG.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Identify Azure resources for each NSG.&lt;/li&gt;
                        &lt;li&gt;Create a set of least privilege NSG for those resources.&lt;/li&gt;
                        &lt;li&gt;Place the resources in those security groups.&lt;/li&gt;
                        &lt;li&gt;Change the inbound/outbound security rules to fulfill the least privilege.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - How to open ports to a virtual machine with the Azure portal' url='https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Check that each Azure resources has got their Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Check that a set of these groups achieve with the principle of the least
                            privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the inbound/outbound security rules are enabled and correctly
                            configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-10T08:35:37.229'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-V03' name='Create alerts for Virtual Machines' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Create alerts based on specific performance metrics:
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the average CPU usage exceeds a certain
                        threshold.&lt;/li&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the available free disk space drops below a
                        certain amount,&lt;/li&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the security configuration of the Virtual
                        Machines changes.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then select
                        myVM in the resource list.&lt;/li&gt;
                        &lt;li&gt;Click Alert rules on the VM blade, then click Add metric alert across the top of the
                        alerts blade.&lt;/li&gt;
                        &lt;li&gt;Provide a Name for your alert, such as myAlertRule&lt;/li&gt;
                        &lt;li&gt;To trigger an alert when CPU percentage exceeds 1.0 for five minutes, leave all the
                        other defaults selected.&lt;/li&gt;
                        &lt;li&gt;Optionally, check the box for Email owners, contributors, and readers to send an email
                        notification. The default action is to present a notification in the portal.&lt;/li&gt;
                        &lt;li&gt;Click the OK button.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Microsoft Azure Virtual Machine Monitoring with Azure Diagnostics Extension' url='https://azure.microsoft.com/en-us/blog/windows-azure-virtual-machine-monitoring-with-wad-extension/' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then
                            select myVM in the resource list.&lt;/li&gt;
                            &lt;li&gt;Click Alert rules on the VM blade.&lt;/li&gt;
                            &lt;li&gt;Check there are some metric alerts and they are correctly configured and enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-06-12T10:01:40.663'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-V02' name='Set up the security policy' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Set up the security policies to define the items for which Security Center collects data and
                        makes recommendations. Apply different security policies to different sets of Azure resources.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;On the Security Center dashboard, select Security policy, and then select your
                        subscription.&lt;/li&gt;
                        &lt;li&gt;Select Prevention policy.&lt;/li&gt;
                        &lt;li&gt;Turn on or turn off policy items that you want to apply to all Azure resources.&lt;/li&gt;
                        &lt;li&gt;When you're finished selecting your settings, select OK.&lt;/li&gt;
                        &lt;li&gt;On the Security policy blade, select Save.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Set security policies in Azure Security Center' url='https://docs.microsoft.com/en-us/azure/security-center/security-center-policies' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;On the Security Center dashboard, select Security policy, and then select your
                            subscription.&lt;/li&gt;
                            &lt;li&gt;Select Prevention policy.&lt;/li&gt;
                            &lt;li&gt;Check that the required policy items are enabled.&amp;nbsp;&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-06-12T09:59:28.434'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-N05' name='Allow Virtual IP of the Microsoft host node' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Allow inbound accesses in Network Security Groups from the IP address 168.63.129.16 to
                        communicate with the Azure Service. This IP belongs to Microsoft and acts as DHCP server, DNS
                        server and monitoring the host node hosting the Azure Virtual Machine.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;: Allow IP 168.63.129.16 inbound traffic.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - How to open ports to a virtual machine with the Azure portal' url='https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the IP 168.63.129.16
                            inbound traffic is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-10T09:06:41.792'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-N03' name='Use Network Security Groups to block ingress to port 3389 from 0.0.0.0/0' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
                        resources. Set the limit inbound access to port 3389 (Remote Desk Protocol) to IP addresses that
                        require this access to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;:&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Allow RDP port traffic just to/from IPs that require the access.&lt;/li&gt;
                        &lt;li&gt;Otherwise, remove all rules that allow port 3389 traffic.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - How to open ports to a virtual machine with the Azure portal' url='https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 3389 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-10T08:42:12.906'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control>
</controls>
<usecases>
<usecase ref='PATCHING' name='Patching' desc='' library=''>
          <threats>
<threat ref='UNAUTHZ-SERVICES-NOT-UPDATE' name='Attackers gain access to the system exploiting a known vulnerability' state='Expose' source='MANUAL' owner='' library=''>
              <desc>Attackers can gain access to the systems because the security patches for each system
                                have not been applied or the licenses of the products have expired.
                            </desc>
              <riskRating confidentiality='75' integrity='75' availability='50' easeOfExploitation='75' />
              <references />
              <weaknesses>
                <weakness ref='AZURE-VM-NOT_LICENSE'>
                  <controls>
                    <control ref='AZ-N06' mitigation='100' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='AZ-N06' mitigation='100' />
              </controls>
            </threat>
</threats>
</usecase>
<usecase ref='ACTIVITY LOGS ALERTS' name='Activity Logs alerts' desc='' library=''>
          <threats>
<threat ref='UNAUTHORIZED-ACCESS-VIRTUAL-MACHINES' name='Attackers gain undetected access to the system by changing Virtual Machine configurations ' state='Expose' source='MANUAL' owner='' library=''>
              <desc>Attackers can gain undetected access to the virtual machine configurations and the
                                changes of the attackers couldn't be audited or detected.
                            </desc>
              <riskRating confidentiality='50' integrity='50' availability='25' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AZURE-VM02'>
                  <controls>
                    <control ref='AZ-V03' mitigation='100' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='AZ-V03' mitigation='100' />
              </controls>
            </threat>
</threats>
</usecase>
<usecase ref='GENERAL' name='General' desc='' library=''>
          <threats>
<threat ref='UNCONFIGURED-SECURITY' name='Attackers gain access to the system by exploiting weak security configurations' state='Expose' source='MANUAL' owner='' library=''>
              <desc></desc>
              <riskRating confidentiality='75' integrity='50' availability='25' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AZURE-VM01'>
                  <controls>
                    <control ref='AZ-V02' mitigation='100' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='AZ-V02' mitigation='100' />
              </controls>
            </threat>
</threats>
</usecase>
<usecase ref='API LOGGING AND AUDITING' name='API Logging and Auditing' desc='' library=''>
          <threats>
<threat ref='UNAUDITABLE-CHANGES-AZURE' name='Attackers make undetected and unaudited changes to system configurations' state='Expose' source='MANUAL' owner='' library=''>
              <desc>If audit trails are not properly protected, an attacker could gain access to the
                                system, modify the status of resources or exfiltrate sensitive data without being
                                noticed.
                            </desc>
              <riskRating confidentiality='25' integrity='75' availability='25' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AZURE-LOGS03'>
                  <controls>
                    <control ref='AZ-V01' mitigation='100' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='AZ-V01' mitigation='100' />
              </controls>
            </threat>
</threats>
</usecase>
<usecase ref='NETWORKING' name='Networking' desc='' library=''>
          <threats>
<threat ref='UNAUTHORISED-CONNECTION' name='Attackers gain access to the system through direct access to Virtual Machines' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;div&gt;
                                Attackers can gain unauthorized connection to the Virtual Machines through misconfigured
                                ports or security network configurations.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality='25' integrity='25' availability='50' easeOfExploitation='50' />
              <references />
              <weaknesses>
                <weakness ref='AZURE-NET-05'>
                  <controls>
                    <control ref='AZ-N05' mitigation='20' />
                  </controls>
                </weakness>
                <weakness ref='AZURE-NET-04'>
                  <controls>
                    <control ref='AZ-N07' mitigation='20' />
                  </controls>
                </weakness>
                <weakness ref='AZURE-NET-01'>
                  <controls>
                    <control ref='AZ-N01' mitigation='20' />
                    <control ref='AZ-N02' mitigation='10' />
                  </controls>
                </weakness>
                <weakness ref='AZURE-NET-02'>
                  <controls>
                    <control ref='AZ-N04' mitigation='10' />
                  </controls>
                </weakness>
                <weakness ref='AZURE-NET-03'>
                  <controls>
                    <control ref='AZ-N03' mitigation='20' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='AZ-N01' mitigation='20' />
                <control ref='AZ-N02' mitigation='10' />
                <control ref='AZ-N03' mitigation='20' />
                <control ref='AZ-N04' mitigation='10' />
                <control ref='AZ-N05' mitigation='20' />
                <control ref='AZ-N07' mitigation='20' />
              </controls>
            </threat>
</threats>
</usecase>
</usecases>
</component>
<component ref='AZURE-LOGS' name='Azure Logging' desc='' groupName='' tags='' position='2' library='' diagramPositionX='0' diagramPositionY='0' componentDefinitionRef=''>
      <weaknesses>
<weakness ref='AZURE-LOGS01' name='Non-auditable resource changes' state='0' impact='100'>
          <desc>&lt;div&gt;
                        The Diagnostic Logs are not activated and configured. Therefore, the changes or the access to
                        the resources are not recorded into the logs.
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to the Azure portal.&lt;/li&gt;
                            &lt;li&gt;Go to the blade for your web app and in &amp;quot;Monitoring&amp;quot; &amp;gt;&amp;gt;
                            &amp;quot;Diagnostics logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that &amp;quot;Application Logging (Filesystem)&amp;quot; and &amp;quot;Application
                            Logging (Blob)&amp;quot; are enabled.&lt;/li&gt;
                            &lt;li&gt;Check that the type &amp;quot;Storage&amp;quot; or &amp;quot;File System&amp;quot;
                            are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:54:42.546'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AZURE-LOGS03' name='Audit logs can be deleted' state='0' impact='100'>
          <desc>There is no external backups of log records. If logs are deleted, there is no way to recover
                        them.ed.
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Activity Logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Push the button &amp;quot;Export&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;All Regions&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Export to a storage account&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that all fields are correctly filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:55:17.070'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness><weakness ref='AZURE-LOGS02' name='Non-auditable connections to the web application' state='0' impact='100'>
          <desc>&lt;div&gt;
                        The status connection or failed attempts cannot be audited because they are not recorded into
                        the logs.
                        &lt;/div&gt;
                    </desc>
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to the Azure portal.&lt;/li&gt;
                            &lt;li&gt;Go to the blade for your web app and in &amp;quot;Monitoring&amp;quot; &amp;gt;&amp;gt;
                            &amp;quot;Diagnostics logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that the &amp;quot;Detailed error messages&amp;quot; is enabled.&lt;/li&gt;
                            &lt;li&gt;Check that the &amp;quot;Failed request tracing&amp;quot; is enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:54:59.341'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </weakness>
</weaknesses>
<controls>
<control ref='AZ-L02' name='Enable Web Server Logging' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Enable the Web Server logging to receive information about HTTP transactions using the W3C
                        extended log file format. This is useful when determining overall site metrics such as the
                        number of requests handled or how many requests are from a specific IP address. There are two
                        ways to save the data:
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;li&gt;&lt;b&gt;File system: &lt;/b&gt;stores the application diagnostics information to the
                        web app file system. These files can be accessed by FTP, or downloaded as a Zip archive by using
                        the Azure PowerShell or Azure Command-Line Interface (Azure CLI).&lt;/li&gt;
                        &lt;li&gt;&lt;b&gt;Storage:&lt;/b&gt; stores the application diagnostics information in the
                        specified Azure Storage Account and the logs are only accessible with a client account.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to the Azure portal.&lt;/li&gt;
                        &lt;li&gt;Go to the blade for your web app and in &amp;quot;Monitoring&amp;quot; &amp;gt;&amp;gt;
                        &amp;quot;Diagnostics logs&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Enable the type &amp;quot;Storage&amp;quot; or &amp;quot;File System&amp;quot; to
                        activate this function.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Save&amp;quot; to save the changes.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Enable diagnostics logging for web apps in Azure App Service' url='https://docs.microsoft.com/en-us/azure/app-service-web/web-sites-enable-diagnostic-log' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to the Azure portal.&lt;/li&gt;
                            &lt;li&gt;Go to the blade for your web app and in &amp;quot;Monitoring&amp;quot; &amp;gt;&amp;gt;
                            &amp;quot;Diagnostics logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that the type &amp;quot;Storage&amp;quot; or &amp;quot;File System&amp;quot;
                            are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:14:32.776'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-L05' name='Export the Audit Logs to a storage account' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Export the information of Audit Logs to a storage account.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Activity Logs&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push the button &amp;quot;Export&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Select &amp;quot;All Regions&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Select &amp;quot;Export to a storage account&amp;quot; and select your account.&lt;/li&gt;
                        &lt;li&gt;Select the &amp;quot;Retention (days)&amp;quot; as minimum 90 days.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Enable diagnostics logging for web apps in Azure App Service' url='https://docs.microsoft.com/en-us/azure/app-service-web/web-sites-enable-diagnostic-log' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Activity Logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Push the button &amp;quot;Export&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;All Regions&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Export to a storage account&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that all fields are correctly filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:16:43.531'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-L01' name='Enable diagnostic logs auditing for Microsoft Azure' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Enable diagnostic logs to give the information over the operations of the resources.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to the Azure portal.&lt;/li&gt;
                        &lt;li&gt;Go to the blade for your web app and in &amp;quot;Monitoring&amp;quot; &amp;gt;&amp;gt;
                        &amp;quot;Diagnostics logs&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Enable the &amp;quot;Application Logging (Filesystem)&amp;quot; and &amp;quot;Application
                        Logging (Blob)&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Save&amp;quot; to save the changes.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Enable diagnostics logging for web apps in Azure App Service' url='https://docs.microsoft.com/en-us/azure/app-service-web/web-sites-enable-diagnostic-log' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to the Azure portal.&lt;/li&gt;
                            &lt;li&gt;Go to the blade for your web app and in &amp;quot;Monitoring&amp;quot; &amp;gt;&amp;gt;
                            &amp;quot;Diagnostics logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that &amp;quot;Application Logging (Filesystem)&amp;quot; and &amp;quot;Application
                            Logging (Blob)&amp;quot; are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:12:46.725'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-L04' name='Enable Failed Request Tracing' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Enable to obtain the detailed information on failed requests, including a trace of the IIS
                        components used to process the request and the time taken in each component. This can be useful
                        if you are attempting to increase site performance or isolate what is causing a specific HTTP
                        error to be returned.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to the Azure portal.&lt;/li&gt;
                        &lt;li&gt;Go to the blade for your web app and in &amp;quot;Monitoring&amp;quot; &amp;gt;&amp;gt;
                        &amp;quot;Diagnostics logs&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Enable the &amp;quot;Failed request tracing&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Save&amp;quot; to save the changes.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Enable diagnostics logging for web apps in Azure App Service' url='https://docs.microsoft.com/en-us/azure/app-service-web/web-sites-enable-diagnostic-log' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to the Azure portal.&lt;/li&gt;
                            &lt;li&gt;Go to the blade for your web app and in &amp;quot;Monitoring&amp;quot; &amp;gt;&amp;gt;
                            &amp;quot;Diagnostics logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that the &amp;quot;Failed request tracing&amp;quot; is enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:15:51.866'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control><control ref='AZ-L03' name='Enable Detailed error messages' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Enable the detailed error information for HTTP status codes that indicate a failure (status code
                        400 or greater) is saved into the logs files. This may contain information that can help
                        determine why the server returned the error code.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to the Azure portal.&lt;/li&gt;
                        &lt;li&gt;Go to the blade for your web app and in &amp;quot;Monitoring&amp;quot; &amp;gt;&amp;gt;
                        &amp;quot;Diagnostics logs&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Enable the &amp;quot;Detailed error messages&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Save&amp;quot; to save the changes.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - Enable diagnostics logging for web apps in Azure App Service' url='https://docs.microsoft.com/en-us/azure/app-service-web/web-sites-enable-diagnostic-log' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to the Azure portal.&lt;/li&gt;
                            &lt;li&gt;Go to the blade for your web app and in &amp;quot;Monitoring&amp;quot; &amp;gt;&amp;gt;
                            &amp;quot;Diagnostics logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that the &amp;quot;Detailed error messages&amp;quot; is enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-05-23T14:15:11.600'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control>
</controls>
<usecases>
<usecase ref='API LOGGING AND AUDITING' name='API Logging and Auditing' desc='' library=''>
          <threats>
<threat ref='UNAUDITABLE-CHANGES-AZURE' name='Attackers make undetected and unaudited changes to system configurations' state='Expose' source='MANUAL' owner='' library=''>
              <desc>&lt;div&gt;
                                If audit trails are not properly protected, an attacker could gain access to the system,
                                modify the status of resources or exfiltrate sensitive data without being noticed.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality='25' integrity='75' availability='50' easeOfExploitation='25' />
              <references />
              <weaknesses>
                <weakness ref='AZURE-LOGS03'>
                  <controls>
                    <control ref='AZ-L05' mitigation='20' />
                  </controls>
                </weakness>
                <weakness ref='AZURE-LOGS02'>
                  <controls>
                    <control ref='AZ-L03' mitigation='20' />
                    <control ref='AZ-L04' mitigation='20' />
                  </controls>
                </weakness>
                <weakness ref='AZURE-LOGS01'>
                  <controls>
                    <control ref='AZ-L01' mitigation='20' />
                    <control ref='AZ-L02' mitigation='20' />
                  </controls>
                </weakness>
              </weaknesses>
              <controls>
                <control ref='AZ-L01' mitigation='20' />
                <control ref='AZ-L02' mitigation='20' />
                <control ref='AZ-L03' mitigation='20' />
                <control ref='AZ-L04' mitigation='20' />
                <control ref='AZ-L05' mitigation='20' />
              </controls>
            </threat>
</threats>
</usecase>
</usecases>
</component>
</components>
<rules>
<rule name='Set Answer: Set Public Cloud when MS Azure SQL is selected' module='component' generatedByGui='true'>
    <condition name='Is specific component definition' type='drools-without-variable-type' field='id' value='azure-sql'>
      <pattern name='Is specific component definition' pattern='ComponentDefinitionProperties(ref == "${value}");' />
    </condition>
    <action project='' value='Public Cloud_::_true_::_true' name='Answer Question' type='drools-without-variable-type'>
      <pattern name='Action of answer question' pattern='$questionToAnswer : Question(id == "${value-1}", answer != ${value-2}); eval(!${value-3} || !$questionToAnswer.isManuallyModified());_:::_modify($questionToAnswer) { setAnswer(${value-2}), setCanBeManuallyModified(${value-3}) };' />
    </action>
    <content />
  </rule>
<rule name='Q: Deployed - Public Cloud &amp; MS Azure &amp; Service' module='component' generatedByGui='true'>
    <condition name='Question is answered' type='Question' field='id' value='cloud.azure'>
      <pattern name='Condition with answer' pattern='${type}(${field} == "${value}", answer == true);' />
    </condition>
    <condition name='Risk pattern exists' type='drools-without-variable-type' field='id' value='CS-Default_::_GENERIC-SERVICE'>
      <pattern name='Risk pattern exists' pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");' />
    </condition>
    <action project='' value='cloud.azure.services_::_Deployment_::_Which Azure services?_::_6510_::_false_::_false_::_' name='Insert Question Group' type='drools-without-variable-type'>
      <pattern name='Action of insert question group' pattern='QuestionGroup group = new QuestionGroup("${value-1}","${value-2}","${value-3}", ${value-4}, "${value-7}"); group.setFlags(${value-5}, ${value-6}); insertLogical(group);' />
    </action>
    <content />
  </rule>
<rule name='Q: Deployed - Public Cloud &amp; MS Azure &amp; Service - *' module='component' generatedByGui='true'>
    <condition name='Question Group exists' type='drools-without-variable-type' field='id' value='cloud.azure.services'>
      <pattern name='Question group exists' pattern='$group : QuestionGroup(id == "${value}") @Watch(!*);' />
    </condition>
    <condition name='Risk pattern exists' type='drools-without-variable-type' field='id' value='CS-Default_::_GENERIC-SERVICE'>
      <pattern name='Risk pattern exists' pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");' />
    </condition>
    <action project='' value='azure.virtualMachines_::_Azure Virtual Machines_::_' name='Insert Question' type='drools-without-variable-type'>
      <pattern name='Action of insert question' pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));' />
    </action>
    <content />
  </rule>
<rule name='Q: Deployed - Public Cloud &amp; MS Azure &amp; Client - *' module='component' generatedByGui='true'>
    <condition name='Question Group exists' type='drools-without-variable-type' field='id' value='cloud.azure.services'>
      <pattern name='Question group exists' pattern='$group : QuestionGroup(id == "${value}") @Watch(!*);' />
    </condition>
    <condition name='Risk pattern exists' type='drools-without-variable-type' field='id' value='CS-Default_::_GENERIC-CLIENT'>
      <pattern name='Risk pattern exists' pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");' />
    </condition>
    <action project='' value='azure.virtualMachines_::_Azure Virtual Machines_::_' name='Insert Question' type='drools-without-variable-type'>
      <pattern name='Action of insert question' pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));' />
    </action>
    <content />
  </rule>
<rule name='Risk Pattern: Azure Virtual Machines' module='component' generatedByGui='true'>
    <condition name='Question is answered' type='Question' field='id' value='azure.virtualMachines'>
      <pattern name='Condition with answer' pattern='${type}(${field} == "${value}", answer == true);' />
    </condition>
    <action project='Microsoft-Azure' value='Microsoft-Azure_::_AZURE-VIRTUAL-MACHINES' name='Import Risk Pattern' type='drools-without-variable-type'>
      <pattern name='Action of import a risk pattern' pattern='insertLogical(ImportRiskPatternFactory.importRiskPattern("${value-1}", "${value-2}", 50));' />
    </action>
    <content />
  </rule>
<rule name='Set Answer: MS Azure Environment --&gt; Public Cloud' module='component' generatedByGui='true'>
    <condition name='Is specific component definition' type='drools-without-variable-type' field='id' value='microsoft-azure-environment'>
      <pattern name='Is specific component definition' pattern='ComponentDefinitionProperties(ref == "${value}");' />
    </condition>
    <action project='' value='Public Cloud_::_true_::_true' name='Answer Question' type='drools-without-variable-type'>
      <pattern name='Action of answer question' pattern='$questionToAnswer : Question(id == "${value-1}", answer != ${value-2}); eval(!${value-3} || !$questionToAnswer.isManuallyModified());_:::_modify($questionToAnswer) { setAnswer(${value-2}), setCanBeManuallyModified(${value-3}) };' />
    </action>
    <content />
  </rule>
<rule name='Risk Pattern: Azure Storage' module='component' generatedByGui='true'>
    <condition name='Question is answered' type='Question' field='id' value='azure.storage'>
      <pattern name='Condition with answer' pattern='${type}(${field} == "${value}", answer == true);' />
    </condition>
    <action project='Microsoft-Azure' value='Microsoft-Azure_::_AZURE-STORAGE' name='Import Risk Pattern' type='drools-without-variable-type'>
      <pattern name='Action of import a risk pattern' pattern='insertLogical(ImportRiskPatternFactory.importRiskPattern("${value-1}", "${value-2}", 50));' />
    </action>
    <content />
  </rule>
<rule name='Q: Deployed - Public Cloud &amp; MS Azure &amp; All' module='component' generatedByGui='true'>
    <condition name='Conclusion exists' type='drools-without-variable-type' field='id' value='trust.zone.public.cloud'>
      <pattern name='Conclusion exists' pattern='Conclusion(id == "${value}");' />
    </condition>
    <condition name='Question Group exists' type='drools-without-variable-type' field='id' value='publicCloud'>
      <pattern name='Question group exists' pattern='$group : QuestionGroup(id == "${value}") @Watch(!*);' />
    </condition>
    <action project='' value='cloud.azure_::_Microsoft Azure_::_' name='Insert Question' type='drools-without-variable-type'>
      <pattern name='Action of insert question' pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));' />
    </action>
    <content />
  </rule>
<rule name='Q: Deployed - Public Cloud &amp; MS Azure &amp; Web UI - *' module='component' generatedByGui='true'>
    <condition name='Question Group exists' type='drools-without-variable-type' field='id' value='cloud.azure.services'>
      <pattern name='Question group exists' pattern='$group : QuestionGroup(id == "${value}") @Watch(!*);' />
    </condition>
    <condition name='Risk pattern exists' type='drools-without-variable-type' field='id' value='CS-Default_::_BROWSER'>
      <pattern name='Risk pattern exists' pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");' />
    </condition>
    <action project='' value='azure.virtualMachines_::_Azure Virtual Machines_::_' name='Insert Question' type='drools-without-variable-type'>
      <pattern name='Action of insert question' pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));' />
    </action>
    <content />
  </rule>
<rule name='Set Answer: Set Public Cloud when MS Azure Virtual Machines is selected' module='component' generatedByGui='true'>
    <condition name='Is specific component definition' type='drools-without-variable-type' field='id' value='azure-virtual-machines'>
      <pattern name='Is specific component definition' pattern='ComponentDefinitionProperties(ref == "${value}");' />
    </condition>
    <action project='' value='Public Cloud_::_true_::_true' name='Answer Question' type='drools-without-variable-type'>
      <pattern name='Action of answer question' pattern='$questionToAnswer : Question(id == "${value-1}", answer != ${value-2}); eval(!${value-3} || !$questionToAnswer.isManuallyModified());_:::_modify($questionToAnswer) { setAnswer(${value-2}), setCanBeManuallyModified(${value-3}) };' />
    </action>
    <content />
  </rule>
<rule name='Q: Deployed - Public Cloud &amp; MS Azure &amp; Data Store SQL - *' module='component' generatedByGui='true'>
    <condition name='Question Group exists' type='drools-without-variable-type' field='id' value='cloud.azure.services'>
      <pattern name='Question group exists' pattern='$group : QuestionGroup(id == "${value}") @Watch(!*);' />
    </condition>
    <condition name='Risk pattern exists' type='drools-without-variable-type' field='id' value='CS-Default_::_DATABASE-SQL'>
      <pattern name='Risk pattern exists' pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");' />
    </condition>
    <action project='' value='azure.sql_::_Azure SQL_::_' name='Insert Question' type='drools-without-variable-type'>
      <pattern name='Action of insert question' pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));' />
    </action>
    <action project='' value='azure.virtualMachines_::_Azure Virtual Machines_::_' name='Insert Question' type='drools-without-variable-type'>
      <pattern name='Action of insert question' pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));' />
    </action>
    <content />
  </rule>
<rule name='Risk Pattern: Azure SQL' module='component' generatedByGui='true'>
    <condition name='Question is answered' type='Question' field='id' value='azure.sql'>
      <pattern name='Condition with answer' pattern='${type}(${field} == "${value}", answer == true);' />
    </condition>
    <action project='Microsoft-Azure' value='Microsoft-Azure_::_AZURE-SQL' name='Import Risk Pattern' type='drools-without-variable-type'>
      <pattern name='Action of import a risk pattern' pattern='insertLogical(ImportRiskPatternFactory.importRiskPattern("${value-1}", "${value-2}", 50));' />
    </action>
    <content />
  </rule>
<rule name='Set Answer: Set Public Cloud when MS Azure Storage is selected' module='component' generatedByGui='true'>
    <condition name='Is specific component definition' type='drools-without-variable-type' field='id' value='azure-storage'>
      <pattern name='Is specific component definition' pattern='ComponentDefinitionProperties(ref == "${value}");' />
    </condition>
    <action project='' value='Public Cloud_::_true_::_true' name='Answer Question' type='drools-without-variable-type'>
      <pattern name='Action of answer question' pattern='$questionToAnswer : Question(id == "${value-1}", answer != ${value-2}); eval(!${value-3} || !$questionToAnswer.isManuallyModified());_:::_modify($questionToAnswer) { setAnswer(${value-2}), setCanBeManuallyModified(${value-3}) };' />
    </action>
    <content />
  </rule>
<rule name='Q: Deployed - Public Cloud &amp; MS Azure &amp; Data Store NoSQL - *' module='component' generatedByGui='true'>
    <condition name='Question Group exists' type='drools-without-variable-type' field='id' value='cloud.azure.services'>
      <pattern name='Question group exists' pattern='$group : QuestionGroup(id == "${value}") @Watch(!*);' />
    </condition>
    <condition name='Risk pattern exists' type='drools-without-variable-type' field='id' value='CS-Default_::_DATABASE-NOSQL'>
      <pattern name='Risk pattern exists' pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");' />
    </condition>
    <action project='' value='azure.storage_::_Azure Storage_::_' name='Insert Question' type='drools-without-variable-type'>
      <pattern name='Action of insert question' pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));' />
    </action>
    <content />
  </rule>
<rule name='Q: Deployed - Public Cloud &amp; MS Azure &amp; Client' module='component' generatedByGui='true'>
    <condition name='Question is answered' type='Question' field='id' value='cloud.azure'>
      <pattern name='Condition with answer' pattern='${type}(${field} == "${value}", answer == true);' />
    </condition>
    <condition name='Risk pattern exists' type='drools-without-variable-type' field='id' value='CS-Default_::_GENERIC-CLIENT'>
      <pattern name='Risk pattern exists' pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");' />
    </condition>
    <action project='' value='cloud.azure.services_::_Deployment_::_Which Azure services?_::_6510_::_false_::_false_::_' name='Insert Question Group' type='drools-without-variable-type'>
      <pattern name='Action of insert question group' pattern='QuestionGroup group = new QuestionGroup("${value-1}","${value-2}","${value-3}", ${value-4}, "${value-7}"); group.setFlags(${value-5}, ${value-6}); insertLogical(group);' />
    </action>
    <content />
  </rule>
<rule name='Q: Deployed - Public Cloud &amp; MS Azure &amp; Data Store other - *' module='component' generatedByGui='true'>
    <condition name='Question Group exists' type='drools-without-variable-type' field='id' value='cloud.azure.services'>
      <pattern name='Question group exists' pattern='$group : QuestionGroup(id == "${value}") @Watch(!*);' />
    </condition>
    <condition name='Risk pattern exists' type='drools-without-variable-type' field='id' value='CS-Default_::_DATASTORE-OTHER'>
      <pattern name='Risk pattern exists' pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");' />
    </condition>
    <action project='' value='azure.storage_::_Azure Storage_::_' name='Insert Question' type='drools-without-variable-type'>
      <pattern name='Action of insert question' pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));' />
    </action>
    <content />
  </rule>
<rule name='Q: Deployed - Public Cloud &amp; MS Azure &amp; Data Store' module='component' generatedByGui='true'>
    <condition name='Question is answered' type='Question' field='id' value='cloud.azure'>
      <pattern name='Condition with answer' pattern='${type}(${field} == "${value}", answer == true);' />
    </condition>
    <condition name='Risk pattern exists' type='drools-without-variable-type' field='id' value='CS-Default_::_DATASTORE'>
      <pattern name='Risk pattern exists' pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");' />
    </condition>
    <action project='' value='cloud.azure.services_::_Deployment_::_Which Azure services?_::_6510_::_false_::_false_::_' name='Insert Question Group' type='drools-without-variable-type'>
      <pattern name='Action of insert question group' pattern='QuestionGroup group = new QuestionGroup("${value-1}","${value-2}","${value-3}", ${value-4}, "${value-7}"); group.setFlags(${value-5}, ${value-6}); insertLogical(group);' />
    </action>
    <content />
  </rule>
<rule name='Q: Deployed - Public Cloud &amp; MS Azure &amp; Web UI' module='component' generatedByGui='true'>
    <condition name='Question is answered' type='Question' field='id' value='cloud.azure'>
      <pattern name='Condition with answer' pattern='${type}(${field} == "${value}", answer == true);' />
    </condition>
    <condition name='Risk pattern exists' type='drools-without-variable-type' field='id' value='CS-Default_::_BROWSER'>
      <pattern name='Risk pattern exists' pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");' />
    </condition>
    <action project='' value='cloud.azure.services_::_Deployment_::_Which Azure services?_::_6510_::_false_::_false_::_' name='Insert Question Group' type='drools-without-variable-type'>
      <pattern name='Action of insert question group' pattern='QuestionGroup group = new QuestionGroup("${value-1}","${value-2}","${value-3}", ${value-4}, "${value-7}"); group.setFlags(${value-5}, ${value-6}); insertLogical(group);' />
    </action>
    <content />
  </rule>

</rules>

</project>