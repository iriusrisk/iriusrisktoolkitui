<?xml version="1.0" encoding="UTF-8"?>
<!-- Copyright (c) 2012-2019 Continuum Security.  All rights reserved.
The content of this library is the property of Continuum Security SL and may only be used in whole or in part with a valid license for IriusRisk. -->
<project ref="Microsoft-Azure" name="Microsoft-Azure" revision="1" type="LIBRARY" status="OPEN" enabled="true" priority="0" tags="" workflowState="">
    <desc></desc>
    <categoryComponents>
        <categoryComponent ref="microsoft-azure" name="Microsoft Azure"/>
    </categoryComponents>
    <componentDefinitions>
        <componentDefinition ref="microsoft-azure-environment" name="Microsoft Azure Environment" desc="Microsoft Azure. Only select this if the security of the Microsoft Azure environment will be managed in this product." categoryRef="microsoft-azure">
            <riskPatterns>
                <riskPattern ref="AZURE-IDENTITY-AND-ACCESS"/>
                <riskPattern ref="AZURE-NETWORKING-VNETS"/>
                <riskPattern ref="AZURE-MONITORING"/>
                <riskPattern ref="AZURE-LOGS"/>
            </riskPatterns>
        </componentDefinition>
        <componentDefinition ref="azure-virtual-machines" name="Microsoft Azure Virtual Machines" desc="" categoryRef="microsoft-azure">
            <riskPatterns>
                <riskPattern ref="AZURE-VIRTUAL-MACHINES"/>
            </riskPatterns>
        </componentDefinition>
        <componentDefinition ref="azure-storage" name="Microsoft Azure Storage" desc="" categoryRef="microsoft-azure">
            <riskPatterns>
                <riskPattern ref="AZURE-STORAGE"/>
            </riskPatterns>
        </componentDefinition>
        <componentDefinition ref="azure-sql" name="Microsoft Azure SQL" desc="" categoryRef="microsoft-azure">
            <riskPatterns>
                <riskPattern ref="AZURE-SQL"/>
            </riskPatterns>
        </componentDefinition>
    </componentDefinitions>
    <udts/>
    <dataflows/>
    <supportedStandards/>
    <components>
        <component ref="AZURE-IDENTITY-AND-ACCESS" name="Azure Identity &amp; Access" desc="" tags="" position="1" groupName="" library="" diagramPositionX="0" diagramPositionY="0" componentDefinitionRef="">
            <weaknesses>
                <weakness ref="AZURE-MON02" name="Excessive use of administrator accounts" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>The administrator accounts are used for all actions, not only for administrative actions.</desc>
                </weakness>
                <weakness ref="AZ-W04" name="Misconfigured Authentication Method for Administrator Accounts" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>The authentication method 'Multi-factor Authentication' for the
 Administrator accounts are not configured</desc>
                </weakness>
                <weakness ref="LOST-SECURITY-ALERTS" name="Misconfigured Security contact details" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>The security contact details for the Azure subscription are not properly configured.</desc>
                </weakness>
                <weakness ref="LOST-ACCESS-ROOT-01" name="The Root Account is mis-configured" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>The administrator account is not configured. The security question to recover or reset the
 password and the authentication method are not configured.</desc>
                </weakness>
                <weakness ref="AZURE-IDENTITY-03" name="Misconfigured User Account" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>Key security settings such as resetting the password and other password controls are not
 configured.</desc>
                </weakness>
                <weakness ref="AZURE-ACCESS-01" name="Misconfigured credentials for groups and roles" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>The credentials for the groups and roles are not correctly configured and there are user
 accounts with more privileges than the necessary.</desc>
                </weakness>
                <weakness ref="AZURE-EXPIRATION-DATE" name="Misconfigured password expiration" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>The password expiration is not configured and users are not obliged to change their passwords.
 Not change frequently the passwords gives facilities to attackers to obtain them.</desc>
                </weakness>
            </weaknesses>
            <controls>
                <control ref="AZ-A03" name="Create Individual Accounts for the administrator users" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Create an individual account for the administrator users and with this new accounts By creating individual Azure users for people accessing your account, you can give each Azure user a unique set of security credentials. &lt;/p&gt;





 The administrator accounts shall be used for the administrative actions and for giving or revoke credentials to the user&amp;#8217;s account. The administrator account shall be not used as a normal user account. 





 &lt;b&gt;Remediation:&lt;/b&gt; 



 # Log into the Azure portal as an owner. 
 # Select Azure Active Directory. 
 # Go into &amp;#8216;Users and groups&amp;#8217; &gt; &amp;#8216;All users&amp;#8217;. 
 # Select &amp;#8216;Add New User&amp;#8217;. 
 # Fill the required information and click &amp;#8216;Create&amp;#8217;.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Add new users to Azure Active Directory" url="https://docs.microsoft.com/en-us/azure/active-directory/add-users-azure-active-directory"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Log into the Azure portal as an owner.
 # Select Azure Active Directory.
 # Go into &amp;#8216;Users and groups&amp;#8217; &gt; &amp;#8216;All users&amp;#8217;.
 # Check that each user has got a user account assigned.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-A04" name="Enable MFA for Administrator &amp; Co Administrator accounts" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Enable multi-factor authentication (MFA) device enhances the security of the login process for the Administrator accounts. With MFA, users have a device that generates a unique authentication code (a one-time password, or OTP) and users must provide both their normal credentials (like their username and password) and the OTP. &lt;/p&gt;





 The MFA device can either be a special piece of hardware, or it can be a virtual device. The recommendation for the Service Administrator &amp;amp; Co Administrator accounts is to use MFA to increase the level of security of the login process. 





 &lt;b&gt;Remediation:&lt;/b&gt; 



 # Log into the Azure portal as an owner. 
 # Select Azure Active Directory. 
 # Go into &amp;#8216;Users and groups&amp;#8217; &gt; &amp;#8216;All users&amp;#8217;. 
 # Select &amp;#8216;Multi-Factor Authentication&amp;#8217;. 
 # Choose all the Service Administrator &amp;amp; Co Administrator accounts and enable MFA.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - How to require two-step verification for a user or group" url="https://docs.microsoft.com/en-us/azure/multi-factor-authentication/multi-factor-authentication-get-started-user-states"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Log into the Azure portal as an owner.
 # Select Azure Active Directory.
 # Go into &amp;#8216;Users and groups&amp;#8217; &gt; &amp;#8216;All users&amp;#8217;.
 # Select &amp;#8216;Multi-Factor Authentication&amp;#8217;.
 # Check all Administrator accounts have got the MFA flag enabled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-A01" name="Register a Security contact for your Azure account" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Provide the security contact details for the Azure subscription. Microsoft Security Response Center (MSRC) performs security monitoring of the Azure network and infrastructure and receives threat intelligence and abuse complaints from third parties. &lt;/p&gt;





 Microsoft will use this information provided to contact if the MSRC discovers that customer data has been accessed by an unlawful or unauthorized party. Also, this provides the means of ensuring these advisories are routed to the security team, especially if a distribution email address is used. 





 &lt;b&gt;Remediation:&lt;/b&gt; 



 # Access &amp;#8216;Azure Security Center&amp;#8217;. 
 # In the &amp;#8216;Recommendations&amp;#8217; tab choose &amp;#8216;Provide security contact details&amp;#8217;. 
 # Once filled, save changes.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Provide security contact details in Azure Security Center" url="https://docs.microsoft.com/en-us/azure/security-center/security-center-provide-security-contact-details"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Access &amp;#8216;Azure Security Center&amp;#8217;.
 # In the &amp;#8216;Recommendations&amp;#8217; tab choose &amp;#8216;Provide security
 contact details&amp;#8217;.
 # Check that all fields are filled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-A02" name="Configure the security challenge questions for the administrator account" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Activate and configure the security challenge question and the possibility of resetting the password by confirming the user&amp;#8217;s identity is allowed. In case of being an owner account of the subscription that has full administration access, it is necessary to do this, as a security measure that this password is lost. &lt;/p&gt;





 The security confirmation measures will depend on those specified by the Active Directory administrator. Make sure that the security confirmation measures match the security criteria. Otherwise, it could make a weak confirmation and allow the password reset to malicious users. 





 &lt;b&gt;Remediation:&lt;/b&gt; 



 * Using the console: 



 # Open https://aka.ms/ssprsetup and Log into the account. 
 # Respond to security measures. 
 # Once all needed controls are finished, click on accept. 



 * Using the portal: 

 * Log into the Azure portal as an owner. 
 * Select Azure Active Directory. 
 * Select &amp;#8216;Password reset&amp;#8217; &gt; &amp;#8216;Authentication Method&amp;#8217;. 
 * Choose the security confirmation measures that match the security criteria and click &amp;#8216;Save&amp;#8217;.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Azure AD self-service password reset" url="https://docs.microsoft.com/en-us/azure/active-directory/active-directory-passwords-getting-started"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;p&gt;Using the portal:&lt;/p&gt;


 # Log into the Azure portal as an owner.
 # Select Azure Active Directory.
 # Select &amp;#8216;Password reset&amp;#8217; &gt; &amp;#8216;Authentication Method&amp;#8217;.
 # Check that the security confirmation measures and the security criteria are filled
 and enabled.</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-A07" name="Recertify user access" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Do regular reviews of accounts on the system and verify that it doesn&amp;#8217;t exist stoled or fake
 accounts. With this process is ensured that there are not compromised accounts by former
 employees or by attackers.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;





 At least every 90 days complete the following:



 # Log in to the Azure portal as an owner.
 # Select Azure Active Directory.
 # Go into &amp;#8216;Users and groups&amp;#8217; &gt; &amp;#8216;All users&amp;#8217;.
 # For any user that should not exist:
 # Select the user.
 # Click &amp;#8216;Delete&amp;#8217;.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Assign a user or group to an enterprise app in Azure Active Directory" url="https://docs.microsoft.com/en-us/azure/active-directory/active-directory-coreapps-assign-user-azure-portal"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Log in to the Azure portal as an owner.
 # Select Azure Active Directory.
 # Go into &amp;#8216;Users and groups&amp;#8217; &gt; &amp;#8216;All users&amp;#8217;.
 # Check that each user has got an assigned account.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-A08" name="Configure a strong security challenge questions for the user account." platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Activate and configure the security challenge question and the possibility of resetting the
 password by confirming the user&amp;#8217;s identity is allowed. Make sure that the security confirmation
 measures match the security criteria. Otherwise, it could make a weak confirmation and allow thepassword
 reset to malicious users.&lt;/p&gt;





 **Remediation: **



 # Log in to the Azure portal as an owner.
 # Select Azure Active Directory.
 # Select &amp;#8216;Password reset&amp;#8217; &gt; &amp;#8216;Authentication Method&amp;#8217;.
 # Choose the security confirmation measures that match the security criteria and click
 &amp;#8216;Save&amp;#8217;.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Azure AD self-service password reset" url="https://docs.microsoft.com/en-us/azure/active-directory/active-directory-passwords-getting-started"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Log in to the Azure portal as an owner.
 # Select Azure Active Directory.
 # Select &amp;#8216;Password reset&amp;#8217; &gt; &amp;#8216;Authentication Method&amp;#8217;.
 # Check that the security confirmation measures and the security criteria are well
 filled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-A09" name="Apply RBAC with pre-defined policies added into groups or roles" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Define and create groups that relate to job functions (administrators, developers, accounting,
 etc.) and assign the relevant permissions for each group, and then assign IAM users to those
 groups.&lt;/p&gt;





 All the users in an IAM group inherit the permissions assigned to the group. That way, you can
 make changes for everyone in a group in just one place. As people move around in your company,
 you can simply change what IAM group their IAM user belongs to. This method is known as Role
 Based Access Control (RBAC).





 &lt;b&gt;Remediation:&lt;/b&gt;



 * Remove a user from a group:



 # Log into the Azure portal as an owner.
 # Select Azure Active Directory.
 # Go into &amp;#8216;Users and groups&amp;#8217; &gt; &amp;#8216;All users&amp;#8217;.
 # Click on the user name. All the groups the user belongs are there.
 # Choose the group and &amp;#8216;Remove&amp;#8217;.



 * Create a group and add user:



 # Log into the Azure portal as an owner.
 # Select Azure Active Directory.
 # Go into &amp;#8216;Users and groups&amp;#8217; &gt; &amp;#8216;All groups&amp;#8217;.
 # Click &amp;#8216;New Group&amp;#8217; and fill the information.
 # Search and add the user.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Create a group and add members in Azure Active Directory" url="https://docs.microsoft.com/en-us/azure/active-directory/active-directory-groups-create-azure-portal"/>
                        <reference name="MS Azure - Use Role-Based Access Control to manage access to your Azure subscription resources" url="https://docs.microsoft.com/en-us/azure/active-directory/role-based-access-control-configure"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Log into the Azure portal as an owner.
 # Select Azure Active Directory.
 # Go into &amp;#8216;Users and groups&amp;#8217; &gt; &amp;#8216;All users&amp;#8217;.
 # Check that each user has got assigned the correct groups.
 # Go into &amp;#8216;Users and groups&amp;#8217; &gt; &amp;#8216;All groups&amp;#8217;.
 # Check that each group has got assigned the correct roles.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-A10" name="Create mechanisms to ensure the principle of least privilege is applied" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Create the mechanisms to review periodically the group and user permissions to ensure the least
 privilege for the user accounts. Granting least privilege ensures that users only have the
 permissions required to complete their jobs rather than additional privileges that are not
 required.&lt;/p&gt;





 Following this model ensures that, should an account be compromised, the blast radius of damage
 is limited





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Allocate privileges via groups or roles via the recommendation in &amp;#8216;Use RBAC
 with pre-defined policies added into groups or roles&amp;#8217;.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Create a group and add members in Azure Active Directory" url="https://docs.microsoft.com/en-us/azure/active-directory/active-directory-groups-create-azure-portal"/>
                        <reference name="MS Azure - Use Role-Based Access Control to manage access to your Azure subscription resources" url="https://docs.microsoft.com/en-us/azure/active-directory/role-based-access-control-configure"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;p&gt;Check that the principle of least privilege is achieved in the assignation of roles and
 groups to the users.&lt;/p&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-A11" name="Configure roles for the Cloud Service" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Define and create the roles for the Azure Cloud Service. For each role, define the permissions
 and also configure how that role runs. When you launch an Azure instance, you shall specify a
 role for the instance as a launch parameter. Applications that run on the Cloud instance use the
 role&amp;#8217;s credentials when they access Azure resources. This role&amp;#8217;s permissions determine what the
 application is allowed to do.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 * Configure an Azure cloud service from Solution Explorer in Visual Studio.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Use Role-Based Access Control to manage access to your Azure subscription resources" url="https://docs.microsoft.com/en-us/azure/active-directory/role-based-access-control-configure"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;p&gt;Check that the roles for the Cloud Service are well assigned.&lt;/p&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-A12" name="Configure password expiration" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Configure the password expiration to force after a determinate time, the password code shall be
 changed for the users.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Configure password management to match security criteria. This value is configurable
 using the Set-MsolPasswordPolicy cmdlet from the Azure Active Directory Module for Windows
 PowerShell. With the following command as the example:







 Set-MsolPasswordPolicy -ValidityPeriod 60 -NotificationDays 14





 This command updates the tenant so that all users passwords expire after 60
 days. The users receive notification 14 days prior to that expiry.



 More information:
 &lt;a
 href=&amp;#8220;https://docs.microsoft.com/en-us/powershell/module/msonline/set-msolpasswordpolicy?view=azureadps-1.0&amp;#8221;&gt;Doc
 MS Azure&lt;/a&gt;</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Password policies and restrictions in Azure Active Directory" url="https://docs.microsoft.com/en-us/azure/active-directory/active-directory-passwords-policy"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;p&gt;Check that the password expiration has got the correct values. Therefore, we can obtain the
 values using the Get-MsolPasswordPolicy cmdlet from the Azure Active Directory Module for
 Windows PowerShell. With the following command:&lt;/p&gt;






 PS C:\&gt; Get-MsolPasswordPolicy -DomainName contoso.com




 More information:
 &lt;a
 href=&amp;#8220;https://docs.microsoft.com/en-us/powershell/module/msonline/get-msolpasswordpolicy?view=azureadps-1.0&amp;#8221;&gt;Doc
 MS Azure&lt;/a&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
            </controls>
            <usecases>
                <usecase ref="AUTHENTICATION" name="Authentication" desc="" library="">
                    <threats>
                        <threat ref="AZURE-LOST-ACCESS-ROOT" name="Attackers gain unauthorized access to the root account due to the lack of configuration of the account" state="Expose" source="MANUAL" owner="" library="">
                            <desc>	&lt;p&gt;Attackers could gain unauthorized access to the administrator account due to the lack of
 configuration of the account and its security mechanisms, like modifying credentials and
 adding/removing user accounts.&lt;/p&gt;</desc>
                            <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
                            <references/>
                            <controls>
                                <control ref="AZ-A03" mitigation="25"/>
                                <control ref="AZ-A04" mitigation="25"/>
                                <control ref="AZ-A01" mitigation="25"/>
                                <control ref="AZ-A02" mitigation="25"/>
                            </controls>
                            <weaknesses>
                                <weakness ref="AZURE-MON02">
                                    <controls>
                                        <control ref="AZ-A03" mitigation="25"/>
                                    </controls>
                                </weakness>
                                <weakness ref="AZ-W04">
                                    <controls>
                                        <control ref="AZ-A04" mitigation="25"/>
                                    </controls>
                                </weakness>
                                <weakness ref="LOST-SECURITY-ALERTS">
                                    <controls>
                                        <control ref="AZ-A01" mitigation="25"/>
                                    </controls>
                                </weakness>
                                <weakness ref="LOST-ACCESS-ROOT-01">
                                    <controls>
                                        <control ref="AZ-A02" mitigation="25"/>
                                    </controls>
                                </weakness>
                            </weaknesses>
                        </threat>
                        <threat ref="AZURE-LOST-ACCESS-USER" name="Attackers gain unauthorized access to the user account due to the lack of configuration of the account" state="Expose" source="MANUAL" owner="" library="">
                            <desc>	&lt;p&gt;Attackers could gain unauthorized access to the user account due to the lack of
 configuration of the account, like the security question to reset the password was
 configured incorrectly.&lt;/p&gt;</desc>
                            <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
                            <references/>
                            <controls>
                                <control ref="AZ-A07" mitigation="50"/>
                                <control ref="AZ-A08" mitigation="50"/>
                            </controls>
                            <weaknesses>
                                <weakness ref="AZURE-IDENTITY-03">
                                    <controls>
                                        <control ref="AZ-A07" mitigation="50"/>
                                        <control ref="AZ-A08" mitigation="50"/>
                                    </controls>
                                </weakness>
                            </weaknesses>
                        </threat>
                    </threats>
                </usecase>
                <usecase ref="AUTHORIZATION" name="Authorization" desc="" library="">
                    <threats>
                        <threat ref="LOSS-CONTROL_ENV" name="Attackers gain unauthorized access to the control of the environment" state="Expose" source="MANUAL" owner="" library="">
                            <desc>	&lt;p&gt;Attackers could gain unauthorized access to the control of the environment, due of the
 user accounts or role groups are not well defined and configured. Therefore, attackers
 can make changes without the root approval.&lt;/p&gt;</desc>
                            <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
                            <references/>
                            <controls>
                                <control ref="AZ-A09" mitigation="25"/>
                                <control ref="AZ-A10" mitigation="25"/>
                                <control ref="AZ-A11" mitigation="25"/>
                                <control ref="AZ-A12" mitigation="25"/>
                            </controls>
                            <weaknesses>
                                <weakness ref="AZURE-ACCESS-01">
                                    <controls>
                                        <control ref="AZ-A09" mitigation="25"/>
                                        <control ref="AZ-A10" mitigation="25"/>
                                        <control ref="AZ-A11" mitigation="25"/>
                                    </controls>
                                </weakness>
                                <weakness ref="AZURE-EXPIRATION-DATE">
                                    <controls>
                                        <control ref="AZ-A12" mitigation="25"/>
                                    </controls>
                                </weakness>
                            </weaknesses>
                        </threat>
                    </threats>
                </usecase>
            </usecases>
        </component>
        <component ref="AZURE-LOGS" name="Azure Logging" desc="" tags="" position="2" groupName="" library="" diagramPositionX="0" diagramPositionY="0" componentDefinitionRef="">
            <weaknesses>
                <weakness ref="AZURE-LOGS03" name="Audit logs can be deleted" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>There is no external backups of log records. If logs are deleted, there is no way to recover
 them.ed.</desc>
                </weakness>
                <weakness ref="AZURE-LOGS02" name="Non-auditable connections to the web application" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>The status connection or failed attempts cannot be audited because they are not recorded into
 the logs.</desc>
                </weakness>
                <weakness ref="AZURE-LOGS01" name="Non-auditable resource changes" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>The Diagnostic Logs are not activated and configured. Therefore, the changes or the access to
 the resources are not recorded into the logs.</desc>
                </weakness>
            </weaknesses>
            <controls>
                <control ref="AZ-L05" name="Export the Audit Logs to a storage account" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Export the information of Audit Logs to a storage account.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Activity Logs&amp;#8217;.
 # Push the button &amp;#8216;Export&amp;#8217;.
 # Select &amp;#8216;All Regions&amp;#8217;.
 # Select &amp;#8216;Export to a storage account&amp;#8217; and select your account.
 # Select the &amp;#8216;Retention (days)&amp;#8217; as minimum 90 days.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Enable diagnostics logging for web apps in Azure App Service" url="https://docs.microsoft.com/en-us/azure/app-service-web/web-sites-enable-diagnostic-log"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Activity Logs&amp;#8217;.
 # Push the button &amp;#8216;Export&amp;#8217;.
 # Select &amp;#8216;All Regions&amp;#8217;.
 # Select &amp;#8216;Export to a storage account&amp;#8217;.
 # Check that all fields are correctly filled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-L03" name="Enable Detailed error messages" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Enable the detailed error information for HTTP status codes that indicate a failure (status code
 400 or greater) is saved into the logs files. This may contain information that can help
 determine why the server returned the error code.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Go to the Azure portal.
 # Go to the blade for your web app and in &amp;#8216;Monitoring&amp;#8217; &gt;&gt;
 &amp;#8216;Diagnostics logs&amp;#8217;.
 # Enable the &amp;#8216;Detailed error messages&amp;#8217;.
 # Push &amp;#8216;Save&amp;#8217; to save the changes.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Enable diagnostics logging for web apps in Azure App Service" url="https://docs.microsoft.com/en-us/azure/app-service-web/web-sites-enable-diagnostic-log"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Go to the Azure portal.
 # Go to the blade for your web app and in &amp;#8216;Monitoring&amp;#8217; &gt;&gt;
 &amp;#8216;Diagnostics logs&amp;#8217;.
 # Check that the &amp;#8216;Detailed error messages&amp;#8217; is enabled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-L04" name="Enable Failed Request Tracing" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Enable to obtain the detailed information on failed requests, including a trace of the IIS
 components used to process the request and the time taken in each component. This can be useful
 if you are attempting to increase site performance or isolate what is causing a specific HTTP
 error to be returned.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Go to the Azure portal.
 # Go to the blade for your web app and in &amp;#8216;Monitoring&amp;#8217; &gt;&gt;
 &amp;#8216;Diagnostics logs&amp;#8217;.
 # Enable the &amp;#8216;Failed request tracing&amp;#8217;.
 # Push &amp;#8216;Save&amp;#8217; to save the changes.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Enable diagnostics logging for web apps in Azure App Service" url="https://docs.microsoft.com/en-us/azure/app-service-web/web-sites-enable-diagnostic-log"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Go to the Azure portal.
 # Go to the blade for your web app and in &amp;#8216;Monitoring&amp;#8217; &gt;&gt;
 &amp;#8216;Diagnostics logs&amp;#8217;.
 # Check that the &amp;#8216;Failed request tracing&amp;#8217; is enabled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-L01" name="Enable diagnostic logs auditing for Microsoft Azure" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Enable diagnostic logs to give the information over the operations of the resources.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Go to the Azure portal.
 # Go to the blade for your web app and in &amp;#8216;Monitoring&amp;#8217; &gt;&gt;
 &amp;#8216;Diagnostics logs&amp;#8217;.
 # Enable the &amp;#8216;Application Logging (Filesystem)&amp;#8217; and &amp;#8216;Application
 Logging (Blob)&amp;#8217;.
 # Push &amp;#8216;Save&amp;#8217; to save the changes.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Enable diagnostics logging for web apps in Azure App Service" url="https://docs.microsoft.com/en-us/azure/app-service-web/web-sites-enable-diagnostic-log"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Go to the Azure portal.
 # Go to the blade for your web app and in &amp;#8216;Monitoring&amp;#8217; &gt;&gt;
 &amp;#8216;Diagnostics logs&amp;#8217;.
 # Check that &amp;#8216;Application Logging (Filesystem)&amp;#8217; and &amp;#8216;Application
 Logging (Blob)&amp;#8217; are enabled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-L02" name="Enable Web Server Logging" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Enable the Web Server logging to receive information about HTTP transactions using the W3C
 extended log file format. This is useful when determining overall site metrics such as the
 number of requests handled or how many requests are from a specific IP address. There are two
 ways to save the data:&lt;/p&gt;



 * **File system: **stores the application diagnostics information to the
 web app file system. These files can be accessed by FTP, or downloaded as a Zip archive by using
 the Azure PowerShell or Azure Command-Line Interface (Azure CLI).
 * &lt;b&gt;Storage:&lt;/b&gt; stores the application diagnostics information in the
 specified Azure Storage Account and the logs are only accessible with a client account.



 &lt;b&gt;Remediation:&lt;/b&gt;



 # Go to the Azure portal.
 # Go to the blade for your web app and in &amp;#8216;Monitoring&amp;#8217; &gt;&gt;
 &amp;#8216;Diagnostics logs&amp;#8217;.
 # Enable the type &amp;#8216;Storage&amp;#8217; or &amp;#8216;File System&amp;#8217; to
 activate this function.
 # Push &amp;#8216;Save&amp;#8217; to save the changes.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Enable diagnostics logging for web apps in Azure App Service" url="https://docs.microsoft.com/en-us/azure/app-service-web/web-sites-enable-diagnostic-log"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Go to the Azure portal.
 # Go to the blade for your web app and in &amp;#8216;Monitoring&amp;#8217; &gt;&gt;
 &amp;#8216;Diagnostics logs&amp;#8217;.
 # Check that the type &amp;#8216;Storage&amp;#8217; or &amp;#8216;File System&amp;#8217;
 are enabled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
            </controls>
            <usecases>
                <usecase ref="API LOGGING AND AUDITING" name="API Logging and Auditing" desc="" library="">
                    <threats>
                        <threat ref="UNAUDITABLE-CHANGES-AZURE" name="Attackers make undetected and unaudited changes to system configurations" state="Expose" source="MANUAL" owner="" library="">
                            <desc>	&lt;p&gt;If audit trails are not properly protected, an attacker could gain access to the system,
 modify the status of resources or exfiltrate sensitive data without being noticed.&lt;/p&gt;</desc>
                            <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
                            <references/>
                            <controls>
                                <control ref="AZ-L05" mitigation="20"/>
                                <control ref="AZ-L03" mitigation="20"/>
                                <control ref="AZ-L04" mitigation="20"/>
                                <control ref="AZ-L01" mitigation="20"/>
                                <control ref="AZ-L02" mitigation="20"/>
                            </controls>
                            <weaknesses>
                                <weakness ref="AZURE-LOGS03">
                                    <controls>
                                        <control ref="AZ-L05" mitigation="20"/>
                                    </controls>
                                </weakness>
                                <weakness ref="AZURE-LOGS02">
                                    <controls>
                                        <control ref="AZ-L03" mitigation="20"/>
                                        <control ref="AZ-L04" mitigation="20"/>
                                    </controls>
                                </weakness>
                                <weakness ref="AZURE-LOGS01">
                                    <controls>
                                        <control ref="AZ-L01" mitigation="20"/>
                                        <control ref="AZ-L02" mitigation="20"/>
                                    </controls>
                                </weakness>
                            </weaknesses>
                        </threat>
                    </threats>
                </usecase>
            </usecases>
        </component>
        <component ref="AZURE-MONITORING" name="Azure Monitoring" desc="" tags="" position="3" groupName="" library="" diagramPositionX="0" diagramPositionY="0" componentDefinitionRef="">
            <weaknesses>
                <weakness ref="AZURE-MON02" name="Excessive use of administrator accounts" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>The administrator accounts are used for all actions, not only for administrative actions.</desc>
                </weakness>
                <weakness ref="AZURE-MON03" name="Lack of 2FA" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>Log into the console without using the Multi-factor Authentication (MFA) and they are not
 detected. The connection without the MFA must be audited and monitored, the correct security
 group must be informed and they must validate this connection.</desc>
                </weakness>
                <weakness ref="AZURE-MON06" name="Undetected brute force attempts on MS Azure management console" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>The failure connection attempts (brute force) must be audited and monitored and correspondent
 personnel must be alerted and informed.</desc>
                </weakness>
                <weakness ref="AZURE-MON05" name="Undetected changes in data encryption configuration" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>The changes on the database encryption must be audited and monitored. When there are changes
 on the database encryption, the security group must be alerted.</desc>
                </weakness>
                <weakness ref="AZURE-MON04" name="Undetected changes in security groups" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>The changes in security groups must be traced and monitored and the correspondent personnel
 must approve these changes. If the situation is not the correct, attackers can access to
 security systems.</desc>
                </weakness>
                <weakness ref="AZURE-MON01" name="Undetected changes in security configurations" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>Monitoring and alerting for security configurations are not configured and changes cannot be
 detected.</desc>
                </weakness>
                <weakness ref="AZURE-MON07" name="Undetected changes in network configuration" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>Changes in network configurations (NACLs, route and gateway tables) are not detected because
 monitoring and alerting on the network is not configured to detect these changes.</desc>
                </weakness>
            </weaknesses>
            <controls>
                <control ref="AZ-M10" name="Create alerts to notify a bad usage of the root account" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Create alerts for the Activity Logs changes to monitor, audit and notify about the usage of the
 root accounts to the correspondent personnel. It&amp;#8217;s vital that these unauthorized changes are
 detected.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Alerts&amp;#8217;.
 # Push &amp;#8216;Add activity log alert&amp;#8217;.
 # Filling the fields with the corresponding values.
 # Select in actions the personnel should be received this information.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Create activity log alerts" url="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Alerts&amp;#8217;.
 # Check that there is any rule to notify when there is a bad usage of the root
 account.
 # Check if these rules are enabled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-M11" name="Create alerts to notify about the console login without MFA" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Create alerts for Activity Log changes to monitor, audit and notify about the user&amp;#8217;s login into
 the console without Multi-factor Authentication to the correspondent personnel. It&amp;#8217;s vital that
 these unauthorized changes are detected.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Alerts&amp;#8217;.
 # Push &amp;#8216;Add activity log alert&amp;#8217;.
 # Filling the fields with the corresponding values.
 # Select in actions the personnel should be received this information.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Create activity log alerts" url="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Alerts&amp;#8217;.
 # Check that there is any rule to notify when someone tries to login into the
 console without MFA.
 # Check if these rules are enabled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-M05" name="Create alerts to notify the console login failure attempts" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Create alerts for the Activity Logs changes to monitor, audit and notify about the console login
 failure attempts to the correspondent personnel. It&amp;#8217;s vital that these unauthorized changes are
 detected.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Alerts&amp;#8217;.
 # Push &amp;#8216;Add activity log alert&amp;#8217;.
 # Filling the fields with the corresponding values.
 # Select in actions the personnel should be received this information.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Create activity log alerts" url="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Alerts&amp;#8217;.
 # Check that there is any rule to notify when severalconsole login failure
 attempts occur.
 # Check if these rules are enabled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-M04" name="Create alerts due of Transparent Data Encryption Deletion" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Create alerts for the Activity Logs changes to monitor, audit and notify about the changes of
 Transparent Data Encryption to the correspondent personnel. It&amp;#8217;s vital that these unauthorized
 changes are detected.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Alerts&amp;#8217;.
 # Push &amp;#8216;Add activity log alert&amp;#8217;.
 # Filling the fields with the corresponding values.
 # Select in actions the personnel should be received this information.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Create activity log alerts" url="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Alerts&amp;#8217;.
 # Check that there is any rule to alert when the Transparent Data Encryption is
 disabled.
 # Check if these rules are enabled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-M12" name="Create alerts for changes in security groups and in security groups configurations" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Create alerts for the Activity Logs changes to monitor, audit and notify about the changes in
 the security groups or in security groups configurations to the correspondent personnel. It&amp;#8217;s
 vital that these unauthorized changes are detected.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Alerts&amp;#8217;.
 # Push &amp;#8216;Add activity log alert&amp;#8217;.
 # Filling the fields with the corresponding values.
 # Select in actions the personnel should be received this information.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Create activity log alerts" url="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Alerts&amp;#8217;.
 # Check that there is any rule to notify when the security groups or security group
 configurations change.
 # Check if these rules are enabled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-M01" name="Create alerts for changes on Activity Logs configuration" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Create alerts for the Activity Logs changes to monitor, audit and notify about the changes to
 the correspondent personnel. It&amp;#8217;s vital that these unauthorized changes are detected.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Alerts&amp;#8217;.
 # Push &amp;#8216;Add activity log alert&amp;#8217;.
 # Filling the fields with the corresponding values.
 # Select in actions the personnel should be received this information.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Create activity log alerts" url="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Alerts&amp;#8217;.
 # Check that there is any rule to alert when the Activity Logs configuration
 changes.
 # Check if these rules are enabled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-M02" name="Create alerts for security policy changes" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Create alerts for the Activity Logs changes to monitor, audit and notify about the Management
 Security Policies changes to the correspondent personnel. It&amp;#8217;s vital that these unauthorized
 changes are detected.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Alerts&amp;#8217;.
 # Push &amp;#8216;Add activity log alert&amp;#8217;.
 # Filling the fields with the corresponding values.
 # Select in actions the personnel should be received this information.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Create activity log alerts" url="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Alerts&amp;#8217;.
 # Check that there is any rule to alert when the security policy changes.
 # Check if these rules are enabled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-M03" name="Create alerts to detect changes in the recommendation configurations" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Create alerts for the Activity Logs changes to monitor, audit and notify about the changes in
 the recommendation configurations to the correspondent personnel. It&amp;#8217;s vital that these
 unauthorized changes are detected.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Alerts&amp;#8217;.
 # Push &amp;#8216;Add activity log alert&amp;#8217;.
 # Filling the fields with the corresponding values.
 # Select in actions the personnel should be received this information.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Create activity log alerts" url="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Alerts&amp;#8217;.
 # Check that there is any rule to alert when the recommended configuration changes.
 # Check if these rules are enabled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-M09" name="Create alerts to detect changes on activity alerts" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Create alerts for the Activity Logs changes to monitor, audit and notify about the alert
 modifications to the correspondent personnel. It&amp;#8217;s vital that these unauthorized changes are
 detected.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Alerts&amp;#8217;.
 # Push &amp;#8216;Add activity log alert&amp;#8217;.
 # Filling the fields with the corresponding values.
 # Select in actions the personnel should be received this information.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Create activity log alerts" url="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Alerts&amp;#8217;.
 # Check that there is any rule to notify when activity alertschanges.
 # Check if these rules are enabled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-M06" name="Create alerts for VPC NACL changes" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Create alerts for the Activity Logs changes to monitor, audit and notify about the changes in
 the Network Access Control Lists (NACLs) to the correspondent personnel. It&amp;#8217;s vital that these
 unauthorized changes are detected.&lt;/p&gt;





 The Network Access Control Lists (NACLs) control inbound and outbound access to &amp;amp; from
 MS Azure subnets and work like packet filters to protect the network. Therefore alerting on
 changes to NACLs help ensure that the subnets protected by them are not exposed.





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Alerts&amp;#8217;.
 # Push &amp;#8216;Add activity log alert&amp;#8217;.
 # Filling the fields with the corresponding values.
 # Select in actions the personnel should be received this information.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Create activity log alerts" url="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Alerts&amp;#8217;.
 # Check that there is any rule to notify when the VPC NACL changes.
 # Check if these rules are enabled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-M07" name="Create alerts for VPC route table changes" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Create alerts for the Activity Logs changes to monitor, audit and notify about the changes in
 the VPC route tables to the correspondent personnel. It&amp;#8217;s vital that these unauthorized changes
 are detected.&lt;/p&gt;





 VPC route table provides a means of routing network traffic between subnets and via gateways and
 ensures traffic flows via the correct path. Therefore alerting on changes to route tables
 ensuring the traffic continues to flow as expected.





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Alerts&amp;#8217;.
 # Push &amp;#8216;Add activity log alert&amp;#8217;.
 # Filling the fields with the corresponding values.
 # Select in actions the personnel should be received this information.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Create activity log alerts" url="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Alerts&amp;#8217;.
 # Check that there is any rule to notify when the VPC route table changes.
 # Check if these rules are enabled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-M08" name="Create alerts for VPC gateway changes" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Create alerts for the Activity Logs changes to monitor, audit and notify about the changes in
 the VPC gateway tables to the correspondent personnel. It&amp;#8217;s vital that these unauthorized
 changes are detected.&lt;/p&gt;





 VPC gateways are used as a means of sending traffic outside of VPC (ie to the
 internet) and are vital in ensuring traffic flows to correct destination. Therefore alerting on
 changes to VPC gateways ensuring traffic continues to flow as expected via the correct gateway.





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Alerts&amp;#8217;.
 # Push &amp;#8216;Add activity log alert&amp;#8217;.
 # Filling the fields with the corresponding values.
 # Select in actions the personnel should be received this information.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Create activity log alerts" url="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Go to &amp;#8216;Monitor&amp;#8217; and then to &amp;#8216;Alerts&amp;#8217;.
 # Check that there is any rule to notify when the VPC gateway changes.
 # Check if these rules are enabled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
            </controls>
            <usecases>
                <usecase ref="LOG ACTIVITY ALERTS" name="Log Activity alerts" desc="" library="">
                    <threats>
                        <threat ref="UNAUTHORIZED-ACCESS-SYSTEMS" name="Attackers access to the systems without being detected" state="Expose" source="MANUAL" owner="" library="">
                            <desc>	&lt;p&gt;Attackers gain access to the systems and they are not detected and the changes of the
 attackers couldn&amp;#8217;t be audited or detected.&lt;/p&gt;</desc>
                            <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
                            <references/>
                            <controls>
                                <control ref="AZ-M10" mitigation="20"/>
                                <control ref="AZ-M11" mitigation="20"/>
                                <control ref="AZ-M05" mitigation="20"/>
                                <control ref="AZ-M04" mitigation="20"/>
                                <control ref="AZ-M12" mitigation="20"/>
                            </controls>
                            <weaknesses>
                                <weakness ref="AZURE-MON02">
                                    <controls>
                                        <control ref="AZ-M10" mitigation="20"/>
                                    </controls>
                                </weakness>
                                <weakness ref="AZURE-MON03">
                                    <controls>
                                        <control ref="AZ-M11" mitigation="20"/>
                                    </controls>
                                </weakness>
                                <weakness ref="AZURE-MON06">
                                    <controls>
                                        <control ref="AZ-M05" mitigation="20"/>
                                    </controls>
                                </weakness>
                                <weakness ref="AZURE-MON05">
                                    <controls>
                                        <control ref="AZ-M04" mitigation="20"/>
                                    </controls>
                                </weakness>
                                <weakness ref="AZURE-MON04">
                                    <controls>
                                        <control ref="AZ-M12" mitigation="20"/>
                                    </controls>
                                </weakness>
                            </weaknesses>
                        </threat>
                        <threat ref="UNAUTHORIZED-ACCESS-SECURITY-SYSTEMS" name="Attackers gain undetected access to security system configurations" state="Expose" source="MANUAL" owner="" library="">
                            <desc>	&lt;p&gt;Attackers could gain undetected access to security system configurations and the changes
 of the attackers couldn&amp;#8217;t be audited or detected.&lt;/p&gt;</desc>
                            <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
                            <references/>
                            <controls>
                                <control ref="AZ-M01" mitigation="25"/>
                                <control ref="AZ-M02" mitigation="25"/>
                                <control ref="AZ-M03" mitigation="25"/>
                                <control ref="AZ-M09" mitigation="25"/>
                            </controls>
                            <weaknesses>
                                <weakness ref="AZURE-MON01">
                                    <controls>
                                        <control ref="AZ-M01" mitigation="25"/>
                                        <control ref="AZ-M02" mitigation="25"/>
                                        <control ref="AZ-M03" mitigation="25"/>
                                        <control ref="AZ-M09" mitigation="25"/>
                                    </controls>
                                </weakness>
                            </weaknesses>
                        </threat>
                        <threat ref="UNAUTHORIZED-ACCESS-NETWORK" name="Sensitive data is compromised through network access" state="Expose" source="MANUAL" owner="" library="">
                            <desc>	&lt;p&gt;Attackers gain undetected access to network systems and produced changes cannot be
 audited or detected.&lt;/p&gt;</desc>
                            <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
                            <references/>
                            <controls>
                                <control ref="AZ-M06" mitigation="34"/>
                                <control ref="AZ-M07" mitigation="33"/>
                                <control ref="AZ-M08" mitigation="33"/>
                            </controls>
                            <weaknesses>
                                <weakness ref="AZURE-MON07">
                                    <controls>
                                        <control ref="AZ-M06" mitigation="34"/>
                                        <control ref="AZ-M07" mitigation="33"/>
                                        <control ref="AZ-M08" mitigation="33"/>
                                    </controls>
                                </weakness>
                            </weaknesses>
                        </threat>
                    </threats>
                </usecase>
            </usecases>
        </component>
        <component ref="AZURE-NETWORKING-VNETS" name="Azure Networking VNets" desc="" tags="" position="4" groupName="" library="" diagramPositionX="0" diagramPositionY="0" componentDefinitionRef="">
            <weaknesses>
                <weakness ref="AZURE-VNET01" name="Networks for Azure resources are not properly segmentated." state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>Resources in the same VNet are compromised because when one of them is attacked and the
 attackers gain access, they also gain access to all resources.</desc>
                </weakness>
            </weaknesses>
            <controls>
                <control ref="AZ-N08" name="Isolate Azure resources into separate VNets by function" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Place the resources into separate VNets according to their use (production, development, test).
 Placing such resources accordingly ensures that a resource of a higher security level is not
 exposed by the security settings of a lower labeled VNet.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Identify the resources that exist in an incorrect VNet.
 # Migrate or move it to the correct Vnet.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Azure Virtual Network" url="https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-overview"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Identify the resources that exist in an incorrect VNet.
 # Check that the resources are into the correct Vnet.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-N09" name="Isolate Azure instances into different VNets" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Specify a VNet for the Azure instance as a launch parameter. Applications that run on the Cloud
 instance can use the VNet security configuration when they access Azure resources.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;


 You can configure an Azure cloud service from Solution Explorer in Visual Studio.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Create a virtual network with multiple subnets" url="https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-create-vnet-arm-pportal"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;p&gt;Check that the Azure instances are into different VNets.&lt;/p&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
            </controls>
            <usecases>
                <usecase ref="NETWORKING" name="Networking" desc="" library="">
                    <threats>
                        <threat ref="UNAUTHORIZED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="MANUAL" owner="" library="">
                            <desc>	&lt;p&gt;Attackers could gain unauthorized connection to the resources through misconfigured
 ports or security network configurations.&lt;/p&gt;</desc>
                            <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
                            <references/>
                            <controls>
                                <control ref="AZ-N08" mitigation="50"/>
                                <control ref="AZ-N09" mitigation="50"/>
                            </controls>
                            <weaknesses>
                                <weakness ref="AZURE-VNET01">
                                    <controls>
                                        <control ref="AZ-N08" mitigation="50"/>
                                        <control ref="AZ-N09" mitigation="50"/>
                                    </controls>
                                </weakness>
                            </weaknesses>
                        </threat>
                    </threats>
                </usecase>
            </usecases>
        </component>
        <component ref="AZURE-SQL" name="Azure SQL" desc="" tags="" position="5" groupName="" library="" diagramPositionX="0" diagramPositionY="0" componentDefinitionRef="">
            <weaknesses>
                <weakness ref="AZURE-ACCESS-DATA-01" name="Sensitive data is accessible" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>Sensitive data is not encrypted and could be exposed.</desc>
                </weakness>
                <weakness ref="AZURE-LOGS01" name="Non-auditable resource changes" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>The Diagnostic Logs are not activated and configured. Therefore, the changes or the access to
 the resources are not recorded into the logs.</desc>
                </weakness>
                <weakness ref="AZURE-NET-21" name="Unauthorised connection between the client and the SQL database" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>All connections to SQL Database are allowed and the firewall and other security networks methods
 are not configured to deny the connections.</desc>
                </weakness>
            </weaknesses>
            <controls>
                <control ref="AZ-Q03" name="Enable Transparent Data Encryption (TDE) for the SQL database" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Enable the Azure SQL Database transparent data encryption (TDE) and encrypt automatically your
 data at rest, without requiring any changes to the application accessing the encrypted database.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Select SQL databases from the left-hand menu, and click your database on the SQL
 databases page.
 # Click on Transparent data encryption to open the configuration page for TDE.
 # Set Data encryption to ON and click Save.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Transparent Data Encryption for Azure SQL Database and Data Warehouse" url="https://docs.microsoft.com/en-us/sql/relational-databases/security/encryption/transparent-data-encryption-azure-sql"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Select SQL databases from the left-hand menu, and click your database on the SQL
 databases page.
 # Click on Transparent data encryption to open the configuration page for TDE.
 # Check that the Data encryption is enabled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-Q04" name="Enable SQL Database auditing" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Enable Azure SQL Database Auditing to audit the database events into the audit log in your Azure
 Storage account. Auditing can help you maintain regulatory compliance, understand database
 activity, and gain insight into discrepancies and anomalies that could indicate potential
 security violations.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Select SQL databases from the left-hand menu, and click your database on the SQL
 databases page.
 # In the Settings blade, select Auditing &amp;amp; Threat Detection.
 # In the database auditing configuration blade, you can check the Inherit settings from
 server checkbox to designate that this database will be audited according to its server&amp;#8217;s
 settings. If this option is checked, you will see a View server auditing settings link that
 allows you to view or modify the server auditing settings from this context.
 # If you prefer to enable an Audit type (or location?) different from the one specified
 at the server level, uncheck the Inherit Auditing settings from server option, turn ON Auditing,
 and choose the Blob Auditing Type.
 # Select Storage Details to open the Audit Logs Storage Blade. Select the Azure storage
 account where logs will be saved, and the retention period, after which the old logs will be
 deleted, then click OK at the bottom. Tip: Use the same storage account for all audited
 databases to get the most out of the auditing reports templates.
 # If you want to customize the audited events, you can do this via PowerShell or REST
 API &amp;#8211; see the Automation (PowerShell / REST API) section for more details.
 # Click Save.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Get started with SQL database auditing" url="https://docs.microsoft.com/en-us/azure/sql-database/sql-database-auditing"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Select SQL databases from the left-hand menu, and click your database on the SQL
 databases page.
 # In the Settings blade, select Auditing &amp;amp; Threat Detection.
 # Check that the Database Auditing is enabled and correct configured.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-Q05" name="Enable SQL Database threat detection" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Enable SQL Database Threat Detection to provide a new layer of security, which enables customers
 to detect and respond to potential threats as they occur by providing security alerts on
 anomalous activities. Users can explore the suspicious events using SQL Database Auditing to
 determine if the results from an attempt to access, breach or exploit data in the database.
 Threat Detection makes it simple to address potential threats to the database without the need
 to be a security expert or manage advanced security monitoring systems. For example, Threat
 Detection detects certain anomalous database activities indicating potential SQL injection
 attempts. SQL injection is one of the common Web application security issues on the Internet,
 used to attack data-driven applications. Attackers take advantage of application vulnerabilities
 to inject malicious SQL statements into application entry fields, for breaching or modifying
 data in the database.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Navigate to the configuration blade of the SQL database you want to monitor. In the
 Settings blade, select Auditing &amp;amp; Threat Detection.
 # In the Auditing &amp;amp; Threat Detection configuration blade turn ON auditing, which
 will display the threat detection settings.
 # Turn ON threat detection.
 # Configure the list of emails that will receive security alerts upon detection of
 anomalous database activities.
 # Click Save in the Auditing &amp;amp; Threat detection blade to save the new or updated
 auditing and threat detection policy.
 # In the email, click on the Azure SQL Auditing Log link, which will launch the Azure
 portal and show the relevant auditing records around the time of the suspicious event.
 # Click on the audit records to view more details on the suspicious database activities
 such as SQL statement, failure reason, and client IP.
 # In the Auditing Records blade, click Open in Excel to open a pre-configured excel
 template to import and run a deeper analysis of the audit log around the time of the suspicious
 event.
 # To configure the Fast Combine setting &amp;#8211; In the POWER QUERY ribbon tab, select Options
 to display the Options dialog. Select the Privacy section and choose the second option &amp;#8211; &amp;#8216;Ignore
 the Privacy Levels and potentially improve performance&amp;#8217;.
 # To load SQL audit logs, ensure that the parameters in the settings tab are set
 correctly and then select the &amp;#8216;Data&amp;#8217; ribbon and click the &amp;#8216;Refresh All&amp;#8217; button.
 # The results appear in the SQL Audit Logs sheet which enables you to run a deeper
 analysis of the anomalous activities that were detected, and mitigate the impact of the security
 event in your application.&amp;#8217;</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - SQL Database Threat Detection" url="https://docs.microsoft.com/en-us/azure/sql-database/sql-database-threat-detection"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Select SQL databases from the left-hand menu, and click your database on the SQL
 databases page.
 # In the Settings blade, select Auditing &amp;amp; Threat Detection.
 # Check that the Database Threat Detection is enabled and correct configured.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-Q01" name="Restrict network access to the database" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Set up the firewall rules for the SQL databases in Azure. By default, all connections to the
 server and the databases inside the server are rejected except for connections from other Azure
 services. Set the secure configuration &amp;#8216;Allow access to Azure services&amp;#8217; to OFF. To connect to
 the database from an Azure VM or cloud service, create a Reserved IP and allow only the reserved
 IP address access through the firewall.&lt;/p&gt;


 ****


 &lt;b&gt;Remediation:&lt;/b&gt;



 # Log in to the Azure portal.
 # Click SQL databases from the left-hand menu and click the database you would like to
 configure the firewall rule for on the SQL databases page. The overview page for your database
 opens, showing you the fully qualified server name (such as
 mynewserver-20170313.database.windows.net) and provides options for further configuration.
 # Click Set server firewall on the toolbar as shown in the previous image. The Firewall
 settings page for the SQL Database server opens.
 # Click Add client IP on the toolbar to add the public IP address of the computer
 connected to the portal with or enter the firewall rule manually and then click Save.
 # Click OK and then click the X to close the Firewall settings page.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Azure SQL Database server-level and database-level firewall rules" url="https://docs.microsoft.com/en-us/azure/sql-database/sql-database-firewall-configure"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Log in to the Azure portal.
 # Click SQL databases from the left-hand menu and click the database you would like
 to configure the firewall rule for on the SQL databases page. The overview page for your
 database opens, showing you the fully qualified server name (such as
 mynewserver-20170313.database.windows.net) and provides options for further configuration.
 # Click Set server firewall on the toolbar as shown in the previous image.
 # Check that the firewall for the Database SQL is correctly configured.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-Q02" name="Encrypt the communication channel to your database" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Configure and encrypt the string connection between the client and SQL Database with the
 following configuration:&lt;/p&gt;



 * request an encrypted connection
 * to not trust the server certificate



 This established connection usesTransport Layer Security (TLS) and reduces the risk of
 man-in-the-middle attacks. Obtain the correctly configured connection strings for your SQL
 Database for supported client drivers from the Azure portal as shown for ADO.net in this
 screenshot.





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Select SQL databases from the left-hand menu, and click your database on the SQL
 databases page.
 # On the Overview page for your database, click Show database connection strings.
 # Review the complete ADO.NET connection string.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Securing your SQL Database" url="https://docs.microsoft.com/en-us/azure/sql-database/sql-database-security-overview"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Select SQL databases from the left-hand menu, and click your database on the SQL
 databases page.
 # On the Overview page for your database, click Show database connection strings.
 # Check that the complete ADO.NET connection string is correctly configured.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
            </controls>
            <usecases>
                <usecase ref="ACCESS DATA" name="Access Data" desc="" library="">
                    <threats>
                        <threat ref="ACCESS-TO-DATA" name="Sensitive data is compromised through unauthorized access to SQL databases" state="Expose" source="MANUAL" owner="" library="">
                            <desc>	&lt;p&gt;Attackers gain unauthorized connection to the SQL database resources through
 misconfigured ports or security network configurations.&lt;/p&gt;</desc>
                            <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
                            <references/>
                            <controls>
                                <control ref="AZ-Q03" mitigation="100"/>
                            </controls>
                            <weaknesses>
                                <weakness ref="AZURE-ACCESS-DATA-01">
                                    <controls>
                                        <control ref="AZ-Q03" mitigation="100"/>
                                    </controls>
                                </weakness>
                            </weaknesses>
                        </threat>
                    </threats>
                </usecase>
                <usecase ref="API LOGGING AND AUDITING" name="API Logging and Auditing" desc="" library="">
                    <threats>
                        <threat ref="UNAUDITABLE-CHANGES-AZURE" name="Attackers make undetected and unaudited changes to system configurations" state="Expose" source="MANUAL" owner="" library="">
                            <desc>	&lt;p&gt;If audit trails are not properly protected, an attacker could gain access to the system,
 modify the status of resources or exfiltrate sensitive data without being noticed.&lt;/p&gt;</desc>
                            <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
                            <references/>
                            <controls>
                                <control ref="AZ-Q04" mitigation="50"/>
                                <control ref="AZ-Q05" mitigation="50"/>
                            </controls>
                            <weaknesses>
                                <weakness ref="AZURE-LOGS01">
                                    <controls>
                                        <control ref="AZ-Q04" mitigation="50"/>
                                        <control ref="AZ-Q05" mitigation="50"/>
                                    </controls>
                                </weakness>
                            </weaknesses>
                        </threat>
                    </threats>
                </usecase>
                <usecase ref="NETWORKING" name="Networking" desc="" library="">
                    <threats>
                        <threat ref="UNAUTHORIZED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="MANUAL" owner="" library="">
                            <desc>	&lt;p&gt;Attackers could gain unauthorized connection to the resources through misconfigured
 ports or security network configurations.&lt;/p&gt;</desc>
                            <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
                            <references/>
                            <controls>
                                <control ref="AZ-Q01" mitigation="50"/>
                                <control ref="AZ-Q02" mitigation="50"/>
                            </controls>
                            <weaknesses>
                                <weakness ref="AZURE-NET-21">
                                    <controls>
                                        <control ref="AZ-Q01" mitigation="50"/>
                                        <control ref="AZ-Q02" mitigation="50"/>
                                    </controls>
                                </weakness>
                            </weaknesses>
                        </threat>
                    </threats>
                </usecase>
            </usecases>
        </component>
        <component ref="AZURE-STORAGE" name="Azure Storage" desc="" tags="" position="6" groupName="" library="" diagramPositionX="0" diagramPositionY="0" componentDefinitionRef="">
            <weaknesses>
                <weakness ref="AZURE-ACCESS-DATA-01" name="Sensitive data is accessible" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>Sensitive data is not encrypted and could be exposed.</desc>
                </weakness>
                <weakness ref="AZURE-LOGS01" name="Non-auditable resource changes" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>The Diagnostic Logs are not activated and configured. Therefore, the changes or the access to
 the resources are not recorded into the logs.</desc>
                </weakness>
            </weaknesses>
            <controls>
                <control ref="AZ-S01" name="Enable the Storage Service Encryption (SSE) for data at Rest" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Enable Azure Storage Service Encryption (SSE) for Data at Rest to protect and safeguard the
 data. With this feature, Azure Storage automatically encrypts the data prior to persisting to
 storage and decrypts prior to retrieval. The encryption, decryption, and key management are
 totally transparent to users.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Log into the Azure portal and select a storage account. On the Settings blade, look
 for the Blob Service section as shown in this screenshot and click Encryption.
 # After you click the Encryption setting, you can enable or disable Storage Service
 Encryption.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Azure Storage Service Encryption for Data at Rest" url="https://docs.microsoft.com/en-us/azure/storage/common/storage-service-encryption"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Log into the Azure portal and select a storage account. On the Settings blade,
 look for the Blob Service section as shown in this screenshot and click Encryption.
 # After you click the Encryption setting, check that the Storage Service Encryption
 is enabled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-S02" name="Enable Azure Storage metrics" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Enable Storage Metrics to configure the monitoring alerts via the Azure portal or Windows
 PowerShell, or programmatically via one of the storage client libraries. Configure a retention
 period for the metrics data: this period determines for how long the storage service keeps the
 metrics and charges you for the space required to store them.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Navigate to your storage account.
 # Select Diagnostics on the Menu blade.
 # Ensure that Status is set to On.
 # Select the metrics for the services you wish to monitor.
 # Specify a retention policy to indicate how long to retain metrics and log data.
 # Select Save.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Enabling Azure Storage metrics and viewing metrics data" url="https://docs.microsoft.com/en-us/azure/storage/common/storage-enable-and-view-metrics"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Navigate to your storage account.
 # Select Diagnostics on the Menu blade.
 # Check that the Status is enabled.
 # Select the metrics for the services you wish to monitor.
 # Check that all fields are correctly configured and filled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
            </controls>
            <usecases>
                <usecase ref="ACCESS DATA" name="Access Data" desc="" library="">
                    <threats>
                        <threat ref="ACCESS-TO-DATA" name="Sensitive data is compromised through unauthorized access to SQL databases" state="Expose" source="MANUAL" owner="" library="">
                            <desc>	&lt;p&gt;Attackers gain unauthorized connection to the SQL database resources through
 misconfigured ports or security network configurations.&lt;/p&gt;</desc>
                            <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
                            <references/>
                            <controls>
                                <control ref="AZ-S01" mitigation="100"/>
                            </controls>
                            <weaknesses>
                                <weakness ref="AZURE-ACCESS-DATA-01">
                                    <controls>
                                        <control ref="AZ-S01" mitigation="100"/>
                                    </controls>
                                </weakness>
                            </weaknesses>
                        </threat>
                    </threats>
                </usecase>
                <usecase ref="API LOGGING AND AUDITING" name="API Logging and Auditing" desc="" library="">
                    <threats>
                        <threat ref="UNAUDITABLE-CHANGES-AZURE" name="Attackers make undetected and unaudited changes to system configurations" state="Expose" source="MANUAL" owner="" library="">
                            <desc>	&lt;p&gt;If audit trails are not properly protected, an attacker could gain access to the system,
 modify the status of resources or exfiltrate sensitive data without being noticed.&lt;/p&gt;</desc>
                            <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
                            <references/>
                            <controls>
                                <control ref="AZ-S02" mitigation="100"/>
                            </controls>
                            <weaknesses>
                                <weakness ref="AZURE-LOGS01">
                                    <controls>
                                        <control ref="AZ-S02" mitigation="100"/>
                                    </controls>
                                </weakness>
                            </weaknesses>
                        </threat>
                    </threats>
                </usecase>
            </usecases>
        </component>
        <component ref="AZURE-VIRTUAL-MACHINES" name="Azure Virtual Machines" desc="" tags="" position="7" groupName="" library="" diagramPositionX="0" diagramPositionY="0" componentDefinitionRef="">
            <weaknesses>
                <weakness ref="AZURE-VM02" name="Undetected changes in Virtual Machine configurations" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>The changes in virtual machines configurations are not detected because the monitorization and
 alerts of the security configuration are not configured.</desc>
                </weakness>
                <weakness ref="AZURE-LOGS03" name="Audit logs can be deleted" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>There is no external backups of log records. If logs are deleted, there is no way to recover
 them.ed.</desc>
                </weakness>
                <weakness ref="AZURE-VM01" name="Exposed security policies for the resources" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>The security policies are not configured and the security configurations are exposed for the
 attackers.</desc>
                </weakness>
                <weakness ref="AZURE-NET-05" name="Communication is not allowed from/to Virtual Machines" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>IP allocation of virtual machines, DNS resolution, and node monitorization is performed by a
 Microsoft host node. It is necessary to allow the communication with this virtual IP to be able
 to make the communication from/to the virtual machine of Azure.</desc>
                </weakness>
                <weakness ref="AZURE-NET-04" name="Unauthorised connection attempts on Azure resources" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>Receiving unauthorized connections to Azure resources is most likely to be receiving an
 attack. To avoid this, access to the network must be as restricted as possible using Network
 Access Control Lists for blacklisting.</desc>
                </weakness>
                <weakness ref="AZURE-NET-01" name="Unauthorised connection attempts on open ports" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>Receiving unauthorized connections to open ports is most likely to be receiving an attack. To
 avoid this, access to the network must be as restricted as possible, so that only the necessary
 ports are open and the minimum inbound traffic is accepted.</desc>
                </weakness>
                <weakness ref="AZURE-NET-02" name="Unauthorised connection attempts on port 22" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>Receiving unauthorized connections to port 22 is most likely to be receiving an SSH attack. To
 avoid this, access to the network must be as restricted as possible, so that only the necessary
 ports are open and the minimum inbound traffic is accepted.</desc>
                </weakness>
                <weakness ref="AZURE-NET-03" name="Unauthorised connection attempts on port 3389" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>Receiving unauthorized connections to port 3389 is most likely to be receiving an RDP attack.
 To avoid this, access to the network must be as restricted as possible, so that only the
 necessary ports are open and the minimum inbound traffic is accepted.</desc>
                </weakness>
                <weakness ref="AZURE-VM-NOT_LICENSE" name="Unlicensed Virtual Machines" state="0" impact="100">
                    <test expiryDate="" expiryPeriod="0">
                        <steps></steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                    <desc>Azure is a system formed by Microsoft machines, therefore, it is necessary that Microsoft
 perform periodic verification of the licenses of the products.</desc>
                </weakness>
            </weaknesses>
            <controls>
                <control ref="AZ-V03" name="Create alerts for Virtual Machines" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Create alerts based on specific performance metrics:&lt;/p&gt;



 # Notify to the correspondent personnel when the average CPU usage exceeds a certain
 threshold.
 # Notify to the correspondent personnel when the available free disk space drops below a
 certain amount,
 # Notify to the correspondent personnel when the security configuration of the Virtual
 Machines changes.






 &lt;b&gt;Remediation:&lt;/b&gt;



 # In the Azure portal, click Resource Groups, select myResourceGroup, and then select
 myVM in the resource list.
 # Click Alert rules on the VM blade, then click Add metric alert across the top of the
 alerts blade.
 # Provide a Name for your alert, such as myAlertRule
 # To trigger an alert when CPU percentage exceeds 1.0 for five minutes, leave all the
 other defaults selected.
 # Optionally, check the box for Email owners, contributors, and readers to send an email
 notification. The default action is to present a notification in the portal.
 # Click the OK button.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Microsoft Azure Virtual Machine Monitoring with Azure Diagnostics Extension" url="https://azure.microsoft.com/en-us/blog/windows-azure-virtual-machine-monitoring-with-wad-extension/"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then
 select myVM in the resource list.
 # Click Alert rules on the VM blade.
 # Check there are some metric alerts and they are correctly configured and enabled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-V01" name="Set up data collection" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Set up the Security Center Data Collection to create an Azure storage account to hold the
 collected data.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # On the Security Center dashboard, click Security policy, and then select your
 subscription.
 # For Data collection, select On.
 # To create a storage account, select Choose a storage account. Then, select OK.
 # On the Security Policy blade, select Save.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Data collection in Azure Security Center" url="https://docs.microsoft.com/en-us/azure/security-center/security-center-enable-data-collection"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;On the Security Center dashboard, click Security policy, and then select your
 subscription.
 # Check that the Data collection is enabled and correctly configured.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-V02" name="Set up the security policy" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Set up the security policies to define the items for which Security Center collects data and
 makes recommendations. Apply different security policies to different sets of Azure resources.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # On the Security Center dashboard, select Security policy, and then select your
 subscription.
 # Select Prevention policy.
 # Turn on or turn off policy items that you want to apply to all Azure resources.
 # When you&amp;#8217;re finished selecting your settings, select OK.
 # On the Security policy blade, select Save.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - Set security policies in Azure Security Center" url="https://docs.microsoft.com/en-us/azure/security-center/security-center-policies"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;On the Security Center dashboard, select Security policy, and then select your
 subscription.
 # Select Prevention policy.
 # Check that the required policy items are enabled.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-N05" name="Allow Virtual IP of the Microsoft host node" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Allow inbound accesses in Network Security Groups from the IP address 168.63.129.16 to
 communicate with the Azure Service. This IP belongs to Microsoft and acts as DHCP server, DNS
 server and monitoring the host node hosting the Azure Virtual Machine.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Log into the Azure portal as an owner.
 # Select Network Security Groups.
 # Choose the NSG to edit (or create a new one).
 # In &amp;#8216;Inbound security rules&amp;#8217;: Allow IP 168.63.129.16 inbound traffic.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Log into the Azure portal as an owner.
 # Select Network Security Groups.
 # Choose the NSG to edit (or create a new one).
 # In &amp;#8216;Inbound security rules&amp;#8217;, check that the IP 168.63.129.16
 inbound traffic is allowed.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-N07" name="Use Network Access Control Lists (NACLs) for blacklisting" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Use Network Access Control Lists (NACLs) as a method of blacklisting IP addresses to filters the
 traffic across endpoints to allow or deny traffic per pre-created rules.&lt;/p&gt;





 **Remediation: **



 # Log into the Azure portal as an owner.
 # Select &amp;#8216;Network security groups&amp;#8217;.
 # Select the Network Security Group (NSG) for your virtual machine and click on &amp;#8216;Inbound
 security rules&amp;#8217;.
 # Add a DENY rule that will restrict inbound access from a blacklisted IP address or
 range to a designated port or port range.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Log into the Azure portal as an owner.
 # Select &amp;#8216;Network security groups&amp;#8217;.
 # Select the Network Security Group (NSG) for your virtual machine and click on
 &amp;#8216;Inbound security rules&amp;#8217;.
 # Check that there is a rule to deny the inbound access from a blacklisted IP
 address or range to a designated port or port range.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-N01" name="Set Network Security Groups to be as restrictive as possible" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
 resources. Set the limit all the traffic (ingress/egress) on the NSG in order to force the use
 of least privilege into the NSG.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Identify Azure resources for each NSG.
 # Create a set of least privilege NSG for those resources.
 # Place the resources in those security groups.
 # Change the inbound/outbound security rules to fulfill the least privilege.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Check that each Azure resources has got their Network Security Groups.
 # Check that a set of these groups achieve with the principle of the least
 privilege.
 # Check that the inbound/outbound security rules are enabled and correctly
 configured.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-N02" name="Use Network Security Groups to block inbound port traffic from 0.0.0.0/0" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
 resources. Set the limit inbound access to all TCP or all ports to avoid undue exposure to risk.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Log into the Azure portal as an owner.
 # Select Network Security Groups.
 # Choose the NSG to edit (or create a new one).
 # In &amp;#8216;Inbound security rules&amp;#8217;:



 * Remove all rules that allow port traffic.
 * Add a rule to deny port traffic</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Log into the Azure portal as an owner.
 # Select Network Security Groups.
 # Choose the NSG to view one of them.
 # In &amp;#8216;Inbound security rules&amp;#8217;, check that all the traffic from
 0.0.0.0/0 is are blocked.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-N04" name="Use Network Security Groups to block ingress to port 22 from 0.0.0.0/0" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
 resources. Set the limit inbound access to port 22 (Secure Desk) to IP addresses that require
 this access to avoid undue exposure to risk.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Log into the Azure portal as an owner.
 # Select Network Security Groups.
 # Choose the NSG to edit (or create a new one).
 # In &amp;#8216;Inbound security rules&amp;#8217;:





 * Allow SSH port traffic just to/from IPs that require the access.
 * Otherwise, remove all rules that allow port 22 traffic.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Log into the Azure portal as an owner.
 # Select Network Security Groups.
 # Choose the NSG to view one of them.
 # In &amp;#8216;Inbound security rules&amp;#8217;, check that the traffic through the
 port 22 is blocked.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-N03" name="Use Network Security Groups to block ingress to port 3389 from 0.0.0.0/0" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
 resources. Set the limit inbound access to port 3389 (Remote Desk Protocol) to IP addresses that
 require this access to avoid undue exposure to risk.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Log into the Azure portal as an owner.
 # Select Network Security Groups.
 # Choose the NSG to edit (or create a new one).
 # In &amp;#8216;Inbound security rules&amp;#8217;:





 * Allow RDP port traffic just to/from IPs that require the access.
 * Otherwise, remove all rules that allow port 3389 traffic.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Log into the Azure portal as an owner.
 # Select Network Security Groups.
 # Choose the NSG to view one of them.
 # In &amp;#8216;Inbound security rules&amp;#8217;, check that the traffic through the
 port 3389 is blocked.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
                <control ref="AZ-N06" name="Allow Key Management Service request" platform="" cost="1" risk="0" state="Recommended" owner="" library="" source="MANUAL">
                    <desc>	&lt;p&gt;Allow Key Management Service host server to handle the periodic request to ensure Microsoft
 licensing. Set the limit outbound access to port 1688 (Service Request) in the Network Security
 Groups to avoid undue exposure to risk.&lt;/p&gt;





 &lt;b&gt;Remediation:&lt;/b&gt;



 # Log into the Azure portal as an owner.
 # Select Network Security Groups.
 # Choose the NSG to edit (or create a new one).
 # In &amp;#8216;Outbound security rules&amp;#8217;: Allow port 1688 outbound traffic.</desc>
                    <implementations/>
                    <references>
                        <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
                    </references>
                    <standards/>
                    <udts/>
                    <test expiryDate="" expiryPeriod="0">
                        <steps>	&lt;ol&gt;
		&lt;li&gt;Log into the Azure portal as an owner.
 # Select Network Security Groups.
 # Choose the NSG to view one of them.
 # In &amp;#8216;Inbound security rules&amp;#8217;, check that the traffic outbound
 through the port 1688 is allowed.&lt;/li&gt;
	&lt;/ol&gt;</steps>
                        <notes></notes>
                        <references/>
                        <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2019-11-11T13:16:58">
                            <output></output>
                        </source>
                        <udts/>
                    </test>
                </control>
            </controls>
            <usecases>
                <usecase ref="ACTIVITY LOGS ALERTS" name="Activity Logs alerts" desc="" library="">
                    <threats>
                        <threat ref="UNAUTHORIZED-ACCESS-VIRTUAL-MACHINES" name="Attackers gain undetected access to the system by changing Virtual Machine configurations " state="Expose" source="MANUAL" owner="" library="">
                            <desc>	&lt;p&gt;Attackers can gain undetected access to the virtual machine configurations and the
 changes of the attackers couldn&amp;#8217;t be audited or detected.&lt;/p&gt;</desc>
                            <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
                            <references/>
                            <controls>
                                <control ref="AZ-V03" mitigation="100"/>
                            </controls>
                            <weaknesses>
                                <weakness ref="AZURE-VM02">
                                    <controls>
                                        <control ref="AZ-V03" mitigation="100"/>
                                    </controls>
                                </weakness>
                            </weaknesses>
                        </threat>
                    </threats>
                </usecase>
                <usecase ref="API LOGGING AND AUDITING" name="API Logging and Auditing" desc="" library="">
                    <threats>
                        <threat ref="UNAUDITABLE-CHANGES-AZURE" name="Attackers make undetected and unaudited changes to system configurations" state="Expose" source="MANUAL" owner="" library="">
                            <desc>	&lt;p&gt;If audit trails are not properly protected, an attacker could gain access to the system,
 modify the status of resources or exfiltrate sensitive data without being noticed.&lt;/p&gt;</desc>
                            <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
                            <references/>
                            <controls>
                                <control ref="AZ-V01" mitigation="100"/>
                            </controls>
                            <weaknesses>
                                <weakness ref="AZURE-LOGS03">
                                    <controls>
                                        <control ref="AZ-V01" mitigation="100"/>
                                    </controls>
                                </weakness>
                            </weaknesses>
                        </threat>
                    </threats>
                </usecase>
                <usecase ref="GENERAL" name="General" desc="" library="">
                    <threats>
                        <threat ref="UNCONFIGURED-SECURITY" name="Attackers gain access to the system by exploiting weak security configurations" state="Expose" source="MANUAL" owner="" library="">
                            <desc>	&lt;p&gt;If audit trails are not properly protected, an attacker could gain access to the
 system, modify the status of resources or exfiltrate sensitive data without being
 noticed.&lt;/p&gt;</desc>
                            <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
                            <references/>
                            <controls>
                                <control ref="AZ-V02" mitigation="100"/>
                            </controls>
                            <weaknesses>
                                <weakness ref="AZURE-VM01">
                                    <controls>
                                        <control ref="AZ-V02" mitigation="100"/>
                                    </controls>
                                </weakness>
                            </weaknesses>
                        </threat>
                    </threats>
                </usecase>
                <usecase ref="NETWORKING" name="Networking" desc="" library="">
                    <threats>
                        <threat ref="UNAUTHORISED-CONNECTION" name="Attackers gain access to the system through direct access to Virtual Machines" state="Expose" source="MANUAL" owner="" library="">
                            <desc>	&lt;p&gt;Attackers can gain unauthorized connection to the Virtual Machines through misconfigured
 ports or security network configurations.&lt;/p&gt;</desc>
                            <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
                            <references/>
                            <controls>
                                <control ref="AZ-N05" mitigation="17"/>
                                <control ref="AZ-N07" mitigation="17"/>
                                <control ref="AZ-N01" mitigation="17"/>
                                <control ref="AZ-N02" mitigation="17"/>
                                <control ref="AZ-N04" mitigation="16"/>
                                <control ref="AZ-N03" mitigation="16"/>
                            </controls>
                            <weaknesses>
                                <weakness ref="AZURE-NET-05">
                                    <controls>
                                        <control ref="AZ-N05" mitigation="17"/>
                                    </controls>
                                </weakness>
                                <weakness ref="AZURE-NET-04">
                                    <controls>
                                        <control ref="AZ-N07" mitigation="17"/>
                                    </controls>
                                </weakness>
                                <weakness ref="AZURE-NET-01">
                                    <controls>
                                        <control ref="AZ-N01" mitigation="17"/>
                                        <control ref="AZ-N02" mitigation="17"/>
                                    </controls>
                                </weakness>
                                <weakness ref="AZURE-NET-02">
                                    <controls>
                                        <control ref="AZ-N04" mitigation="16"/>
                                    </controls>
                                </weakness>
                                <weakness ref="AZURE-NET-03">
                                    <controls>
                                        <control ref="AZ-N03" mitigation="16"/>
                                    </controls>
                                </weakness>
                            </weaknesses>
                        </threat>
                    </threats>
                </usecase>
                <usecase ref="PATCHING" name="Patching" desc="" library="">
                    <threats>
                        <threat ref="UNAUTHZ-SERVICES-NOT-UPDATE" name="Attackers gain access to the system exploiting a known vulnerability" state="Expose" source="MANUAL" owner="" library="">
                            <desc>	&lt;p&gt;Attackers can gain access to the systems because the security patches for each system
 have not been applied or the licenses of the products have expired.&lt;/p&gt;</desc>
                            <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
                            <references/>
                            <controls>
                                <control ref="AZ-N06" mitigation="100"/>
                            </controls>
                            <weaknesses>
                                <weakness ref="AZURE-VM-NOT_LICENSE">
                                    <controls>
                                        <control ref="AZ-N06" mitigation="100"/>
                                    </controls>
                                </weakness>
                            </weaknesses>
                        </threat>
                    </threats>
                </usecase>
            </usecases>
        </component>
    </components>
    <rules>
        <rule name="C-Modify: Deployment - Data Store SQL - Azure SQL &amp; VM" module="component" generatedByGui="true">
            <condition name="Question is answered" type="Question" field="id" value="azure.sql">
                <pattern name="Condition with answer" pattern='${type}(${field} == "${value}", answer == true);'/>
            </condition>
            <action project="Microsoft-Azure" value="Microsoft-Azure_::_AZURE-SQL_::_Microsoft-Azure_::_AZURE-SQL_::_API LOGGING AND AUDITING_::_UNAUDITABLE-CHANGES-AZURE_::_AZ-Q04_::_25" name="Modify Mitigation Value" type="drools-without-variable-type">
                <pattern name="Action of modify mitigation value" pattern='insertLogical(RiskMitigationModifier.setMitigationValue("${value-1}", "${value-2}", "${value-6}", "${value-7}", "${value-8}"));'/>
            </action>
        </rule>
        <rule name="nan" module="nan" generatedByGui="true"/>
        <rule name="Q: Deployed - Public Cloud &amp; MS Azure &amp; All" module="nan" generatedByGui="true">
            <condition name="Question is answered" type="Question" field="id" value="azure.virtualMachines">
                <pattern name="Condition with answer" pattern='${type}(${field} == "${value}", answer == true);'/>
            </condition>
            <condition name="Risk pattern exists" type="drools-without-variable-type" field="id" value="CS-Default_::_DATABASE-SQL">
                <pattern name="Risk pattern exists" pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");'/>
            </condition>
            <condition name="Conclusion exists" type="drools-without-variable-type" field="id" value="trust.zone.public.cloud">
                <pattern name="Conclusion exists" pattern='Conclusion(id == "${value}");'/>
            </condition>
            <action project="Microsoft-Azure" value="Microsoft-Azure_::_AZURE-SQL_::_Microsoft-Azure_::_AZURE-SQL_::_API LOGGING AND AUDITING_::_UNAUDITABLE-CHANGES-AZURE_::_AZ-Q05_::_25" name="Modify Mitigation Value" type="drools-without-variable-type">
                <pattern name="Action of modify mitigation value" pattern='insertLogical(RiskMitigationModifier.setMitigationValue("${value-1}", "${value-2}", "${value-6}", "${value-7}", "${value-8}"));'/>
            </action>
            <action project="Microsoft-Azure" value="Microsoft-Azure_::_AZURE-VIRTUAL-MACHINES_::_Microsoft-Azure_::_AZURE-VIRTUAL-MACHINES_::_API LOGGING AND AUDITING_::_UNAUDITABLE-CHANGES-AZURE_::_AZ-V01_::_50" name="Modify Mitigation Value" type="drools-without-variable-type">
                <pattern name="Action of modify mitigation value" pattern='insertLogical(RiskMitigationModifier.setMitigationValue("${value-1}", "${value-2}", "${value-6}", "${value-7}", "${value-8}"));'/>
            </action>
            <action project="Microsoft-Azure" value="Microsoft-Azure_::_AZURE-VIRTUAL-MACHINES_::_Microsoft-Azure_::_AZURE-VIRTUAL-MACHINES_::_NETWORKING_::_UNAUTHORISED-CONNECTION_::_AZ-N05_::_20" name="Modify Mitigation Value" type="drools-without-variable-type">
                <pattern name="Action of modify mitigation value" pattern='insertLogical(RiskMitigationModifier.setMitigationValue("${value-1}", "${value-2}", "${value-6}", "${value-7}", "${value-8}"));'/>
            </action>
            <action project="Microsoft-Azure" value="Microsoft-Azure_::_AZURE-VIRTUAL-MACHINES_::_Microsoft-Azure_::_AZURE-VIRTUAL-MACHINES_::_NETWORKING_::_UNAUTHORISED-CONNECTION_::_AZ-N07_::_20" name="Modify Mitigation Value" type="drools-without-variable-type">
                <pattern name="Action of modify mitigation value" pattern='insertLogical(RiskMitigationModifier.setMitigationValue("${value-1}", "${value-2}", "${value-6}", "${value-7}", "${value-8}"));'/>
            </action>
            <action project="" value="cloud.azure_::_Microsoft Azure_::_" name="Insert Question" type="drools-without-variable-type">
                <pattern name="Action of insert question" pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));'/>
            </action>
        </rule>
        <rule name="Q: Deployed - Public Cloud &amp; MS Azure &amp; Client" module="nan" generatedByGui="true">
            <condition name="Question Group exists" type="drools-without-variable-type" field="id" value="publicCloud">
                <pattern name="Question group exists" pattern='$group : QuestionGroup(id == "${value}") @Watch(!*);'/>
            </condition>
            <condition name="Question is answered" type="Question" field="id" value="cloud.azure">
                <pattern name="Condition with answer" pattern='${type}(${field} == "${value}", answer == true);'/>
            </condition>
            <action project="" value="cloud.azure.services_::_Deployment_::_Which Azure services?_::_6510_::_false_::_false_::_" name="Insert Question Group" type="drools-without-variable-type">
                <pattern name="Action of insert question group" pattern='QuestionGroup group = new QuestionGroup("${value-1}","${value-2}","${value-3}", ${value-4}, "${value-7}"); group.setFlags(${value-5}, ${value-6}); insertLogical(group);'/>
            </action>
        </rule>
        <rule name="Q: Deployed - Public Cloud &amp; MS Azure &amp; Client - *" module="nan" generatedByGui="true">
            <condition name="Risk pattern exists" type="drools-without-variable-type" field="id" value="CS-Default_::_GENERIC-CLIENT">
                <pattern name="Risk pattern exists" pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");'/>
            </condition>
            <condition name="Question Group exists" type="drools-without-variable-type" field="id" value="cloud.azure.services">
                <pattern name="Question group exists" pattern='$group : QuestionGroup(id == "${value}") @Watch(!*);'/>
            </condition>
            <action project="" value="azure.virtualMachines_::_Azure Virtual Machines_::_" name="Insert Question" type="drools-without-variable-type">
                <pattern name="Action of insert question" pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));'/>
            </action>
        </rule>
        <rule name="Q: Deployed - Public Cloud &amp; MS Azure &amp; Data Store" module="component" generatedByGui="true">
            <condition name="Risk pattern exists" type="drools-without-variable-type" field="id" value="CS-Default_::_GENERIC-CLIENT">
                <pattern name="Risk pattern exists" pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");'/>
            </condition>
            <condition name="Question is answered" type="Question" field="id" value="cloud.azure">
                <pattern name="Condition with answer" pattern='${type}(${field} == "${value}", answer == true);'/>
            </condition>
            <action project="" value="cloud.azure.services_::_Deployment_::_Which Azure services?_::_6510_::_false_::_false_::_" name="Insert Question Group" type="drools-without-variable-type">
                <pattern name="Action of insert question group" pattern='QuestionGroup group = new QuestionGroup("${value-1}","${value-2}","${value-3}", ${value-4}, "${value-7}"); group.setFlags(${value-5}, ${value-6}); insertLogical(group);'/>
            </action>
        </rule>
        <rule name="Q: Deployed - Public Cloud &amp; MS Azure &amp; Data Store NoSQL - *" module="nan" generatedByGui="true">
            <condition name="Risk pattern exists" type="drools-without-variable-type" field="id" value="CS-Default_::_DATASTORE">
                <pattern name="Risk pattern exists" pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");'/>
            </condition>
            <condition name="Question Group exists" type="drools-without-variable-type" field="id" value="cloud.azure.services">
                <pattern name="Question group exists" pattern='$group : QuestionGroup(id == "${value}") @Watch(!*);'/>
            </condition>
            <action project="" value="azure.storage_::_Azure Storage_::_" name="Insert Question" type="drools-without-variable-type">
                <pattern name="Action of insert question" pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));'/>
            </action>
        </rule>
        <rule name="Q: Deployed - Public Cloud &amp; MS Azure &amp; Data Store other - *" module="component" generatedByGui="true">
            <condition name="Risk pattern exists" type="drools-without-variable-type" field="id" value="CS-Default_::_DATABASE-NOSQL">
                <pattern name="Risk pattern exists" pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");'/>
            </condition>
            <condition name="Question Group exists" type="drools-without-variable-type" field="id" value="cloud.azure.services">
                <pattern name="Question group exists" pattern='$group : QuestionGroup(id == "${value}") @Watch(!*);'/>
            </condition>
            <action project="" value="azure.storage_::_Azure Storage_::_" name="Insert Question" type="drools-without-variable-type">
                <pattern name="Action of insert question" pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));'/>
            </action>
        </rule>
        <rule name="Q: Deployed - Public Cloud &amp; MS Azure &amp; Data Store SQL - *" module="nan" generatedByGui="true">
            <condition name="Risk pattern exists" type="drools-without-variable-type" field="id" value="CS-Default_::_DATASTORE-OTHER">
                <pattern name="Risk pattern exists" pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");'/>
            </condition>
            <condition name="Question Group exists" type="drools-without-variable-type" field="id" value="cloud.azure.services">
                <pattern name="Question group exists" pattern='$group : QuestionGroup(id == "${value}") @Watch(!*);'/>
            </condition>
            <action project="" value="azure.sql_::_Azure SQL_::_" name="Insert Question" type="drools-without-variable-type">
                <pattern name="Action of insert question" pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));'/>
            </action>
        </rule>
        <rule name="Q: Deployed - Public Cloud &amp; MS Azure &amp; Service" module="component" generatedByGui="true">
            <condition name="Risk pattern exists" type="drools-without-variable-type" field="id" value="CS-Default_::_DATABASE-SQL">
                <pattern name="Risk pattern exists" pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");'/>
            </condition>
            <condition name="Question is answered" type="Question" field="id" value="cloud.azure">
                <pattern name="Condition with answer" pattern='${type}(${field} == "${value}", answer == true);'/>
            </condition>
            <action project="" value="azure.virtualMachines_::_Azure Virtual Machines_::_" name="Insert Question" type="drools-without-variable-type">
                <pattern name="Action of insert question" pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));'/>
            </action>
            <action project="" value="cloud.azure.services_::_Deployment_::_Which Azure services?_::_6510_::_false_::_false_::_" name="Insert Question Group" type="drools-without-variable-type">
                <pattern name="Action of insert question group" pattern='QuestionGroup group = new QuestionGroup("${value-1}","${value-2}","${value-3}", ${value-4}, "${value-7}"); group.setFlags(${value-5}, ${value-6}); insertLogical(group);'/>
            </action>
        </rule>
        <rule name="Q: Deployed - Public Cloud &amp; MS Azure &amp; Service - *" module="nan" generatedByGui="true">
            <condition name="Risk pattern exists" type="drools-without-variable-type" field="id" value="CS-Default_::_GENERIC-SERVICE">
                <pattern name="Risk pattern exists" pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");'/>
            </condition>
            <condition name="Question Group exists" type="drools-without-variable-type" field="id" value="cloud.azure.services">
                <pattern name="Question group exists" pattern='$group : QuestionGroup(id == "${value}") @Watch(!*);'/>
            </condition>
            <action project="" value="azure.virtualMachines_::_Azure Virtual Machines_::_" name="Insert Question" type="drools-without-variable-type">
                <pattern name="Action of insert question" pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));'/>
            </action>
        </rule>
        <rule name="Q: Deployed - Public Cloud &amp; MS Azure &amp; Web UI" module="component" generatedByGui="true">
            <condition name="Risk pattern exists" type="drools-without-variable-type" field="id" value="CS-Default_::_GENERIC-SERVICE">
                <pattern name="Risk pattern exists" pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");'/>
            </condition>
            <condition name="Question is answered" type="Question" field="id" value="cloud.azure">
                <pattern name="Condition with answer" pattern='${type}(${field} == "${value}", answer == true);'/>
            </condition>
            <action project="" value="cloud.azure.services_::_Deployment_::_Which Azure services?_::_6510_::_false_::_false_::_" name="Insert Question Group" type="drools-without-variable-type">
                <pattern name="Action of insert question group" pattern='QuestionGroup group = new QuestionGroup("${value-1}","${value-2}","${value-3}", ${value-4}, "${value-7}"); group.setFlags(${value-5}, ${value-6}); insertLogical(group);'/>
            </action>
        </rule>
        <rule name="Q: Deployed - Public Cloud &amp; MS Azure &amp; Web UI - *" module="nan" generatedByGui="true">
            <condition name="Risk pattern exists" type="drools-without-variable-type" field="id" value="CS-Default_::_BROWSER">
                <pattern name="Risk pattern exists" pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");'/>
            </condition>
            <condition name="Question Group exists" type="drools-without-variable-type" field="id" value="cloud.azure.services">
                <pattern name="Question group exists" pattern='$group : QuestionGroup(id == "${value}") @Watch(!*);'/>
            </condition>
            <action project="" value="azure.virtualMachines_::_Azure Virtual Machines_::_" name="Insert Question" type="drools-without-variable-type">
                <pattern name="Action of insert question" pattern='insertLogical(new Question($group, "${value-1}", "${value-2}", "${value-3}"));'/>
            </action>
        </rule>
        <rule name="Risk Pattern: Azure SQL" module="component" generatedByGui="true">
            <condition name="Risk pattern exists" type="drools-without-variable-type" field="id" value="CS-Default_::_BROWSER">
                <pattern name="Risk pattern exists" pattern='$riskPattern : ImportWholeRiskPatternAwareDto(libraryRef == "${value-1}",riskPatternRef == "${value-2}");'/>
            </condition>
            <condition name="Question is answered" type="Question" field="id" value="azure.sql">
                <pattern name="Condition with answer" pattern='${type}(${field} == "${value}", answer == true);'/>
            </condition>
            <action project="Microsoft-Azure" value="Microsoft-Azure_::_AZURE-SQL" name="Import Risk Pattern" type="drools-without-variable-type">
                <pattern name="Action of import a risk pattern" pattern='insertLogical(ImportRiskPatternFactory.importRiskPattern("${value-1}", "${value-2}", 50));'/>
            </action>
        </rule>
        <rule name="Risk Pattern: Azure Storage" module="nan" generatedByGui="true">
            <condition name="Question is answered" type="Question" field="id" value="azure.storage">
                <pattern name="Condition with answer" pattern='${type}(${field} == "${value}", answer == true);'/>
            </condition>
            <action project="Microsoft-Azure" value="Microsoft-Azure_::_AZURE-STORAGE" name="Import Risk Pattern" type="drools-without-variable-type">
                <pattern name="Action of import a risk pattern" pattern='insertLogical(ImportRiskPatternFactory.importRiskPattern("${value-1}", "${value-2}", 50));'/>
            </action>
        </rule>
        <rule name="Risk Pattern: Azure Virtual Machines" module="component" generatedByGui="true">
            <condition name="Question is answered" type="Question" field="id" value="azure.virtualMachines">
                <pattern name="Condition with answer" pattern='${type}(${field} == "${value}", answer == true);'/>
            </condition>
            <action project="Microsoft-Azure" value="Microsoft-Azure_::_AZURE-VIRTUAL-MACHINES" name="Import Risk Pattern" type="drools-without-variable-type">
                <pattern name="Action of import a risk pattern" pattern='insertLogical(ImportRiskPatternFactory.importRiskPattern("${value-1}", "${value-2}", 50));'/>
            </action>
        </rule>
        <rule name="Set Answer: MS Azure Environment --&gt; Public Cloud" module="nan" generatedByGui="true">
            <condition name="Is specific component definition" type="drools-without-variable-type" field="id" value="microsoft-azure-environment">
                <pattern name="Is specific component definition" pattern='ComponentDefinitionProperties(ref == "${value}");'/>
            </condition>
            <action project="" value="Public Cloud_::_true_::_true" name="Answer Question" type="drools-without-variable-type">
                <pattern name="Action of answer question" pattern='$questionToAnswer : Question(id == "${value-1}", answer != ${value-2}); eval(!${value-3} || !$questionToAnswer.isManuallyModified());_:::_modify($questionToAnswer) { setAnswer(${value-2}), setCanBeManuallyModified(${value-3}) };'/>
            </action>
        </rule>
        <rule name="Set Answer: Set Public Cloud when MS Azure SQL is selected" module="component" generatedByGui="true">
            <condition name="Is specific component definition" type="drools-without-variable-type" field="id" value="azure-sql">
                <pattern name="Is specific component definition" pattern='ComponentDefinitionProperties(ref == "${value}");'/>
            </condition>
            <action project="" value="Public Cloud_::_true_::_true" name="Answer Question" type="drools-without-variable-type">
                <pattern name="Action of answer question" pattern='$questionToAnswer : Question(id == "${value-1}", answer != ${value-2}); eval(!${value-3} || !$questionToAnswer.isManuallyModified());_:::_modify($questionToAnswer) { setAnswer(${value-2}), setCanBeManuallyModified(${value-3}) };'/>
            </action>
        </rule>
        <rule name="Set Answer: Set Public Cloud when MS Azure Storage is selected" module="nan" generatedByGui="true">
            <condition name="Is specific component definition" type="drools-without-variable-type" field="id" value="azure-storage">
                <pattern name="Is specific component definition" pattern='ComponentDefinitionProperties(ref == "${value}");'/>
            </condition>
            <action project="" value="Public Cloud_::_true_::_true" name="Answer Question" type="drools-without-variable-type">
                <pattern name="Action of answer question" pattern='$questionToAnswer : Question(id == "${value-1}", answer != ${value-2}); eval(!${value-3} || !$questionToAnswer.isManuallyModified());_:::_modify($questionToAnswer) { setAnswer(${value-2}), setCanBeManuallyModified(${value-3}) };'/>
            </action>
        </rule>
        <rule name="Set Answer: Set Public Cloud when MS Azure Virtual Machines is selected" module="component" generatedByGui="true">
            <condition name="Is specific component definition" type="drools-without-variable-type" field="id" value="azure-virtual-machines">
                <pattern name="Is specific component definition" pattern='ComponentDefinitionProperties(ref == "${value}");'/>
            </condition>
            <action project="" value="Public Cloud_::_true_::_true" name="Answer Question" type="drools-without-variable-type">
                <pattern name="Action of answer question" pattern='$questionToAnswer : Question(id == "${value-1}", answer != ${value-2}); eval(!${value-3} || !$questionToAnswer.isManuallyModified());_:::_modify($questionToAnswer) { setAnswer(${value-2}), setCanBeManuallyModified(${value-3}) };'/>
            </action>
        </rule>
    </rules>
</project>
