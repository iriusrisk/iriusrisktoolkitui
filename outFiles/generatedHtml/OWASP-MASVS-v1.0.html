<!DOCTYPE html><html><head><title>Risk Patterns for OWASP-MASVS-v1.0.xml</title><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous"><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script></head><body><center><h2>Risk patterns for OWASP-MASVS-v1.0.xml<h2></center><div class="accordion" id="components"><div class="card border-primary"><div class="card-header " id="heading21"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse21" aria-expanded="true" aria-controls="collapse21">Risk pattern: Android Client <span>[ANDROID-CLIENT]</span></button></h5></div><div id="collapse21" class="collapse" aria-labelledby="heading21" data-parent="#components"><div class="card-body">A device running Android. This risk pattern is imported when we have a mobile device, and the client application runs in an android operating system.<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading12"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse12" aria-expanded="true" aria-controls="collapse12">Use case: General <span>[GENERAL]</span></button></h5></div><div id="collapse12" class="collapse" aria-labelledby="heading12" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading11"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse11" aria-expanded="true" aria-controls="collapse11">Threat: An attacker attempts to invoke all common switches and options to discover weaknesses  <span>[CAPEC-133]</span></button></h5></div><div id="collapse11" class="collapse" aria-labelledby="heading11" data-parent="#threats"><div class="card-body">An attacker attempts to invoke all common switches and options in the target
                                application for the purpose of discovering weaknesses in the target. For example, in
                                some applications, adding the --debug switch causes debugging information to be
                                displayed, which can sometimes reveal sensitive processing or configuration information
                                to an attacker.&nbsp;
                                <div>
                                <br />
                                </div>
                                <div>
                                This attack differs from other forms of API abuse in that the attacker is blindly
                                attempting to invoke options in the hope that one of them will work rather than
                                specifically targeting a known option. Nonetheless, even if the attacker is familiar
                                with the published options of a targeted application this attack method may still be
                                fruitful as it might discover unpublicized functionality.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading4"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse4" aria-expanded="true" aria-controls="collapse4">Weakness: Information Exposure Through Debug Information <span>[CWE-215]</span></button></h5></div><div id="collapse4" class="collapse" aria-labelledby="heading4" data-parent="#weaknesses"><div class="card-body">The application contains debugging code that can expose sensitive information to untrusted parties.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading0"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse0" aria-expanded="true" aria-controls="collapse0">Countermeasure: Disable the debug flags in the release mode <span>[MASVS-7.2]</span></button></h5></div><div id="collapse0" class="collapse" aria-labelledby="heading0" data-parent="#controls"><div class="card-body">The android:debuggable attribute in the Application element in the manifest determines whether or not the app can be debugged when running on a user mode build of Android. This attribute shall be set to false to disable the debug mode.</div></div></div><div class="card border-success"><div class="card-header " id="heading1"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse1" aria-expanded="true" aria-controls="collapse1">Countermeasure: Remove or obfuscate the debugging symbols from native binaries <span>[MASVS-7.3]</span></button></h5></div><div id="collapse1" class="collapse" aria-labelledby="heading1" data-parent="#controls"><div class="card-body">As a general rule of thumb, as little explanative information as possible should be provided along with the compiled code. Some metadata such as debugging information, line numbers and descriptive function or method names make the binary or bytecode easier to understand for the reverse engineer, but isn't actually needed in a release build and can therefore be safely discarded without impacting the functionality of the app. This data shall be removed from the release version or shall be obfuscated in order to be inaccessible to the reverse engineer.</div></div></div><div class="card border-success"><div class="card-header " id="heading2"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse2" aria-expanded="true" aria-controls="collapse2">Countermeasure: Insert the condition DEVELOPER-MODE to remove the debugging code, log verbose errors or debugging messages in the production version <span>[MASVS-7.4]</span></button></h5></div><div id="collapse2" class="collapse" aria-labelledby="heading2" data-parent="#controls"><div class="card-body">Insert the policy in the if statement with DEVELOPER_MODE as condition. The DEVELOPER_MODE has to be disabled for release build in order to disable StrictMode too.&nbsp; 
<div> 
 <br /> 
</div> 
<div>
  Remove the debugging code, log verbose errors or debugging messages in the production version. 
</div></div></div></div><div class="card border-success"><div class="card-header " id="heading3"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse3" aria-expanded="true" aria-controls="collapse3">Countermeasure: Implement functionality to notify when anti-debugging mechanisms are presented within the app <span>[MASVS-8.2]</span></button></h5></div><div id="collapse3" class="collapse" aria-labelledby="heading3" data-parent="#controls"><div class="card-body">Implement anti-debugging mechanisms to prohibit debug mode being activated. Anti-debugging features can be preventive or reactive. As the name implies, preventive anti-debugging techniques prevent the debugger from attaching in the first place, while reactive techniques attempt to detect whether a debugger is present and react to it in some way (e.g. terminating the app, or triggering some kind of hidden behavior).&nbsp; 
<div> 
 <br /> 
</div> 
<div>
  The &quot;more-is-better&quot; rule applies: To maximize effectiveness, defenders combine multiple methods of prevention and detection which operate on different API layers and are distributed throughout the app. 
</div></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading6"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse6" aria-expanded="true" aria-controls="collapse6">Weakness: Leftover Debug Code <span>[CWE-489]</span></button></h5></div><div id="collapse6" class="collapse" aria-labelledby="heading6" data-parent="#weaknesses"><div class="card-body">The application can be deployed with active debugging code that can create unintended entry
                        points.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading5"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse5" aria-expanded="true" aria-controls="collapse5">Countermeasure: Insert the condition DEVELOPER-MODE to remove the debugging code, log verbose errors or debugging messages in the production version <span>[MASVS-7.4]</span></button></h5></div><div id="collapse5" class="collapse" aria-labelledby="heading5" data-parent="#controls"><div class="card-body">Insert the policy in the if statement with DEVELOPER_MODE as condition. The DEVELOPER_MODE has to be disabled for release build in order to disable StrictMode too.&nbsp; 
<div> 
 <br /> 
</div> 
<div>
  Remove the debugging code, log verbose errors or debugging messages in the production version. 
</div></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading10"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse10" aria-expanded="true" aria-controls="collapse10">Weakness: Reliance on Security Through Obscurity <span>[CWE-656]</span></button></h5></div><div id="collapse10" class="collapse" aria-labelledby="heading10" data-parent="#weaknesses"><div class="card-body">The software uses a protection mechanism whose strength depends heavily on its obscurity, such
                        that knowledge of its algorithms or key data is sufficient to defeat the mechanism.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading7"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse7" aria-expanded="true" aria-controls="collapse7">Countermeasure: Activate the Free Security Features <span>[MASVS-7.8]</span></button></h5></div><div id="collapse7" class="collapse" aria-labelledby="heading7" data-parent="#controls"><div class="card-body">For Android:&nbsp; 
<div> 
 <ul> 
  <li>We shall activate the Obfuscation of the code and strip unneeded debugging information.&nbsp;</li> 
 </ul>For iOS:&nbsp; 
</div> 
<div> 
 <ul> 
  <li>We shall activate:&nbsp;</li> 
  <ul> 
   <li>ARC (Automatic Reference Counting): memory management feature, adds retain and release messages when required.&nbsp;</li> 
   <li>Stack Canary: helps prevent buffer overflow attacks.&nbsp;</li> 
   <li>PIE (Position Independent Executable): enables full ASLR for binary.</li> 
  </ul> 
 </ul> 
</div></div></div></div><div class="card border-success"><div class="card-header " id="heading8"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse8" aria-expanded="true" aria-controls="collapse8">Countermeasure: Encrypt and pack all executable files and libraries belonging to the app <span>[MASVS-8.8]</span></button></h5></div><div id="collapse8" class="collapse" aria-labelledby="heading8" data-parent="#controls"><div class="card-body">Ensure that all executable files and libraries belonging to the app are encrypted on the file level and/or important code and data segments inside the executables are encrypted or packed.</div></div></div><div class="card border-success"><div class="card-header " id="heading9"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse9" aria-expanded="true" aria-controls="collapse9">Countermeasure: Obfuscate all executable files, libraries, important code and data segments <span>[MASVS-8.9]</span></button></h5></div><div id="collapse9" class="collapse" aria-labelledby="heading9" data-parent="#controls"><div class="card-body">Obfuscation is the process of transforming code and data in order to make it more difficult to comprehend. It is an integral part of every software protection scheme.</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading20"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse20" aria-expanded="true" aria-controls="collapse20">Use case: Provide mobile access to services <span>[PROVIDE MOBILE ACCESS TO SERVICES]</span></button></h5></div><div id="collapse20" class="collapse" aria-labelledby="heading20" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading19"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse19" aria-expanded="true" aria-controls="collapse19">Threat: Malicious applications gain access to unauthorised data or perform unauthorised actions <span>[CAPEC-1-ANDROID]</span></button></h5></div><div id="collapse19" class="collapse" aria-labelledby="heading19" data-parent="#threats"><div class="card-body">Attackers could use malicious mobile applications to attack legitimate applications
                                that export their components improperly. The attacks and consequences of improperly
                                exporting a component may depend on the exported component: If access to an exported
                                Activity is not restricted, any application will be able to launch the activity.&nbsp;
                                <div>
                                <br />
                                </div>
                                <div>
                                This may allow a malicious application to gain access to sensitive information, modify
                                the internal state of the application, or trick a user into interacting with the victim
                                application whilst believing they are still interacting with the malicious application.
                                If access to an exported Service is not restricted, any application may start and bind
                                to the Service.&nbsp;
                                </div>
                                <div>
                                <br />
                                </div>
                                <div>
                                Depending on the exposed functionality, this may allow a malicious application to
                                perform unauthorized actions, gain access to sensitive information, or corrupt the
                                internal state of the application. If access to a Content Provider is not restricted to
                                only the expected applications, then malicious applications might be able to access the
                                sensitive data. Note that in Android before 4.2, the Content Provider is automatically
                                exported unless it has been explicitly declared as NOT exported.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading16"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse16" aria-expanded="true" aria-controls="collapse16">Weakness: Incorrect Permission Assignment for Critical Resource <span>[CWE-732]</span></button></h5></div><div id="collapse16" class="collapse" aria-labelledby="heading16" data-parent="#weaknesses"><div class="card-body">The software specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.

When a resource is given a permission setting that provides access to a wider range of actors than required, it could lead to the exposure of sensitive information, or the modification of that resource by unintended parties. This is especially dangerous when the resource is related to program configuration, execution or sensitive user data.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading13"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse13" aria-expanded="true" aria-controls="collapse13">Countermeasure: Access to an exported Activity should be restricted <span>[CAPEC-1-ANDROID]</span></button></h5></div><div id="collapse13" class="collapse" aria-labelledby="heading13" data-parent="#controls"><div class="card-body">Any application on the mobile device will be able to launch an exported Activity if it is not
                        explicitly restricted. This may allow a malicious application to gain access to sensitive
                        information, modify the internal state of the application, or trick a user into interacting with
                        the victim application whilst they are still interacting with the malicious application
                        (comparable to framing or clickjacking attacks).
                        Access to an exported Activity must be restricted.
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading14"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse14" aria-expanded="true" aria-controls="collapse14">Countermeasure: Access to a Content Provider should be restricted <span>[CAPEC-1-ANDROID-CONT]</span></button></h5></div><div id="collapse14" class="collapse" aria-labelledby="heading14" data-parent="#controls"><div class="card-body">Malicious applications on the mobile device may be able to access a Content Provider, and
                        sensitive data it has access to, if it is not properly restricted to only the expected
                        applications.
                        Explicitly restrict access to Content Providers to expected applications.
                        Note that prior to Android 4.2, the Content Provider was automatically exported unless
                        explicitly declared as NOT exported.
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading15"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse15" aria-expanded="true" aria-controls="collapse15">Countermeasure: Access to an exported Service should be restricted <span>[CAPEC-1-ANDROID-SRV]</span></button></h5></div><div id="collapse15" class="collapse" aria-labelledby="heading15" data-parent="#controls"><div class="card-body">Malicious applications on the mobile device may be able to start and bind to an exported
                        Service if access is not properly restricted. Depending on the exposed functionality, this may
                        allow a malicious application to perform unauthorized actions, gain access to sensitive
                        information, or corrupt the internal state of the application.
                        Restrict access to start and bind to an exported Service to authorized applications only
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading18"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse18" aria-expanded="true" aria-controls="collapse18">Weakness: Input to exported activities, intents or content providers is not validated <span>[CWE-20]</span></button></h5></div><div id="collapse18" class="collapse" aria-labelledby="heading18" data-parent="#weaknesses"><div class="card-body">The product does not validate or incorrectly validates input that can affect the control flow
                        or data flow of a program.

                        When software does not validate input properly, an attacker is able to craft the input in a form
                        that is not expected by the rest of the application. This will lead to parts of the system
                        receiving unintended input, which may result in altered control flow, arbitrary control of a
                        resource, or arbitrary code execution.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading17"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse17" aria-expanded="true" aria-controls="collapse17">Countermeasure: Validate all input data sent to exported activities, intents or content providers <span>[CWE-20]</span></button></h5></div><div id="collapse17" class="collapse" aria-labelledby="heading17" data-parent="#controls"><div class="card-body">All data received from the client-side should be considered tainted and a potential risk,
                        regardless of the source or transport method. This affects all application platforms, including
                        mobile. All data from the client side must be subjected to strict validation, sanitization, and
                        encoding against expected syntactic and semantic criteria.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        Define a specification of the data that is expected at each input; both the syntax (e.g.
                        alphanumeric only) and semantics (e.g. a word of between 1 and 25 characters, or a specific
                        list). As an example of business rule logic, &quot;boat&quot; may be syntactically valid
                        because it only contains alphanumeric characters, but it is not valid if the input is only
                        expected to contain colors such as &quot;red&quot; or &quot;blue.&quot;&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        Implement a 'known good' or white-list approach, where only inputs that meet the strict criteria
                        for each input are accepted, and reject, transform, or encapsulate any non-compliant data. While
                        useful for identifying malicious content, do not rely on looking for specific malformed or
                        attack payloads (blacklists). It is almost impossible to maintain a comprehensive and accurate
                        blacklist due to the complexity and evolving nature of attacks, opportunities to obfuscate
                        payloads, and changes to the code's execution environment. As noted, blacklists can be useful
                        for detecting and logging potential attacks, or determining which inputs are so malformed that
                        they should be rejected outright. Validate all data received from the client, including values
                        such as HTTP headers and cookie values if these are used as input on the server side, X-
                        headers, and other platform specific data objects passed between the client and server.&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        This validation and sanitization must be performed in context, for example, data sent to an SQL
                        database must be escaped for SQL special characters whereas data sent as part of a shell command
                        must be escaped for shell special characters.
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading34"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse34" aria-expanded="true" aria-controls="collapse34">Risk pattern: Android Client: Sensitive data <span>[ANDROID-CLIENT: SENS-DATA]</span></button></h5></div><div id="collapse34" class="collapse" aria-labelledby="heading34" data-parent="#components"><div class="card-body">A device running Android. This risk pattern is imported when we have a mobile device, and the client application runs in an android operating system and the application reads, stores and sends sensitive data.<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading33"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse33" aria-expanded="true" aria-controls="collapse33">Use case: Provide mobile access to services <span>[PROVIDE MOBILE ACCESS TO SERVICES]</span></button></h5></div><div id="collapse33" class="collapse" aria-labelledby="heading33" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading24"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse24" aria-expanded="true" aria-controls="collapse24">Threat: Attackers can gain access to the application with the serialized objects injection <span>[CAPEC-586]</span></button></h5></div><div id="collapse24" class="collapse" aria-labelledby="heading24" data-parent="#threats"><div class="card-body">An adversary attempts to exploit an application by injecting additional, malicious
                                content during its processing of serialized objects. Developers leverage serialization
                                in order to convert data or state into a static, binary format for saving to disk or
                                transferring over a network. These objects are then deserialized when needed to recover
                                the data/state. By injecting a malformed object into a vulnerable application, an
                                adversary can potentially compromise the application by manipulating the deserialization
                                process. This can result in a number of unwanted outcomes, including remote code
                                execution.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading23"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse23" aria-expanded="true" aria-controls="collapse23">Weakness: Deserialization of Untrusted Data <span>[CWE-502]</span></button></h5></div><div id="collapse23" class="collapse" aria-labelledby="heading23" data-parent="#weaknesses"><div class="card-body">The application deserializes untrusted data without sufficiently verifying that the resulting
                        data will be valid.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading22"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse22" aria-expanded="true" aria-controls="collapse22">Countermeasure: Serialize the objects for the sensitive data with the Java Serialization API <span>[MASVS-6.9]</span></button></h5></div><div id="collapse22" class="collapse" aria-labelledby="heading22" data-parent="#controls"><div class="card-body">Serialize the objects for the sensitive data with the Java Serialization API. After
                        serialization, the data shall be encrypted and HMACed/signed. The user and/or application
                        instance shall be properly authenticated/authorized to obtain the keys to use the data.

                        The data within the deserialized object is carefully validated before you can actively use it
                        (e.g. no exploit of business/application logic).
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading32"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse32" aria-expanded="true" aria-controls="collapse32">Threat: Attackers gain access to the data through the WebView functionality <span>[ACCESS-WEBVIEW]</span></button></h5></div><div id="collapse32" class="collapse" aria-labelledby="heading32" data-parent="#threats"><div class="card-body">An attacker employs forceful browsing to access portions of a website that are
                                otherwise unreachable through direct URL entry.

                                Usually, a front controller or similar design pattern is employed to protect access to
                                portions of a web application.

                                Forceful browsing enables an attacker to access information, perform privileged
                                operations and otherwise reach sections of the web application that have been improperly
                                protected.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading26"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse26" aria-expanded="true" aria-controls="collapse26">Weakness: Exposed Dangerous Method or Function <span>[CWE-749]</span></button></h5></div><div id="collapse26" class="collapse" aria-labelledby="heading26" data-parent="#weaknesses"><div class="card-body">The software provides an Applications Programming Interface (API) or similar interface for
                        interaction with external actors, but the interface includes a dangerous method or function that
                        is not properly restricted.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading25"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse25" aria-expanded="true" aria-controls="collapse25">Countermeasure: Allow only the minimum set of protocol handlers required <span>[MASVS-6.6]</span></button></h5></div><div id="collapse25" class="collapse" aria-labelledby="heading25" data-parent="#controls"><div class="card-body">Configure the WebViews to allow only the minimum set of protocol handlers required (ideally, only https). Potentially dangerous handlers, such as file, tel and app-id, are disabled.</div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading29"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse29" aria-expanded="true" aria-controls="collapse29">Weakness: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') <span>[CWE-79]</span></button></h5></div><div id="collapse29" class="collapse" aria-labelledby="heading29" data-parent="#weaknesses"><div class="card-body">The software does not neutralize or incorrectly neutralizes user-controllable input before it
                        is placed in output that is used as a web page that is served to other users. Cross-site
                        scripting (XSS) vulnerabilities occur when:
                        <ol>
                        <li>Untrusted data enters a web application, typically from a web request.</li>
                        <li>The web application dynamically generates a web page that contains this untrusted
                        data.</li>
                        <li>During page generation, the application does not prevent the data from containing
                        content that is executable by a web browser, such as JavaScript, HTML tags, HTML attributes,
                        mouse events, Flash, ActiveX, etc.</li>
                        <li>A victim visits the generated web page through a web browser, which contains malicious
                        script that was injected using the untrusted data.</li>
                        <li>Since the script comes from a web page that was sent by the web server, the victim's
                        web browser executes the malicious script in the context of the web server's domain.</li>
                        <li>This effectively violates the intention of the web browser's same-origin policy, which
                        states that scripts in one domain should not be able to access resources or run code in a
                        different domain.</li>
                        </ol>There are three main kinds of XSS:
                        <ul>
                        <li><b>Type 1: Reflected XSS (or Non-Persistent)</b></li>
                        </ul>
                        <blockquote>
                        The server reads data directly from the HTTP request and reflects it back in the HTTP response.
                        Reflected XSS exploits occur when an attacker causes a victim to supply dangerous content to a
                        vulnerable web application, which is then reflected back to the victim and executed by the web
                        browser. The most common mechanism for delivering malicious content is to include it as a
                        parameter in a URL that is posted publicly or e-mailed directly to the victim. URLs constructed
                        in this manner constitute the core of many phishing schemes, whereby an attacker convinces a
                        victim to visit a URL that refers to a vulnerable site. After the site reflects the attacker's
                        content back to the victim, the content is executed by the victim's browser.
                        </blockquote>
                        <ul>
                        <li><b>Type 2: Stored XSS (or Persistent)</b></li>
                        </ul>
                        <blockquote>
                        The application stores dangerous data in a database, message forum, visitor log, or other
                        trusted data store. At a later time, the dangerous data is subsequently read back into the
                        application and included in dynamic content. From an attacker's perspective, the optimal place
                        to inject malicious content is in an area that is displayed to either many users or particularly
                        interesting users. Interesting users typically have elevated privileges in the application or
                        interact with sensitive data that is valuable to the attacker. If one of these users executes
                        malicious content, the attacker may be able to perform privileged operations on behalf of the
                        user or gain access to sensitive data belonging to the user. For example, the attacker might
                        inject XSS into a log message, which might not be handled properly when an administrator views
                        the logs.
                        </blockquote>
                        <ul>
                        <li><b>Type 0: DOM-Based XSS</b></li>
                        </ul>
                        <blockquote>
                        In DOM-based XSS, the client performs the injection of XSS into the page; in the other types,
                        the server performs the injection. DOM-based XSS generally involves server-controlled, trusted
                        script that is sent to the client, such as Javascript that performs sanity checks on a form
                        before the user submits it. If the server-supplied script processes user-supplied data and then
                        injects it back into the web page (such as with dynamic HTML), then DOM-based XSS is
                        possible.Once the malicious script is injected, the attacker can perform a variety of malicious
                        activities. The attacker could transfer private information, such as cookies that may include
                        session information, from the victim's machine to the attacker. The attacker could send
                        malicious requests to a web site on behalf of the victim, which could be especially dangerous to
                        the site if the victim has administrator privileges to manage that site. Phishing attacks could
                        be used to emulate trusted web sites and trick the victim into entering a password, allowing the
                        attacker to compromise the victim's account on that web site. Finally, the script could exploit
                        a vulnerability in the web browser itself possibly taking over the victim's machine, sometimes
                        referred to as &quot;drive-by hacking&quot;.
                        </blockquote>
                        <blockquote>
                        <br />
                        </blockquote>In many cases, the attack can be launched without the victim even being aware
                        of it. Even with careful users, attackers frequently use a variety of methods to encode the
                        malicious portion of the attack, such as URL encoding or Unicode, so the request looks less
                        suspicious.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading27"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse27" aria-expanded="true" aria-controls="collapse27">Countermeasure: Do not load user-supplied local resources into WebViews <span>[MASVS-6.7]</span></button></h5></div><div id="collapse27" class="collapse" aria-labelledby="heading27" data-parent="#controls"><div class="card-body">WebViews can load content remotely and locally from the app data directory. If the content is loaded locally, users should not be able to change the filename or path from which the file is loaded, and they shouldn't be able to edit the loaded file. To avoid this you shall not allow the loading of local resources into the Webviews.</div></div></div><div class="card border-success"><div class="card-header " id="heading28"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse28" aria-expanded="true" aria-controls="collapse28">Countermeasure: Only JavaScript provided with the app code is allowed <span>[MASVS-6.8]</span></button></h5></div><div id="collapse28" class="collapse" aria-labelledby="heading28" data-parent="#controls"><div class="card-body">Only JavaScript provided with the APK should be allowed to call it but no JavaScript loaded from remote endpoints.</div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading31"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse31" aria-expanded="true" aria-controls="collapse31">Weakness: Improper Neutralization of Script in Attributes in a Web Page <span>[CWE-83]</span></button></h5></div><div id="collapse31" class="collapse" aria-labelledby="heading31" data-parent="#weaknesses"><div class="card-body">The software does not neutralize or incorrectly neutralizes "javascript:" or other URIs from
                        dangerous attributes within tags, such as onmouseover, onload, onerror, or style.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading30"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse30" aria-expanded="true" aria-controls="collapse30">Countermeasure: Disable JavaScript by default in a WebView if it is not necessary <span>[MASVS-6.5]</span></button></h5></div><div id="collapse30" class="collapse" aria-labelledby="heading30" data-parent="#controls"><div class="card-body">JavaScript is disabled by default in a WebView and if not needed shouldn't be enabled. This reduces the attack surface and potential threats to the app.</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading44"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse44" aria-expanded="true" aria-controls="collapse44">Risk pattern: iOS Client <span>[IOS-CLIENT]</span></button></h5></div><div id="collapse44" class="collapse" aria-labelledby="heading44" data-parent="#components"><div class="card-body">This pattern is imported when we have a mobile device, and the client application runs in an iOS operating system.<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading43"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse43" aria-expanded="true" aria-controls="collapse43">Use case: Provide mobile access to services <span>[PROVIDE MOBILE ACCESS TO SERVICES]</span></button></h5></div><div id="collapse43" class="collapse" aria-labelledby="heading43" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading42"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse42" aria-expanded="true" aria-controls="collapse42">Threat: Attackers gain access to the data through the WebView functionality <span>[ACCESS-WEBVIEW]</span></button></h5></div><div id="collapse42" class="collapse" aria-labelledby="heading42" data-parent="#threats"><div class="card-body">An attacker employs forceful browsing to access portions of a website that are
                                otherwise unreachable through direct URL entry.

                                Usually, a front controller or similar design pattern is employed to protect access to
                                portions of a web application.

                                Forceful browsing enables an attacker to access information, perform privileged
                                operations and otherwise reach sections of the web application that have been improperly
                                protected.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading36"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse36" aria-expanded="true" aria-controls="collapse36">Weakness: Exposed Dangerous Method or Function <span>[CWE-749]</span></button></h5></div><div id="collapse36" class="collapse" aria-labelledby="heading36" data-parent="#weaknesses"><div class="card-body">The software provides an Applications Programming Interface (API) or similar interface for
                        interaction with external actors, but the interface includes a dangerous method or function that
                        is not properly restricted.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading35"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse35" aria-expanded="true" aria-controls="collapse35">Countermeasure: Allow only the minimum set of protocol handlers required <span>[MASVS-6.6]</span></button></h5></div><div id="collapse35" class="collapse" aria-labelledby="heading35" data-parent="#controls"><div class="card-body">Configure the WebViews to allow only the minimum set of protocol handlers required (ideally, only https). Potentially dangerous handlers, such as file, tel and app-id, are disabled.</div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading38"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse38" aria-expanded="true" aria-controls="collapse38">Weakness: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') <span>[CWE-79]</span></button></h5></div><div id="collapse38" class="collapse" aria-labelledby="heading38" data-parent="#weaknesses"><div class="card-body">The software does not neutralize or incorrectly neutralizes user-controllable input before it
                        is placed in output that is used as a web page that is served to other users. Cross-site
                        scripting (XSS) vulnerabilities occur when:
                        <ol>
                        <li>Untrusted data enters a web application, typically from a web request.</li>
                        <li>The web application dynamically generates a web page that contains this untrusted
                        data.</li>
                        <li>During page generation, the application does not prevent the data from containing
                        content that is executable by a web browser, such as JavaScript, HTML tags, HTML attributes,
                        mouse events, Flash, ActiveX, etc.</li>
                        <li>A victim visits the generated web page through a web browser, which contains malicious
                        script that was injected using the untrusted data.</li>
                        <li>Since the script comes from a web page that was sent by the web server, the victim's
                        web browser executes the malicious script in the context of the web server's domain.</li>
                        <li>This effectively violates the intention of the web browser's same-origin policy, which
                        states that scripts in one domain should not be able to access resources or run code in a
                        different domain.</li>
                        </ol>There are three main kinds of XSS:
                        <ul>
                        <li><b>Type 1: Reflected XSS (or Non-Persistent)</b></li>
                        </ul>
                        <blockquote>
                        The server reads data directly from the HTTP request and reflects it back in the HTTP response.
                        Reflected XSS exploits occur when an attacker causes a victim to supply dangerous content to a
                        vulnerable web application, which is then reflected back to the victim and executed by the web
                        browser. The most common mechanism for delivering malicious content is to include it as a
                        parameter in a URL that is posted publicly or e-mailed directly to the victim. URLs constructed
                        in this manner constitute the core of many phishing schemes, whereby an attacker convinces a
                        victim to visit a URL that refers to a vulnerable site. After the site reflects the attacker's
                        content back to the victim, the content is executed by the victim's browser.
                        </blockquote>
                        <ul>
                        <li><b>Type 2: Stored XSS (or Persistent)</b></li>
                        </ul>
                        <blockquote>
                        The application stores dangerous data in a database, message forum, visitor log, or other
                        trusted data store. At a later time, the dangerous data is subsequently read back into the
                        application and included in dynamic content. From an attacker's perspective, the optimal place
                        to inject malicious content is in an area that is displayed to either many users or particularly
                        interesting users. Interesting users typically have elevated privileges in the application or
                        interact with sensitive data that is valuable to the attacker. If one of these users executes
                        malicious content, the attacker may be able to perform privileged operations on behalf of the
                        user or gain access to sensitive data belonging to the user. For example, the attacker might
                        inject XSS into a log message, which might not be handled properly when an administrator views
                        the logs.
                        </blockquote>
                        <ul>
                        <li><b>Type 0: DOM-Based XSS</b></li>
                        </ul>
                        <blockquote>
                        In DOM-based XSS, the client performs the injection of XSS into the page; in the other types,
                        the server performs the injection. DOM-based XSS generally involves server-controlled, trusted
                        script that is sent to the client, such as Javascript that performs sanity checks on a form
                        before the user submits it. If the server-supplied script processes user-supplied data and then
                        injects it back into the web page (such as with dynamic HTML), then DOM-based XSS is
                        possible.Once the malicious script is injected, the attacker can perform a variety of malicious
                        activities. The attacker could transfer private information, such as cookies that may include
                        session information, from the victim's machine to the attacker. The attacker could send
                        malicious requests to a web site on behalf of the victim, which could be especially dangerous to
                        the site if the victim has administrator privileges to manage that site. Phishing attacks could
                        be used to emulate trusted web sites and trick the victim into entering a password, allowing the
                        attacker to compromise the victim's account on that web site. Finally, the script could exploit
                        a vulnerability in the web browser itself possibly taking over the victim's machine, sometimes
                        referred to as &quot;drive-by hacking&quot;.
                        </blockquote>
                        <blockquote>
                        <br />
                        </blockquote>In many cases, the attack can be launched without the victim even being aware
                        of it. Even with careful users, attackers frequently use a variety of methods to encode the
                        malicious portion of the attack, such as URL encoding or Unicode, so the request looks less
                        suspicious.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading37"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse37" aria-expanded="true" aria-controls="collapse37">Countermeasure: Do not load user-supplied local resources into WebViews <span>[MASVS-6.7]</span></button></h5></div><div id="collapse37" class="collapse" aria-labelledby="heading37" data-parent="#controls"><div class="card-body">WebViews can load content remotely and locally from the app data directory. If the content is loaded locally, users should not be able to change the filename or path from which the file is loaded, and they shouldn't be able to edit the loaded file. To avoid this you shall not allow the loading of local resources into the Webviews.</div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading41"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse41" aria-expanded="true" aria-controls="collapse41">Weakness: Improper Neutralization of Script in Attributes in a Web Page <span>[CWE-83]</span></button></h5></div><div id="collapse41" class="collapse" aria-labelledby="heading41" data-parent="#weaknesses"><div class="card-body">The software does not neutralize or incorrectly neutralizes "javascript:" or other URIs from
                        dangerous attributes within tags, such as onmouseover, onload, onerror, or style.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading39"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse39" aria-expanded="true" aria-controls="collapse39">Countermeasure: Disable JavaScript by default in a WebView if it is not necessary <span>[MASVS-6.5]</span></button></h5></div><div id="collapse39" class="collapse" aria-labelledby="heading39" data-parent="#controls"><div class="card-body">JavaScript is disabled by default in a WebView and if not needed shouldn't be enabled. This reduces the attack surface and potential threats to the app.</div></div></div><div class="card border-success"><div class="card-header " id="heading40"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse40" aria-expanded="true" aria-controls="collapse40">Countermeasure: Disable the UIWebView for iOS platform <span>[MASVS-6.6-IOS-UIWEBVIEW]</span></button></h5></div><div id="collapse40" class="collapse" aria-labelledby="heading40" data-parent="#controls"><div class="card-body">UIWebView is deprecated and should not be used. Make sure that either WKWebView or SafariViewController are used to embed web content:&nbsp; 
<div> 
 <ul> 
  <li>WKWebView is the appropriate choice for extending app functionality, controlling displayed content (i.e., prevent the user from navigating to arbitrary URLs) and customizing. SafariViewController should be used to provide a generalized web viewing experience. Note that SafariViewController shares cookies and other website data with Safari.&nbsp;</li> 
  <li>WKWebView comes with several security advantages over UIWebView:&nbsp;</li> 
  <ul> 
   <li>The JavaScriptEnabled property can be used to completely disable JavaScript in the WKWebView. This prevents all script injection flaws.&nbsp;</li> 
   <li>The JavaScriptCanOpenWindowsAutomatically can be used to prevent JavaScript from opening new windows, such as pop-ups.&nbsp;</li> 
   <li>The hasOnlySecureContent property can be used to verify resources loaded by the WebView are retrieved through encrypted connections.&nbsp;</li> 
   <li>WKWebView implements out-of-process rendering, so memory corruption bugs won't affect the main app process.</li> 
  </ul> 
 </ul> 
</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading93"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse93" aria-expanded="true" aria-controls="collapse93">Risk pattern: Mobile Client <span>[MOBILE-CLIENT]</span></button></h5></div><div id="collapse93" class="collapse" aria-labelledby="heading93" data-parent="#components"><div class="card-body">A client component on a mobile device. This risk pattern is imported when we have a mobile device, and we don't know which operating system runs. This is a common risk pattern for all types of operating systems.<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading74"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse74" aria-expanded="true" aria-controls="collapse74">Use case: General <span>[GENERAL]</span></button></h5></div><div id="collapse74" class="collapse" aria-labelledby="heading74" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading55"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse55" aria-expanded="true" aria-controls="collapse55">Threat: An attacker attempts to invoke all common switches and options to discover weaknesses  <span>[CAPEC-133]</span></button></h5></div><div id="collapse55" class="collapse" aria-labelledby="heading55" data-parent="#threats"><div class="card-body">An attacker attempts to invoke all common switches and options in the target
                                application for the purpose of discovering weaknesses in the target. For example, in
                                some applications, adding the --debug switch causes debugging information to be
                                displayed, which can sometimes reveal sensitive processing or configuration information
                                to an attacker. This attack differs from other forms of API abuse in that the attacker
                                is blindly attempting to invoke options in the hope that one of them will work rather
                                than specifically targeting a known option. Nonetheless, even if the attacker is
                                familiar with the published options of a targeted application this attack method may
                                still be fruitful as it might discover unpublicized functionality.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading48"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse48" aria-expanded="true" aria-controls="collapse48">Weakness: Information Exposure Through Debug Information <span>[CWE-215]</span></button></h5></div><div id="collapse48" class="collapse" aria-labelledby="heading48" data-parent="#weaknesses"><div class="card-body">The application contains debugging code that can expose sensitive information to untrusted parties.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading45"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse45" aria-expanded="true" aria-controls="collapse45">Countermeasure: Remove or obfuscate the debugging symbols from native binaries <span>[MASVS-7.3]</span></button></h5></div><div id="collapse45" class="collapse" aria-labelledby="heading45" data-parent="#controls"><div class="card-body">As a general rule of thumb, as little explanative information as possible should be provided
                        along with the compiled code. Some metadata such as debugging information, line numbers and
                        descriptive function or method names make the binary or bytecode easier to understand for the
                        reverse engineer, but isn't actually needed in a release build and can therefore be safely
                        discarded without impacting the functionality of the app.

                        This data shall be removed from the release version or shall be obfuscated in order to be
                        inaccessible to the reverse engineer.
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading46"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse46" aria-expanded="true" aria-controls="collapse46">Countermeasure: Insert the condition DEVELOPER-MODE to remove the debugging code, log verbose errors or debugging messages in the production version <span>[MASVS-7.4]</span></button></h5></div><div id="collapse46" class="collapse" aria-labelledby="heading46" data-parent="#controls"><div class="card-body">Insert the policy in the if statement with DEVELOPER_MODE as condition. The DEVELOPER_MODE has
                        to be disabled for release build in order to disable StrictMode too.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        Remove the debugging code, log verbose errors or debugging messages in the production version.
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading47"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse47" aria-expanded="true" aria-controls="collapse47">Countermeasure: Implement functionality to notify when anti-debugging mechanisms are presented within the app <span>[MASVS-8.2]</span></button></h5></div><div id="collapse47" class="collapse" aria-labelledby="heading47" data-parent="#controls"><div class="card-body">Implement anti-debugging mechanisms to prohibit debug mode being activated. Anti-debugging
                        features can be preventive or reactive. As the name implies, preventive anti-debugging
                        techniques prevent the debugger from attaching in the first place, while reactive techniques
                        attempt to detect whether a debugger is present and react to it in some way (e.g. terminating
                        the app, or triggering some kind of hidden behavior).&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        The &quot;more-is-better&quot; rule applies: To maximize effectiveness, defenders
                        combine multiple methods of prevention and detection which operate on different API layers and
                        are distributed throughout the app.
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading50"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse50" aria-expanded="true" aria-controls="collapse50">Weakness: Leftover Debug Code <span>[CWE-489]</span></button></h5></div><div id="collapse50" class="collapse" aria-labelledby="heading50" data-parent="#weaknesses"><div class="card-body">The application can be deployed with active debugging code that can create unintended entry
                        points.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading49"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse49" aria-expanded="true" aria-controls="collapse49">Countermeasure: Insert the condition DEVELOPER-MODE to remove the debugging code, log verbose errors or debugging messages in the production version <span>[MASVS-7.4]</span></button></h5></div><div id="collapse49" class="collapse" aria-labelledby="heading49" data-parent="#controls"><div class="card-body">Insert the policy in the if statement with DEVELOPER_MODE as condition. The DEVELOPER_MODE has
                        to be disabled for release build in order to disable StrictMode too.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        Remove the debugging code, log verbose errors or debugging messages in the production version.
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading54"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse54" aria-expanded="true" aria-controls="collapse54">Weakness: Reliance on Security Through Obscurity <span>[CWE-656]</span></button></h5></div><div id="collapse54" class="collapse" aria-labelledby="heading54" data-parent="#weaknesses"><div class="card-body">The software uses a protection mechanism whose strength depends heavily on its obscurity, such
                        that knowledge of its algorithms or key data is sufficient to defeat the mechanism.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading51"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse51" aria-expanded="true" aria-controls="collapse51">Countermeasure: Activate the Free Security Features <span>[MASVS-7.8]</span></button></h5></div><div id="collapse51" class="collapse" aria-labelledby="heading51" data-parent="#controls"><div class="card-body">For Android:&nbsp;
                        <div>
                        <ul>
                        <li>We shall activate the Obfuscation of the code and strip unneeded debugging
                        information.&nbsp;</li>
                        </ul>For iOS:&nbsp;
                        </div>
                        <div>
                        <ul>
                        <li>We shall activate:&nbsp;</li>
                        <ul>
                        <li>ARC (Automatic Reference Counting): memory management feature, adds retain and release
                        messages when required.&nbsp;</li>
                        <li>Stack Canary: helps prevent buffer overflow attacks.&nbsp;</li>
                        <li>PIE (Position Independent Executable): enables full ASLR for binary.</li>
                        </ul>
                        </ul>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading52"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse52" aria-expanded="true" aria-controls="collapse52">Countermeasure: Encrypt and pack all executable files and libraries belonging to the app <span>[MASVS-8.8]</span></button></h5></div><div id="collapse52" class="collapse" aria-labelledby="heading52" data-parent="#controls"><div class="card-body">Ensure that all executable files and libraries belonging to the app are encrypted on the file
                        level and/or important code and data segments inside the executables are encrypted or packed.
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading53"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse53" aria-expanded="true" aria-controls="collapse53">Countermeasure: Obfuscate all executable files, libraries, important code and data segments <span>[MASVS-8.9]</span></button></h5></div><div id="collapse53" class="collapse" aria-labelledby="heading53" data-parent="#controls"><div class="card-body">Obfuscation is the process of transforming code and data in order to make it more difficult to
                        comprehend. It is an integral part of every software protection scheme.
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading59"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse59" aria-expanded="true" aria-controls="collapse59">Threat: An attacker initiates a series of events to perform actions which undermine the integrity of software code <span>[CAPEC-184]</span></button></h5></div><div id="collapse59" class="collapse" aria-labelledby="heading59" data-parent="#threats"><div class="card-body">An attacker initiates a series of events designed to cause a user, program, server, or
                                device to perform actions which undermine the integrity of software code, device data
                                structures, or device firmware, achieving the modification of the target's integrity to
                                achieve an insecure state.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading58"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse58" aria-expanded="true" aria-controls="collapse58">Weakness: Download of Code Without Integrity Check <span>[CWE-494]</span></button></h5></div><div id="collapse58" class="collapse" aria-labelledby="heading58" data-parent="#weaknesses"><div class="card-body">The product downloads source code or an executable from a remote location and executes the
                        code without sufficiently verifying the origin and integrity of the code.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading56"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse56" aria-expanded="true" aria-controls="collapse56">Countermeasure: Sign the app and provision with valid certificate <span>[MASVS-7.1]</span></button></h5></div><div id="collapse56" class="collapse" aria-labelledby="heading56" data-parent="#controls"><div class="card-body">Code signing your app assures users that it is from a known source and the app hasn't
                        been
                        modified since it was last signed. This process can prevent an app from being tampered with, or
                        modified to include malicious code.
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading57"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse57" aria-expanded="true" aria-controls="collapse57">Countermeasure: Implement functionality to alert when the app code changes <span>[MASVS-8.3]</span></button></h5></div><div id="collapse57" class="collapse" aria-labelledby="heading57" data-parent="#controls"><div class="card-body">Implement functionality to detect, notify and respond when the app is modified by executable
                        files or by anti-debugging tools. When the injection is detected the app shall alert the user
                        and terminate the session.
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading68"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse68" aria-expanded="true" aria-controls="collapse68">Threat: Attacker gains access to sensitive data by modifying the application's expected behavior <span>[CAPEC-188]</span></button></h5></div><div id="collapse68" class="collapse" aria-labelledby="heading68" data-parent="#threats"><div class="card-body">An attacker discovers the structure, function, and composition of an object, resource,
                                or system by using a variety of analysis techniques to effectively determine how the
                                analyzed entity was constructed or operates. The goal of reverse engineering is often to
                                duplicate the function, or a part of the function, of an object in order to duplicate or
                                &quot;back engineer&quot; some aspect of its functioning.&nbsp;
                                <div>
                                <br />
                                </div>
                                <div>
                                Reverse engineering techniques can be applied to mechanical objects, electronic devices,
                                or software, although the methodology and techniques involved in each type of analysis
                                differ widely. When adversaries are reverse engineering software, methodologies fall
                                into two broad categories, 'white box' and 'black box.' White box techniques involve
                                methods which can be applied to a piece of software when an executable or some other
                                compiled object can be directly subjected to analysis, revealing at least a portion of
                                its machine instructions that can be observed upon execution.
                                </div>
                                <div>
                                <br />
                                </div>
                                <div>
                                'Black Box' methods involve interacting with the software indirectly, in the absence of
                                the ability to measure, instrument, or analyze an executable object directly. Such
                                analysis typically involves interacting with the software at the boundaries of where the
                                software interfaces with a larger execution environment, such as input-output vectors,
                                libraries, or APIs.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading63"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse63" aria-expanded="true" aria-controls="collapse63">Weakness: Inappropriate use of emulation tools <span>[MASVS-EMULATION-TOOLS]</span></button></h5></div><div id="collapse63" class="collapse" aria-labelledby="heading63" data-parent="#weaknesses"><div class="card-body">The inappropriate use of emulation tools are not detected by the app, and attackers can
                        leverage them to obtain information about the app.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading60"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse60" aria-expanded="true" aria-controls="collapse60">Countermeasure: Implement two or more independent functionalities to detect the app is running inside an emulator. <span>[MASVS-8.11]</span></button></h5></div><div id="collapse60" class="collapse" aria-labelledby="heading60" data-parent="#controls"><div class="card-body">Implement two or more independent functionalities to detect when the app is running inside an
                        emulator in the context of the overall protection scheme. With this security protection in
                        place, the app forces the adversary to invest significantly more manual effort to run the app
                        within an emulator.
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading61"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse61" aria-expanded="true" aria-controls="collapse61">Countermeasure: Implement functionality to detect if the app is being run inside an emulator <span>[MASVS-8.5]</span></button></h5></div><div id="collapse61" class="collapse" aria-labelledby="heading61" data-parent="#controls"><div class="card-body">Create and implement functionality to detect when the app is being run inside an emulator. If
                        the app is running inside an emulator, the app shall terminate the session.
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading62"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse62" aria-expanded="true" aria-controls="collapse62">Countermeasure: Ensure that the app responds correctly against tampering, debugging and emulation <span>[MASVS-8.7]</span></button></h5></div><div id="collapse62" class="collapse" aria-labelledby="heading62" data-parent="#controls"><div class="card-body">Ensure the app implements multiple different responses to tampering, debugging and emulation,
                        including stealthy responses that don't simply terminate the app.
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading67"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse67" aria-expanded="true" aria-controls="collapse67">Weakness: Inappropriate use of reverse engineering tools <span>[MASVS-REVERSE-ENGINEERING-TOOLS]</span></button></h5></div><div id="collapse67" class="collapse" aria-labelledby="heading67" data-parent="#weaknesses"><div class="card-body">The inappropriate use of the reverse engineering tools is not detected by the app, and
                        attackers can leverage them to obtain information about the app.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading64"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse64" aria-expanded="true" aria-controls="collapse64">Countermeasure: Do not use the SSAID for 'device binding' <span>[MASVS-8.10]</span></button></h5></div><div id="collapse64" class="collapse" aria-labelledby="heading64" data-parent="#controls"><div class="card-body">Do not use the SSAID for device binding because the behavior of the SSAID has changed since
                        Android O and the behavior of MAC addresses have changed in Android N.

                        Google has set a new set of recommendations in their SDK documentation regarding identifiers as
                        well. Because of this new behavior, we recommend developers not rely on the SSAID alone, as the
                        identifier has become less stable. For instance: The SSAID might change upon a factory reset or
                        when the app is reinstalled after the upgrade to Android O. Please note that there are a number
                        of devices which have the same ANDROID_ID and/or have an ANDROID_ID that can be overridden.
                        Also, the Build.Serial was often used but now apps targeting Android O will get "UNKNOWN" when
                        they request the Build.Serial.
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading65"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse65" aria-expanded="true" aria-controls="collapse65">Countermeasure: Implement functionality to detect the presence of widely used reverse engineering tools <span>[MASVS-8.4]</span></button></h5></div><div id="collapse65" class="collapse" aria-labelledby="heading65" data-parent="#controls"><div class="card-body">Create functionality to detect the presence of widely used reverse engineering tools, such as
                        code injection tools, hooking frameworks and debugging servers. If any reverse engineering tool
                        is detected, the app shall force termination of the session.
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading66"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse66" aria-expanded="true" aria-controls="collapse66">Countermeasure: Implement functionality to detect and respond to, modifications of process memory <span>[MASVS-8.6]</span></button></h5></div><div id="collapse66" class="collapse" aria-labelledby="heading66" data-parent="#controls"><div class="card-body">Create functionality to detect &quot;hostile&quot; code in its memory and respond
                        accordingly. Controls in this category verify the integrity of the app's own memory space, with
                        the goal of protecting against memory patches applied during runtime. This includes unwanted
                        changes to binary code or bytecode, functions pointer tables, and important data structures, as
                        well as rogue code loaded into process memory.&nbsp;
                        <div>
                        <br />
                        <div>
                        Integrity can be verified either by:&nbsp;
                        <div>
                        <ul>
                        <li>Comparing the contents of memory, or a checksum over the contents, with known good
                        values.&nbsp;</li>
                        <li>Searching memory for signatures of unwanted modifications.</li>
                        </ul>
                        </div>
                        </div>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading73"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse73" aria-expanded="true" aria-controls="collapse73">Threat: Users lose trust in the application because it requests unnecessary privileges <span>[CAPEC-122-MOBILE]</span></button></h5></div><div id="collapse73" class="collapse" aria-labelledby="heading73" data-parent="#threats"><div class="card-body">If the mobile application requests permissions or access to components that are not
                                strictly needed by the application, then users can lose trust in the security of the
                                application with an associated impact on the trust placed in the application provider.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading72"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse72" aria-expanded="true" aria-controls="collapse72">Weakness: Execution with Unnecessary Privileges <span>[CWE-250]</span></button></h5></div><div id="collapse72" class="collapse" aria-labelledby="heading72" data-parent="#weaknesses"><div class="card-body">The software performs an operation at a privilege level that is higher than the minimum level
                        required, which creates new weaknesses or amplifies the consequences of other weaknesses.

                        New weaknesses can be exposed because running with extra privileges, such as root or
                        Administrator, can disable the normal security checks being performed by the operating system or
                        surrounding environment. Other pre-existing weaknesses can turn into security vulnerabilities if
                        they occur while operating at raised privileges. Privilege management functions can behave in
                        some less-than-obvious ways, and they have different quirks on different platforms. These
                        inconsistencies are particularly pronounced if you are transitioning from one non-root user to
                        another. Signal handlers and spawned processes run at the privilege of the owning process, so if
                        a process is running as root when a signal fires or a sub-process is executed, the signal
                        handler or sub-process will operate with root privileges.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading69"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse69" aria-expanded="true" aria-controls="collapse69">Countermeasure: Request only the minimum required permissions from the mobile operating system <span>[CWE-250-MOBILE]</span></button></h5></div><div id="collapse69" class="collapse" aria-labelledby="heading69" data-parent="#controls"><div class="card-body">Security best practice dictates the practice of least-privilege is followed, thereby reducing the attack surface and risk of compromise. By limiting the access an application has to the system, developers may reduce the impact a compromise may have.&nbsp; 
<div> 
 <br /> 
</div> 
<div>
  Request only the minimum required permissions from the mobile operating system. For example, if there is no requirement to use the camera then the application should not request this permission. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Review features and functionality present in the application, in particular legacy features, to determine if they are relevant and required, and if not remove them and associated OS permissions. 
</div></div></div></div><div class="card border-success"><div class="card-header " id="heading70"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse70" aria-expanded="true" aria-controls="collapse70">Countermeasure: Create the functionality to verify the app uses a minimum device-access-security policy <span>[MASVS-2.11]</span></button></h5></div><div id="collapse70" class="collapse" aria-labelledby="heading70" data-parent="#controls"><div class="card-body">Different checks on the Android device can be implemented by querying different system preferences from Settings.Secure. The Device Administration API offers different mechanisms to create security aware applications, that are able to enforce password policies or encryption of the device.</div></div></div><div class="card border-success"><div class="card-header " id="heading71"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse71" aria-expanded="true" aria-controls="collapse71">Countermeasure: Implement two or more independent functionallies for root detection <span>[MASVS-8.1]</span></button></h5></div><div id="collapse71" class="collapse" aria-labelledby="heading71" data-parent="#controls"><div class="card-body">Implement two or more independent methods to detect rooted devices and if the device is rooted, the app shall respond in two ways:&nbsp; 
<div> 
 <ul> 
  <li>The app notifies the user that their device is rooted and it's not secure to continue with the app.&nbsp;</li> 
  <li>Terminate the session and the app, because sensitive data is vulnerable.</li> 
 </ul> 
</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading92"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse92" aria-expanded="true" aria-controls="collapse92">Use case: Provide mobile access to services <span>[PROVIDE MOBILE ACCESS TO SERVICES]</span></button></h5></div><div id="collapse92" class="collapse" aria-labelledby="heading92" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading81"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse81" aria-expanded="true" aria-controls="collapse81">Threat: Attackers gain access to the data through the WebView functionality <span>[ACCESS-WEBVIEW]</span></button></h5></div><div id="collapse81" class="collapse" aria-labelledby="heading81" data-parent="#threats"><div class="card-body">An attacker employs forceful browsing to access portions of a website that are
                                otherwise unreachable through direct URL entry.

                                Usually, a front controller or similar design pattern is employed to protect access to
                                portions of a web application.

                                Forceful browsing enables an attacker to access information, perform privileged
                                operations and otherwise reach sections of the web application that have been improperly
                                protected.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading76"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse76" aria-expanded="true" aria-controls="collapse76">Weakness: Exposed Dangerous Method or Function <span>[CWE-749]</span></button></h5></div><div id="collapse76" class="collapse" aria-labelledby="heading76" data-parent="#weaknesses"><div class="card-body">The software provides an Applications Programming Interface (API) or similar interface for
                        interaction with external actors, but the interface includes a dangerous method or function that
                        is not properly restricted.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading75"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse75" aria-expanded="true" aria-controls="collapse75">Countermeasure: Allow only the minimum set of protocol handlers required <span>[MASVS-6.6]</span></button></h5></div><div id="collapse75" class="collapse" aria-labelledby="heading75" data-parent="#controls"><div class="card-body">Configure the WebViews to allow only the minimum set of protocol handlers required (ideally, only https). Potentially dangerous handlers, such as file, tel and app-id, are disabled.</div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading78"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse78" aria-expanded="true" aria-controls="collapse78">Weakness: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') <span>[CWE-79]</span></button></h5></div><div id="collapse78" class="collapse" aria-labelledby="heading78" data-parent="#weaknesses"><div class="card-body">The software does not neutralize or incorrectly neutralizes user-controllable input before it
                        is placed in output that is used as a web page that is served to other users. Cross-site
                        scripting (XSS) vulnerabilities occur when:
                        <ol>
                        <li>Untrusted data enters a web application, typically from a web request.</li>
                        <li>The web application dynamically generates a web page that contains this untrusted
                        data.</li>
                        <li>During page generation, the application does not prevent the data from containing
                        content that is executable by a web browser, such as JavaScript, HTML tags, HTML attributes,
                        mouse events, Flash, ActiveX, etc.</li>
                        <li>A victim visits the generated web page through a web browser, which contains malicious
                        script that was injected using the untrusted data.</li>
                        <li>Since the script comes from a web page that was sent by the web server, the victim's
                        web browser executes the malicious script in the context of the web server's domain.</li>
                        <li>This effectively violates the intention of the web browser's same-origin policy, which
                        states that scripts in one domain should not be able to access resources or run code in a
                        different domain.</li>
                        </ol>There are three main kinds of XSS:
                        <ul>
                        <li><b>Type 1: Reflected XSS (or Non-Persistent)</b></li>
                        </ul>
                        <blockquote>
                        The server reads data directly from the HTTP request and reflects it back in the HTTP response.
                        Reflected XSS exploits occur when an attacker causes a victim to supply dangerous content to a
                        vulnerable web application, which is then reflected back to the victim and executed by the web
                        browser. The most common mechanism for delivering malicious content is to include it as a
                        parameter in a URL that is posted publicly or e-mailed directly to the victim. URLs constructed
                        in this manner constitute the core of many phishing schemes, whereby an attacker convinces a
                        victim to visit a URL that refers to a vulnerable site. After the site reflects the attacker's
                        content back to the victim, the content is executed by the victim's browser.
                        </blockquote>
                        <ul>
                        <li><b>Type 2: Stored XSS (or Persistent)</b></li>
                        </ul>
                        <blockquote>
                        The application stores dangerous data in a database, message forum, visitor log, or other
                        trusted data store. At a later time, the dangerous data is subsequently read back into the
                        application and included in dynamic content. From an attacker's perspective, the optimal place
                        to inject malicious content is in an area that is displayed to either many users or particularly
                        interesting users. Interesting users typically have elevated privileges in the application or
                        interact with sensitive data that is valuable to the attacker. If one of these users executes
                        malicious content, the attacker may be able to perform privileged operations on behalf of the
                        user or gain access to sensitive data belonging to the user. For example, the attacker might
                        inject XSS into a log message, which might not be handled properly when an administrator views
                        the logs.
                        </blockquote>
                        <ul>
                        <li><b>Type 0: DOM-Based XSS</b></li>
                        </ul>
                        <blockquote>
                        In DOM-based XSS, the client performs the injection of XSS into the page; in the other types,
                        the server performs the injection. DOM-based XSS generally involves server-controlled, trusted
                        script that is sent to the client, such as Javascript that performs sanity checks on a form
                        before the user submits it. If the server-supplied script processes user-supplied data and then
                        injects it back into the web page (such as with dynamic HTML), then DOM-based XSS is
                        possible.Once the malicious script is injected, the attacker can perform a variety of malicious
                        activities. The attacker could transfer private information, such as cookies that may include
                        session information, from the victim's machine to the attacker. The attacker could send
                        malicious requests to a web site on behalf of the victim, which could be especially dangerous to
                        the site if the victim has administrator privileges to manage that site. Phishing attacks could
                        be used to emulate trusted web sites and trick the victim into entering a password, allowing the
                        attacker to compromise the victim's account on that web site. Finally, the script could exploit
                        a vulnerability in the web browser itself possibly taking over the victim's machine, sometimes
                        referred to as &quot;drive-by hacking&quot;.
                        </blockquote>
                        <blockquote>
                        <br />
                        </blockquote>In many cases, the attack can be launched without the victim even being aware
                        of it. Even with careful users, attackers frequently use a variety of methods to encode the
                        malicious portion of the attack, such as URL encoding or Unicode, so the request looks less
                        suspicious.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading77"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse77" aria-expanded="true" aria-controls="collapse77">Countermeasure: Do not load user-supplied local resources into WebViews <span>[MASVS-6.7]</span></button></h5></div><div id="collapse77" class="collapse" aria-labelledby="heading77" data-parent="#controls"><div class="card-body">WebViews can load content remotely and locally from the app data directory. If the content is loaded locally, users should not be able to change the filename or path from which the file is loaded, and they shouldn't be able to edit the loaded file. To avoid this you shall not allow the loading of local resources into the Webviews.</div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading80"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse80" aria-expanded="true" aria-controls="collapse80">Weakness: Improper Neutralization of Script in Attributes in a Web Page <span>[CWE-83]</span></button></h5></div><div id="collapse80" class="collapse" aria-labelledby="heading80" data-parent="#weaknesses"><div class="card-body">The software does not neutralize or incorrectly neutralizes "javascript:" or other URIs from
                        dangerous attributes within tags, such as onmouseover, onload, onerror, or style.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading79"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse79" aria-expanded="true" aria-controls="collapse79">Countermeasure: Disable JavaScript by default in a WebView if it is not necessary <span>[MASVS-6.5]</span></button></h5></div><div id="collapse79" class="collapse" aria-labelledby="heading79" data-parent="#controls"><div class="card-body">JavaScript is disabled by default in a WebView and if not needed shouldn't be enabled. This reduces the attack surface and potential threats to the app.</div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading85"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse85" aria-expanded="true" aria-controls="collapse85">Threat: Attackers gain unauthorised access to the application through an error handling flaw <span>[7k-CWE-ErrorH]</span></button></h5></div><div id="collapse85" class="collapse" aria-labelledby="heading85" data-parent="#threats"><div class="card-body">Errors and error handling represent a class of API. Errors related to error handling
                                are so common that they deserve a special kingdom of their own. As with "API
                                Abuse", there are two ways to introduce an error-related security vulnerability: the most common one is handling errors poorly (or not at all). The second is producing errors that
                                either give out too much information (to possible attackers) or are difficult to handle.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading84"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse84" aria-expanded="true" aria-controls="collapse84">Weakness: An error condition is not properly handled (Error Handling) <span>[CWE-388]</span></button></h5></div><div id="collapse84" class="collapse" aria-labelledby="heading84" data-parent="#weaknesses"><div class="card-body">Errors and error handling represent a class of API. Errors related to error handling are so
                        common that they deserve a special kingdom of their own. As with "API Abuse", there
                        are two ways to introduce an error-related security vulnerability: the most common one is handling errors poorly (or not at all). The second is producing errors that either give out too much information (to possible attackers) or are difficult to handle
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading82"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse82" aria-expanded="true" aria-controls="collapse82">Countermeasure: Catch and handle the possible exceptions <span>[MASVS-7.5]</span></button></h5></div><div id="collapse82" class="collapse" aria-labelledby="heading82" data-parent="#controls"><div class="card-body">Implement a well-designed and unified scheme to handle exceptions. Make sure the application
                        has centralized handlers for exceptions that result in similar behavior. This can be a static
                        class for instance. For specific exceptions given the methods context, specific catch blocks
                        should be provided.
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading83"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse83" aria-expanded="true" aria-controls="collapse83">Countermeasure: Deny the access by default when an uncaught exception appears <span>[MASVS-7.6]</span></button></h5></div><div id="collapse83" class="collapse" aria-labelledby="heading83" data-parent="#controls"><div class="card-body">Deny the access by default to prevent the app crashing because of uncaught exception and to
                        avoid unauthorised access.
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading88"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse88" aria-expanded="true" aria-controls="collapse88">Threat: Attackers gain unauthorised access to the application through buffer overflow flaws <span>[CAPEC-100]</span></button></h5></div><div id="collapse88" class="collapse" aria-labelledby="heading88" data-parent="#threats"><div class="card-body">Buffer Overflow attacks target improper or missing bounds checking on buffer
                                operations, typically triggered by input injected by an attacker. As a consequence, an
                                attacker is able to write past the boundaries of allocated buffer regions in memory,
                                causing a program crash or potential redirection of execution as per the attackers'
                                choice.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading87"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse87" aria-expanded="true" aria-controls="collapse87">Weakness: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') <span>[CWE-120]</span></button></h5></div><div id="collapse87" class="collapse" aria-labelledby="heading87" data-parent="#weaknesses"><div class="card-body">The program copies an input buffer to an output buffer without verifying that the size of the
                        input buffer is less than the size of the output buffer, leading to a buffer overflow.
                        <br />A buffer overflow condition exists when a program attempts to put more data in a
                        buffer than it can hold, or when a program attempts to put data in a memory area outside of the
                        boundaries of a buffer. The simplest type of error, and the most common cause of buffer
                        overflows, is the &quot;classic&quot; case in which the program copies the buffer
                        without restricting how much is copied. Other variants exist, but the existence of a classic
                        overflow strongly suggests that the programmer is not considering even the most basic of
                        security protections.
                        <br />
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading86"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse86" aria-expanded="true" aria-controls="collapse86">Countermeasure: Secure in the unmanaged code, the allocated memory, freed memory and used memory <span>[MASVS-7.7]</span></button></h5></div><div id="collapse86" class="collapse" aria-labelledby="heading86" data-parent="#controls"><div class="card-body">Memory corruption bugs are a popular mainstay for hackers. This class of bug results from a
                        programming error that causes the program to access an unintended memory location. Under the
                        right conditions, attackers can capitalize on this behavior to hijack the execution flow of the
                        vulnerable program and execute arbitrary code.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        This kind of vulnerability occurs in a number of ways:
                        <div>
                        <ul>
                        <li><b>Buffer overflows:</b> This describes a programming error where an app
                        writes beyond an allocated memory range for a particular operation. An attacker can use this
                        flaw to overwrite important control data located in adjacent memory, such as function pointers.
                        Buffer overflows were formerly the most common type of memory corruption flaw, but have become
                        less prevalent over the years due to a number of factors. Notably, awareness among developers of
                        the risks in using unsafe C library functions is now a common best practice plus, catching
                        buffer overflow bugs is relatively simple. However, it is still worth testing for such defects.&nbsp;</li>
                        <li><b>Out-of-bounds-access: </b>Buggy pointer arithmetic may cause a pointer
                        or index to reference a position beyond the bounds of the intended memory structure (e.g. buffer
                        or list). When an app attempts to write to an out-of-bounds address, a crash or unintended
                        behavior occurs. If the attacker can control the target offset and manipulate the content
                        written to some extent, code execution exploit is likely possible.&nbsp;</li>
                        <li><b>Dangling pointers:</b> These occur when an object with an incoming
                        reference to a memory location is deleted or deallocated, but the object pointer is not reset.
                        If the program later uses the dangling pointer to call a virtual function of the already
                        deallocated object, it is possible to hijack execution by overwriting the original vtable
                        pointer. Alternatively, it is possible to read or write object variables or other memory
                        structures referenced by a dangling pointer.&nbsp;</li>
                        <li><b>Use-after-free:</b> This refers to a special case of dangling pointers
                        referencing released (deallocated) memory. After a memory address is cleared, all pointers
                        referencing the location become invalid, causing the memory manager to return the address to a
                        pool of available memory. When this memory location is eventually re-allocated, accessing the
                        original pointer will read or write the data contained in the newly allocated memory. This
                        usually leads to data corruption and undefined behavior, but crafty attackers can set up the
                        appropriate memory locations to leverage control of the instruction pointer.&nbsp;</li>
                        <li><b>Integer overflows: </b>When the result of an arithmetic operation
                        exceeds the maximum value for the integer type defined by the programmer, this results in the
                        value &quot;wrapping around&quot; the maximum integer value, inevitably resulting in a
                        small value being stored. Conversely, when the result of an arithmetic operation is smaller than
                        the minimum value of the integer type, an integer underflow occurs where the result is larger
                        than expected. Whether a particular integer overflow/underflow bug is exploitable depends on how
                        the integer is used - for example, if the integer type were to represent the length of a
                        buffer,
                        this could create a buffer overflow vulnerability.&nbsp;</li>
                        <li><b>Format string vulnerabilities: </b>When unchecked user input is passed
                        to the format string parameter of the printf() family of C functions, attackers may inject
                        format tokens such as '%c' and '%n' to access memory. Format string bugs
                        are convenient to
                        exploit due to their flexibility. Should a program output the result of the string formatting
                        operation, the attacker can read and write to memory arbitrarily, thus bypassing protection
                        features such as ASLR.&nbsp;</li>
                        </ul>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        A best practice to fix the Memory Corruption Bugs are the following:&nbsp;
                        </div>
                        <div>
                        <ul>
                        <li>When using integer variables for array indexing, buffer length calculations, or any
                        other security-critical operation, verify that unsigned integer types are used and perform
                        precondition tests to prevent the possibility of integer wrapping.&nbsp;</li>
                        <li>Ensure the app does not use unsafe string functions such as strcpy, most other
                        functions beginning with the "str" prefix, sprint, vsprintf, gets, etc.; If the app
                        contains C++
                        code, ANSI C++ string classes are used; iOS apps written in Objective-C use NSString class. C
                        apps on iOS should use CFString, the Core Foundation representation of a string. No untrusted
                        data is concatenated into format strings.</li>
                        </ul>
                        </div>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading91"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse91" aria-expanded="true" aria-controls="collapse91">Threat: Malicious applications gain access to unauthorised data or perform unauthorised actions <span>[CAPEC-1]</span></button></h5></div><div id="collapse91" class="collapse" aria-labelledby="heading91" data-parent="#threats"><div class="card-body">Attackers could use malicious mobile applications to attack legitimate applications
                                that export their components improperly.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading90"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse90" aria-expanded="true" aria-controls="collapse90">Weakness: Incorrect Permission Assignment for Critical Resource <span>[CWE-732]</span></button></h5></div><div id="collapse90" class="collapse" aria-labelledby="heading90" data-parent="#weaknesses"><div class="card-body">The software specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.

When a resource is given a permission setting that provides access to a wider range of actors than required, it could lead to the exposure of sensitive information, or the modification of that resource by unintended parties. This is especially dangerous when the resource is related to program configuration, execution or sensitive user data.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading89"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse89" aria-expanded="true" aria-controls="collapse89">Countermeasure: Anonymize all data that is sent to 3rd Party services <span>[MASVS-2.6]</span></button></h5></div><div id="collapse89" class="collapse" aria-labelledby="heading89" data-parent="#controls"><div class="card-body">All data that is sent to 3rd Party services shall be anonymized, so no PII data is available
                        that would allow the 3rd party to identify the user account. Also all other data, like IDs in an
                        application that can be mapped to a user account or session should not be sent to a third party.
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading98"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse98" aria-expanded="true" aria-controls="collapse98">Risk pattern: Mobile Client: Post sensitive data <span>[MOBILE-CLIENT:SENS-DATA-TRANSMIT]</span></button></h5></div><div id="collapse98" class="collapse" aria-labelledby="heading98" data-parent="#components"><div class="card-body">Post sensitive data from the mobile client. This risk pattern is imported when we have a mobile device, and we don't know which  system runs and the mobile app sensitive data. It is a common risk pattern for all types of systems<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading97"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse97" aria-expanded="true" aria-controls="collapse97">Use case: Post sensitive data <span>[POST SENSITIVE DATA]</span></button></h5></div><div id="collapse97" class="collapse" aria-labelledby="heading97" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading96"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse96" aria-expanded="true" aria-controls="collapse96">Threat: Sensitive data could be compromised through autocompletion <span>[CAPEC-37-MOBILE]</span></button></h5></div><div id="collapse96" class="collapse" aria-labelledby="heading96" data-parent="#threats"><div class="card-body">An attacker with permanent or temporary access to the users' mobile device could gain
                                access to sensitive data if the mobile application supports auto-completion of that
                                data.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading95"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse95" aria-expanded="true" aria-controls="collapse95">Weakness: Information Exposure Through Browser Caching <span>[CWE-525-MOBILE]</span></button></h5></div><div id="collapse95" class="collapse" aria-labelledby="heading95" data-parent="#weaknesses"><div class="card-body">The application should have an appropriate caching policy specifying the extent to which data
                        and form fields should be cached.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading94"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse94" aria-expanded="true" aria-controls="collapse94">Countermeasure: Disable autocompletion of sensitive data <span>[CWE-525-MOBILE]</span></button></h5></div><div id="collapse94" class="collapse" aria-labelledby="heading94" data-parent="#controls"><div class="card-body">Auto-completion or pre-filling of sensitive details by the mobile device or browser implies
                        that those details are stored in plaintext or a reversible format. This may be in violation of
                        security best-practice, or application security expectations. T
                        <div>
                        <br />
                        </div>
                        <div>
                        he application should attempt to mitigate this risk by requesting the browser does not cache or
                        store sensitive data such as credit card PANs and CV2s, personally identifiable information
                        (PII) or other secret data. All forms handling sensitive data should be protected using the
                        autocomplete=off HTML directive at the form or field level. Issue browser specific directives to
                        request auto-fill or completion is disabled; The AUTOCOMPLETE attribute should be set to &quot;OFF&quot;.&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        Mobile applications must not store or offer to autocomplete sensitive data such as
                        authentication credentials, credit card numbers, or sensitive personal details. Where data is
                        stored locally, system provided stores should be used; for example, iOS and Android provide
                        password stores and digital wallets. It should be noted that compliance with these requests on
                        the client-side is optional, and many browsers and clients override these directives to use
                        operating system, browser, or third party password managers or key-safes to store secrets.
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading111"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse111" aria-expanded="true" aria-controls="collapse111">Risk pattern: Mobile Client: Read sensitive data <span>[MOBILE-CLIENT:SENS-DATA-RECEIVED]</span></button></h5></div><div id="collapse111" class="collapse" aria-labelledby="heading111" data-parent="#components"><div class="card-body">A mobile client that reads sensitive data from a service. This risk pattern is imported when we have a mobile device, and we don't know which operating system runs and the mobile app reads sensitive data. This is a common risk pattern for all types of operating systems.<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading110"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse110" aria-expanded="true" aria-controls="collapse110">Use case: Read sensitive data <span>[READ SENSITIVE DATA]</span></button></h5></div><div id="collapse110" class="collapse" aria-labelledby="heading110" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading109"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse109" aria-expanded="true" aria-controls="collapse109">Threat: Sensitive data is retrieved from the mobile device by an attacker <span>[CAPEC-204]</span></button></h5></div><div id="collapse109" class="collapse" aria-labelledby="heading109" data-parent="#threats"><div class="card-body">An attacker with access to the mobile device could inspect the cache to find sensitive
                                data.

                                Many applications that communicate with remote entities or which perform intensive
                                calculations utilize caches to improve efficiency. However, if the application computes
                                or receives sensitive information and the cache is not appropriately protected, an
                                attacker can browse the cache and retrieve this information. This can result in the
                                disclosure of sensitive information.

                                iOS in particular caches the active screen when an app is put into the background. This
                                screenshots is then stored on the file system.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading100"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse100" aria-expanded="true" aria-controls="collapse100">Weakness: API keys or secrets are stored on the device <span>[MOB-SECRET-STORED]</span></button></h5></div><div id="collapse100" class="collapse" aria-labelledby="heading100" data-parent="#weaknesses"><div class="card-body">API keys or global secrets stored on the device can be easily extracted by an attacker by
                        analyzing the application (reverse engineering).
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading99"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse99" aria-expanded="true" aria-controls="collapse99">Countermeasure: API keys, tokens, and secrets should be generated dynamically to prevent disclosure <span>[MOB-API-DYN]</span></button></h5></div><div id="collapse99" class="collapse" aria-labelledby="heading99" data-parent="#controls"><div class="card-body">Data hard-coded into the application may be exposed before installation. For example, API
                        keys, cryptographic keys, or other secrets shipped in the application may be retrieved by a
                        malicious party through examining the installer or its contents.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        To prevent interception or disclosure, API keys, tokens, and other secrets should be generated
                        dynamically. If the secrets have to be agreed before the application is even run, a trusted
                        credential interchange should happen on the first run. After the initial trusted credential
                        interchange on the first run, the secrets should be saved to the OS provided secure stores, for
                        example the iOS Keychain or Android Secure Preferences).
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading102"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse102" aria-expanded="true" aria-controls="collapse102">Weakness: Data is stored into unprotected locations <span>[MOB-DATA]</span></button></h5></div><div id="collapse102" class="collapse" aria-labelledby="heading102" data-parent="#weaknesses"><div class="card-body">When sensitive data is stored in unprotected locations, an attacker with access to the device
                        through physical access or a remote exploit, could gain access to it.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading101"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse101" aria-expanded="true" aria-controls="collapse101">Countermeasure: Store sensitive data only in protected locations <span>[MOB-DATA]</span></button></h5></div><div id="collapse101" class="collapse" aria-labelledby="heading101" data-parent="#controls"><div class="card-body">Applications storing or caching data locally are at risk of attack and compromise of that
                        data. Most mobile devices and operating systems offer built in API's to store data in their
                        encrypted stores, such as the Keychain on iOS. Data stored in shared memory, such as a removable
                        SD card, may be accessed by other applications on the device, or may be removed and accessed in
                        a third party system.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        Do not store sensitive or private data on shared or removable storage, such as SD cards. Where
                        data is stored on shared but non removable storage, there is still a risk an attacker with
                        physical access may be able to access the device storage and therefore the data.&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        Use OS provided secure storage for sensitive or private data.
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading104"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse104" aria-expanded="true" aria-controls="collapse104">Weakness: Information Exposure Through Caching <span>[CWE-524]</span></button></h5></div><div id="collapse104" class="collapse" aria-labelledby="heading104" data-parent="#weaknesses"><div class="card-body">The application uses a cache to maintain a pool of objects, threads, connections, pages, or
                        passwords to minimize the time it takes to access them or the resources to which they connect.
                        If implemented improperly, these caches can allow access to unauthorized information or cause a
                        denial of service vulnerability.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading103"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse103" aria-expanded="true" aria-controls="collapse103">Countermeasure: Clear caches of sensitive data <span>[CWE-524]</span></button></h5></div><div id="collapse103" class="collapse" aria-labelledby="heading103" data-parent="#controls"><div class="card-body">Applications storing or caching data locally are at risk of attack and compromise of that
                        data. Local temporary storage, thumbnail images, and configuration files often contain excerpts
                        of sensitive information that may be left on the device during or after the application is used.
                        <div>
                        <ul>
                        <li>Ensure all temporary files, caches, and storage are purged after use and when the
                        application is closed.&nbsp;</li>
                        <li>Do not allow the application to cache sensitive information outside of OS provided
                        secure stores.&nbsp;</li>
                        <li>Use OS controls to restrict thumbnails of the application where any sensitive
                        information is displayed</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading106"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse106" aria-expanded="true" aria-controls="collapse106">Weakness: Sensitive information is not cleared from memory <span>[CWE-226]</span></button></h5></div><div id="collapse106" class="collapse" aria-labelledby="heading106" data-parent="#weaknesses"><div class="card-body">The software does not fully clear previously used information in a data structure, file, or
                        other resource, before making that resource available to a party in another control sphere.

                        This typically results from new data that is not as long as the old data, which leaves portions
                        of the old data still available. Equivalent errors can occur in other situations where the
                        length of data is variable but the associated data structure is not. If memory is not cleared
                        after use, it may allow unintended actors to read the data when the memory is reallocated.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading105"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse105" aria-expanded="true" aria-controls="collapse105">Countermeasure: Overwrite data in memory before release <span>[CWE-226]</span></button></h5></div><div id="collapse105" class="collapse" aria-labelledby="heading105" data-parent="#controls"><div class="card-body">Memory chunks released by an application are not actively overwritten, they are simply
                        de-referenced with the data left until the memory is reallocated and used by another process. As
                        such, sensitive data that is stored in memory may be exposed to an attacker with the ability to
                        inspect that memory; for example through use of an uninitialized variable or other process.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        Overwrite memory with zeros or random data before release.&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        Pay particular attention to sensitive data, such as passwords or other credentials, or sensitive
                        personal information.
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading108"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse108" aria-expanded="true" aria-controls="collapse108">Weakness: The application leaks sensitive information <span>[MOB-INFO-LEAK]</span></button></h5></div><div id="collapse108" class="collapse" aria-labelledby="heading108" data-parent="#weaknesses"><div class="card-body">Information leakage is an application weakness in which an application reveals sensitive data,
                        such as technical details of the web application, environment, or user-specific data. Sensitive
                        data may be used by an attacker to exploit the target web application, its hosting network, or
                        its users. Therefore, leakage of sensitive data should be limited or prevented whenever
                        possible. Information leakage, in its most common form, is the result of one or more of the
                        following conditions: A failure to scrub out HTML/Script comments containing sensitive
                        information, improper application or server configurations, or differences in page responses for
                        valid versus invalid data.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading107"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse107" aria-expanded="true" aria-controls="collapse107">Countermeasure: Do not allow sensitive data to be written to log files or thumbnail/background images <span>[MOB-LOG-BACK]</span></button></h5></div><div id="collapse107" class="collapse" aria-labelledby="heading107" data-parent="#controls"><div class="card-body">Applications storing or caching data locally are at risk of attack and compromise of that
                        data. Local temporary storage, thumbnail images, and configuration files often contain excerpts
                        of sensitive information that may be left on the device during or after the application is used.
                        Sensitive data should not be logged by the application.
                        Where the data is relevant from a support perspective, it should be masked or otherwise
                        obfuscated, in accordance with industry or legislative requirements where appropriate (e.g. PAN
                        masking dictated by the PCI DSS standards).
                        Use OS controls to restrict thumbnails of the application where any sensitive information is
                        displayed.
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading175"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse175" aria-expanded="true" aria-controls="collapse175">Risk pattern: Mobile Client: Sensitive data <span>[MOBILE-CLIENT:SENS-DATA]</span></button></h5></div><div id="collapse175" class="collapse" aria-labelledby="heading175" data-parent="#components"><div class="card-body">This risk pattern is imported when we have a mobile device, and we don't know which operating system runs and the mobile app uses sensitive data (all processes with sensitive data, i.e. read, post). This is a common risk pattern for all types of operating systems.<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading120"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse120" aria-expanded="true" aria-controls="collapse120">Use case: Access sensitive data <span>[ACCESS SENSITIVE DATA]</span></button></h5></div><div id="collapse120" class="collapse" aria-labelledby="heading120" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading114"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse114" aria-expanded="true" aria-controls="collapse114">Threat: An attacker exploits a weakness in order to generate a certificate signing request <span>[CAPEC-459]</span></button></h5></div><div id="collapse114" class="collapse" aria-labelledby="heading114" data-parent="#threats"><div class="card-body">An attacker exploits a weakness in the MD5 hash algorithm (weak collision resistance)
                                to generate a certificate signing request (CSR) that contains collision blocks in the
                                &quot;to be signed&quot; part. The attacker specially crafts two different, but
                                valid X.509 certificates that when hashed with the MD5 algorithm would yield the same
                                value. The attacker then sends the CSR for one of the certificates to the Certification
                                Authority which uses the MD5 hashing algorithm. That request is completely valid and the
                                Certificate Authority issues an X.509 certificate to the attacker which is signed with
                                its private key. An attacker then takes that signed blob and inserts it into another
                                X.509 certificate that the attacker generated.&nbsp;
                                <div>
                                <br />
                                </div>
                                <div>
                                Due to the MD5 collision, both certificates, though different, hash to the same value
                                and so the signed blob works just as well in the second certificate. The net effect is
                                that the attackers' second X.509 certificate, which the Certification Authority has
                                never seen, is now signed and validated by that Certification Authority. To make the
                                attack more interesting, the second certificate could be not just a regular certificate,
                                but rather itself a signing certificate. Thus the attacker is able to start their own
                                Certification Authority that is anchored in its root of trust in the legitimate
                                Certification Authority that has signed the attackers' first X.509 certificate. If the
                                original Certificate Authority was accepted by default by browsers, so will now the
                                Certificate Authority set up by the attacker and of course any certificates that it
                                signs. So the attacker is now able to generate any SSL certificates to impersonate any
                                web server, and the user's browser will not issue any warning to the victim. This can be
                                used to compromise HTTPS communications and other types of systems where PKI and X.509
                                certificates may be used (e.g., VPN, IPSec) -
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading113"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse113" aria-expanded="true" aria-controls="collapse113">Weakness: Improper Certificate Validation <span>[CWE-295]</span></button></h5></div><div id="collapse113" class="collapse" aria-labelledby="heading113" data-parent="#weaknesses"><div class="card-body">The software does not validate, or incorrectly validates, a certificate.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading112"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse112" aria-expanded="true" aria-controls="collapse112">Countermeasure: Implement Certificate pinning <span>[MASVS-5.4]</span></button></h5></div><div id="collapse112" class="collapse" aria-labelledby="heading112" data-parent="#controls"><div class="card-body">Certificate pinning is the process of associating the backend server with a particular X509
                        certificate or public key, instead of accepting any certificate signed by a trusted certificate
                        authority. A mobile app that stores (&quot;pins&quot;) the server certificate or public
                        key will subsequently only establish connections to the known server. Verify that the server
                        certificate is pinned. Pinning can be implemented in multiple ways:&nbsp;
                        <div>
                        <ul>
                        <li>Including server's certificate in the application bundle and performing verification
                        on each connection. This requires an update mechanism whenever the certificate on the server is
                        updated Limiting certificate issuer to e.g. one entity and bundling the intermediate CA's public
                        key into the application. In this way we limit the attack surface and have a valid certificate.&nbsp;</li>
                        <li>Owning and managing your own PKI. The application would contain the intermediate CA's
                        public key. This avoids updating the application every time you change the certificate on the
                        server, due to e.g. expiration.&nbsp;</li>
                        </ul>Note that using your own CA would cause the certificate to be self-singed.
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading119"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse119" aria-expanded="true" aria-controls="collapse119">Threat: User data or credentials are compromised through network sniffing or man-in-the-middle attacks <span>[CAPEC-158-SESSION]</span></button></h5></div><div id="collapse119" class="collapse" aria-labelledby="heading119" data-parent="#threats"><div class="card-body">An attacker with access to the network path between the victim and the server could
                                employ a sniffer to observe clear text traffic on the network. If the session ID is
                                transmitted in clear text, then the attacker could compromise it and thereby gain access
                                to the user's session.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading116"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse116" aria-expanded="true" aria-controls="collapse116">Weakness: Cleartext Transmission of Sensitive Information <span>[CWE-319]</span></button></h5></div><div id="collapse116" class="collapse" aria-labelledby="heading116" data-parent="#weaknesses"><div class="card-body">The software transmits sensitive or security-critical data in cleartext in a communication channel that can be sniffed by unauthorized actors.

Many communication channels can be "sniffed" by attackers during data transmission. For example, network traffic can often be sniffed by any attacker who has access to a network interface. This significantly lowers the difficulty of exploitation by attackers.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading115"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse115" aria-expanded="true" aria-controls="collapse115">Countermeasure: Ensure that each critical operation requires at least one additional channel (e.g., SMS, e-mail, or token) <span>[MASVS-5.5]</span></button></h5></div><div id="collapse115" class="collapse" aria-labelledby="heading115" data-parent="#controls"><div class="card-body">Identify all of the tested application's critical operations (e.g., user enrollment, account
                        recovery, and money transfer) and make sure that critical operations enforce the use of at least
                        one additional channel to confirm user actions. These channels must not be bypassed when
                        executing critical operations. The following are examples of additional verification channels:&nbsp;
                        <div>
                        <ul>
                        <li>Token (e.g., RSA token, yubikey);&nbsp;</li>
                        <li>Push notification (e.g., Google Prompt);&nbsp;</li>
                        <li>SMS;&nbsp;</li>
                        <li>E-mail;&nbsp;</li>
                        <li>Data from another website you visited or scanned;&nbsp;</li>
                        <li>Data from a physical letter or physical entry point (e.g., data you receive only after
                        signing a document at a bank).&nbsp;</li>
                        </ul>If you're going to implement an additional factor to verify the user's identity,
                        consider Infobip 2FA library or one-time passcodes (OTP) via Google Authenticator.
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading118"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse118" aria-expanded="true" aria-controls="collapse118">Weakness: Use of Single-factor Authentication <span>[CWE-308]</span></button></h5></div><div id="collapse118" class="collapse" aria-labelledby="heading118" data-parent="#weaknesses"><div class="card-body">The use of single-factor authentication can lead to unnecessary risk of compromise when
                        compared with the benefits of a dual-factor authentication scheme.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading117"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse117" aria-expanded="true" aria-controls="collapse117">Countermeasure: Ensure that each critical operation requires at least one additional channel (e.g., SMS, e-mail, or token) <span>[MASVS-5.5]</span></button></h5></div><div id="collapse117" class="collapse" aria-labelledby="heading117" data-parent="#controls"><div class="card-body">Identify all of the tested application's critical operations (e.g., user enrollment, account
                        recovery, and money transfer) and make sure that critical operations enforce the use of at least
                        one additional channel to confirm user actions. These channels must not be bypassed when
                        executing critical operations. The following are examples of additional verification channels:&nbsp;
                        <div>
                        <ul>
                        <li>Token (e.g., RSA token, yubikey);&nbsp;</li>
                        <li>Push notification (e.g., Google Prompt);&nbsp;</li>
                        <li>SMS;&nbsp;</li>
                        <li>E-mail;&nbsp;</li>
                        <li>Data from another website you visited or scanned;&nbsp;</li>
                        <li>Data from a physical letter or physical entry point (e.g., data you receive only after
                        signing a document at a bank).&nbsp;</li>
                        </ul>If you're going to implement an additional factor to verify the user's identity,
                        consider Infobip 2FA library or one-time passcodes (OTP) via Google Authenticator.
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading131"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse131" aria-expanded="true" aria-controls="collapse131">Use case: Authentication <span>[AUTHENTICATION]</span></button></h5></div><div id="collapse131" class="collapse" aria-labelledby="heading131" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading123"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse123" aria-expanded="true" aria-controls="collapse123">Threat: An attacker obtains an authoritative or reputable signer's private signature key by theft  <span>[CAPEC-474]</span></button></h5></div><div id="collapse123" class="collapse" aria-labelledby="heading123" data-parent="#threats"><div class="card-body">An attacker obtains an authoritative or reputable signer's private signature key by
                                theft and then uses this key to forge signatures from the original signer to mislead a
                                victim into performing actions that benefit the attacker.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading122"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse122" aria-expanded="true" aria-controls="collapse122">Weakness: The application does not wipe used and not needed passwords or key material <span>[CWE-255]</span></button></h5></div><div id="collapse122" class="collapse" aria-labelledby="heading122" data-parent="#weaknesses"><div class="card-body">When using password or key material within an application, these are copied in memory and can be copied back to the disk depending on several factors.

If the application handles passwords or key material, an attacker with access to the system could inspect the memory or the hard disk to retrieve back those secrets on its original form.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading121"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse121" aria-expanded="true" aria-controls="collapse121">Countermeasure: Create the mechanisms to control the lifecycle of cryptographic keys <span>[MASVS-1.11]</span></button></h5></div><div id="collapse121" class="collapse" aria-labelledby="heading121" data-parent="#controls"><div class="card-body">Create the mechanisms to control the lifecycle of the cryptographic keys as it's shown in the
                        key management standard as NIST SP 800-57. In this standard the usage period is determined as
                        follows:
                        <div>
                        <ul>
                        <li>Originator Usage Period (OUP)&nbsp;</li>
                        <ul>
                        <li>Private Signature Key: 1-3 years</li>
                        <li>Public Signature Key: Several years&nbsp;</li>
                        <li>Symmetric Authentication Key: &lt;= 2 years</li>
                        <li>Private Authentication Key: 1-2 years&nbsp;</li>
                        <li>Public Authentication Key: 1-2 years&nbsp;</li>
                        <li>Symmetric Data Encryption Key: &lt;= 2 years&nbsp;</li>
                        <li>Symmetric Key Wrapping Key: &lt;= 2 years</li>
                        <li>Symmetric RBG keys: Determined by design&nbsp;</li>
                        <li>Symmetric Master Key: About 1 year&nbsp;</li>
                        <li>Private Key Transport Key: &lt;= 2 years&nbsp;</li>
                        <li>Public Key Transport Key: 1-2 years&nbsp;</li>
                        <li>Symmetric Key Agreement Key 1-2 years&nbsp;</li>
                        <li>Private Static Key Agreement Key: 1-2 years&nbsp;</li>
                        <li>Public Static Key Agreement Key: 1-2 years&nbsp;</li>
                        <li>Private Ephemeral Key Agreement Key: One key agreement transaction&nbsp;</li>
                        <li>Public Ephemeral Key Agreement Key: One key agreement transaction&nbsp;</li>
                        <li>Symmetric Authorization Key: &lt;= 2 years&nbsp;</li>
                        <li>Private Authorization Key: &lt;= 2 years&nbsp;</li>
                        <li>Public Authorization Key: &lt;= 2 years</li>
                        </ul>
                        </ul>
                        <ul>
                        <li>Recipient Usage Period</li>
                        <ul>
                        <li>Private Signature Key:&nbsp; -</li>
                        <li>Public Signature Key: Several years&nbsp;</li>
                        <li>Symmetric Authentication Key: &lt;= OUP + 3 years&nbsp;</li>
                        <li>Private Authentication Key: 1-2 years&nbsp;</li>
                        <li>Public Authentication Key: 1-2 years&nbsp;</li>
                        <li>Symmetric Data Encryption Key: &lt;= OUP + 3 years&nbsp;</li>
                        <li>Symmetric Key Wrapping Key: &lt;= OUP + 3 years&nbsp;</li>
                        <li>Symmetric RBG keys: -</li>
                        <li>Symmetric Master Key: -</li>
                        <li>Private Key Transport Key: &lt;= 2 years&nbsp;</li>
                        <li>Public Key Transport Key: 1-2 years&nbsp;</li>
                        <li>Symmetric Key Agreement Key 1-2 years&nbsp;</li>
                        <li>Private Static Key Agreement Key: 1-2 years&nbsp;</li>
                        <li>Public Static Key Agreement Key: 1-2 years&nbsp;</li>
                        <li>Private Ephemeral Key Agreement Key: One key agreement transaction&nbsp;</li>
                        <li>Public Ephemeral Key Agreement Key: One key agreement transaction&nbsp;</li>
                        <li>Symmetric Authorization Key: &lt;= 2 years&nbsp;</li>
                        <li>Private Authorization Key: &lt;= 2 years&nbsp;</li>
                        <li>Public Authorization Key: &lt;= 2 years</li>
                        </ul>
                        </ul>
                        <ul>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading127"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse127" aria-expanded="true" aria-controls="collapse127">Threat: Attackers bypass authentication implemented on the client side <span>[CAPEC-21]</span></button></h5></div><div id="collapse127" class="collapse" aria-labelledby="heading127" data-parent="#threats"><div class="card-body">If a predictable token is used to authorize requests to read or post data, or if the
                                token can easily be compromised, then an attacker could use this token to impersonate
                                the user.

                                In mobile applications, using seemingly unique values such as the IMEI or UDID numbers
                                to authorize users can be abused since any application on the device can read these
                                values.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading126"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse126" aria-expanded="true" aria-controls="collapse126">Weakness: Improper Authentication <span>[CWE-287]</span></button></h5></div><div id="collapse126" class="collapse" aria-labelledby="heading126" data-parent="#weaknesses"><div class="card-body">When an actor claims to have a given identity, the software does not prove or insufficiently
                        proves that the claim is correct.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading124"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse124" aria-expanded="true" aria-controls="collapse124">Countermeasure: Implement biometric authentication <span>[MASVS-4.6]</span></button></h5></div><div id="collapse124" class="collapse" aria-labelledby="heading124" data-parent="#controls"><div class="card-body">Implement biometric authentication that is not event-bound (i.e. using an API that simply
                        returns "true" or "false"). Instead, ensure it is based on unlocking the keychain/keystore and
                        does not provide information about the methods and processes of authentication.
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading125"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse125" aria-expanded="true" aria-controls="collapse125">Countermeasure: Apply a step-up authentication for Transaction Signing with Push Notifications and PKI <span>[MASVS-4.9]</span></button></h5></div><div id="collapse125" class="collapse" aria-labelledby="heading125" data-parent="#controls"><div class="card-body">Transaction signing requires authentication of the user's approval of critical transactions.
                        Asymmetric cryptography is the best way to implement transaction signing. The app will generate
                        a public/private key pair when the user signs up, then registers the public key on the back end.
                        The private key is securely stored in the device keystore.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        To authorize a transaction, the back end sends the mobile app a push notification containing the
                        transaction data. The user is then asked to confirm or deny the transaction. After confirmation,
                        the user is prompted to unlock the Keychain (by entering the PIN or fingerprint), and the data
                        is signed with user's private key. The signed transaction is then sent to the server, which
                        verifies the signature with the user's public key.
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading130"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse130" aria-expanded="true" aria-controls="collapse130">Threat: Attackers gain access to critical functions by compromising the session ID <span>[CSD-SESSION-ID]</span></button></h5></div><div id="collapse130" class="collapse" aria-labelledby="heading130" data-parent="#threats"><div class="card-body">If a session ID is leaked through a flaw in the application, then attackers could
                                perform sensitive operations or hijack the session of the affected user. This type of
                                attack does not usually result in mass-compromise of ID's.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading129"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse129" aria-expanded="true" aria-controls="collapse129">Weakness: Insufficient Session Expiration <span>[CWE-613]</span></button></h5></div><div id="collapse129" class="collapse" aria-labelledby="heading129" data-parent="#weaknesses"><div class="card-body">Insufficient Session Expiration is when a web site permits an attacker to reuse old session credentials or session IDs for authorization.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading128"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse128" aria-expanded="true" aria-controls="collapse128">Countermeasure: Implement functionality to terminate the session at the remote endpoint after a predefined period of inactivity <span>[MASVS-4.7]</span></button></h5></div><div id="collapse128" class="collapse" aria-labelledby="heading128" data-parent="#controls"><div class="card-body">In most popular frameworks, you can set the session timeout via configuration options. This
                        parameter should be set according to the best practices specified in the framework
                        documentation. The recommended timeout may be between 10 minutes and two hours, depending on the
                        app's sensitivity.
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading141"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse141" aria-expanded="true" aria-controls="collapse141">Use case: General <span>[GENERAL]</span></button></h5></div><div id="collapse141" class="collapse" aria-labelledby="heading141" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading134"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse134" aria-expanded="true" aria-controls="collapse134">Threat: An attacker monitors data streams to or from a target in order to gather information <span>[CAPEC-117]</span></button></h5></div><div id="collapse134" class="collapse" aria-labelledby="heading134" data-parent="#threats"><div class="card-body">An attacker monitors data streams to or from a target in order to gather information.
                                This attack may be undertaken in order to gather information to support a later attack,
                                or the data collected may be the end goal of the attack. This attack usually involves
                                sniffing network traffic, but may include observing other types of data streams, such as
                                radio. In most varieties of this attack, the attacker is passive and simply observes
                                regular communication, however in some variants the attacker may attempt to initiate the
                                establishment of a data stream or influence the nature of the data transmitted. However,
                                in all variants of this attack, and distinguishing this attack from other data
                                collection methods, the attacker is not the intended recipient of the data stream.
                                Unlike some other data leakage attacks, the attacker is observing explicit data channels
                                (e.g. network traffic) and reading the content. This differs from attacks that collect
                                more qualitative information, such as communication volume, or other information not
                                explicitly communicated via a data stream.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading133"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse133" aria-expanded="true" aria-controls="collapse133">Weakness: Information Exposure <span>[CWE-200]</span></button></h5></div><div id="collapse133" class="collapse" aria-labelledby="heading133" data-parent="#weaknesses"><div class="card-body">An information exposure is the intentional or unintentional disclosure of information to an
                        actor that is not explicitly authorized to have access to that information.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading132"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse132" aria-expanded="true" aria-controls="collapse132">Countermeasure: Create warnings to educate personnel <span>[MASVS-2.12]</span></button></h5></div><div id="collapse132" class="collapse" aria-labelledby="heading132" data-parent="#controls"><div class="card-body">Create warning notifications to educate personnel who work with personally identifiable
                        information. These warnings are shown to the users when they use the app for first time.
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading140"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse140" aria-expanded="true" aria-controls="collapse140">Threat: Users lose trust in the application because it requests unnecessary privileges <span>[CAPEC-122-MOBILE]</span></button></h5></div><div id="collapse140" class="collapse" aria-labelledby="heading140" data-parent="#threats"><div class="card-body">If the mobile application requests permissions or access to components that are not
                                strictly needed by the application, then users can lose trust in the security of the
                                application with an associated impact on the trust placed in the application provider.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading139"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse139" aria-expanded="true" aria-controls="collapse139">Weakness: Execution with Unnecessary Privileges <span>[CWE-250]</span></button></h5></div><div id="collapse139" class="collapse" aria-labelledby="heading139" data-parent="#weaknesses"><div class="card-body">The software performs an operation at a privilege level that is higher than the minimum level
                        required, which creates new weaknesses or amplifies the consequences of other weaknesses.

                        New weaknesses can be exposed because running with extra privileges, such as root or
                        Administrator, can disable the normal security checks being performed by the operating system or
                        surrounding environment. Other pre-existing weaknesses can turn into security vulnerabilities if
                        they occur while operating at raised privileges. Privilege management functions can behave in
                        some less-than-obvious ways, and they have different quirks on different platforms. These
                        inconsistencies are particularly pronounced if you are transitioning from one non-root user to
                        another. Signal handlers and spawned processes run at the privilege of the owning process, so if
                        a process is running as root when a signal fires or a sub-process is executed, the signal
                        handler or sub-process will operate with root privileges.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading135"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse135" aria-expanded="true" aria-controls="collapse135">Countermeasure: Request only the minimum required permissions from the mobile operating system <span>[CWE-250-MOBILE]</span></button></h5></div><div id="collapse135" class="collapse" aria-labelledby="heading135" data-parent="#controls"><div class="card-body">Security best practice dictates the practice of least-privilege is followed, thereby reducing the attack surface and risk of compromise. By limiting the access an application has to the system, developers may reduce the impact a compromise may have.&nbsp; 
<div> 
 <br /> 
</div> 
<div>
  Request only the minimum required permissions from the mobile operating system. For example, if there is no requirement to use the camera then the application should not request this permission. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Review features and functionality present in the application, in particular legacy features, to determine if they are relevant and required, and if not remove them and associated OS permissions. 
</div></div></div></div><div class="card border-success"><div class="card-header " id="heading136"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse136" aria-expanded="true" aria-controls="collapse136">Countermeasure: Create the functionality to verify the app uses a minimum device-access-security policy <span>[MASVS-2.11]</span></button></h5></div><div id="collapse136" class="collapse" aria-labelledby="heading136" data-parent="#controls"><div class="card-body">Different checks on the Android device can be implemented by querying different system preferences from Settings.Secure. The Device Administration API offers different mechanisms to create security aware applications, that are able to enforce password policies or encryption of the device.</div></div></div><div class="card border-success"><div class="card-header " id="heading137"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse137" aria-expanded="true" aria-controls="collapse137">Countermeasure: Implement root detection notification to inform the user about the threats of this action <span>[MASVS-6.10]</span></button></h5></div><div id="collapse137" class="collapse" aria-labelledby="heading137" data-parent="#controls"><div class="card-body">Implement root detection functionality within the Android app, libraries can be used like RootBeer. The root detection should either trigger a warning to the user after start, to remind him that the device is rooted and that the user can only proceed at his own risk. Alternatively, the app can terminate itself in case a rooted environment is detected. This decision is dependent on the business requirements and the risk appetite of the stakeholders.</div></div></div><div class="card border-success"><div class="card-header " id="heading138"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse138" aria-expanded="true" aria-controls="collapse138">Countermeasure: Implement two or more independent functionallies for root detection <span>[MASVS-8.1]</span></button></h5></div><div id="collapse138" class="collapse" aria-labelledby="heading138" data-parent="#controls"><div class="card-body">Implement two or more independent methods to detect rooted devices and if the device is rooted, the app shall respond in two ways:&nbsp; 
<div> 
 <ul> 
  <li>The app notifies the user that their device is rooted and it's not secure to continue with the app.&nbsp;</li> 
  <li>Terminate the session and the app, because sensitive data is vulnerable.</li> 
 </ul> 
</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading145"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse145" aria-expanded="true" aria-controls="collapse145">Use case: Read sensitive data <span>[READ SENSITIVE DATA]</span></button></h5></div><div id="collapse145" class="collapse" aria-labelledby="heading145" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading144"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse144" aria-expanded="true" aria-controls="collapse144">Threat: Attackers gain unauthorised access to data or services by exploiting known weaknesses in components, libraries, modules, frameworks, platform and operating systems <span>[CWE-937]</span></button></h5></div><div id="collapse144" class="collapse" aria-labelledby="heading144" data-parent="#threats"><div class="card-body">Application components, libraries, modules, frameworks, platform, and operating
                                systems could suffer from known vulnerabilities. There is a high risk that an attacker
                                could easily gain access to the underlying systems or data by exploiting these
                                vulnerabilities.

                                In some cases, public exploits exist, making the exploitation process even easier.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading143"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse143" aria-expanded="true" aria-controls="collapse143">Weakness: Components, libraries, modules, frameworks, platform, and operating systems contain known security weaknesses <span>[CWE-937]</span></button></h5></div><div id="collapse143" class="collapse" aria-labelledby="heading143" data-parent="#weaknesses"><div class="card-body">In theory, it ought to be easy to figure out if you are currently using any vulnerable
                        components or libraries. Unfortunately, vulnerability reports for commercial or open source
                        software do not always specify exactly which versions of a component are vulnerable in a
                        standard, searchable way. Further, not all libraries use an understandable version numbering
                        system. Worst of all, not all vulnerabilities are reported to a central clearing house that is
                        easy to search, although sites like CVE and NVD are becoming easier to search.

                        Determining if you are vulnerable requires searching these databases, as well as keeping abreast
                        of project mailing lists and announcements for anything that might be a vulnerability. If one of
                        your components does have a vulnerability, you should carefully evaluate whether you are
                        actually vulnerable by checking to see if your code uses the part of the component with the
                        vulnerability and whether the flaw could result in an impact you care about.

                        Component vulnerabilities can cause almost any type of risk imaginable, ranging from the trivial
                        to sophisticated malware designed to target a specific organization. Components almost always
                        run with the full privilege of the application, so flaws in any component can be serious.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading142"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse142" aria-expanded="true" aria-controls="collapse142">Countermeasure: Do not share sensitive data with third parties unless it is a necessary part of the architecture <span>[MASVS-2.3]</span></button></h5></div><div id="collapse142" class="collapse" aria-labelledby="heading142" data-parent="#controls"><div class="card-body">Do not share sensitive data with third parties unless it is a necessary part of the
                        architecture, because sensitive data such as credentials or Personal Identifiable Information
                        can be intercepted in transport.
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading174"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse174" aria-expanded="true" aria-controls="collapse174">Use case: Sensitive Read or Post data <span>[SENSITIVE READ OR POST DATA]</span></button></h5></div><div id="collapse174" class="collapse" aria-labelledby="heading174" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading152"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse152" aria-expanded="true" aria-controls="collapse152">Threat: An attacker discovers the structure, function, and composition of a type of computer software through white box analysis techniques <span>[CAPEC-167]</span></button></h5></div><div id="collapse152" class="collapse" aria-labelledby="heading152" data-parent="#threats"><div class="card-body">An attacker discovers the structure, function, and composition of a type of computer
                                software through white box analysis techniques. White box techniques involve methods
                                which can be applied to a piece of software when an executable or some other compiled
                                object can be directly subjected to analysis, revealing at least a portion of its
                                machine instructions that can be observed upon execution.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading147"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse147" aria-expanded="true" aria-controls="collapse147">Weakness: Exposure of Backup File to an Unauthorized Control Sphere <span>[CWE-530]</span></button></h5></div><div id="collapse147" class="collapse" aria-labelledby="heading147" data-parent="#weaknesses"><div class="card-body">A backup file is stored in a directory that is accessible to actors outside of the intended
                        control sphere.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading146"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse146" aria-expanded="true" aria-controls="collapse146">Countermeasure: Disable auto-backup for sensitive data <span>[MASVS-2.8]</span></button></h5></div><div id="collapse146" class="collapse" aria-labelledby="heading146" data-parent="#controls"><div class="card-body">The auto backup attribute is enabled by default, this attribute shall be disabled for the
                        following cases:
                        Sensitive information should not be sent in clear text to the cloud.
                        Either, avoid storing the information in the first place, or encrypt the information at rest,
                        before sending it to the cloud.
                        Files can also be excluded from Auto Backup, in case they should not be shared in the Cloud.
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading149"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse149" aria-expanded="true" aria-controls="collapse149">Weakness: Reusing a Nonce, Key Pair in Encryption <span>[CWE-323]</span></button></h5></div><div id="collapse149" class="collapse" aria-labelledby="heading149" data-parent="#weaknesses"><div class="card-body">Nonces should be used for the present occasion and only once.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading148"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse148" aria-expanded="true" aria-controls="collapse148">Countermeasure: Do not re-use the same cryptographic key for multiple purposes <span>[MASVS-3.5]</span></button></h5></div><div id="collapse148" class="collapse" aria-labelledby="heading148" data-parent="#controls"><div class="card-body"></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading151"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse151" aria-expanded="true" aria-controls="collapse151">Weakness: Use of Hard-coded Cryptographic Key <span>[CWE-321]</span></button></h5></div><div id="collapse151" class="collapse" aria-labelledby="heading151" data-parent="#weaknesses"><div class="card-body">The use of a hard-coded cryptographic key significantly increases the possibility that
                        encrypted data may be recovered.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading150"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse150" aria-expanded="true" aria-controls="collapse150">Countermeasure: Do not hard-code encryption keys when using symmetric encryption <span>[MASVS-3.1]</span></button></h5></div><div id="collapse150" class="collapse" aria-labelledby="heading150" data-parent="#controls"><div class="card-body">The security of symmetric encryption and keyed hashes (MACs) depends on the secrecy of the
                        key. If the key is disclosed, the security gained by encryption is lost. To prevent this, never
                        store secret keys in the same place as the encrypted data they helped create. Developers often
                        make the mistake of encrypting locally stored data with a static, hard-coded encryption key and
                        compiling that key into the app. This makes the key accessible to anyone who can use a
                        disassembler. Ensure that no keys or passwords are stored within the source code.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        Note that hard-coded keys are problematic even if the source code is obfuscated since
                        obfuscation is easily bypassed by dynamic instrumentation. If the app is using two-way SSL (both
                        server and client certificates are validated), make sure that:&nbsp;
                        </div>
                        <div>
                        <ul>
                        <li>The password to the client certificate isn't stored locally or is locked in the device
                        Keychain.&nbsp;</li>
                        <li>The client certificate isn't shared among all installations.&nbsp;</li>
                        <li>If the app relies on additional encrypted containers stored in app data, check how the
                        encryption key is used.&nbsp;</li>
                        <li>If a key-wrapping scheme is used, ensure that the master secret is initialized for
                        each user or the container is re-encrypted with new key.&nbsp;</li>
                        <li>If you can use the master secret or previous password to decrypt the container, check
                        how password changes are handled.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading157"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse157" aria-expanded="true" aria-controls="collapse157">Threat: An attacker examines a target application's cache for sensitive information <span>[CAPEC-204]</span></button></h5></div><div id="collapse157" class="collapse" aria-labelledby="heading157" data-parent="#threats"><div class="card-body">An attacker examines a target application's cache for sensitive information. Many
                                applications that communicate with remote entities or which perform intensive
                                calculations utilize caches to improve efficiency. However, if the application computes
                                or receives sensitive information and the cache is not appropriately protected, an
                                attacker can browse the cache and retrieve this information. This can result in the
                                disclosure of sensitive information.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading154"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse154" aria-expanded="true" aria-controls="collapse154">Weakness: Information Exposure Through Caching <span>[CWE-524]</span></button></h5></div><div id="collapse154" class="collapse" aria-labelledby="heading154" data-parent="#weaknesses"><div class="card-body">The application uses a cache to maintain a pool of objects, threads, connections, pages, or
                        passwords to minimize the time it takes to access them or the resources to which they connect.
                        If implemented improperly, these caches can allow access to unauthorized information or cause a
                        denial of service vulnerability.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading153"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse153" aria-expanded="true" aria-controls="collapse153">Countermeasure: Mask sensitive data when the data is shown in the app <span>[MASVS-2.7]</span></button></h5></div><div id="collapse153" class="collapse" aria-labelledby="heading153" data-parent="#controls"><div class="card-body">Many apps require users to enter several kinds of data to, for example, register an account or make a payment. Sensitive data may be exposed if the app doesn't properly mask it, when displaying data in clear text. Masking of sensitive data, by showing asterisk or dots instead of clear text should be enforced within an app's activity to prevent disclosure and mitigate risks such as shoulder surfing.</div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading156"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse156" aria-expanded="true" aria-controls="collapse156">Weakness: The application leaks sensitive information <span>[MOB-INFO-LEAK]</span></button></h5></div><div id="collapse156" class="collapse" aria-labelledby="heading156" data-parent="#weaknesses"><div class="card-body">Information leakage is an application weakness in which an application reveals sensitive data,
                        such as technical details of the web application, environment, or user-specific data. Sensitive
                        data may be used by an attacker to exploit the target web application, its hosting network, or
                        its users. Therefore, leakage of sensitive data should be limited or prevented whenever
                        possible. Information leakage, in its most common form, is the result of one or more of the
                        following conditions: A failure to scrub out HTML/Script comments containing sensitive
                        information, improper application or server configurations, or differences in page responses for
                        valid versus invalid data.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading155"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse155" aria-expanded="true" aria-controls="collapse155">Countermeasure: Disable the clipboard for sensitive data <span>[MASVS-2.5]</span></button></h5></div><div id="collapse155" class="collapse" aria-labelledby="heading155" data-parent="#controls"><div class="card-body">A general best practice is overwriting different functions in the input field to disable the clipboard specifically for it. Also longclickable should be deactivated for the input field.</div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading162"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse162" aria-expanded="true" aria-controls="collapse162">Threat: An attacker leverages Cryptanalysis to gain access to sensitive data <span>[CAPEC-97]</span></button></h5></div><div id="collapse162" class="collapse" aria-labelledby="heading162" data-parent="#threats"><div class="card-body">Cryptanalysis is the process of finding weaknesses in cryptographic algorithms and
                                using these weaknesses to decipher the ciphertext without knowing the secret key
                                (instance deduction). Sometimes the weakness is not in the cryptographic algorithm
                                itself, but rather in how it is applied that makes cryptanalysis successful. An attacker
                                may have other goals as well, such as:
                                The goal of the attacker performing cryptanalysis will depend on the specific needs of
                                the attacker in a given attack context. In most cases, if cryptanalysis is successful at
                                all, an attacker will not be able to go past being able to deduce some information about
                                the plaintext (goal 3). However, that may be sufficient for an attacker, depending on
                                the context.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading161"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse161" aria-expanded="true" aria-controls="collapse161">Weakness: Use of a Broken or Risky Cryptographic Algorithm <span>[CWE-327]</span></button></h5></div><div id="collapse161" class="collapse" aria-labelledby="heading161" data-parent="#weaknesses"><div class="card-body">The use of a broken or risky cryptographic algorithm is an unnecessary risk that may result in
                        the exposure of sensitive information.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading158"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse158" aria-expanded="true" aria-controls="collapse158">Countermeasure: Use proven implementations of cryptographic primitives <span>[MASVS-3.2]</span></button></h5></div><div id="collapse158" class="collapse" aria-labelledby="heading158" data-parent="#controls"><div class="card-body">It's recommended to use well-known algorithms that are widely regarded as secure. Mobile
                        operating systems offer standard cryptographic APIs that implement those algorithms.
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading159"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse159" aria-expanded="true" aria-controls="collapse159">Countermeasure: Use other block modes rather than ECB mode for AES encryption <span>[MASVS-3.3-KEY-AES]</span></button></h5></div><div id="collapse159" class="collapse" aria-labelledby="heading159" data-parent="#controls"><div class="card-body">Advanced Encryption Standard (AES) is the widely accepted standard for symmetric encryption in
                        mobile apps. It's an iterative block cipher that is based on a series of linked mathematical
                        operations. AES performs a variable number of rounds on the input, each of which involve
                        substitution and permutation of the bytes in the input block. Each round uses a 128-bit round
                        key which is derived from the original AES key. As of this writing, no efficient cryptanalytic
                        attacks against AES have been discovered. However, implementation details and configurable
                        parameters such as the block cipher mode leave some margin for error.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        You shall configure AES encryption with Cipher Block Chaining (CBC) mode instead of ECB mode.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        In CBC mode, plaintext blocks are XORed with the previous ciphertext block. This ensures each
                        encrypted block is unique and randomized even if blocks contain the same information. When
                        storing encrypted data, we recommend using a block mode that also protects the integrity of the
                        stored data, such as Galois/Counter Mode (GCM). The latter has the additional benefit that the
                        algorithm is mandatory for each TLSv1.2 implementation, and thus is available on all modern
                        platforms.
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading160"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse160" aria-expanded="true" aria-controls="collapse160">Countermeasure: Frequently review the used cryptographic protocols and controls to ensure they are not deprecated  <span>[MASVS-3.4]</span></button></h5></div><div id="collapse160" class="collapse" aria-labelledby="heading160" data-parent="#controls"><div class="card-body">Ensure the cryptographic protocols or algorithms used are widely considered suitable for
                        security purposes. Frequently review all cryptographic protocols and algorithms to verify they
                        are not deprecated.
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading167"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse167" aria-expanded="true" aria-controls="collapse167">Threat: An attacker obtains an authoritative signer's private signature key by exploiting a cryptographic weaknesses <span>[CAPEC-485]</span></button></h5></div><div id="collapse167" class="collapse" aria-labelledby="heading167" data-parent="#threats"><div class="card-body">An attacker obtains an authoritative or reputable signer's private signature key by
                                exploiting a cryptographic weakness in the signature algorithm or pseudorandom number
                                generation and then uses this key to forge signatures from the original signer to
                                mislead a victim into performing actions which benefit the attacker.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading164"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse164" aria-expanded="true" aria-controls="collapse164">Weakness: Not Using a Random IV with CBC Mode <span>[CWE-329]</span></button></h5></div><div id="collapse164" class="collapse" aria-labelledby="heading164" data-parent="#weaknesses"><div class="card-body">Not using a random initialization Vector (IV) with Cipher Block Chaining (CBC) Mode causes
                        algorithms to be susceptible to dictionary attacks.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading163"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse163" aria-expanded="true" aria-controls="collapse163">Countermeasure: Use Random IV with CBC Mode <span>[MASVS-3.3-RANDOM-KEY]</span></button></h5></div><div id="collapse163" class="collapse" aria-labelledby="heading163" data-parent="#controls"><div class="card-body">CBC mode requires the first plaintext block to be combined with an initialization vector (IV).
                        The IV doesn't have to be kept secret, but it shouldn't be predictable. Make sure that IVs are
                        generated using a cryptographically-secure random number generator. For more information on IVs,
                        see Crypto Fail's initialization vectors article.
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading166"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse166" aria-expanded="true" aria-controls="collapse166">Weakness: Use of Insufficiently Random Values <span>[CWE-330]</span></button></h5></div><div id="collapse166" class="collapse" aria-labelledby="heading166" data-parent="#weaknesses"><div class="card-body">The software may use insufficiently random numbers or values in a security context that
                        depends on unpredictable numbers.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading165"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse165" aria-expanded="true" aria-controls="collapse165">Countermeasure: All random values are generated using a sufficiently secure random number generator <span>[MASVS-3.6]</span></button></h5></div><div id="collapse165" class="collapse" aria-labelledby="heading165" data-parent="#controls"><div class="card-body">Mobile SDKs offer standard implementations of RNG algorithms that produce numbers with
                        sufficient artificial randomness. We'll introduce the available APIs in the Android and iOS
                        specific sections.
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading170"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse170" aria-expanded="true" aria-controls="collapse170">Threat: An attacker uses Brute Force to gain access to sensitive data <span>[CAPEC-112]</span></button></h5></div><div id="collapse170" class="collapse" aria-labelledby="heading170" data-parent="#threats"><div class="card-body">In this attack, some asset (information, functionality, identity, etc.) is protected
                                by a finite secret value. The attacker attempts to gain access to this asset by using
                                trial-and-error to exhaustively explore all the possible secret values in the hope of
                                finding the secret (or a value that is functionally equivalent) that will unlock the
                                asset. Examples of secrets can include, but are not limited to, passwords, encryption
                                keys, database lookup keys, and initial values to one-way functions.
                                The key factor in this attack is the attackers' ability to explore the possible secret
                                space rapidly. This, in turn, is a function of the size of the secret space and the
                                computational power the attacker is able to bring to bear on the problem. If the
                                attacker has modest resources and the secret space is large, the challenge facing the
                                attacker is intractable. While the defender cannot control the resources available to an
                                attacker, they can control the size of the secret space. Creating a large secret space
                                involves selecting one's secret from as large a field of equally likely alternative
                                secrets as possible and ensuring that an attacker is unable to reduce the size of this
                                field using available clues or cryptanalysis. Doing this is more difficult than it
                                sounds since elimination of patterns (which, in turn, would provide an attacker clues
                                that would help them reduce the space of potential secrets) is difficult to do using
                                deterministic machines, such as computers. Assuming a finite secret space, a brute force
                                attack will eventually succeed. The defender must rely on making sure that the time and
                                resources necessary to do so will exceed the value of the information. For example, a
                                secret space that will likely take hundreds of years to explore is likely safe from
                                raw-brute force attacks.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading169"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse169" aria-expanded="true" aria-controls="collapse169">Weakness: Inadequate Encryption Strength <span>[CWE-326]</span></button></h5></div><div id="collapse169" class="collapse" aria-labelledby="heading169" data-parent="#weaknesses"><div class="card-body">The software stores or transmits sensitive data using an encryption scheme that is theoretically sound, but is not strong enough for the level of protection required. A weak encryption scheme can be subjected to brute force attacks that have a reasonable chance of succeeding using current attack methods and resources.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading168"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse168" aria-expanded="true" aria-controls="collapse168">Countermeasure: Ensure the key length fulfills accepted industry standards <span>[MASVS-3.3-KEY-LENGTH]</span></button></h5></div><div id="collapse168" class="collapse" aria-labelledby="heading168" data-parent="#controls"><div class="card-body">Even the most secure encryption algorithm becomes vulnerable to brute-force attacks when that
                        algorithm uses an insufficient key size. Ensure the key length fulfills accepted industry
                        standards.
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading173"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse173" aria-expanded="true" aria-controls="collapse173">Threat: Attackers could gain access to sensitive data through a man-in-the-middle attack <span>[NTW-MITM]</span></button></h5></div><div id="collapse173" class="collapse" aria-labelledby="heading173" data-parent="#threats"><div class="card-body">Sensitive data transmission that it is not properly protected could allow an attacker
                                to eavesdrop on this data.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading172"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse172" aria-expanded="true" aria-controls="collapse172">Weakness: Lack of TLS certificate validation <span>[CWE-295-AUTH]</span></button></h5></div><div id="collapse172" class="collapse" aria-labelledby="heading172" data-parent="#weaknesses"><div class="card-body">The software transmits sensitive or security-critical data in cleartext in a communication
                        channel that can be sniffed by unauthorized actors.
                        Many communication channels can be "sniffed" by attackers during data transmission. For example,
                        network traffic can often be sniffed by any attacker who has access to a network interface. This
                        significantly lowers the difficulty of exploitation by attackers.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading171"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse171" aria-expanded="true" aria-controls="collapse171">Countermeasure: Validate that the certificate presented by the server is signed by a trusted Certificate Authority <span>[CWE-295-MOBILE]</span></button></h5></div><div id="collapse171" class="collapse" aria-labelledby="heading171" data-parent="#controls"><div class="card-body">The client should verify that the TLS certificate presented by the server has been signed by a
                        recognized certificate authority and that the information in the certificate is valid.
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading189"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse189" aria-expanded="true" aria-controls="collapse189">Risk pattern: Mobile Client: Store Sensitive data <span>[MOBILE-CLIENT:SENS-DATA-STORAGE]</span></button></h5></div><div id="collapse189" class="collapse" aria-labelledby="heading189" data-parent="#components"><div class="card-body">This risk pattern is imported when we have a mobile device, and we don't know which operating system runs and the mobile app uses sensitive data (all processes with sensitive data, i.e. store). This is a common risk pattern for all types of operating systems.<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading188"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse188" aria-expanded="true" aria-controls="collapse188">Use case: Sensitive Read or Post data <span>[SENSITIVE READ OR POST DATA]</span></button></h5></div><div id="collapse188" class="collapse" aria-labelledby="heading188" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading187"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse187" aria-expanded="true" aria-controls="collapse187">Threat: An attacker discovers the structure, function, and composition of a type of computer software through white box analysis techniques <span>[CAPEC-167]</span></button></h5></div><div id="collapse187" class="collapse" aria-labelledby="heading187" data-parent="#threats"><div class="card-body">An attacker could retrieve sensitive data stored on a mobile device. This information may be stored in configuration files, embedded within the application itself, or stored in other ways. Sensitive information may include long-term keys, passwords, credit card or financial information, and other private material that the mobile app uses in its interactions with the server. In some cases, it may not even be necessary to gain access to another user's installation - if all instances of the client software are embedded with the same sensitive information (for example, long term keys for communication with the server) then the attacker must simply find a way to gain their own copy of the client software in order to perform this attack.<div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading177"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse177" aria-expanded="true" aria-controls="collapse177">Weakness: Exposure of Backup File to an Unauthorized Control Sphere <span>[CWE-530]</span></button></h5></div><div id="collapse177" class="collapse" aria-labelledby="heading177" data-parent="#weaknesses"><div class="card-body">A backup file is stored in a directory that is accessible to actors outside of the intended
                        control sphere.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading176"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse176" aria-expanded="true" aria-controls="collapse176">Countermeasure: Disable auto-backup for sensitive data <span>[MASVS-2.8]</span></button></h5></div><div id="collapse176" class="collapse" aria-labelledby="heading176" data-parent="#controls"><div class="card-body">The auto backup attribute is enabled by default, this attribute shall be disabled for the following cases: Sensitive information should not be sent in clear text to the cloud. Either, avoid storing the information in the first place, or encrypt the information at rest, before sending it to the cloud. Files can also be excluded from Auto Backup, in case they should not be shared in the Cloud.</div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading179"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse179" aria-expanded="true" aria-controls="collapse179">Weakness: Reusing a Nonce, Key Pair in Encryption <span>[CWE-323]</span></button></h5></div><div id="collapse179" class="collapse" aria-labelledby="heading179" data-parent="#weaknesses"><div class="card-body">Nonces should be used for the present occasion and only once.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading178"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse178" aria-expanded="true" aria-controls="collapse178">Countermeasure: Do not re-use the same cryptographic key for multiple purposes <span>[MASVS-3.5]</span></button></h5></div><div id="collapse178" class="collapse" aria-labelledby="heading178" data-parent="#controls"><div class="card-body"></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading181"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse181" aria-expanded="true" aria-controls="collapse181">Weakness: Secrets, API keys and or passwords are included in the source code or online repositories <span>[CWE-312]</span></button></h5></div><div id="collapse181" class="collapse" aria-labelledby="heading181" data-parent="#weaknesses"><div class="card-body">API keys, passwords or secrets included in the source code or in the configuration files can be leaked to users with access to the code. This access can be incidentally granted by publishing the source code on a package-form or an online, public repository.

          The unauthorized access to any of those secrets could lead to a compromise of sensitive data or a system.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading180"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse180" aria-expanded="true" aria-controls="collapse180">Countermeasure: Store sensitive data in a cryptographically secure (system provided) store <span>[CWE-312-ENCRYPT]</span></button></h5></div><div id="collapse180" class="collapse" aria-labelledby="heading180" data-parent="#controls"><div class="card-body">Applications storing or caching data locally are at risk of attack and compromise of that data. Most mobile devices and operating systems offer built in API's to store data in their encrypted stores, such as the Keychain on iOS. These stores are ultimately encrypted using a key derived from the device passcode and require the user to set a passcode.&nbsp; 
<div> 
 <br /> 
</div> 
<div>
  However, they do not enforce the quality of the passcode, nor is it possible to determine the quality of the passcode (and therefore, ultimately the key) from within the application.&nbsp; 
</div> 
<div> 
 <ul> 
  <li>Data should not be stored locally unless there is an explicit requirement to do so. This includes restricting thumbnails or screenshots of pages in the application that contain private data.&nbsp;</li> 
  <li>Data that must be stored on the client side must be held in a cryptographically secure store.&nbsp;</li> 
  <li>Use OS provided stores to protect private data on the client side, acknowledging that the residual risk from users with weak passwords may affect that data.&nbsp;</li> 
  <li>Do not store highly sensitive/financial data on the client-side without implementing a provably strong cryptographic process. For example, it should be encrypted using a key derived from an independent password where the strength of this password can be verified.</li> 
 </ul> 
</div></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading184"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse184" aria-expanded="true" aria-controls="collapse184">Weakness: Storage of Sensitive Data in a Mechanism without Access Control <span>[CWE-921]</span></button></h5></div><div id="collapse184" class="collapse" aria-labelledby="heading184" data-parent="#weaknesses"><div class="card-body">The software stores sensitive information in a file system or device that does not have
                        built-in access control.

                        While many modern file systems or devices utilize some form of access control in order to
                        restrict access to data, not all storage mechanisms have this capability. For example, memory
                        cards, floppy disks, CDs, and USB devices are typically made accessible to any user within the
                        system. This can become a problem when sensitive data is stored in these mechanisms in a
                        multi-user environment, because anybody on the system can read or write this data. On Android
                        devices, external storage is typically globally readable and writable by other applications on
                        the device. External storage may also be easily accessible through the mobile device's USB
                        connection or physically accessible through the device's memory card port.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading182"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse182" aria-expanded="true" aria-controls="collapse182">Countermeasure: Avoid storing sensitive data in shared memory such as the SD card <span>[CWE-921]</span></button></h5></div><div id="collapse182" class="collapse" aria-labelledby="heading182" data-parent="#controls"><div class="card-body">Applications storing or caching data locally are at risk of attack and compromise of that data. Most mobile devices and operating systems offer built in API's to store data in their encrypted stores, such as the Keychain on iOS.&nbsp; 
<div> 
 <ul> 
  <li>Data stored in shared memory, such as a removable SD card, may be accessed by other applications on the device, or may be removed and accessed in a third party system.&nbsp;</li> 
  <li>Do not store sensitive or private data on shared or removable storage, such as SD cards. Where data is stored on shared but non removable storage, there is still a risk an attacker with physical access may be able to access the device storage and therefore the data.&nbsp;</li> 
  <li>Use OS provided secure storage for sensitive or private data.</li> 
 </ul> 
</div></div></div></div><div class="card border-success"><div class="card-header " id="heading183"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse183" aria-expanded="true" aria-controls="collapse183">Countermeasure: Ensure sensitive data is not written to log files on the mobile device <span>[CWE-921-LOGS-MOBILE]</span></button></h5></div><div id="collapse183" class="collapse" aria-labelledby="heading183" data-parent="#controls"><div class="card-body">Applications are commonly built with detailed logging enabled, in particular debug logs during development. These logs are often accessible to processes and users outside of the application's trust model, and as such it is important that sensitive data is not included in the logs. Sensitive data should not be logged by the application. Where the data is relevant from a support perspective, it should be masked or otherwise obfuscated, in accordance with industry or legislative requirements where appropriate (e.g. PAN masking dictated by the PCI DSS standards).</div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading186"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse186" aria-expanded="true" aria-controls="collapse186">Weakness: Use of Hard-coded Cryptographic Key <span>[CWE-321]</span></button></h5></div><div id="collapse186" class="collapse" aria-labelledby="heading186" data-parent="#weaknesses"><div class="card-body">The use of a hard-coded cryptographic key significantly increases the possibility that
                        encrypted data may be recovered.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading185"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse185" aria-expanded="true" aria-controls="collapse185">Countermeasure: Do not hard-code encryption keys when using symmetric encryption <span>[MASVS-3.1]</span></button></h5></div><div id="collapse185" class="collapse" aria-labelledby="heading185" data-parent="#controls"><div class="card-body">The security of symmetric encryption and keyed hashes (MACs) depends on the secrecy of the key. If the key is disclosed, the security gained by encryption is lost. To prevent this, never store secret keys in the same place as the encrypted data they helped create. Developers often make the mistake of encrypting locally stored data with a static, hard-coded encryption key and compiling that key into the app. This makes the key accessible to anyone who can use a disassembler. Ensure that no keys or passwords are stored within the source code.&nbsp; 
<div> 
 <br /> 
</div> 
<div>
  Note that hard-coded keys are problematic even if the source code is obfuscated since obfuscation is easily bypassed by dynamic instrumentation. If the app is using two-way SSL (both server and client certificates are validated), make sure that:&nbsp; 
</div> 
<div> 
 <ul> 
  <li>The password to the client certificate isn't stored locally or is locked in the device Keychain.&nbsp;</li> 
  <li>The client certificate isn't shared among all installations.&nbsp;</li> 
  <li>If the app relies on additional encrypted containers stored in app data, check how the encryption key is used.&nbsp;</li> 
  <li>If a key-wrapping scheme is used, ensure that the master secret is initialized for each user or the container is re-encrypted with new key.&nbsp;</li> 
  <li>If you can use the master secret or previous password to decrypt the container, check how password changes are handled.</li> 
 </ul> 
</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>