<!DOCTYPE html><html><head><title>Risk Patterns for iot-security-compliance-framework.xml</title><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous"><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script></head><body><center><h2>Risk patterns for iot-security-compliance-framework.xml<h2></center><div class="accordion" id="components"><div class="card border-primary"><div class="card-header " id="heading36"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse36" aria-expanded="true" aria-controls="collapse36">Risk pattern: IoT Authentication and Authorization <span>[iot-authentication-and-authorization]</span></button></h5></div><div id="collapse36" class="collapse" aria-labelledby="heading36" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading3"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse3" aria-expanded="true" aria-controls="collapse3">Use case: Access control <span>[access-control]</span></button></h5></div><div id="collapse3" class="collapse" aria-labelledby="heading3" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading2"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse2" aria-expanded="true" aria-controls="collapse2">Threat: An attacker examines a target system to find sensitive data that has been embedded within it <span>[CAPEC-37]</span></button></h5></div><div id="collapse2" class="collapse" aria-labelledby="heading2" data-parent="#threats"><div class="card-body"><p>An attacker examines a target system to find sensitive data that has been embedded within it. This information can reveal confidential contents, such as account numbers or individual keys/credentials that can be used as an intermediate step in a larger attack.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading1"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse1" aria-expanded="true" aria-controls="collapse1">Weakness: Information Exposure <span>[CWE-200]</span></button></h5></div><div id="collapse1" class="collapse" aria-labelledby="heading1" data-parent="#weaknesses"><div class="card-body">An information exposure is the unintentional disclosure of information to an actor that is not explicitly authorized to have access to that information.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading0"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse0" aria-expanded="true" aria-controls="collapse0">Countermeasure: The product only allows controlled user account access <span>[IOT2.4.8.11]</span></button></h5></div><div id="collapse0" class="collapse" aria-labelledby="heading0" data-parent="#controls"><div class="card-body"><p>The product only allows controlled user account access. Access using anonymous or guest user accounts is not supported without justification.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Product should not allow any unjustified anonymous or guest access in order to prevent potential theft or disclosure of sensitive information, therefore only controlled user account access should be permitted.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that the product only allows controlled user account access and access using anonymous or guest user accounts is not supported without justification.</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading29"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse29" aria-expanded="true" aria-controls="collapse29">Use case: Authentication and Authorization <span>[AUTHENTICATION AND AUTHORIZATION]</span></button></h5></div><div id="collapse29" class="collapse" aria-labelledby="heading29" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading6"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse6" aria-expanded="true" aria-controls="collapse6">Threat: An adversary is able to exploit features of the target that should be reserved for privileged users  <span>[CAPEC-122]</span></button></h5></div><div id="collapse6" class="collapse" aria-labelledby="heading6" data-parent="#threats"><div class="card-body"><p>An adversary is able to exploit features of the target that should be reserved for privileged users or administrators but are exposed to use by lower or non-privileged accounts. Access to sensitive information and functionality must be controlled to ensure that only authorized users are able to access these resources. If access control mechanisms are absent or misconfigured, a user may be able to access resources that are intended only for higher level users. An adversary may be able to exploit this to utilize a less trusted account to gain information and perform activities reserved for more trusted accounts.&nbsp;</p> 
<p>This attack differs from privilege escalation and other privilege stealing attacks in that the adversary never actually escalates their privileges but instead is able to use a lesser degree of privilege to access resources that should be (but are not) reserved for higher privilege accounts. Likewise, the adversary does not exploit trust or subvert systems - all control functionality is working as configured but the configuration does not adequately protect sensitive resources at an appropriate level.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading5"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse5" aria-expanded="true" aria-controls="collapse5">Weakness: Incorrect Permission Assignment for Critical Resource <span>[CWE-732]</span></button></h5></div><div id="collapse5" class="collapse" aria-labelledby="heading5" data-parent="#weaknesses"><div class="card-body">The software specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.

When a resource is given a permission setting that provides access to a wider range of actors than required, it could lead to the exposure of sensitive information, or the modification of that resource by unintended parties. This is especially dangerous when the resource is related to program configuration, execution or sensitive user data.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading4"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse4" aria-expanded="true" aria-controls="collapse4">Countermeasure: The product only allows controlled user account access <span>[IOT2.4.8.11]</span></button></h5></div><div id="collapse4" class="collapse" aria-labelledby="heading4" data-parent="#controls"><div class="card-body"><p>The product only allows controlled user account access. Access using anonymous or guest user accounts is not supported without justification.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Product should not allow any unjustified anonymous or guest access in order to prevent potential theft or disclosure of sensitive information, therefore only controlled user account access should be permitted.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that the product only allows controlled user account access and access using anonymous or guest user accounts is not supported without justification.</p></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading17"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse17" aria-expanded="true" aria-controls="collapse17">Threat: Attackers gain unauthorized access through Brute Force attacks <span>[CAPEC-112]</span></button></h5></div><div id="collapse17" class="collapse" aria-labelledby="heading17" data-parent="#threats"><div class="card-body"><p>In this attack, some asset (information, functionality, identity, etc.) is protected by a finite secret value. The attacker attempts to gain access to this asset by using trial-and-error to exhaustively explore all the possible secret values in the hope of finding the secret (or a value that is functionally equivalent) that will unlock the asset. Examples of secrets can include, but are not limited to, passwords, encryption keys, database lookup keys, and initial values to one-way functions.&nbsp;</p> 
<p>The key factor in this attack is the attackers' ability to explore the possible secret space rapidly. This, in turn, is a function of the size of the secret space and the computational power the attacker is able to bring to bear on the problem. If the attacker has modest resources and the secret space is large, the challenge facing the attacker is intractable. While the defender cannot control the resources available to an attacker, they can control the size of the secret space.&nbsp;</p> 
<p>Creating a large secret space involves selecting one's secret from as large a field of equally likely alternative secrets as possible and ensuring that an attacker is unable to reduce the size of this field using available clues or cryptanalysis. Doing this is more difficult than it sounds since elimination of patterns (which, in turn, would provide an attacker clues that would help them reduce the space of potential secrets) is difficult to do using deterministic machines, such as computers.&nbsp;</p> 
<p>Assuming a finite secret space, a brute force attack will eventually succeed. The defender must rely on making sure that the time and resources necessary to do so will exceed the value of the information. For example, a secret space that will likely take hundreds of years to explore is likely safe from raw-brute force attacks.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading8"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse8" aria-expanded="true" aria-controls="collapse8">Weakness: Lack of password change facility <span>[NO-PASSWORD-CHANGE]</span></button></h5></div><div id="collapse8" class="collapse" aria-labelledby="heading8" data-parent="#weaknesses"><div class="card-body">When the application does not offer a password change facility, a compromise of the current user password will lead to an attacker having persistent access to the account.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading7"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse7" aria-expanded="true" aria-controls="collapse7">Countermeasure: The product allows the factory issued or OEM login accounts to be disabled, erased or renamed <span>[IOT2.4.8.12]</span></button></h5></div><div id="collapse7" class="collapse" aria-labelledby="heading7" data-parent="#controls"><div class="card-body"><p>The product allows the factory issued or <span class="caps">OEM</span> login accounts to be disabled, erased or renamed.</p> 
<p><b><font size="4">Rationale:<br /></font></b> The factory issued or <span class="caps">OEM</span> login accounts should be disabled, erased or renamed. This is to avoid the type of attacks where factory default logins and passwords are published on the web, which allows attackers to mount very simple scanning and dictionary attacks on devices.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that the product allows the factory issued or <span class="caps">OEM</span> login accounts to be disabled, erased or renamed when installed or commissioned.</p></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading13"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse13" aria-expanded="true" aria-controls="collapse13">Weakness: Poor quality passwords in use <span>[CWE-521]</span></button></h5></div><div id="collapse13" class="collapse" aria-labelledby="heading13" data-parent="#weaknesses"><div class="card-body">The product does not enforce a strong password policy, which makes it easier for attackers to compromise user accounts through brute force or dictionary based attacks.

An authentication mechanism is only as strong as its credentials. For this reason, it is important to require users to have strong passwords. Lack of password complexity significantly reduces the search space when trying to guess user's passwords, making brute-force attacks easier.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading9"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse9" aria-expanded="true" aria-controls="collapse9">Countermeasure: The product allows the factory issued or OEM login accounts to be disabled, erased or renamed <span>[IOT2.4.8.12]</span></button></h5></div><div id="collapse9" class="collapse" aria-labelledby="heading9" data-parent="#controls"><div class="card-body"><p>The product allows the factory issued or <span class="caps">OEM</span> login accounts to be disabled, erased or renamed.</p> 
<p><b><font size="4">Rationale:<br /></font></b> The factory issued or <span class="caps">OEM</span> login accounts should be disabled, erased or renamed. This is to avoid the type of attacks where factory default logins and passwords are published on the web, which allows attackers to mount very simple scanning and dictionary attacks on devices.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that the product allows the factory issued or <span class="caps">OEM</span> login accounts to be disabled, erased or renamed when installed or commissioned.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading10"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse10" aria-expanded="true" aria-controls="collapse10">Countermeasure: Where a UI password is used for login authentication, the factory issued or reset password is unique to each device in the product family <span>[IOT2.4.8.3]</span></button></h5></div><div id="collapse10" class="collapse" aria-labelledby="heading10" data-parent="#controls"><div class="card-body"><p>Where a user interface password is used for login authentication, the factory issued or reset password is unique to each device in the product family.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Where a device needs a password to log in, a default password is usually provided that allows the device to be accessed during its initial setup, and then the user will be prompted to change it after he/she first logs on. An attacker with knowledge of the default password can log in, usually with root or administrative privileges and perform malicious actions. Therefore, all initial passwords and factory reset passwords issued should be unique to each user.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Apply a process which ensures that the initial user interface password or factory reset password is unique to each device in the product family. If a password-less authentication is used the same principles of uniqueness apply.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading11"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse11" aria-expanded="true" aria-controls="collapse11">Countermeasure: The product will not allow new passwords containing the user account name with which the user account is associated <span>[IOT2.4.8.5]</span></button></h5></div><div id="collapse11" class="collapse" aria-labelledby="heading11" data-parent="#controls"><div class="card-body"><p>The product will not allow new passwords containing the user account name with which the user account is associated.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Weak passwords are a serious threat to computer security, and specifically the guessable ones should be forbidden through organizational policy and suitable technical measures. Using the user account name as password or part of a password is completely insecure and makes a brute-force attack against the login interface much easier.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that the product does not allow new passwords containing the user account name with which the user account is associated.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading12"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse12" aria-expanded="true" aria-controls="collapse12">Countermeasure: The product/system enforces passwords to be compliant with 3GPP TS33.117 or similar recommendations <span>[IOT2.4.8.6]</span></button></h5></div><div id="collapse12" class="collapse" aria-labelledby="heading12" data-parent="#controls"><div class="card-body"><p>Password entry follows industry standard practice such recommendations of the 3GPP TS33.117 Password policy. [ref. 1] or <span class="caps">NIST</span> SP800-63b [ref. 2] or <span class="caps">NCSC</span> [Ref 3] on password length, characters from the groupings and special characters.</p> 
<p><b><font size="4">Rationale:<br /></font></b> A key concern when using passwords for authentication is password strength. A "strong" password policy makes it difficult or even improbable for one to guess the password through either manual or automated means. The main characteristics that define a strong password are length, complexity and topology (the pattern that a password is written).</p> 
<p>Passwords should not be vulnerable to dictionary attack, which is a type of brute force attack technique for defeating a cipher or authentication mechanism by trying to determine its decryption key or passphrase by trying hundreds or sometimes millions of likely possibilities, such as words in a dictionary. </p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that the product/system enforces passwords to be compliant with 3GPP TS33.117 or similar (<span class="caps">NIST</span> SP800-63b [ref. 2] or <span class="caps">NCSC</span> [Ref 3]) recommendations to include: At least eight characters in length, characters from the groupings: alpha, numeric and special characters and should not be vulnerable to dictionary attack.</p></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading16"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse16" aria-expanded="true" aria-controls="collapse16">Weakness: The application does not wipe used and not needed passwords or key material <span>[CWE-255]</span></button></h5></div><div id="collapse16" class="collapse" aria-labelledby="heading16" data-parent="#weaknesses"><div class="card-body">When using password or key material within an application, these are copied in memory and can be copied back to the disk depending on several factors.

If the application handles passwords or key material, an attacker with access to the system could inspect the memory or the hard disk to retrieve back those secrets on its original form.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading14"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse14" aria-expanded="true" aria-controls="collapse14">Countermeasure: The product allows the factory issued or OEM login accounts to be disabled, erased or renamed <span>[IOT2.4.8.12]</span></button></h5></div><div id="collapse14" class="collapse" aria-labelledby="heading14" data-parent="#controls"><div class="card-body"><p>The product allows the factory issued or <span class="caps">OEM</span> login accounts to be disabled, erased or renamed.</p> 
<p><b><font size="4">Rationale:<br /></font></b> The factory issued or <span class="caps">OEM</span> login accounts should be disabled, erased or renamed. This is to avoid the type of attacks where factory default logins and passwords are published on the web, which allows attackers to mount very simple scanning and dictionary attacks on devices.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that the product allows the factory issued or <span class="caps">OEM</span> login accounts to be disabled, erased or renamed when installed or commissioned.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading15"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse15" aria-expanded="true" aria-controls="collapse15">Countermeasure: The product allows an authorized factory reset of the device's authorization information <span>[IOT2.4.8.16]</span></button></h5></div><div id="collapse15" class="collapse" aria-labelledby="heading15" data-parent="#controls"><div class="card-body"><p>The product allows an authorized factory reset of the device's authorization information.</p> 
<p><b><font size="4">Rationale:<br /></font></b> The devices are often authorized to an account, based on license agreements with service providers. The device should have the option to be deauthorized and reset in case the user no longer wants to use it or if the user wants to authorize the device to another account.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that the product allows an authorized factory reset of the device's authorization information.</p></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading20"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse20" aria-expanded="true" aria-controls="collapse20">Threat: Denial of service through resource exhaustion <span>[CAPEC-130]</span></button></h5></div><div id="collapse20" class="collapse" aria-labelledby="heading20" data-parent="#threats"><div class="card-body"><p>An attacker causes the target to allocate excessive resources to servicing the attackers' request, thereby reducing the resources available for legitimate services and degrading or denying services. Usually, this attack focuses on memory allocation, but any finite resource on the target could be the attacked, including bandwidth, processing cycles, or other resources.&nbsp;</p> 
<p>This attack does not attempt to force this allocation through a large number of requests (that would be Resource Depletion through Flooding) but instead uses one or a small number of requests that are carefully formatted to force the target to allocate excessive resources to service this request(s). Often this attack takes advantage of a bug in the target to cause the target to allocate resources vastly beyond what would be needed for a normal request.&nbsp;</p> 
<p>For example, using an Integer Attack, the attacker could cause a variable that controls allocation for a request to hold an excessively large value. Excessive allocation of resources can render a service degraded or unavailable to legitimate users and can even lead to crashing of the target.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading19"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse19" aria-expanded="true" aria-controls="collapse19">Weakness: Allocation of Resources Without Limits or Throttling <span>[CWE-770]</span></button></h5></div><div id="collapse19" class="collapse" aria-labelledby="heading19" data-parent="#weaknesses"><div class="card-body">The software allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on how many resources can be allocated, in violation of the intended security policy for that actor.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading18"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse18" aria-expanded="true" aria-controls="collapse18">Countermeasure: Implement application and network rate limiting <span>[CWE-799]</span></button></h5></div><div id="collapse18" class="collapse" aria-labelledby="heading18" data-parent="#controls"><div class="card-body"><p>A number of attacks rely on brute-force techniques to send large volumes of requests to enumerate or attempt to exploit flaws in an application, for example, sending common passwords to multiple target accounts within an application. By profiling normal traffic volumes, and applying rate limiting, the application can be built to actively mitigate such attacks.</p> 
<p></p> 
<ul> 
 <li>Connection rate-limiting based on the source IP address can be used to restrict attacks against the authentication or registration systems. Multiple failures (or attempts) from a single IP should result in temporarily blocking or dropping traffic from the source. Note however that some corporate and <span class="caps">ISP</span> environment may place multiple valid and discrete clients behind the same IP address, resulting in false-positives.&nbsp;</li> 
 <li>Attackers may use botnets and other IP masking techniques to deliver attacks from multiple sources to avoid IP based rate-limiting. To mitigate this class of attack, Indicators of Compromise should be monitored (for example a higher rate of login failures than usual), and appropriate actions taken. For example, when the application detects active brute-force attacks, a Web Application Firewall (<span class="caps">WAF</span>) or other intermediate devices could be used to block attacks sharing a signature from pattern matching or deep packet inspection (e.g. <span class="caps">HTTP</span> headers or common passwords across multiple accounts). Similarly, the application could respond by requiring a <span class="caps">CAPTCHA</span>, cookie, or Javascript challenge when an attack is detected.</li> 
</ul> 
<p></p> 
<b><font size="4"> Remediation:</font></b> 
<div> 
 <b><font size="4"></font></b>Implement the mechanisms to lockout accounts:&nbsp; 
</div> 
<div> 
 <ul> 
  <li>When the application detects a set number of failure login attempts, the account shall be locked for a certain time period.&nbsp;</li> 
  <li>When the application detects that an account is locked more times than usual, this account shall be disabled. A disabled account shall only be restored by an administrator.&nbsp;</li> 
  <li>When the application detects active brute-force attacks, the application shall require a <span class="caps">CAPTCHA</span>, cookie, or JavaScript challenge.</li> 
 </ul> 
</div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading25"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse25" aria-expanded="true" aria-controls="collapse25">Threat: User accounts compromised through username guessing <span>[CAPEC-112-USERNAME]</span></button></h5></div><div id="collapse25" class="collapse" aria-labelledby="heading25" data-parent="#threats"><div class="card-body">	<p>Attackers could perform a brute force attack against the login function by choosing a simple password that users are likely to use for the site, and that meets the site&#8217;s password policy. Then they could use an automated script to iterate through a list of possible usernames. These could be obtained from a dictionary, or generated through pure brute force means. </p>

 This type of attack cannot be defended against using an account lockout policy because each username is only attempted once.<div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading22"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse22" aria-expanded="true" aria-controls="collapse22">Weakness: Poor quality passwords in use <span>[CWE-521]</span></button></h5></div><div id="collapse22" class="collapse" aria-labelledby="heading22" data-parent="#weaknesses"><div class="card-body">The product does not enforce a strong password policy, which makes it easier for attackers to compromise user accounts through brute force or dictionary based attacks.

An authentication mechanism is only as strong as its credentials. For this reason, it is important to require users to have strong passwords. Lack of password complexity significantly reduces the search space when trying to guess user's passwords, making brute-force attacks easier.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading21"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse21" aria-expanded="true" aria-controls="collapse21">Countermeasure: Require the use of strong passwords <span>[CWE-521]</span></button></h5></div><div id="collapse21" class="collapse" aria-labelledby="heading21" data-parent="#controls"><div class="card-body"><div>
                        Passwords used either as a sole verification credentials, or as part of a multi-factor
                        authentication, are a key aspect of application security, and strong password selection should
                        be encouraged and enforced. The application should allow flexibility in user password selection,
                        and enforce minimum criteria for password quality. This should include:
                        </div>
                        <div>
                        <ul>
                        <li>Minimum password length requirements, to mitigate brute-force and dictionary attacks.</li>
                        <li>Encourage use of pass-phrases using multiple words, achieving longer passwords more
                        resistant to attack.</li>
                        <li>Enforce use of mixed case, numeric and/or special characters to increase complexity.</li>
                        <li>Prevent or discourage use of dictionary words and common passwords through
                        black-lists. For example, a set of commonly used passwords can be found on SecLists at&nbsp;<a
                        href="https://github.com/danielmiessler/SecLists/tree/master/Passwords">https://github.com/danielmiessler/SecLists/tree/master/Passwords</a>&nbsp;</li>
                        </ul>
                        </div>
                        <div>
                        <p><b>Password length</b></p>
                        <p>Password length considers the minimum and maximum length of characters comprising the
                        password of your users. For ease of changing this length, its implementation can be configurable
                        possibly using a properties file or xml configuration file.</p>
                        <ul>
                        <li>Minimum length. Passwords should be at least ten (10) characters long. Combining this
                        length with complexity makes a password difficult to guess and/or brute force.</li>
                        <li>Maximum length. People tend to forget their passwords easily. The longer the password,
                        the more likely people are to enter them incorrectly for the system. However, long pass-phrases
                        can be easily remembered, and should not be prevented through unnecessarily strict upper
                        restrictions on length.</li>
                        </ul>
                        <p><b>Password Complexity</b></p>
                        <ul>
                        <li>Password characters should be a combination of alphanumeric characters. Alphanumeric
                        characters consist of letters, numbers, punctuation marks, mathematical and other conventional
                        symbols.</li>
                        <li>For change and reset password functionality it is recommended a history of old
                        password (salted) hashes used. This can be used to prevent password reuse, or an attacker
                        alternating between a selection of passwords (Monday1, Tuesday2 etc.)</li>
                        <li>Actual passwords must not be stored, to protect them against brute forcing if the
                        database is compromised.</li>
                        </ul>
                        </div>
                        <div>
                        <ul>
                        </ul>
                        <ul>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading24"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse24" aria-expanded="true" aria-controls="collapse24">Weakness: The application does not implement anti-automation mechanisms to prevent automated long-time sustained probes <span>[CWE-307]</span></button></h5></div><div id="collapse24" class="collapse" aria-labelledby="heading24" data-parent="#weaknesses"><div class="card-body">The software does not properly limit the number or frequency of interactions that it has with an actor, such as the number of incoming requests.

This can allow the actor to perform actions more frequently than expected. The actor could be a human or an automated process such as a virus or bot. This could be used to cause a denial of service, compromise program logic (such as limiting humans to a single vote), or other consequences. For example, an authentication routine might not limit the number of times an attacker can guess a password. Or, a web site might conduct a poll but only expect humans to vote a maximum of once a day.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading23"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse23" aria-expanded="true" aria-controls="collapse23">Countermeasure: Implement application and network rate limiting on the login function <span>[CWE-799-LOGIN]</span></button></h5></div><div id="collapse23" class="collapse" aria-labelledby="heading23" data-parent="#controls"><div class="card-body"><p>A number of attacks rely on brute-force techniques to send large volumes of requests to enumerate or attempt to exploit flaws in an application, for example, sending common passwords to multiple target accounts within an application. By profiling normal traffic volumes, and applying rate limiting, the application can be built to actively mitigate such attacks.&nbsp;</p> 
<p></p> 
<ul> 
 <li>Connection rate-limiting based on the source IP address can be used to restrict attacks against the authentication or registration systems. Multiple failures (or attempts) from a single IP should result in temporarily blocking or dropping traffic from the source. Note however that some corporate and <span class="caps">ISP</span> environment may place multiple valid and discrete clients behind the same IP address, resulting in false-positives.&nbsp;</li> 
 <li>Attackers may use botnets and other IP masking techniques to deliver attacks from multiple sources to avoid IP based rate-limiting. To mitigate this class of attack, Indicators of Compromise should be monitored (for example a higher rate of login failures than usual), and appropriate actions taken. For example, when the application detects active brute-force attacks, a Web Application Firewall (<span class="caps">WAF</span>) or other intermediate devices could be used to block attacks sharing a signature from pattern matching or deep packet inspection (e.g. <span class="caps">HTTP</span> headers or common passwords across multiple accounts). Similarly, the application could respond by requiring a <span class="caps">CAPTCHA</span>, cookie, or Javascript challenge when an attack is detected.</li> 
</ul> 
<p></p> 
<font size="4"><b> Remediation:&nbsp;</b></font> 
<div>
  Implement the mechanisms to lockout accounts:&nbsp; 
</div> 
<div> 
 <ul> 
  <li>When the application detects a set number of failure login attempts, the account shall be locked for a certain time period.&nbsp;</li> 
  <li>When the application detects that an account is locked more times than usual, this account shall be disabled. A disabled account shall only be restored by an administrator.&nbsp;</li> 
  <li>When the application detects active brute-force attacks, the application shall require a <span class="caps">CAPTCHA</span>, cookie, or JavaScript challenge.</li> 
 </ul> 
</div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading28"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse28" aria-expanded="true" aria-controls="collapse28">Threat: Users' passwords are compromised if the storage medium is compromised <span>[CWE-256]</span></button></h5></div><div id="collapse28" class="collapse" aria-labelledby="heading28" data-parent="#threats"><div class="card-body">	<p>A compromise of the storage system medium itself (device, server or database) could allow attackers full access to the data stored, including authentication credentials such as passwords.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading27"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse27" aria-expanded="true" aria-controls="collapse27">Weakness: Plaintext Storage of a Password <span>[CWE-257]</span></button></h5></div><div id="collapse27" class="collapse" aria-labelledby="heading27" data-parent="#weaknesses"><div class="card-body">The storage of passwords in a recoverable format makes them subject to password reuse attacks by malicious users. In fact, it should be noted that recoverable encrypted passwords provide no significant benefit over plaintext passwords since they are subject not only to reuse by malicious attackers but also by malicious insiders. If a system administrator can recover a password directly, or use a brute force search on the available information, the administrator can use the password on other accounts.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading26"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse26" aria-expanded="true" aria-controls="collapse26">Countermeasure: Store passwords in unrecoverable form to prevent disclosure <span>[CWE-256]</span></button></h5></div><div id="collapse26" class="collapse" aria-labelledby="heading26" data-parent="#controls"><div class="card-body"><p>To protect users passwords from accidental or deliberate exposure, the application should store cryptographic hashes of passwords instead of the passwords themselves.&nbsp;</p> 
<p></p> 
<ul> 
 <li>Do not store passwords themselves in the data store for verification at login.&nbsp;</li> 
 <li>Instead, create a cryptographic hash of the password using a strong hash function that includes a work factor and a built in ‘salt’ value, like bcrypt or scrypt. This reduces the risk of brute-force attacks and rainbow tables, and allows flexibility to adapt the hashing function to balance security and performance.&nbsp;</li> 
 <li>Alternatively, use a strong hash function like <span class="caps">SHA</span>-384 together with a unique ‘salt’ value for every account. Apply multiple iterations of the hash to create the additional computational work required to mitigate brute-force attacks.</li> 
</ul> 
<p></p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading35"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse35" aria-expanded="true" aria-controls="collapse35">Use case: General <span>[GENERAL]</span></button></h5></div><div id="collapse35" class="collapse" aria-labelledby="heading35" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading34"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse34" aria-expanded="true" aria-controls="collapse34">Threat: Attackers gain access to the system exploiting insufficient or misconfigured security features <span>[IOT-INSUF-SEC]</span></button></h5></div><div id="collapse34" class="collapse" aria-labelledby="heading34" data-parent="#threats"><div class="card-body">	<p>Attackers will often attempt to exploit insufficient tampering protection, unprotected storage or other misconfigured features.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading33"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse33" aria-expanded="true" aria-controls="collapse33">Weakness: The product lacks key security features <span>[CWE-254-PROD]</span></button></h5></div><div id="collapse33" class="collapse" aria-labelledby="heading33" data-parent="#weaknesses"><div class="card-body">The product lack of key security features such as protection against tampering, unprotected storages or it has other misconfigurations and omissions during production.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading30"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse30" aria-expanded="true" aria-controls="collapse30">Countermeasure: Where passwords are entered on a UI, the actual pass phrase is obscured by default <span>[IOT2.4.8.15]</span></button></h5></div><div id="collapse30" class="collapse" aria-labelledby="heading30" data-parent="#controls"><div class="card-body"><p>Where passwords are entered on a user interface, the actual pass phrase is obscured by default.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Password masking is the practice of obscuring the password characters when entered on a user interface, more often behind bullets (·), asterisks (*) or similar camouflaging characters. The idea behind password masking is primarily the protection against "shoulder surfing", in other words to prevent nearby observers reading the password "over the user's shoulder" and thus stolen, which is crucial for mobile devices. A second reason is to obscure the password in cases of shared screens, projectors, etc.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that the actual pass phrase is obscured by default where entered on a user interface.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading31"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse31" aria-expanded="true" aria-controls="collapse31">Countermeasure: Where the product  has the ability to remotely recover from an attack, it should rely on a known good state, to enable safe recovery and updating of the device <span>[IOT2.4.8.17]</span></button></h5></div><div id="collapse31" class="collapse" aria-labelledby="heading31" data-parent="#controls"><div class="card-body">	<p>The ability to remotely recover from these situations should rely on a known good state, such as locally storing a known good version to enable safe recovery and updating of the device. This will avoid denial of service and costly recalls or maintenance visits, whilst managing the risk of potential takeover of the device by an attacker subverting update or other network communications mechanisms.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading32"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse32" aria-expanded="true" aria-controls="collapse32">Countermeasure: Where the product has a secure source of time there is a method of validating its integrity <span>[IOT2.4.8.2]</span></button></h5></div><div id="collapse32" class="collapse" aria-labelledby="heading32" data-parent="#controls"><div class="card-body"><p>Where the product has a secure source of time there is a method of validating its integrity.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Network Time Protocol (<span class="caps">NTP</span>) is a networking protocol for clock synchronization between computer systems over packet-switched, variable-latency data networks. In operation since before 1985, <span class="caps">NTP</span> is one of the oldest Internet protocols in current use. <span class="caps">NTP</span>sec is a fork implementation of <span class="caps">NTP</span> that has been systematically security-hardened.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that where the product has a secure source of time there is a method of validating its integrity such as <span class="caps">NTP</span>sec (please see reference <span class="caps">URL</span> [1]).</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading72"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse72" aria-expanded="true" aria-controls="collapse72">Risk pattern: IoT Device Interfaces <span>[iot-device-interfaces]</span></button></h5></div><div id="collapse72" class="collapse" aria-labelledby="heading72" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading43"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse43" aria-expanded="true" aria-controls="collapse43">Use case: Authentication and Authorization <span>[AUTHENTICATION AND AUTHORIZATION]</span></button></h5></div><div id="collapse43" class="collapse" aria-labelledby="heading43" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading39"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse39" aria-expanded="true" aria-controls="collapse39">Threat: Attackers gain access to unauthorised data by exploiting vulnerabilities in the service <span>[VULN-SERVICE]</span></button></h5></div><div id="collapse39" class="collapse" aria-labelledby="heading39" data-parent="#threats"><div class="card-body">	<p>Attackers exploit vulnerabilities in the service and gain access to data, or to services for which they are not authorized.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading38"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse38" aria-expanded="true" aria-controls="collapse38">Weakness: The service contains vulnerabilities that could grant access to data <span>[CWE-284]</span></button></h5></div><div id="collapse38" class="collapse" aria-labelledby="heading38" data-parent="#weaknesses"><div class="card-body">The services may contain security vulnerabilities that can be exploited by attackers to gain unauthorized access to data or additional services.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading37"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse37" aria-expanded="true" aria-controls="collapse37">Countermeasure: Restrict access to the service at the network layer to reduce exposure <span>[RESTRICT-SERVICE]</span></button></h5></div><div id="collapse37" class="collapse" aria-labelledby="heading37" data-parent="#controls"><div class="card-body"><p>Access to services should be restricted to expected sources, limiting exposure of the service and its attack surface; and the likelihood of a malicious actor gaining access to the system.&nbsp;</p> 
<p>Apply network layer security controls so that only the necessary and expected IP addresses are permitted access to connect to the service.</p></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading42"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse42" aria-expanded="true" aria-controls="collapse42">Threat: Data compromised if the server itself is compromised <span>[SERVER-ATTACK]</span></button></h5></div><div id="collapse42" class="collapse" aria-labelledby="heading42" data-parent="#threats"><div class="card-body">	<p>If attackers compromise the server that hosts the service or data, then the data and the service itself could be at risk of compromise. The server could be compromised through any of the services that it exposes.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading41"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse41" aria-expanded="true" aria-controls="collapse41">Weakness: Unnecessary services are exposed <span>[UNNECESSARY-SERVICES]</span></button></h5></div><div id="collapse41" class="collapse" aria-labelledby="heading41" data-parent="#weaknesses"><div class="card-body">The application exposes unnecessary services which increase the attack surface.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading40"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse40" aria-expanded="true" aria-controls="collapse40">Countermeasure: Restrict access to required services only <span>[INF-UNNECESSARY-SERVICES]</span></button></h5></div><div id="collapse40" class="collapse" aria-labelledby="heading40" data-parent="#controls"><div class="card-body"><p>The attack surface, and therefore susceptibility to attack, should be minimized. In particular, services that are not explicitly required for the proper operation of the server or service should be disable, or access to them be restricted.&nbsp;</p> 
<p></p> 
<ul> 
 <li>Any service, feature, or functionality that is not required should be disabled or removed. This applies equally to the operating system, middleware, web-server, or other software in use.</li> 
 <li>Access to the server and remaining services (in particular those that cannot be disabled or removed) should be controlled use host-based and/or network security controls; for example host firewalls, network firewalls, routers, or switches.</li> 
</ul> 
<p></p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading47"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse47" aria-expanded="true" aria-controls="collapse47">Use case: General <span>[GENERAL]</span></button></h5></div><div id="collapse47" class="collapse" aria-labelledby="heading47" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading46"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse46" aria-expanded="true" aria-controls="collapse46">Threat: Attackers attempt to exploit unpatched flaws to gain unauthorized access or knowledge of the system <span>[OWASP A6:2017]</span></button></h5></div><div id="collapse46" class="collapse" aria-labelledby="heading46" data-parent="#threats"><div class="card-body"><p>Attackers will often attempt to exploit unpatched flaws or access default accounts, unused pages, unprotected files and directories, etc to gain unauthorized access or knowledge of the system.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading45"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse45" aria-expanded="true" aria-controls="collapse45">Weakness: Recommended security patches are not applied <span>[UNPATCHED-PRODUCT]</span></button></h5></div><div id="collapse45" class="collapse" aria-labelledby="heading45" data-parent="#weaknesses"><div class="card-body">When patches and updates are not applied in a timely manner then a product (e.g. Operating System, Software or Mobile App) or a system could be vulnerable to known security issues. These issues could be leveraged by an attacker to gain access to the system.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading44"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse44" aria-expanded="true" aria-controls="collapse44">Countermeasure: When a factory reset is leveraged the device should warn that the secure operation may be compromised unless updated <span>[IOT2.4.7.21]</span></button></h5></div><div id="collapse44" class="collapse" aria-labelledby="heading44" data-parent="#controls"><div class="card-body"><p>If a factory reset is leveraged the device should warn that the secure operation may be compromised unless updated.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Software updates perform numerous tasks and they are available for both Operating System and individual software programs. Updates can apply a wide range of revisions on a system such as adding new features, removing outdated features, updating drivers, fixing bugs, and most importantly, fixing security holes. For that reason after a factory reset, the device may be reverting to an earlier, out-of-date and possibly insecure version and should be updated again to ensure its secure operation.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that if a factory reset is leveraged the device warns that the secure operation may be compromised unless updated.</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading71"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse71" aria-expanded="true" aria-controls="collapse71">Use case: Networking <span>[NETWORKING]</span></button></h5></div><div id="collapse71" class="collapse" aria-labelledby="heading71" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading50"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse50" aria-expanded="true" aria-controls="collapse50">Threat: An attacker examines a target system to find sensitive data that has been embedded within it <span>[CAPEC-37]</span></button></h5></div><div id="collapse50" class="collapse" aria-labelledby="heading50" data-parent="#threats"><div class="card-body"><p>An attacker examines a target system to find sensitive data that has been embedded within it. This information can reveal confidential contents, such as account numbers or individual keys/credentials that can be used as an intermediate step in a larger attack.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading49"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse49" aria-expanded="true" aria-controls="collapse49">Weakness: Information Exposure <span>[CWE-200]</span></button></h5></div><div id="collapse49" class="collapse" aria-labelledby="heading49" data-parent="#weaknesses"><div class="card-body">An information exposure is the unintentional disclosure of information to an actor that is not explicitly authorized to have access to that information.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading48"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse48" aria-expanded="true" aria-controls="collapse48">Countermeasure: All network communication keys are stored securely, in accordance with industry standards <span>[IOT2.4.7.12]</span></button></h5></div><div id="collapse48" class="collapse" aria-labelledby="heading48" data-parent="#controls"><div class="card-body"><p>All network communication keys are stored securely, in accordance with industry standards such as <span class="caps">FIPS</span> 140 or similar.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Network communication keys should be securely stored in accordance with industry standards. </p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that cryptographic keys for update integrity protection and confidentiality are securely managed in accordance with industry standards such as <span class="caps">FIPS</span> 140-2.</p></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading62"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse62" aria-expanded="true" aria-controls="collapse62">Threat: An attacker monitors information transmitted between logical or physical nodes of a network <span>[CAPEC-157]</span></button></h5></div><div id="collapse62" class="collapse" aria-labelledby="heading62" data-parent="#threats"><div class="card-body"><p>An attacker monitors information transmitted between logical or physical nodes of a network. The attacker need not be able to prevent reception or change content but must simply be able to observe and read the traffic. The attacker might precipitate or indirectly influence the content of the observed transaction, but the attacker is never the intended recipient of the information. Any transmission medium can theoretically be sniffed if the attacker can listen to the contents between the sender and recipient.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading54"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse54" aria-expanded="true" aria-controls="collapse54">Weakness: Cleartext Transmission of Sensitive Information <span>[CWE-319]</span></button></h5></div><div id="collapse54" class="collapse" aria-labelledby="heading54" data-parent="#weaknesses"><div class="card-body">The software transmits sensitive or security-critical data in cleartext in a communication channel that can be sniffed by unauthorized actors.

Many communication channels can be "sniffed" by attackers during data transmission. For example, network traffic can often be sniffed by any attacker who has access to a network interface. This significantly lowers the difficulty of exploitation by attackers.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading51"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse51" aria-expanded="true" aria-controls="collapse51">Countermeasure: Where the MQTT protocol is used, it is protected by a TLS connection with no known cipher vulnerabilities <span>[IOT2.4.7.13]</span></button></h5></div><div id="collapse51" class="collapse" aria-labelledby="heading51" data-parent="#controls"><div class="card-body"><p>Where the <span class="caps">MQTT</span> protocol is used, it is protected by a <span class="caps">TLS</span> connection with no known cipher vulnerabilities.</p> 
<p><b><font size="4">Rationale:<br /></font></b> <span class="caps">MQTT</span> (Message Queue Telemetry Transport), is a very lightweight and widely used messaging and information exchange protocol for IoT devices throughout the world. The <span class="caps">MQTT</span> communication can be encrypted using <span class="caps">TLS</span> / <span class="caps">SSL</span> protocols, ensuring a secure and safe communication.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that where the <span class="caps">MQTT</span> protocol is used, it is protected by a <span class="caps">TLS</span> connection with no known cipher vulnerabilities.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading52"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse52" aria-expanded="true" aria-controls="collapse52">Countermeasure: Where the CoAP protocol is used, it is protected by a DTLS connection with no known cipher vulnerabilities <span>[IOT2.4.7.14]</span></button></h5></div><div id="collapse52" class="collapse" aria-labelledby="heading52" data-parent="#controls"><div class="card-body"><p>Where the CoAP protocol is used, it is protected by a <span class="caps">DTLS</span> connection with no known cipher vulnerabilities.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Constrained Application Protocol (CoAP) is a service layer protocol that is intended for use in resource-constrained internet devices, such as wireless sensor network nodes. CoAP is designed to easily translate to <span class="caps">HTTP</span> for simplified integration with the web, whilst also meeting specialized requirements such as multicast support, very low overhead, and simplicity, which are extremely important for IoT.</p> 
<p>Because CoAP is built on top of <span class="caps">UDP</span> not <span class="caps">TCP</span>, <span class="caps">SSL</span>/TLS are not available to provide security. Datagram Transport Layer Security (<span class="caps">DTLS</span>) provides the same assurances as <span class="caps">TLS</span> but for transfers of data over <span class="caps">UDP</span>.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that where the CoAP protocol is used, it is protected by a <span class="caps">DTLS</span> connection with no known cipher vulnerabilities.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading53"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse53" aria-expanded="true" aria-controls="collapse53">Countermeasure: Alerting on unauthorized changes <span>[IOT2.4.7.5]</span></button></h5></div><div id="collapse53" class="collapse" aria-labelledby="heading53" data-parent="#controls"><div class="card-body"><p>If an unauthorised change is detected, the device should alert the user/administrator to the issue and should not connect to wider networks than those necessary to perform the alerting function.</p> 
<p><b><font size="4">Rationale:<br /></font></b> IoT device software should be verified using secure boot mechanisms. When an unauthorized change is detected, the device should alert operators to the issue. The issue notification should not connect to wider networks than necessary to deliver the alert.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that If an unauthorised change is detected, the device alerts the user/administrator to the issue and doesn't connect to wider networks than those necessary to perform the alerting function.</p></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading59"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse59" aria-expanded="true" aria-controls="collapse59">Weakness: Inadequate Encryption Strength <span>[CWE-326]</span></button></h5></div><div id="collapse59" class="collapse" aria-labelledby="heading59" data-parent="#weaknesses"><div class="card-body">The software stores or transmits sensitive data using an encryption scheme that is theoretically sound, but is not strong enough for the level of protection required. A weak encryption scheme can be subjected to brute force attacks that have a reasonable chance of succeeding using current attack methods and resources.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading55"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse55" aria-expanded="true" aria-controls="collapse55">Countermeasure: All network communication keys are stored securely, in accordance with industry standards <span>[IOT2.4.7.12]</span></button></h5></div><div id="collapse55" class="collapse" aria-labelledby="heading55" data-parent="#controls"><div class="card-body"><p>All network communication keys are stored securely, in accordance with industry standards such as <span class="caps">FIPS</span> 140 or similar.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Network communication keys should be securely stored in accordance with industry standards. </p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that cryptographic keys for update integrity protection and confidentiality are securely managed in accordance with industry standards such as <span class="caps">FIPS</span> 140-2.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading56"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse56" aria-expanded="true" aria-controls="collapse56">Countermeasure: Where the MQTT protocol is used, it is protected by a TLS connection with no known cipher vulnerabilities <span>[IOT2.4.7.13]</span></button></h5></div><div id="collapse56" class="collapse" aria-labelledby="heading56" data-parent="#controls"><div class="card-body"><p>Where the <span class="caps">MQTT</span> protocol is used, it is protected by a <span class="caps">TLS</span> connection with no known cipher vulnerabilities.</p> 
<p><b><font size="4">Rationale:<br /></font></b> <span class="caps">MQTT</span> (Message Queue Telemetry Transport), is a very lightweight and widely used messaging and information exchange protocol for IoT devices throughout the world. The <span class="caps">MQTT</span> communication can be encrypted using <span class="caps">TLS</span> / <span class="caps">SSL</span> protocols, ensuring a secure and safe communication.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that where the <span class="caps">MQTT</span> protocol is used, it is protected by a <span class="caps">TLS</span> connection with no known cipher vulnerabilities.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading57"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse57" aria-expanded="true" aria-controls="collapse57">Countermeasure: Where the CoAP protocol is used, it is protected by a DTLS connection with no known cipher vulnerabilities <span>[IOT2.4.7.14]</span></button></h5></div><div id="collapse57" class="collapse" aria-labelledby="heading57" data-parent="#controls"><div class="card-body"><p>Where the CoAP protocol is used, it is protected by a <span class="caps">DTLS</span> connection with no known cipher vulnerabilities.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Constrained Application Protocol (CoAP) is a service layer protocol that is intended for use in resource-constrained internet devices, such as wireless sensor network nodes. CoAP is designed to easily translate to <span class="caps">HTTP</span> for simplified integration with the web, whilst also meeting specialized requirements such as multicast support, very low overhead, and simplicity, which are extremely important for IoT.</p> 
<p>Because CoAP is built on top of <span class="caps">UDP</span> not <span class="caps">TCP</span>, <span class="caps">SSL</span>/TLS are not available to provide security. Datagram Transport Layer Security (<span class="caps">DTLS</span>) provides the same assurances as <span class="caps">TLS</span> but for transfers of data over <span class="caps">UDP</span>.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that where the CoAP protocol is used, it is protected by a <span class="caps">DTLS</span> connection with no known cipher vulnerabilities.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading58"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse58" aria-expanded="true" aria-controls="collapse58">Countermeasure: Alerting on unauthorized changes <span>[IOT2.4.7.5]</span></button></h5></div><div id="collapse58" class="collapse" aria-labelledby="heading58" data-parent="#controls"><div class="card-body"><p>If an unauthorised change is detected, the device should alert the user/administrator to the issue and should not connect to wider networks than those necessary to perform the alerting function.</p> 
<p><b><font size="4">Rationale:<br /></font></b> IoT device software should be verified using secure boot mechanisms. When an unauthorized change is detected, the device should alert operators to the issue. The issue notification should not connect to wider networks than necessary to deliver the alert.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that If an unauthorised change is detected, the device alerts the user/administrator to the issue and doesn't connect to wider networks than those necessary to perform the alerting function.</p></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading61"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse61" aria-expanded="true" aria-controls="collapse61">Weakness: Use of weak TLS cipher suites <span>[SSL-WEAK-CIPHERS]</span></button></h5></div><div id="collapse61" class="collapse" aria-labelledby="heading61" data-parent="#weaknesses"><div class="card-body">A weak TLS cipher suite could allow an attacker to sniff the transmission by exploiting this weakness.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading60"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse60" aria-expanded="true" aria-controls="collapse60">Countermeasure: Where the MQTT protocol is used, it is protected by a TLS connection with no known cipher vulnerabilities <span>[IOT2.4.7.13]</span></button></h5></div><div id="collapse60" class="collapse" aria-labelledby="heading60" data-parent="#controls"><div class="card-body"><p>Where the <span class="caps">MQTT</span> protocol is used, it is protected by a <span class="caps">TLS</span> connection with no known cipher vulnerabilities.</p> 
<p><b><font size="4">Rationale:<br /></font></b> <span class="caps">MQTT</span> (Message Queue Telemetry Transport), is a very lightweight and widely used messaging and information exchange protocol for IoT devices throughout the world. The <span class="caps">MQTT</span> communication can be encrypted using <span class="caps">TLS</span> / <span class="caps">SSL</span> protocols, ensuring a secure and safe communication.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that where the <span class="caps">MQTT</span> protocol is used, it is protected by a <span class="caps">TLS</span> connection with no known cipher vulnerabilities.</p></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading66"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse66" aria-expanded="true" aria-controls="collapse66">Threat: Attackers gain access to the system exploiting insufficient or misconfigured security features <span>[IOT-INSUF-SEC]</span></button></h5></div><div id="collapse66" class="collapse" aria-labelledby="heading66" data-parent="#threats"><div class="card-body">	<p>Attackers will often attempt to exploit insufficient tampering protection, unprotected storage or other misconfigured features.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading65"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse65" aria-expanded="true" aria-controls="collapse65">Weakness: The product lacks key security features <span>[CWE-254-PROD]</span></button></h5></div><div id="collapse65" class="collapse" aria-labelledby="heading65" data-parent="#weaknesses"><div class="card-body">The product lack of key security features such as protection against tampering, unprotected storages or it has other misconfigurations and omissions during production.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading63"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse63" aria-expanded="true" aria-controls="collapse63">Countermeasure: Where there is a loss of communication this should should not compromise the integrity of the device <span>[IOT2.4.7.17]</span></button></h5></div><div id="collapse63" class="collapse" aria-labelledby="heading63" data-parent="#controls"><div class="card-body"><p>Where there is a loss of communications this should not compromise the integrity of the device.</p> 
<p><b><font size="4">Rationale:<br /></font></b> A device is expected to lose communication periodically, but when it does it should be in a safe way and all security controls and settings remain in effect. The integrity of a system should remain even though networking has been lost. Therefore, the device's integrity should be ensured regardless of being connected to a network or not. </p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that where there is a loss of communication it does not compromise the integrity of the device.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading64"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse64" aria-expanded="true" aria-controls="collapse64">Countermeasure: As far as reasonably possible, devices should remain operating and locally functional in the case of a loss of network connection and should recover cleanly in the case of restoration of a loss of power <span>[IOT2.4.7.24]</span></button></h5></div><div id="collapse64" class="collapse" aria-labelledby="heading64" data-parent="#controls"><div class="card-body">	<p>As far as reasonably possible, devices should remain operating and locally functional in the case of a loss of network connection and should recover cleanly in the case of restoration of a loss of power. Devices should be able to return to a network in a sensible state and in an orderly fashion, rather than in a massive scale reconnect.</p>

	<p>Continuous operation ensures that devices provide basic functionality without relying on other systems or networks. It is important to note here that a device should only be required to supply basic features when the network is inaccessible. Devices should provide continuous operation if the network or the Internet is inaccessible. Manual controls where needed, either physical buttons &#8211; or digital &#8211; on the device itself.</p></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading70"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse70" aria-expanded="true" aria-controls="collapse70">Threat: Attackers try to take advantage of a wide attack surface <span>[IOT-WIDE-ATTACK-SURFACE]</span></button></h5></div><div id="collapse70" class="collapse" aria-labelledby="heading70" data-parent="#threats"><div class="card-body"><p>Every point of network interaction or other service is a potential part of the attack surface having exploitable vulnerabilities.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading69"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse69" aria-expanded="true" aria-controls="collapse69">Weakness: Service is exposed to a wide attack surface <span>[UNRESTRICTED-NETWORK]</span></button></h5></div><div id="collapse69" class="collapse" aria-labelledby="heading69" data-parent="#weaknesses"><div class="card-body">The product is exposed or reachable by an unnecessarily large group of potential attackers. An over-exposure of a component increases the chance of an attacker gaining access to the system through a vulnerability.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading67"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse67" aria-expanded="true" aria-controls="collapse67">Countermeasure: The product prevents unauthorized connections to itself or other devices the product is connected to <span>[IOT2.4.7.1]</span></button></h5></div><div id="collapse67" class="collapse" aria-labelledby="heading67" data-parent="#controls"><div class="card-body"><p>The product prevents unauthorized connections to itself or other devices the product is connected to.</p> 
<p><b><font size="4">Rationale:<br /></font></b> A significant vulnerability is networked system accessibility. Because by definition IoT systems are connected to the Internet, attacks can be conducted remotely, either by direct access to networked control interfaces, or by downloading malware to devices. For that reason the product should prevent unauthorized connections to itself or other devices the product is connected to, for example by firewalls.</p> 
<p>A firewall is software used to maintain the security of a private network and block unauthorized access to or from private networks and are often employed to prevent unauthorized Web users or malware from gaining access to private networks connected to the Internet.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that the product prevents unauthorized connections to itself or other devices the product is connected to. For example, there is a firewall on each interface and internet layer protocol.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading68"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse68" aria-expanded="true" aria-controls="collapse68">Countermeasure: Any unintended packet forwarding function should be blocked <span>[IOT2.4.7.3]</span></button></h5></div><div id="collapse68" class="collapse" aria-labelledby="heading68" data-parent="#controls"><div class="card-body"><p>For products with one or more network interfaces, any unintended packet forwarding function should be blocked.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Forwarding refers to the router-local action of transferring the packet from an input link interface to the appropriate output link interface. When applications allow user input to forward requests between different parts of the site, the application must check that the user is authorized to access the <span class="caps">URL</span>, perform the functions it provides, and is an appropriate <span class="caps">URL</span> request. If the application fails to perform these checks, an attacker crafted <span class="caps">URL</span> may pass the application's access control check and then forward the attacker to an administrative function that is not normally permitted.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that any unintended packet forwarding function is blocked to stop undesirable communication paths.</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading101"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse101" aria-expanded="true" aria-controls="collapse101">Risk pattern: IoT Device Operating System <span>[iot-device-operating-system]</span></button></h5></div><div id="collapse101" class="collapse" aria-labelledby="heading101" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading93"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse93" aria-expanded="true" aria-controls="collapse93">Use case: Authentication and Authorization <span>[AUTHENTICATION AND AUTHORIZATION]</span></button></h5></div><div id="collapse93" class="collapse" aria-labelledby="heading93" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading92"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse92" aria-expanded="true" aria-controls="collapse92">Threat: An adversary is able to exploit Operating System features of the target that should be reserved for privileged users  <span>[CAPEC-122-OS]</span></button></h5></div><div id="collapse92" class="collapse" aria-labelledby="heading92" data-parent="#threats"><div class="card-body"><p>An adversary is able to exploit features of the target that should be reserved for privileged users or administrators but are exposed to use by lower or non-privileged accounts. Access to sensitive information and functionality must be controlled to ensure that only authorized users are able to access these resources. If access control mechanisms are absent or misconfigured, a user may be able to access resources that are intended only for higher level users.&nbsp;</p> 
<p>An adversary may be able to exploit this to utilize a less trusted account to gain information and perform activities reserved for more trusted accounts. This attack differs from privilege escalation and other privilege stealing attacks in that the adversary never actually escalates their privileges but instead is able to use a lesser degree of privilege to access resources that should be (but are not) reserved for higher privilege accounts. Likewise, the adversary does not exploit trust or subvert systems - all control functionality is working as configured but the configuration does not adequately protect sensitive resources at an appropriate level.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading81"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse81" aria-expanded="true" aria-controls="collapse81">Weakness: Execution with Unnecessary Privileges <span>[CWE-250]</span></button></h5></div><div id="collapse81" class="collapse" aria-labelledby="heading81" data-parent="#weaknesses"><div class="card-body">The software performs an operation at a privilege level that is higher than the minimum level
                        required, which creates new weaknesses or amplifies the consequences of other weaknesses.

                        New weaknesses can be exposed because running with extra privileges, such as root or
                        Administrator, can disable the normal security checks being performed by the operating system or
                        surrounding environment. Other pre-existing weaknesses can turn into security vulnerabilities if
                        they occur while operating at raised privileges. Privilege management functions can behave in
                        some less-than-obvious ways, and they have different quirks on different platforms. These
                        inconsistencies are particularly pronounced if you are transitioning from one non-root user to
                        another. Signal handlers and spawned processes run at the privilege of the owning process, so if
                        a process is running as root when a signal fires or a sub-process is executed, the signal
                        handler or sub-process will operate with root privileges.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading73"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse73" aria-expanded="true" aria-controls="collapse73">Countermeasure: The OS is separated from the application(s) and is only accessible via defined secure interfaces.  <span>[IOT2.4.6.11]</span></button></h5></div><div id="collapse73" class="collapse" aria-labelledby="heading73" data-parent="#controls"><div class="card-body"><p>The Operating System is separated from the application(s) and is only accessible via defined secure interfaces.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Every device that is to be operated by an individual requires a user interface, usually referred to as a shell. The shell is the outermost layer around the Operating System kernel and is used to access its services including file management, process management (running and terminating applications), batch processing, and operating system monitoring and configuration.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that the Operating System is separated from the application(s) and is only accessible via defined secure interfaces.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading74"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse74" aria-expanded="true" aria-controls="collapse74">Countermeasure: The product's OS kernel is designed such that each component runs with the minimal security capabilities required (e.g. a microkernel architecture) <span>[IOT2.4.6.13]</span></button></h5></div><div id="collapse74" class="collapse" aria-labelledby="heading74" data-parent="#controls"><div class="card-body">	<p>Monolithic kernels are large in size and the structure &#8211; or lack of structure &#8211; makes them difficult to change and maintain without affecting other parts of the kernel. The microkernel approach is based on the idea of only placing essential core real-time operating system functions in the kernel, and other functionality is designed in modules that communicate through the kernel via minimal well-defined interfaces. The microkernel approach results in easy reconfigurable systems without the need to rebuild the kernel.</p>

	<p>Modern mainstream operating systems (OSes) are designed for functionality, speed and ease of development. With the increase of functionality and support for more diverse hardware, their size and complexity keeps growing. These OSes have a monolithic structure, with most services contained in the kernel, i.e. the part of the system that executes in the privileged mode of the hardware. The result is an explosive growth in the amount of privileged code.</p>

	<p>Any code executing in privileged mode can bypass security, and is therefore inherently part of a system&#8217;s trusted computing base (<span class="caps">TCB</span>). Hence we are experiencing a rapid growth of the <span class="caps">TCB</span> of mainstream OSes. As almost all code is buggy, and the number of bugs grows with the size of the code base, this <span class="caps">TCB</span> growth is bound to lead to a growth in the number of vulnerabilities.</p>

	<p>Microkernel design, with its ability to reduce <span class="caps">TCB</span> size, contain faults and encapsulate untrusted components, is, in terms of security, superior to monolithic systems.</p>

	<p>Examples of microkernel architecture are: Mach, L4, <span class="caps">QNX</span>, <span class="caps">MINIX</span>, <span class="caps">IBM</span> K42.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading75"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse75" aria-expanded="true" aria-controls="collapse75">Countermeasure: OS accounts or logins have been disabled or eliminated at the end of the development process.  <span>[IOT2.4.6.3]</span></button></h5></div><div id="collapse75" class="collapse" aria-labelledby="heading75" data-parent="#controls"><div class="card-body"><p>All unnecessary Accounts or logins have been disabled or removed from the software at the end of the software development process. E.g. Development or debug accounts</p> 
<p><b><font size="4">Rationale:<br /></font></b> Interactive Operating System accounts have been used during the software development process and in most cases have high privileges. This gives them access to critical resources and consequently they can be exploitable if they remain active after the development process. Therefore any interactive accounts or logins should be disabled or eliminated at the end of the software development process.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Disable or remove all interactive Operating System accounts or logins at the end of the development process.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading76"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse76" aria-expanded="true" aria-controls="collapse76">Countermeasure: Files and directories are set to appropriate access privileges <span>[IOT2.4.6.4]</span></button></h5></div><div id="collapse76" class="collapse" aria-labelledby="heading76" data-parent="#controls"><div class="card-body"><p>Files and directories are set to appropriate access privileges on a need to access basis.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Most Operating Systems have methods to assign permissions or access rights to specific users or groups. These permissions control the ability of the users to view, change, navigate, and execute the contents of the file system. Therefore files and directories should be set to appropriate access privileges according to the principle of the least privilege.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Set files, directories and persistent data to the minimum access privileges required to correctly function.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading77"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse77" aria-expanded="true" aria-controls="collapse77">Countermeasure: Passwords file(s) ownership and access/write permissions are set to Devices' OS's most privileged account <span>[IOT2.4.6.5]</span></button></h5></div><div id="collapse77" class="collapse" aria-labelledby="heading77" data-parent="#controls"><div class="card-body"><p>If passwords absolutely must be stored in a local file, then passwords file(s) are owned by - and are only accessible to - and writable by the by the Devices' OS's most privileged account.</p> 
<p><b><font size="4">Rationale:<br /></font></b> The Devices' OS's most privileged account or "superuser" is a special user account used for system administration, capable of making unrestricted, potentially adverse, system-wide changes. For that reason it is often recommended that no-one use "superuser" as their normal user account.&nbsp;</p> 
<p>According to the principle of least privilege, most users and applications run under an ordinary account to perform their work, and must be able to access only the information and resources that are necessary for their legitimate purpose. Thus, if a user only needs to be able to view a particular file, that user should have read-only access to it and should not be able to write to that file. Therefore all files that contain critical or sensitive data like the passwords file(s) should have their ownership and their access/write permissions set to the Devices' OS's most privileged account.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Set ownership and access/write permissions for passwords file(s) to Devices' OS's most privileged account.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading78"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse78" aria-expanded="true" aria-controls="collapse78">Countermeasure: All OS command line access to the most privileged accounts has been removed from the operating system <span>[IOT2.4.6.7]</span></button></h5></div><div id="collapse78" class="collapse" aria-labelledby="heading78" data-parent="#controls"><div class="card-body"><p>All OS command line access to the most privileged accounts has been removed from the Operating System.</p> 
<p><b><font size="4">Rationale:<br /></font></b> The Devices' OS's most privileged account or "superuser" is a special user account used for system administration, capable of making unrestricted, potentially adverse, system-wide changes. For that reason it is often recommended that no-one use "superuser" as their normal user account and any access from the command line should be removed.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Remove all OS command line access to the most privileged accounts from the Operating System.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading79"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse79" aria-expanded="true" aria-controls="collapse79">Countermeasure: OS kernel and its functions are prevented from being called by external product level interfaces and unauthorized applications <span>[IOT2.4.6.8]</span></button></h5></div><div id="collapse79" class="collapse" aria-labelledby="heading79" data-parent="#controls"><div class="card-body"><p>The product's OS kernel and its functions are prevented from being called by external product level interfaces and unauthorized applications.</p> 
<p><b><font size="4">Rationale:<br /></font></b> The kernel is a computer program that is the core of a computer's Operating System, with complete control over everything in the system. Therefore only internal calls should be allowed and only from authorized applications in order to minimize the exposed attack surface.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Configure the product's OS kernel and its functions to prevented being called by external product level interfaces and unauthorized applications.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading80"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse80" aria-expanded="true" aria-controls="collapse80">Countermeasure: Applications are operated at the lowest privilege level possible <span>[IOT2.4.6.9]</span></button></h5></div><div id="collapse80" class="collapse" aria-labelledby="heading80" data-parent="#controls"><div class="card-body">	<p>Applications are operated at the lowest privilege level possible. 	Rationale: Applications are following the principle of the least privilege like every module (such as processes, a users, etc.), which means that they must be able to access only the information and resources that are necessary for their legitimate purpose. Doing this minimizes the amount of damage that results if an attacker successfully exploits any known or future vulnerability. 	Remediation: Configure the Operating System to operate applications at the lowest privilege level possible.</p></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading83"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse83" aria-expanded="true" aria-controls="collapse83">Weakness: Incorrect Ownership Assignment <span>[CWE-708]</span></button></h5></div><div id="collapse83" class="collapse" aria-labelledby="heading83" data-parent="#weaknesses"><div class="card-body">The software assigns an owner to a resource, but the owner is outside of the intended control sphere.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading82"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse82" aria-expanded="true" aria-controls="collapse82">Countermeasure: Passwords file(s) ownership and access/write permissions are set to Devices' OS's most privileged account <span>[IOT2.4.6.5]</span></button></h5></div><div id="collapse82" class="collapse" aria-labelledby="heading82" data-parent="#controls"><div class="card-body"><p>If passwords absolutely must be stored in a local file, then passwords file(s) are owned by - and are only accessible to - and writable by the by the Devices' OS's most privileged account.</p> 
<p><b><font size="4">Rationale:<br /></font></b> The Devices' OS's most privileged account or "superuser" is a special user account used for system administration, capable of making unrestricted, potentially adverse, system-wide changes. For that reason it is often recommended that no-one use "superuser" as their normal user account.&nbsp;</p> 
<p>According to the principle of least privilege, most users and applications run under an ordinary account to perform their work, and must be able to access only the information and resources that are necessary for their legitimate purpose. Thus, if a user only needs to be able to view a particular file, that user should have read-only access to it and should not be able to write to that file. Therefore all files that contain critical or sensitive data like the passwords file(s) should have their ownership and their access/write permissions set to the Devices' OS's most privileged account.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Set ownership and access/write permissions for passwords file(s) to Devices' OS's most privileged account.</p></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading91"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse91" aria-expanded="true" aria-controls="collapse91">Weakness: Incorrect Permission Assignment for Critical Resource <span>[CWE-732]</span></button></h5></div><div id="collapse91" class="collapse" aria-labelledby="heading91" data-parent="#weaknesses"><div class="card-body">The software specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.

When a resource is given a permission setting that provides access to a wider range of actors than required, it could lead to the exposure of sensitive information, or the modification of that resource by unintended parties. This is especially dangerous when the resource is related to program configuration, execution or sensitive user data.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading84"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse84" aria-expanded="true" aria-controls="collapse84">Countermeasure: The OS is separated from the application(s) and is only accessible via defined secure interfaces.  <span>[IOT2.4.6.11]</span></button></h5></div><div id="collapse84" class="collapse" aria-labelledby="heading84" data-parent="#controls"><div class="card-body"><p>The Operating System is separated from the application(s) and is only accessible via defined secure interfaces.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Every device that is to be operated by an individual requires a user interface, usually referred to as a shell. The shell is the outermost layer around the Operating System kernel and is used to access its services including file management, process management (running and terminating applications), batch processing, and operating system monitoring and configuration.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that the Operating System is separated from the application(s) and is only accessible via defined secure interfaces.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading85"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse85" aria-expanded="true" aria-controls="collapse85">Countermeasure: OS accounts or logins have been disabled or eliminated at the end of the development process.  <span>[IOT2.4.6.3]</span></button></h5></div><div id="collapse85" class="collapse" aria-labelledby="heading85" data-parent="#controls"><div class="card-body"><p>All unnecessary Accounts or logins have been disabled or removed from the software at the end of the software development process. E.g. Development or debug accounts</p> 
<p><b><font size="4">Rationale:<br /></font></b> Interactive Operating System accounts have been used during the software development process and in most cases have high privileges. This gives them access to critical resources and consequently they can be exploitable if they remain active after the development process. Therefore any interactive accounts or logins should be disabled or eliminated at the end of the software development process.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Disable or remove all interactive Operating System accounts or logins at the end of the development process.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading86"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse86" aria-expanded="true" aria-controls="collapse86">Countermeasure: Files and directories are set to appropriate access privileges <span>[IOT2.4.6.4]</span></button></h5></div><div id="collapse86" class="collapse" aria-labelledby="heading86" data-parent="#controls"><div class="card-body"><p>Files and directories are set to appropriate access privileges on a need to access basis.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Most Operating Systems have methods to assign permissions or access rights to specific users or groups. These permissions control the ability of the users to view, change, navigate, and execute the contents of the file system. Therefore files and directories should be set to appropriate access privileges according to the principle of the least privilege.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Set files, directories and persistent data to the minimum access privileges required to correctly function.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading87"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse87" aria-expanded="true" aria-controls="collapse87">Countermeasure: Passwords file(s) ownership and access/write permissions are set to Devices' OS's most privileged account <span>[IOT2.4.6.5]</span></button></h5></div><div id="collapse87" class="collapse" aria-labelledby="heading87" data-parent="#controls"><div class="card-body"><p>If passwords absolutely must be stored in a local file, then passwords file(s) are owned by - and are only accessible to - and writable by the by the Devices' OS's most privileged account.</p> 
<p><b><font size="4">Rationale:<br /></font></b> The Devices' OS's most privileged account or "superuser" is a special user account used for system administration, capable of making unrestricted, potentially adverse, system-wide changes. For that reason it is often recommended that no-one use "superuser" as their normal user account.&nbsp;</p> 
<p>According to the principle of least privilege, most users and applications run under an ordinary account to perform their work, and must be able to access only the information and resources that are necessary for their legitimate purpose. Thus, if a user only needs to be able to view a particular file, that user should have read-only access to it and should not be able to write to that file. Therefore all files that contain critical or sensitive data like the passwords file(s) should have their ownership and their access/write permissions set to the Devices' OS's most privileged account.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Set ownership and access/write permissions for passwords file(s) to Devices' OS's most privileged account.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading88"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse88" aria-expanded="true" aria-controls="collapse88">Countermeasure: All OS command line access to the most privileged accounts has been removed from the operating system <span>[IOT2.4.6.7]</span></button></h5></div><div id="collapse88" class="collapse" aria-labelledby="heading88" data-parent="#controls"><div class="card-body"><p>All OS command line access to the most privileged accounts has been removed from the Operating System.</p> 
<p><b><font size="4">Rationale:<br /></font></b> The Devices' OS's most privileged account or "superuser" is a special user account used for system administration, capable of making unrestricted, potentially adverse, system-wide changes. For that reason it is often recommended that no-one use "superuser" as their normal user account and any access from the command line should be removed.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Remove all OS command line access to the most privileged accounts from the Operating System.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading89"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse89" aria-expanded="true" aria-controls="collapse89">Countermeasure: OS kernel and its functions are prevented from being called by external product level interfaces and unauthorized applications <span>[IOT2.4.6.8]</span></button></h5></div><div id="collapse89" class="collapse" aria-labelledby="heading89" data-parent="#controls"><div class="card-body"><p>The product's OS kernel and its functions are prevented from being called by external product level interfaces and unauthorized applications.</p> 
<p><b><font size="4">Rationale:<br /></font></b> The kernel is a computer program that is the core of a computer's Operating System, with complete control over everything in the system. Therefore only internal calls should be allowed and only from authorized applications in order to minimize the exposed attack surface.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Configure the product's OS kernel and its functions to prevented being called by external product level interfaces and unauthorized applications.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading90"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse90" aria-expanded="true" aria-controls="collapse90">Countermeasure: Applications are operated at the lowest privilege level possible <span>[IOT2.4.6.9]</span></button></h5></div><div id="collapse90" class="collapse" aria-labelledby="heading90" data-parent="#controls"><div class="card-body">	<p>Applications are operated at the lowest privilege level possible. 	Rationale: Applications are following the principle of the least privilege like every module (such as processes, a users, etc.), which means that they must be able to access only the information and resources that are necessary for their legitimate purpose. Doing this minimizes the amount of damage that results if an attacker successfully exploits any known or future vulnerability. 	Remediation: Configure the Operating System to operate applications at the lowest privilege level possible.</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading100"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse100" aria-expanded="true" aria-controls="collapse100">Use case: General <span>[GENERAL]</span></button></h5></div><div id="collapse100" class="collapse" aria-labelledby="heading100" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading99"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse99" aria-expanded="true" aria-controls="collapse99">Threat: Exploitation of Operating System security misconfiguration <span>[OWASP A6:2017-OS]</span></button></h5></div><div id="collapse99" class="collapse" aria-labelledby="heading99" data-parent="#threats"><div class="card-body"><p>Attackers will often attempt to exploit unpatched flaws or access default accounts, unused pages, unprotected files and directories, etc to gain unauthorized access or knowledge of the system.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading96"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse96" aria-expanded="true" aria-controls="collapse96">Weakness: The application does not define isolated boundaries (Insufficient Encapsulation) <span>[CWE-485]</span></button></h5></div><div id="collapse96" class="collapse" aria-labelledby="heading96" data-parent="#weaknesses"><div class="card-body"><div>
                        The application does not sufficiently encapsulate critical data or functionality.
                        </div>
                        <p>Encapsulation is about drawing strong boundaries. In a web browser that might mean
                        ensuring that your mobile code cannot be abused by other mobile code. On the server it might
                        mean differentiation between validated data and unvalidated data, between one user's data and
                        another's, or between data users are allowed to see and data that they are not.</p>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading94"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse94" aria-expanded="true" aria-controls="collapse94">Countermeasure: The OS is separated from the application(s) and is only accessible via defined secure interfaces.  <span>[IOT2.4.6.11]</span></button></h5></div><div id="collapse94" class="collapse" aria-labelledby="heading94" data-parent="#controls"><div class="card-body"><p>The Operating System is separated from the application(s) and is only accessible via defined secure interfaces.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Every device that is to be operated by an individual requires a user interface, usually referred to as a shell. The shell is the outermost layer around the Operating System kernel and is used to access its services including file management, process management (running and terminating applications), batch processing, and operating system monitoring and configuration.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that the Operating System is separated from the application(s) and is only accessible via defined secure interfaces.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading95"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse95" aria-expanded="true" aria-controls="collapse95">Countermeasure: The OS implements a separation architecture to separate trusted from untrusted applications <span>[IOT2.4.6.12]</span></button></h5></div><div id="collapse95" class="collapse" aria-labelledby="heading95" data-parent="#controls"><div class="card-body">	<p>The trusted execution environment, or <span class="caps">TEE</span>, is an isolated area on the main processor of a device that is separate from the main operating system. It ensures that data is stored, processed and protected in a trusted environment. <span class="caps">TEE</span> provides protection for any connected "thing" by enabling end-to-end security, protected execution of authenticated code, confidentiality, authenticity, privacy, system integrity and data access rights.</p>

	<p>It is already used widely in complex devices, such as smartphones, tablets and set-top boxes, and also by manufacturers of constrained chipsets and IoT devices in sectors such as industrial automation, automotive and healthcare, who are now recognizing its value in protecting connected things.</p></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading98"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse98" aria-expanded="true" aria-controls="collapse98">Weakness: Unexpected Environment Condition <span>[CWE-2]</span></button></h5></div><div id="collapse98" class="collapse" aria-labelledby="heading98" data-parent="#weaknesses"><div class="card-body">This is a generic weakness that includes several different situations, they are all related to
                        unexpected environmental conditions and they could be related to:&nbsp;
                        <div>
                        <ul>
                        <li>Misconfiguration.</li>
                        <li>Uncleared buffers, shared memory, files, etc.&nbsp;</li>
                        <li>Problems between the interaction of two different entities that cause unexpected
                        behavior.</li>
                        </ul>
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading97"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse97" aria-expanded="true" aria-controls="collapse97">Countermeasure: All the applicable security features supported by the OS are enabled <span>[IOT2.4.6.10]</span></button></h5></div><div id="collapse97" class="collapse" aria-labelledby="heading97" data-parent="#controls"><div class="card-body"><p>All the applicable security features supported by the Operating System are enabled.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Operating System security features are essential to ensure OS security and to prevent various types of malicious actions and attacks such as malware, viruses, etc. Therefore all the applicable security features should be enabled.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Enable all the applicable security features supported by the Operating System such as updates, anti-spyware and anti-virus protection, etc.</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading106"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse106" aria-expanded="true" aria-controls="collapse106">Risk pattern: IoT Device Ownership Transfer <span>[iot-device-ownership-transfer]</span></button></h5></div><div id="collapse106" class="collapse" aria-labelledby="heading106" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading105"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse105" aria-expanded="true" aria-controls="collapse105">Use case: Device management <span>[device-management]</span></button></h5></div><div id="collapse105" class="collapse" aria-labelledby="heading105" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading104"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse104" aria-expanded="true" aria-controls="collapse104">Threat: An attacker examines a target system to find sensitive data that has been embedded within it <span>[CAPEC-37]</span></button></h5></div><div id="collapse104" class="collapse" aria-labelledby="heading104" data-parent="#threats"><div class="card-body"><p>An attacker examines a target system to find sensitive data that has been embedded within it. This information can reveal confidential contents, such as account numbers or individual keys/credentials that can be used as an intermediate step in a larger attack.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading103"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse103" aria-expanded="true" aria-controls="collapse103">Weakness: Information Exposure <span>[CWE-200]</span></button></h5></div><div id="collapse103" class="collapse" aria-labelledby="heading103" data-parent="#weaknesses"><div class="card-body">An information exposure is the unintentional disclosure of information to an actor that is not explicitly authorized to have access to that information.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading102"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse102" aria-expanded="true" aria-controls="collapse102">Countermeasure: The device has an irrevocable method of decommissioning and recommissioning <span>[IOT2.4.16.4]</span></button></h5></div><div id="collapse102" class="collapse" aria-labelledby="heading102" data-parent="#controls"><div class="card-body"><p>In case of ownership change, the device has an irrevocable method of decommissioning and recommissioning.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Decommissioning is the last stage in the device's life cycle. For example an IoT device may need to be decommissioned, because it will be commissioned in another network (recommissioning) or because it is due for replacement which is the case when the device reaches its end of life. In both cases resetting the device to its factory configuration is an important activity and should be handled properly by an irrevocable method.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that the device has an irrevocable method of decommissioning and recommissioning.</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading137"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse137" aria-expanded="true" aria-controls="collapse137">Risk pattern: IoT Device Software <span>[iot-device-software]</span></button></h5></div><div id="collapse137" class="collapse" aria-labelledby="heading137" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading119"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse119" aria-expanded="true" aria-controls="collapse119">Use case: Device operation <span>[device-operation]</span></button></h5></div><div id="collapse119" class="collapse" aria-labelledby="heading119" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading118"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse118" aria-expanded="true" aria-controls="collapse118">Threat: Attackers gain access to the system exploiting insufficient or misconfigured security features <span>[IOT-INSUF-SEC]</span></button></h5></div><div id="collapse118" class="collapse" aria-labelledby="heading118" data-parent="#threats"><div class="card-body">	<p>Attackers will often attempt to exploit insufficient tampering protection, unprotected storage or other misconfigured features.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading108"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse108" aria-expanded="true" aria-controls="collapse108">Weakness: Information Exposure <span>[CWE-200]</span></button></h5></div><div id="collapse108" class="collapse" aria-labelledby="heading108" data-parent="#weaknesses"><div class="card-body">An information exposure is the unintentional disclosure of information to an actor that is not explicitly authorized to have access to that information.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading107"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse107" aria-expanded="true" aria-controls="collapse107">Countermeasure: Memory locations used to store sensitive material (e.g. cryptographic keys, passwords/passphrases, etc.) are sanitised as soon as possible after they are no longer needed <span>[IOT2.4.5.33]</span></button></h5></div><div id="collapse107" class="collapse" aria-labelledby="heading107" data-parent="#controls"><div class="card-body">	<p>Memory locations used to store sensitive material (e.g. cryptographic keys, passwords/passphrases, etc.) are sanitized as soon as possible after they are no longer needed. These can include but are not limited to locations on the heap, the stack, and statically-allocated storage.</p></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading110"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse110" aria-expanded="true" aria-controls="collapse110">Weakness: Information Exposure Through an Error Message <span>[CWE-209]</span></button></h5></div><div id="collapse110" class="collapse" aria-labelledby="heading110" data-parent="#weaknesses"><div class="card-body">The software generates an error message that includes sensitive information about its environment, users, or associated data. This sensitive information may be valuable information on its own (such as a password), or it may be useful for launching other, more deadly attacks. If an attack fails, an attacker may use error information provided by the server to launch another more focused attack.&nbsp; 
<div> 
 <br /> 
</div> 
<div>
  For example, an attempt to exploit a path traversal weakness (CWE-22) might yield the full pathname of the installed application. In turn, this could be used to select the proper number of &quot;..&quot; sequences to navigate to the targeted file.&nbsp; 
</div> 
<div> 
 <br /> 
</div> 
<div>
  An attack using SQL injection (CWE-89) might not initially succeed, but an error message could reveal the malformed query, which would expose query logic and possibly even passwords or other sensitive information used within the query. 
</div><div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading109"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse109" aria-expanded="true" aria-controls="collapse109">Countermeasure: The software has been designed to fail safely <span>[IOT2.4.5.24]</span></button></h5></div><div id="collapse109" class="collapse" aria-labelledby="heading109" data-parent="#controls"><div class="card-body"><p>The software has been designed to meet the safety requirements identified in the risk assessment, i.e. in the case of unexpected invalid inputs, or erroneous software operation, the product does not become dangerous, or compromise the security of other connected systems.</p> 
<p><b><font size="4">Rationale:<br /></font></b> A fail safe software is expected to fail, but when it does it will be in a safe way and security controls and settings remain in effect. The confidentiality and integrity of a system should remain even though availability has been lost. Attackers must not be permitted to gain access rights to privileged objects during a failure that are normally inaccessible. Upon failing, a system that reveals sensitive information about the failure to potential attackers could supply additional knowledge for creating an attack.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that software has been designed to fail safely. This typically involves several things:<br /></p> 
<ul> 
 <li>Secure defaults (default is to deny access).</li> 
 <li>On failure undo changes and restore to a secure state.</li> 
 <li>Always check return values for failure.</li> 
 <li>In conditional code/filters make sure that there is a default case that does the right thing</li> 
</ul> 
<p></p></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading115"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse115" aria-expanded="true" aria-controls="collapse115">Weakness: Recommended security patches are not applied <span>[UNPATCHED-PRODUCT]</span></button></h5></div><div id="collapse115" class="collapse" aria-labelledby="heading115" data-parent="#weaknesses"><div class="card-body">When patches and updates are not applied in a timely manner then a product (e.g. Operating System, Software or Mobile App) or a system could be vulnerable to known security issues. These issues could be leveraged by an attacker to gain access to the system.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading111"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse111" aria-expanded="true" aria-controls="collapse111">Countermeasure: Support for partially installing updates is provided <span>[IOT2.4.5.25]</span></button></h5></div><div id="collapse111" class="collapse" aria-labelledby="heading111" data-parent="#controls"><div class="card-body"><p>Support for partially installing updates is provided for devices whose on-time is insufficient for the complete installation of a whole update.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Software updates perform numerous tasks and they are available for both Operating System and individual software programs. Updates can apply a wide range of revisions into a system such as adding new features, removing outdated features, updating drivers, fixing bugs, and most importantly, fixing security holes. For that reason, support for partially installing updates may be provided for devices whose on-time is insufficient for the complete installation of a whole update.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that software provides support for partially installing updates.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading112"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse112" aria-expanded="true" aria-controls="collapse112">Countermeasure: Support for partially downloading updates is provided <span>[IOT2.4.5.26]</span></button></h5></div><div id="collapse112" class="collapse" aria-labelledby="heading112" data-parent="#controls"><div class="card-body"><p>Support for partially downloading updates is provided for devices whose network access is limited or sporadic.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Software updates perform numerous tasks and they are available for both Operating System and individual software programs. Updates can apply a wide range of revisions into a system such as adding new features, removing outdated features, updating drivers, fixing bugs, and most importantly, fixing security holes. For that reason, support for partially downloading updates may be provided for devices whose network access is limited or sporadic.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that software provides support for partially downloading updates.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading113"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse113" aria-expanded="true" aria-controls="collapse113">Countermeasure: Where a device cannot verify authenticity of updates itself, only local update is permitted <span>[IOT2.4.5.29]</span></button></h5></div><div id="collapse113" class="collapse" aria-labelledby="heading113" data-parent="#controls"><div class="card-body"><p>Where a device cannot verify authenticity of updates itself (e.g. due to no cryptographic capabilities), only local update by a physically present user is permitted.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Code signing is the process of using a certificate-based digital signature to sign executables and scripts in order to confirm the software author and ensure that the code has not been altered or corrupted since it was signed. This process is used for remote updates, too, where devices can verify the signature to confirm that the package is authentic and complete. For that reason, in the case where a device cannot verify authenticity of updates itself, only local update should be permitted.</p> 
<p><b><font size="4">Remediation:<br /></font></b> If the device cannot verify authenticity of updates itself, permit local update only.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading114"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse114" aria-expanded="true" aria-controls="collapse114">Countermeasure: When a device cannot verify authenticity of updates itself, it should be possible revert to the last known good configuration which was stored on the device before the update was attempted <span>[IOT2.4.5.30]</span></button></h5></div><div id="collapse114" class="collapse" aria-labelledby="heading114" data-parent="#controls"><div class="card-body"><p>When a device cannot verify authenticity of updates itself, it should be possible revert to the last known good configuration which was stored on the device before the update was attempted.</p> 
<p><b><font size="4">Rationale:<br /></font></b> To implement certain control capabilities into a system, you'll want to remotely reset the device so as to achieve a known-good state and recover from errors and implement new configuration changes. You may also want to be able reset the device to a factory default configuration, which is useful when you want to decommission a device or as a more invasive way to recover from unknown error conditions.</p> 
<p>Lastly, issuing a command to update or reload firmware is very important in order maintain security of the remote device, implement feature enhancements, and patch bugs.</p> 
<p><b><font size="4">Remediation:<br /></font></b> When a device cannot verify authenticity of updates itself, it should be possible revert to the last known good configuration which was stored on the device before the update was attempted.</p></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading117"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse117" aria-expanded="true" aria-controls="collapse117">Weakness: The product lacks key security features <span>[CWE-254-PROD]</span></button></h5></div><div id="collapse117" class="collapse" aria-labelledby="heading117" data-parent="#weaknesses"><div class="card-body">The product lack of key security features such as protection against tampering, unprotected storages or it has other misconfigurations and omissions during production.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading116"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse116" aria-expanded="true" aria-controls="collapse116">Countermeasure: The product has protection against software reverting <span>[IOT2.4.5.8]</span></button></h5></div><div id="collapse116" class="collapse" aria-labelledby="heading116" data-parent="#controls"><div class="card-body"><p>The product has protection against reverting the software to an earlier and potentially less secure version.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Software updates perform numerous tasks and they are available for both Operating System and individual software programs. Updates can apply a wide range of revisions into a system such as adding new features, removing outdated features, updating drivers, fixing bugs, and most importantly, fixing security holes. For that reason the product should have protection against reverting software to an earlier, out-of-date and probably insecure version.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that the product has mechanisms against software reverting.</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading126"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse126" aria-expanded="true" aria-controls="collapse126">Use case: Networking <span>[NETWORKING]</span></button></h5></div><div id="collapse126" class="collapse" aria-labelledby="heading126" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading122"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse122" aria-expanded="true" aria-controls="collapse122">Threat: Attackers try to retrieve banner information through the open ports to discover potential vulnerabilities <span>[IOT-WIDE-ATTACK-SURFACE-OPEN-PORTS]</span></button></h5></div><div id="collapse122" class="collapse" aria-labelledby="heading122" data-parent="#threats"><div class="card-body"><p>Every point of network interaction or other service is a potential part of the attack surface having exploitable vulnerabilities.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading121"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse121" aria-expanded="true" aria-controls="collapse121">Weakness: Service is exposed to a wide attack surface <span>[UNRESTRICTED-NETWORK]</span></button></h5></div><div id="collapse121" class="collapse" aria-labelledby="heading121" data-parent="#weaknesses"><div class="card-body">The product is exposed or reachable by an unnecessarily large group of potential attackers. An over-exposure of a component increases the chance of an attacker gaining access to the system through a vulnerability.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading120"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse120" aria-expanded="true" aria-controls="collapse120">Countermeasure: Any product's port(s) that are not required for normal operation should be restricted or disabled <span>[IOT2.4.5.5]</span></button></h5></div><div id="collapse120" class="collapse" aria-labelledby="heading120" data-parent="#controls"><div class="card-body"><p>If the product has any virtual port(s) that are not required for normal operation, they are only allowed to communicate with authorized and authenticated entities or securely disabled when shipped.</p> 
<p> Where a port is used for field diagnostics, the port input commands are deactivated and the output provides no information which could compromise the device, such as credentials, memory address or function names. </p> 
<p><b><font size="4">Rationale:<br /></font></b> One of the most important principles in information security is to reduce the attack surface. Open ports are not always a security risk, for example a web server has to have 80 or 443 open otherwise users can not connect to use the web server. Thus taking into account that every open port increases the attack surface, any product's port(s) that are not required for normal operation should be restricted or disabled.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Restrict or disable any port(s) that are not required for normal operation.</p> 
<p> Deactivate port input for port(s) that are used for field diagnostics and ensure their output provides no information which could compromise the device.</p></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading125"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse125" aria-expanded="true" aria-controls="collapse125">Threat: The attacker places himself in the communication channel between the two components <span>[CAPEC-94]</span></button></h5></div><div id="collapse125" class="collapse" aria-labelledby="heading125" data-parent="#threats"><div class="card-body"><p>This type of attack targets the communication between two components (typically client and server).</p> 
<p>The attacker places himself in the communication channel between the two components. Whenever one component attempts to communicate with the other (data flow, authentication challenges, etc.), the data first goes to the attacker, who has the opportunity to observe or alter it, and it is then passed on to the other component as if it was never intercepted. This interposition is transparent leaving the two compromised components unaware of the potential corruption or leakage of their communications. The potential for Man-in-the-Middle attacks yields an implicit lack of trust in communication or identify between two components.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading124"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse124" aria-expanded="true" aria-controls="collapse124">Weakness: Improper Server Identity Validation <span>[CWE-287]</span></button></h5></div><div id="collapse124" class="collapse" aria-labelledby="heading124" data-parent="#weaknesses"><div class="card-body">The software does not validate, or incorrectly validates, the server's identity. 

If the server's identity is not validated, an attacker could spoof a trusted entity by using a man-in-the-middle (MITM) attack. The software might connect to a malicious host while believing it is a trusted host, or the software might be deceived into accepting spoofed data that appears to originate from a trusted host. 
 
One way to perform server authentication is by using X509 certificates over TLS. 
 <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading123"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse123" aria-expanded="true" aria-controls="collapse123">Countermeasure: Software uses certificate pinning or public/private key equivalent for TCP/IP or UDP/IP connections <span>[IOT2.4.5.21]</span></button></h5></div><div id="collapse123" class="collapse" aria-labelledby="heading123" data-parent="#controls"><div class="card-body"><p>Where the device software communicates with a product related webserver or application over <span class="caps">TCP</span>/IP or <span class="caps">UDP</span>/IP, the device software uses certificate pinning or public/private key equivalent, where appropriate.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Secure connections are a cornerstone for client/server communication. Users, developers, and applications expect end-to-end security for their secure channels, but some secure channels are not meeting this expectation. Specifically, channels built using well known protocols can be vulnerable to a number of attacks. For example, traditional certificate validation protects against many types of man-in-the-middle (<span class="caps">MITM</span>) attacks, but it doesn't prevent all of them.</p> 
<p>Certificate pinning can still prevent the interception of a program's network traffic. Pinning is the process of associating a host with their expected X509 certificate or public key, which can be added to an application at development time, or it can be added upon first encountering the certificate or public key.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that device software uses certificate pinning or public/private key equivalent for <span class="caps">TCP</span>/IP or <span class="caps">UDP</span>/IP connections.</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading136"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse136" aria-expanded="true" aria-controls="collapse136">Use case: Update Process <span>[update-process]</span></button></h5></div><div id="collapse136" class="collapse" aria-labelledby="heading136" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading132"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse132" aria-expanded="true" aria-controls="collapse132">Threat: An adversary is able to exploit the update process of the device to escalate its privileges <span>[CAPEC-122-UPDATE-PROCESS]</span></button></h5></div><div id="collapse132" class="collapse" aria-labelledby="heading132" data-parent="#threats"><div class="card-body"><p>An adversary is able to exploit features of the target that should be reserved for privileged users or administrators but are exposed to use by lower or non-privileged accounts. Access to sensitive information and functionality must be controlled to ensure that only authorized users are able to access these resources. If access control mechanisms are absent or misconfigured, a user may be able to access resources that are intended only for higher level users.&nbsp;</p> 
<p>An adversary may be able to exploit this to utilize a less trusted account to gain information and perform activities reserved for more trusted accounts. This attack differs from privilege escalation and other privilege stealing attacks in that the adversary never actually escalates their privileges but instead is able to use a lesser degree of privilege to access resources that should be (but are not) reserved for higher privilege accounts. Likewise, the adversary does not exploit trust or subvert systems - all control functionality is working as configured but the configuration does not adequately protect sensitive resources at an appropriate level.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading129"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse129" aria-expanded="true" aria-controls="collapse129">Weakness: Missing Authentication for Critical Function <span>[CWE-306]</span></button></h5></div><div id="collapse129" class="collapse" aria-labelledby="heading129" data-parent="#weaknesses"><div class="card-body">The software does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading127"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse127" aria-expanded="true" aria-controls="collapse127">Countermeasure: Software images are digitally signed by the organization's approved signing authority. (for remote software upgrade) <span>[IOT2.4.5.2]</span></button></h5></div><div id="collapse127" class="collapse" aria-labelledby="heading127" data-parent="#controls"><div class="card-body"><p>Where remote software upgrade can be supported by the device, the software images are digitally signed by the organization's approved signing authority.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Code signing is the process of using a certificate-based digital signature to sign executables and scripts in order to confirm the software author and ensure that the code has not been altered or corrupted since it was signed. Certificate authority (CA) acts as a trusted third party, trusted both by the software author and the device, and verifies the entity's identity.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that for remote software upgrades, the software images are digitally signed by the organization's approved signing authority.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading128"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse128" aria-expanded="true" aria-controls="collapse128">Countermeasure: When a device cannot verify authenticity of updates itself, it should be possible revert to the last known good configuration which was stored on the device before the update was attempted <span>[IOT2.4.5.30]</span></button></h5></div><div id="collapse128" class="collapse" aria-labelledby="heading128" data-parent="#controls"><div class="card-body"><p>When a device cannot verify authenticity of updates itself, it should be possible revert to the last known good configuration which was stored on the device before the update was attempted.</p> 
<p><b><font size="4">Rationale:<br /></font></b> To implement certain control capabilities into a system, you'll want to remotely reset the device so as to achieve a known-good state and recover from errors and implement new configuration changes. You may also want to be able reset the device to a factory default configuration, which is useful when you want to decommission a device or as a more invasive way to recover from unknown error conditions.</p> 
<p>Lastly, issuing a command to update or reload firmware is very important in order maintain security of the remote device, implement feature enhancements, and patch bugs.</p> 
<p><b><font size="4">Remediation:<br /></font></b> When a device cannot verify authenticity of updates itself, it should be possible revert to the last known good configuration which was stored on the device before the update was attempted.</p></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading131"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse131" aria-expanded="true" aria-controls="collapse131">Weakness: Reliance on a Single Factor in a Security Decision <span>[CWE-654]</span></button></h5></div><div id="collapse131" class="collapse" aria-labelledby="heading131" data-parent="#weaknesses"><div class="card-body">A protection mechanism relies exclusively, or to a large extent, on the evaluation of a single condition or the integrity of a single object or entity in order to make a decision about granting access to restricted resources or functionality.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading130"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse130" aria-expanded="true" aria-controls="collapse130">Countermeasure: When a device cannot verify authenticity of updates itself, it should be possible revert to the last known good configuration which was stored on the device before the update was attempted <span>[IOT2.4.5.30]</span></button></h5></div><div id="collapse130" class="collapse" aria-labelledby="heading130" data-parent="#controls"><div class="card-body"><p>When a device cannot verify authenticity of updates itself, it should be possible revert to the last known good configuration which was stored on the device before the update was attempted.</p> 
<p><b><font size="4">Rationale:<br /></font></b> To implement certain control capabilities into a system, you'll want to remotely reset the device so as to achieve a known-good state and recover from errors and implement new configuration changes. You may also want to be able reset the device to a factory default configuration, which is useful when you want to decommission a device or as a more invasive way to recover from unknown error conditions.</p> 
<p>Lastly, issuing a command to update or reload firmware is very important in order maintain security of the remote device, implement feature enhancements, and patch bugs.</p> 
<p><b><font size="4">Remediation:<br /></font></b> When a device cannot verify authenticity of updates itself, it should be possible revert to the last known good configuration which was stored on the device before the update was attempted.</p></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading135"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse135" aria-expanded="true" aria-controls="collapse135">Threat: An attacker monitors information transmitted between logical or physical nodes of a network <span>[CAPEC-157]</span></button></h5></div><div id="collapse135" class="collapse" aria-labelledby="heading135" data-parent="#threats"><div class="card-body"><p>An attacker monitors information transmitted between logical or physical nodes of a network. The attacker need not be able to prevent reception or change content but must simply be able to observe and read the traffic. The attacker might precipitate or indirectly influence the content of the observed transaction, but the attacker is never the intended recipient of the information. Any transmission medium can theoretically be sniffed if the attacker can listen to the contents between the sender and recipient.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading134"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse134" aria-expanded="true" aria-controls="collapse134">Weakness: Cleartext Transmission of Sensitive Information <span>[CWE-319]</span></button></h5></div><div id="collapse134" class="collapse" aria-labelledby="heading134" data-parent="#weaknesses"><div class="card-body">The software transmits sensitive or security-critical data in cleartext in a communication channel that can be sniffed by unauthorized actors.

Many communication channels can be "sniffed" by attackers during data transmission. For example, network traffic can often be sniffed by any attacker who has access to a network interface. This significantly lowers the difficulty of exploitation by attackers.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading133"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse133" aria-expanded="true" aria-controls="collapse133">Countermeasure: Software images should be encrypted whilst being transferred to a device. (for remote software upgrade) <span>[IOT2.4.5.4]</span></button></h5></div><div id="collapse133" class="collapse" aria-labelledby="heading133" data-parent="#controls"><div class="card-body"><p>If remote software upgrade is supported by a device, software images should be encrypted whilst being transferred to it.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Data transmitted over a public network can be intercepted by unauthorized parties. A secure file transfer adds security features to the transmission by encrypting the file to preserve its confidentiality and integrity. This prevents eavesdroppers on the networks between the systems from accessing the file contents and reading or modifying them, necessitating the use of encryption for software images that are used for remote software upgrades.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Utilize encrypted protocols wherever possible to protect all data in transit. Where protocol encryption is not possible consider encrypting data before transfer.</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading157"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse157" aria-expanded="true" aria-controls="collapse157">Risk pattern: IoT Device Software OS <span>[iot-device-software-os]</span></button></h5></div><div id="collapse157" class="collapse" aria-labelledby="heading157" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading150"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse150" aria-expanded="true" aria-controls="collapse150">Use case: Authentication and Authorization <span>[AUTHENTICATION AND AUTHORIZATION]</span></button></h5></div><div id="collapse150" class="collapse" aria-labelledby="heading150" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading143"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse143" aria-expanded="true" aria-controls="collapse143">Threat: An attacker exploits a weakness in the configuration of access controls and is able to bypass the intended protection that these measures guard against and thereby obtain unauthorized access to the system or network.  <span>[CAPEC-180]</span></button></h5></div><div id="collapse143" class="collapse" aria-labelledby="heading143" data-parent="#threats"><div class="card-body"><p>An adversary is able to exploit features of the target that should be reserved for privileged users or administrators but are exposed to use by lower or non-privileged accounts. Access to sensitive information and functionality must be controlled to ensure that only authorized users are able to access these resources. If access control mechanisms are absent or misconfigured, a user may be able to access resources that are intended only for higher level users. An adversary may be able to exploit this to utilize a less trusted account to gain information and perform activities reserved for more trusted accounts.&nbsp;</p> 
<p>This attack differs from privilege escalation and other privilege stealing attacks in that the adversary never actually escalates their privileges but instead is able to use a lesser degree of privilege to access resources that should be (but are not) reserved for higher privilege accounts. Likewise, the adversary does not exploit trust or subvert systems - all control functionality is working as configured but the configuration does not adequately protect sensitive resources at an appropriate level.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading139"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse139" aria-expanded="true" aria-controls="collapse139">Weakness: Execution with Unnecessary Privileges <span>[CWE-250]</span></button></h5></div><div id="collapse139" class="collapse" aria-labelledby="heading139" data-parent="#weaknesses"><div class="card-body">The software performs an operation at a privilege level that is higher than the minimum level
                        required, which creates new weaknesses or amplifies the consequences of other weaknesses.

                        New weaknesses can be exposed because running with extra privileges, such as root or
                        Administrator, can disable the normal security checks being performed by the operating system or
                        surrounding environment. Other pre-existing weaknesses can turn into security vulnerabilities if
                        they occur while operating at raised privileges. Privilege management functions can behave in
                        some less-than-obvious ways, and they have different quirks on different platforms. These
                        inconsistencies are particularly pronounced if you are transitioning from one non-root user to
                        another. Signal handlers and spawned processes run at the privilege of the owning process, so if
                        a process is running as root when a signal fires or a sub-process is executed, the signal
                        handler or sub-process will operate with root privileges.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading138"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse138" aria-expanded="true" aria-controls="collapse138">Countermeasure: The product has measures to prevent unauthenticated software and files being loaded onto it or to limit their permissions <span>[IOT2.4.5.1]</span></button></h5></div><div id="collapse138" class="collapse" aria-labelledby="heading138" data-parent="#controls"><div class="card-body"><p>The product has measures to prevent unauthenticated software and files being loaded onto it. In the event that the product is intended to allow unauthenticated software, such software should only be run with limited permissions and/or sandbox.</p> 
<p><b><font size="4">Rationale:<br /></font></b> The product should have software execution control to limit which software applications and services are able to run on the Operating System and to control the exposed attack surface of the system by reducing the number of potential vulnerabilities.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Software execution control is used in combination with an administrator defined set of rules, that define which software a non-privileged user is able to execute. These rules can be based on:</p> 
<p></p> 
<ul> 
 <li>Software's properties e.g. name, signature, etc.</li> 
 <li>More generic rules e.g. permitting execution of files based on their storage location on the system.</li> 
</ul> 
<p></p> 
<p>In the event that the product is intended to allow unauthenticated software, such software should only be run with limited permissions and/or sandbox (security mechanism which executes the software in a restricted operating system environment).</p></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading142"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse142" aria-expanded="true" aria-controls="collapse142">Weakness: Missing Authentication for Critical Function <span>[CWE-306]</span></button></h5></div><div id="collapse142" class="collapse" aria-labelledby="heading142" data-parent="#weaknesses"><div class="card-body">The software does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading140"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse140" aria-expanded="true" aria-controls="collapse140">Countermeasure: The product has measures to prevent unauthenticated software and files being loaded onto it or to limit their permissions <span>[IOT2.4.5.1]</span></button></h5></div><div id="collapse140" class="collapse" aria-labelledby="heading140" data-parent="#controls"><div class="card-body"><p>The product has measures to prevent unauthenticated software and files being loaded onto it. In the event that the product is intended to allow unauthenticated software, such software should only be run with limited permissions and/or sandbox.</p> 
<p><b><font size="4">Rationale:<br /></font></b> The product should have software execution control to limit which software applications and services are able to run on the Operating System and to control the exposed attack surface of the system by reducing the number of potential vulnerabilities.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Software execution control is used in combination with an administrator defined set of rules, that define which software a non-privileged user is able to execute. These rules can be based on:</p> 
<p></p> 
<ul> 
 <li>Software's properties e.g. name, signature, etc.</li> 
 <li>More generic rules e.g. permitting execution of files based on their storage location on the system.</li> 
</ul> 
<p></p> 
<p>In the event that the product is intended to allow unauthenticated software, such software should only be run with limited permissions and/or sandbox (security mechanism which executes the software in a restricted operating system environment).</p></div></div></div><div class="card border-success"><div class="card-header " id="heading141"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse141" aria-expanded="true" aria-controls="collapse141">Countermeasure: A software update package is verified by the device before the update process begins <span>[IOT2.4.5.3]</span></button></h5></div><div id="collapse141" class="collapse" aria-labelledby="heading141" data-parent="#controls"><div class="card-body"><p>A software update package has its digital signature, signing certificate and signing certificate chain verified by the device before the update process begins.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Code signing is the process of using a certificate-based digital signature to sign executables and scripts in order to confirm the software author and ensure that the code has not been altered or corrupted since it was signed. Certificate authority (CA) acts as a trusted third party, trusted both by the software author and the device, and verifies the entity's identity. A chain of trust is established by validating each certificate from the end entity to the root certificate.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that the device verifies the digital signature, signing certificate and signing certificate chain of a software update before the update process begins.</p></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading146"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse146" aria-expanded="true" aria-controls="collapse146">Threat: Attackers who compromise the application or application server could directly access and modify the data store <span>[AUTH-DATASTORE-LEAST-PRIV]</span></button></h5></div><div id="collapse146" class="collapse" aria-labelledby="heading146" data-parent="#threats"><div class="card-body">	<p>If attackers gain access to the application or the application server, then they could directly access the data store using the privilege assigned to the application. If the data store user account used by the application has elevated privileges then this could allow attackers to perform unauthorised operations such as dropping tables, modifying the database schema or modifying data.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading145"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse145" aria-expanded="true" aria-controls="collapse145">Weakness: Execution with Unnecessary Privileges <span>[CWE-250]</span></button></h5></div><div id="collapse145" class="collapse" aria-labelledby="heading145" data-parent="#weaknesses"><div class="card-body">The software performs an operation at a privilege level that is higher than the minimum level
                        required, which creates new weaknesses or amplifies the consequences of other weaknesses.

                        New weaknesses can be exposed because running with extra privileges, such as root or
                        Administrator, can disable the normal security checks being performed by the operating system or
                        surrounding environment. Other pre-existing weaknesses can turn into security vulnerabilities if
                        they occur while operating at raised privileges. Privilege management functions can behave in
                        some less-than-obvious ways, and they have different quirks on different platforms. These
                        inconsistencies are particularly pronounced if you are transitioning from one non-root user to
                        another. Signal handlers and spawned processes run at the privilege of the owning process, so if
                        a process is running as root when a signal fires or a sub-process is executed, the signal
                        handler or sub-process will operate with root privileges.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading144"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse144" aria-expanded="true" aria-controls="collapse144">Countermeasure: Access the data store from an account with the least privileges necessary <span>[RESTRICT-ACCESS-DATABASE]</span></button></h5></div><div id="collapse144" class="collapse" aria-labelledby="heading144" data-parent="#controls"><div class="card-body">	<p>Use an account with only the minimum set of permissions required to access the data store. The account should not be able to perform operations that are not explicitly required by the component that performs these operations. For example, if a web application needs to read data from certain tables and insert and update data from others, then a database account with only those specific permissions should be used by the application server.</p></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading149"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse149" aria-expanded="true" aria-controls="collapse149">Threat: Data compromised if the server itself is compromised <span>[SERVER-ATTACK]</span></button></h5></div><div id="collapse149" class="collapse" aria-labelledby="heading149" data-parent="#threats"><div class="card-body">	<p>If attackers compromise the server that hosts the service or data, then the data and the service itself could be at risk of compromise. The server could be compromised through any of the services that it exposes.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading148"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse148" aria-expanded="true" aria-controls="collapse148">Weakness: Unnecessary services are exposed <span>[UNNECESSARY-SERVICES]</span></button></h5></div><div id="collapse148" class="collapse" aria-labelledby="heading148" data-parent="#weaknesses"><div class="card-body">The application exposes unnecessary services which increase the attack surface.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading147"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse147" aria-expanded="true" aria-controls="collapse147">Countermeasure: Restrict access to required services only <span>[INF-UNNECESSARY-SERVICES]</span></button></h5></div><div id="collapse147" class="collapse" aria-labelledby="heading147" data-parent="#controls"><div class="card-body"><p>The attack surface, and therefore susceptibility to attack, should be minimized. In particular, services that are not explicitly required for the proper operation of the server or service should be disable, or access to them be restricted.&nbsp;</p> 
<p></p> 
<ul> 
 <li>Any service, feature, or functionality that is not required should be disabled or removed. This applies equally to the operating system, middleware, web-server, or other software in use.</li> 
 <li>Access to the server and remaining services (in particular those that cannot be disabled or removed) should be controlled use host-based and/or network security controls; for example host firewalls, network firewalls, routers, or switches.</li> 
</ul> 
<p></p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading156"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse156" aria-expanded="true" aria-controls="collapse156">Use case: Update process <span>[update-process]</span></button></h5></div><div id="collapse156" class="collapse" aria-labelledby="heading156" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading155"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse155" aria-expanded="true" aria-controls="collapse155">Threat: Attackers attempt to exploit unpatched flaws to gain unauthorized access or knowledge of the system <span>[OWASP A6:2017]</span></button></h5></div><div id="collapse155" class="collapse" aria-labelledby="heading155" data-parent="#threats"><div class="card-body"><p>Attackers will often attempt to exploit unpatched flaws or access default accounts, unused pages, unprotected files and directories, etc to gain unauthorized access or knowledge of the system.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading152"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse152" aria-expanded="true" aria-controls="collapse152">Weakness: Recommended security patches are not applied <span>[UNPATCHED-PRODUCT]</span></button></h5></div><div id="collapse152" class="collapse" aria-labelledby="heading152" data-parent="#weaknesses"><div class="card-body">When patches and updates are not applied in a timely manner then a product (e.g. Operating System, Software or Mobile App) or a system could be vulnerable to known security issues. These issues could be leveraged by an attacker to gain access to the system.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading151"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse151" aria-expanded="true" aria-controls="collapse151">Countermeasure: Update mechanisms must not interfere with performance expectations <span>[IOT2.4.5.27]</span></button></h5></div><div id="collapse151" class="collapse" aria-labelledby="heading151" data-parent="#controls"><div class="card-body"><p>Where real-time expectations of performance are present, update mechanisms must not interfere with meeting these expectations.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Software update mechanisms may reduce the device's performance when running simultaneously with other processes.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that update mechanisms are not interfering with performance expectations, e.g. by running update processes at low priority.</p></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading154"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse154" aria-expanded="true" aria-controls="collapse154">Weakness: Unexpected Environment Condition <span>[CWE-2]</span></button></h5></div><div id="collapse154" class="collapse" aria-labelledby="heading154" data-parent="#weaknesses"><div class="card-body">This is a generic weakness that includes several different situations that are all related to unexpected environmental conditions and could be related to:&nbsp; 
<div> 
 <ul> 
  <li>Misconfiguration.&nbsp;</li> 
  <li>Uncleared buffers, shared memory, files, etc.&nbsp;</li> 
  <li>Problems between the interaction of two different entities that cause unexpected behavior.</li> 
 </ul> 
</div><div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading153"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse153" aria-expanded="true" aria-controls="collapse153">Countermeasure: Update mechanisms must not interfere with performance expectations <span>[IOT2.4.5.27]</span></button></h5></div><div id="collapse153" class="collapse" aria-labelledby="heading153" data-parent="#controls"><div class="card-body"><p>Where real-time expectations of performance are present, update mechanisms must not interfere with meeting these expectations.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Software update mechanisms may reduce the device's performance when running simultaneously with other processes.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that update mechanisms are not interfering with performance expectations, e.g. by running update processes at low priority.</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading177"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse177" aria-expanded="true" aria-controls="collapse177">Risk pattern: IoT Device Wireless Interfaces <span>[iot-device-wireless-interfaces]</span></button></h5></div><div id="collapse177" class="collapse" aria-labelledby="heading177" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading164"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse164" aria-expanded="true" aria-controls="collapse164">Use case: Authentication and Authorization <span>[AUTHENTICATION AND AUTHORIZATION]</span></button></h5></div><div id="collapse164" class="collapse" aria-labelledby="heading164" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading160"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse160" aria-expanded="true" aria-controls="collapse160">Threat: An adversary is able to exploit the wireless authentication mechanisms <span>[CAPEC-122-WIFI-AUTH]</span></button></h5></div><div id="collapse160" class="collapse" aria-labelledby="heading160" data-parent="#threats"><div class="card-body"><p>An adversary is able to exploit features of the target that should be reserved for privileged users or administrators but are exposed to use by lower or non-privileged accounts. Access to sensitive information and functionality must be controlled to ensure that only authorized users are able to access these resources. If access control mechanisms are absent or misconfigured, a user may be able to access resources that are intended only for higher level users. An adversary may be able to exploit this to utilize a less trusted account to gain information and perform activities reserved for more trusted accounts.&nbsp;</p> 
<p>This attack differs from privilege escalation and other privilege stealing attacks in that the adversary never actually escalates their privileges but instead is able to use a lesser degree of privilege to access resources that should be (but are not) reserved for higher privilege accounts. Likewise, the adversary does not exploit trust or subvert systems - all control functionality is working as configured but the configuration does not adequately protect sensitive resources at an appropriate level.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading159"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse159" aria-expanded="true" aria-controls="collapse159">Weakness: Reliance on a Single Factor in a Security Decision <span>[CWE-654]</span></button></h5></div><div id="collapse159" class="collapse" aria-labelledby="heading159" data-parent="#weaknesses"><div class="card-body">A protection mechanism relies exclusively, or to a large extent, on the evaluation of a single condition or the integrity of a single object or entity in order to make a decision about granting access to restricted resources or functionality.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading158"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse158" aria-expanded="true" aria-controls="collapse158">Countermeasure: Where a wireless communications interface requires an initial pairing process, strong authentication should be used <span>[IOT2.4.7.8]</span></button></h5></div><div id="collapse158" class="collapse" aria-labelledby="heading158" data-parent="#controls"><div class="card-body"><p>Where a wireless communications interface requires an initial pairing process, strong authentication should be used.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Strong authentication blends at least two different authentication factors of different types to improve the safety of identity verification and to prevent unauthorized logins even when passwords have been compromised. For example, this can be achieved by using something the user has (e.g. security token) and something the user knows (e.g. password). </p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that where a wireless communications interface requires an initial pairing process, strong authentication is used, requiring physical interaction with the device or possession of a shared secret. For example, Bluetooth Numeric Comparison.</p></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading163"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse163" aria-expanded="true" aria-controls="collapse163">Threat: Attackers gain unauthorized access in WPS enabled Wifi network through Brute Force Attacks <span>[CAPEC-112-WIFI-WPS]</span></button></h5></div><div id="collapse163" class="collapse" aria-labelledby="heading163" data-parent="#threats"><div class="card-body"><p>In this attack, some asset (information, functionality, identity, etc.) is protected by a finite secret value. The attacker attempts to gain access to this asset by using trial-and-error to exhaustively explore all the possible secret values in the hope of finding the secret (or a value that is functionally equivalent) that will unlock the asset. Examples of secrets can include, but are not limited to, passwords, encryption keys, database lookup keys, and initial values to one-way functions. The key factor in this attack is the attackers' ability to explore the possible secret space rapidly. This, in turn, is a function of the size of the secret space and the computational power the attacker is able to bring to bear on the problem. If the attacker has modest resources and the secret space is large, the challenge facing the attacker is intractable. While the defender cannot control the resources available to an attacker, they can control the size of the secret space.&nbsp;</p> 
<p>Creating a large secret space involves selecting one's secret from as large a field of equally likely alternative secrets as possible and ensuring that an attacker is unable to reduce the size of this field using available clues or cryptanalysis. Doing this is more difficult than it sounds since elimination of patterns (which, in turn, would provide an attacker clues that would help them reduce the space of potential secrets) is difficult to do using deterministic machines, such as computers. Assuming a finite secret space, a brute force attack will eventually succeed.&nbsp;</p> 
<p>The defender must rely on making sure that the time and resources necessary to do so will exceed the value of the information. For example, a secret space that will likely take hundreds of years to explore is likely safe from raw-brute force attacks.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading162"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse162" aria-expanded="true" aria-controls="collapse162">Weakness: The application does not implement anti-automation mechanisms to prevent automated long-time sustained probes <span>[CWE-307]</span></button></h5></div><div id="collapse162" class="collapse" aria-labelledby="heading162" data-parent="#weaknesses"><div class="card-body">The software does not properly limit the number or frequency of interactions that it has with an actor, such as the number of incoming requests.

This can allow the actor to perform actions more frequently than expected. The actor could be a human or an automated process such as a virus or bot. This could be used to cause a denial of service, compromise program logic (such as limiting humans to a single vote), or other consequences. For example, an authentication routine might not limit the number of times an attacker can guess a password. Or, a web site might conduct a poll but only expect humans to vote a maximum of once a day.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading161"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse161" aria-expanded="true" aria-controls="collapse161">Countermeasure: Where WPA2 WPS is used it has a unique, random key per device and enforces exponentially increasing retry attempt delays <span>[IOT2.4.7.11]</span></button></h5></div><div id="collapse161" class="collapse" aria-labelledby="heading161" data-parent="#controls"><div class="card-body"><p>Where WPA2 <span class="caps">WPS</span> is used it has a unique, random key per device and enforces exponentially increasing retry attempt delays.</p> 
<p><b><font size="4">Rationale:<br /></font></b> When the same secret key programmed into a product at manufacturing is shared between multiple devices, it exposes them to various types of malicious attacks. In other words, this means that if an attacker is able to access one device, he/she can possibly log into a huge quantity of other devices that share the same secret key.</p> 
<p>Where WPA2 <span class="caps">WPS</span> is used and allows users to enter passwords as many times as they want, an attacker may try to exploit this by using scripts that enter different combinations until the password cracks. To prevent this kind of brute force attack, the product should have defense such as exponentially increasing retry attempt delays.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that where WPA2 <span class="caps">WPS</span> is used it has a unique, random key per device and enforces exponentially increasing retry attempt delays.</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading168"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse168" aria-expanded="true" aria-controls="collapse168">Use case: Logging and Monitoring <span>[LOGGING AND MONITORING]</span></button></h5></div><div id="collapse168" class="collapse" aria-labelledby="heading168" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading167"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse167" aria-expanded="true" aria-controls="collapse167">Threat: Exploitation of insufficient logging and monitoring <span>[OWASP A10:2017]</span></button></h5></div><div id="collapse167" class="collapse" aria-labelledby="heading167" data-parent="#threats"><div class="card-body">	<p>Exploitation of insufficient logging and monitoring is the bedrock of nearly every major incident.<br />
Attackers rely on the lack of monitoring and timely response to achieve their goals without being detected.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading166"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse166" aria-expanded="true" aria-controls="collapse166">Weakness: Insufficient Logging <span>[CWE-778]</span></button></h5></div><div id="collapse166" class="collapse" aria-labelledby="heading166" data-parent="#weaknesses"><div class="card-body">When a security-critical event occurs, the software either does not record the event or omits important details about the event when logging it.

When security-critical events are not logged properly, such as a failed login attempt, this can make malicious behavior more difficult to detect and may hinder forensic analysis after an attack succeeds.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading165"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse165" aria-expanded="true" aria-controls="collapse165">Countermeasure: Where WPA2 WPS is used it has a unique, random key per device and enforces exponentially increasing retry attempt delays <span>[IOT2.4.7.11]</span></button></h5></div><div id="collapse165" class="collapse" aria-labelledby="heading165" data-parent="#controls"><div class="card-body"><p>Where WPA2 <span class="caps">WPS</span> is used it has a unique, random key per device and enforces exponentially increasing retry attempt delays.</p> 
<p><b><font size="4">Rationale:<br /></font></b> When the same secret key programmed into a product at manufacturing is shared between multiple devices, it exposes them to various types of malicious attacks. In other words, this means that if an attacker is able to access one device, he/she can possibly log into a huge quantity of other devices that share the same secret key.</p> 
<p>Where WPA2 <span class="caps">WPS</span> is used and allows users to enter passwords as many times as they want, an attacker may try to exploit this by using scripts that enter different combinations until the password cracks. To prevent this kind of brute force attack, the product should have defense such as exponentially increasing retry attempt delays.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that where WPA2 <span class="caps">WPS</span> is used it has a unique, random key per device and enforces exponentially increasing retry attempt delays.</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading176"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse176" aria-expanded="true" aria-controls="collapse176">Use case: Networking <span>[NETWORKING]</span></button></h5></div><div id="collapse176" class="collapse" aria-labelledby="heading176" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading175"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse175" aria-expanded="true" aria-controls="collapse175">Threat: An attacker monitors information transmitted through a wireless network <span>[CAPEC-157-WIFI]</span></button></h5></div><div id="collapse175" class="collapse" aria-labelledby="heading175" data-parent="#threats"><div class="card-body"><p>An attacker monitors information transmitted between logical or physical nodes of a network. The attacker need not be able to prevent reception or change content but must simply be able to observe and read the traffic. The attacker might precipitate or indirectly influence the content of the observed transaction, but the attacker is never the intended recipient of the information. Any transmission medium can theoretically be sniffed if the attacker can listen to the contents between the sender and recipient.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading171"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse171" aria-expanded="true" aria-controls="collapse171">Weakness: Cleartext Transmission of Sensitive Information <span>[CWE-319]</span></button></h5></div><div id="collapse171" class="collapse" aria-labelledby="heading171" data-parent="#weaknesses"><div class="card-body">The software transmits sensitive or security-critical data in cleartext in a communication channel that can be sniffed by unauthorized actors.

Many communication channels can be "sniffed" by attackers during data transmission. For example, network traffic can often be sniffed by any attacker who has access to a network interface. This significantly lowers the difficulty of exploitation by attackers.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading169"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse169" aria-expanded="true" aria-controls="collapse169">Countermeasure: For any WiFi connection, WPA2 with AES or a similar strength encryption has been used and insecure protocols such as WPA and TKIP are disabled <span>[IOT2.4.7.10]</span></button></h5></div><div id="collapse169" class="collapse" aria-labelledby="heading169" data-parent="#controls"><div class="card-body"><p>For any WiFi connection, WPA2 with <span class="caps">AES</span> or a similar strength encryption has been used and insecure protocols such as <span class="caps">WPA</span> and <span class="caps">TKIP</span> are disabled.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Most Wi-Fi networks are configured to encrypt traffic between client devices and access points, so that someone outside the network cannot read or interfere with communications on the network. WPA2 is one protocol that can be used for this purpose.</p> 
<p><b>Note: </b>Keep in mind to get protection from the "Krack" WPA2 vulnerability, please see reference <span class="caps">URL</span> [1] for details.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that for any WiFi connection, WPA2 with <span class="caps">AES</span> or a similar strength encryption has been used and insecure protocols such as <span class="caps">WPA</span> and <span class="caps">TKIP</span> are disabled.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading170"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse170" aria-expanded="true" aria-controls="collapse170">Countermeasure: Where WPA2 WPS is used it has a unique, random key per device and enforces exponentially increasing retry attempt delays <span>[IOT2.4.7.11]</span></button></h5></div><div id="collapse170" class="collapse" aria-labelledby="heading170" data-parent="#controls"><div class="card-body"><p>Where WPA2 <span class="caps">WPS</span> is used it has a unique, random key per device and enforces exponentially increasing retry attempt delays.</p> 
<p><b><font size="4">Rationale:<br /></font></b> When the same secret key programmed into a product at manufacturing is shared between multiple devices, it exposes them to various types of malicious attacks. In other words, this means that if an attacker is able to access one device, he/she can possibly log into a huge quantity of other devices that share the same secret key.</p> 
<p>Where WPA2 <span class="caps">WPS</span> is used and allows users to enter passwords as many times as they want, an attacker may try to exploit this by using scripts that enter different combinations until the password cracks. To prevent this kind of brute force attack, the product should have defense such as exponentially increasing retry attempt delays.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that where WPA2 <span class="caps">WPS</span> is used it has a unique, random key per device and enforces exponentially increasing retry attempt delays.</p></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading174"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse174" aria-expanded="true" aria-controls="collapse174">Weakness: Inadequate Encryption Strength <span>[CWE-326]</span></button></h5></div><div id="collapse174" class="collapse" aria-labelledby="heading174" data-parent="#weaknesses"><div class="card-body">The software stores or transmits sensitive data using an encryption scheme that is theoretically sound, but is not strong enough for the level of protection required. A weak encryption scheme can be subjected to brute force attacks that have a reasonable chance of succeeding using current attack methods and resources.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading172"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse172" aria-expanded="true" aria-controls="collapse172">Countermeasure: For any WiFi connection, WPA2 with AES or a similar strength encryption has been used and insecure protocols such as WPA and TKIP are disabled <span>[IOT2.4.7.10]</span></button></h5></div><div id="collapse172" class="collapse" aria-labelledby="heading172" data-parent="#controls"><div class="card-body"><p>For any WiFi connection, WPA2 with <span class="caps">AES</span> or a similar strength encryption has been used and insecure protocols such as <span class="caps">WPA</span> and <span class="caps">TKIP</span> are disabled.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Most Wi-Fi networks are configured to encrypt traffic between client devices and access points, so that someone outside the network cannot read or interfere with communications on the network. WPA2 is one protocol that can be used for this purpose.</p> 
<p><b>Note: </b>Keep in mind to get protection from the "Krack" WPA2 vulnerability, please see reference <span class="caps">URL</span> [1] for details.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that for any WiFi connection, WPA2 with <span class="caps">AES</span> or a similar strength encryption has been used and insecure protocols such as <span class="caps">WPA</span> and <span class="caps">TKIP</span> are disabled.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading173"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse173" aria-expanded="true" aria-controls="collapse173">Countermeasure: Where WPA2 WPS is used it has a unique, random key per device and enforces exponentially increasing retry attempt delays <span>[IOT2.4.7.11]</span></button></h5></div><div id="collapse173" class="collapse" aria-labelledby="heading173" data-parent="#controls"><div class="card-body"><p>Where WPA2 <span class="caps">WPS</span> is used it has a unique, random key per device and enforces exponentially increasing retry attempt delays.</p> 
<p><b><font size="4">Rationale:<br /></font></b> When the same secret key programmed into a product at manufacturing is shared between multiple devices, it exposes them to various types of malicious attacks. In other words, this means that if an attacker is able to access one device, he/she can possibly log into a huge quantity of other devices that share the same secret key.</p> 
<p>Where WPA2 <span class="caps">WPS</span> is used and allows users to enter passwords as many times as they want, an attacker may try to exploit this by using scripts that enter different combinations until the password cracks. To prevent this kind of brute force attack, the product should have defense such as exponentially increasing retry attempt delays.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that where WPA2 <span class="caps">WPS</span> is used it has a unique, random key per device and enforces exponentially increasing retry attempt delays.</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading186"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse186" aria-expanded="true" aria-controls="collapse186">Risk pattern: IoT Encryption and Key Management for Hardware <span>[iot-encryption-and-key-management-for-hardware]</span></button></h5></div><div id="collapse186" class="collapse" aria-labelledby="heading186" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading181"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse181" aria-expanded="true" aria-controls="collapse181">Use case: General <span>[GENERAL]</span></button></h5></div><div id="collapse181" class="collapse" aria-labelledby="heading181" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading180"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse180" aria-expanded="true" aria-controls="collapse180">Threat: An attacker examines a target system to find sensitive data that has been embedded within it <span>[CAPEC-37]</span></button></h5></div><div id="collapse180" class="collapse" aria-labelledby="heading180" data-parent="#threats"><div class="card-body"><p>An attacker examines a target system to find sensitive data that has been embedded within it. This information can reveal confidential contents, such as account numbers or individual keys/credentials that can be used as an intermediate step in a larger attack.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading179"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse179" aria-expanded="true" aria-controls="collapse179">Weakness: Information Exposure <span>[CWE-200]</span></button></h5></div><div id="collapse179" class="collapse" aria-labelledby="heading179" data-parent="#weaknesses"><div class="card-body">An information exposure is the unintentional disclosure of information to an actor that is not explicitly authorized to have access to that information.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading178"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse178" aria-expanded="true" aria-controls="collapse178">Countermeasure: There is a secure method of key insertion that protects keys against copying <span>[IOT2.4.9.4]</span></button></h5></div><div id="collapse178" class="collapse" aria-labelledby="heading178" data-parent="#controls"><div class="card-body"><p>There is a secure method of key insertion that protects keys against copying.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Keys should be protected from copying, using a secure insertion method. This can be achieved by using a dedicated secure and trusted hardware module which stores and protects the keys.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Trusted Platform Module (<span class="caps">TPM</span>, also known as <span class="caps">ISO</span>/IEC 11889) is an international standard for a secure cryptoprocessor, a dedicated microcontroller designed to secure hardware through integrated cryptographic keys. Each <span class="caps">TPM</span> chip has a unique and secret <span class="caps">RSA</span> key burned in as it is produced. Pushing the security down to the hardware level provides more protection than a software-only solution.</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading185"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse185" aria-expanded="true" aria-controls="collapse185">Use case: Key management <span>[key-management]</span></button></h5></div><div id="collapse185" class="collapse" aria-labelledby="heading185" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading184"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse184" aria-expanded="true" aria-controls="collapse184">Threat: An adversary is able to exploit features of the target that should be reserved for privileged users  <span>[CAPEC-122]</span></button></h5></div><div id="collapse184" class="collapse" aria-labelledby="heading184" data-parent="#threats"><div class="card-body"><p>An adversary is able to exploit features of the target that should be reserved for privileged users or administrators but are exposed to use by lower or non-privileged accounts. Access to sensitive information and functionality must be controlled to ensure that only authorized users are able to access these resources. If access control mechanisms are absent or misconfigured, a user may be able to access resources that are intended only for higher level users.&nbsp;</p> 
<p>An adversary may be able to exploit this to utilize a less trusted account to gain information and perform activities reserved for more trusted accounts. This attack differs from privilege escalation and other privilege stealing attacks in that the adversary never actually escalates their privileges but instead is able to use a lesser degree of privilege to access resources that should be (but are not) reserved for higher privilege accounts. Likewise, the adversary does not exploit trust or subvert systems - all control functionality is working as configured but the configuration does not adequately protect sensitive resources at an appropriate level.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading183"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse183" aria-expanded="true" aria-controls="collapse183">Weakness: The product lacks key security features <span>[CWE-254-PROD]</span></button></h5></div><div id="collapse183" class="collapse" aria-labelledby="heading183" data-parent="#weaknesses"><div class="card-body">The product lack of key security features such as protection against tampering, unprotected storages or it has other misconfigurations and omissions during production.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading182"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse182" aria-expanded="true" aria-controls="collapse182">Countermeasure: The cryptographic key chain used for signing production software is different from that used for any other software images <span>[IOT2.4.9.8]</span></button></h5></div><div id="collapse182" class="collapse" aria-labelledby="heading182" data-parent="#controls"><div class="card-body"><p>The cryptographic key chain used for signing production software is different from that used for any other test, development or other software images.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Often test or development images have fewer restrictions and/or more privileges. Therefore, to prevent the installation of non production software into production devices, a different cryptographic key chain should be used for signing production software.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Use a different cryptographic key chain for signing production software from that used for any other test, development or other software images.</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading226"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse226" aria-expanded="true" aria-controls="collapse226">Risk pattern: IoT Mobile Application <span>[iot-mobile-application]</span></button></h5></div><div id="collapse226" class="collapse" aria-labelledby="heading226" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading190"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse190" aria-expanded="true" aria-controls="collapse190">Use case: Administration service <span>[ADMINISTRATION SERVICE]</span></button></h5></div><div id="collapse190" class="collapse" aria-labelledby="heading190" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading189"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse189" aria-expanded="true" aria-controls="collapse189">Threat: Attackers gain access to the system through an unprotected administration interface <span>[CSD-ADM-IFACE]</span></button></h5></div><div id="collapse189" class="collapse" aria-labelledby="heading189" data-parent="#threats"><div class="card-body">	<p>Administrative interfaces grant access to sensitive operations that can typically affect key security mechanisms, like modifying credentials and adding/removing user accounts.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading188"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse188" aria-expanded="true" aria-controls="collapse188">Weakness: Access to the administration interfaces is open to untrusted parties <span>[CSD-ADM-OPEN]</span></button></h5></div><div id="collapse188" class="collapse" aria-labelledby="heading188" data-parent="#weaknesses"><div class="card-body">The application does not restrict access to administration interfaces to untrusted parties. 
This fact could allow an attacker to chain vulnerabilities in order to gain unauthorized access to the system. <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading187"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse187" aria-expanded="true" aria-controls="collapse187">Countermeasure: Restrict access to administrative interfaces <span>[CSD-ADM-TRUST]</span></button></h5></div><div id="collapse187" class="collapse" aria-labelledby="heading187" data-parent="#controls"><div class="card-body"><p>Restrict access to administrative interfaces to trusted actors from trusted locations to reduce the application attack surface and likelihood of compromise.</p> 
<p>Restrict administrative access to specific networks or hosts.</p> 
<div>
  Use strong authentication for privileged access, for example a 2FA. 
</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading207"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse207" aria-expanded="true" aria-controls="collapse207">Use case: Authentication and Authorization <span>[AUTHENTICATION AND AUTHORIZATION]</span></button></h5></div><div id="collapse207" class="collapse" aria-labelledby="heading207" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading193"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse193" aria-expanded="true" aria-controls="collapse193">Threat: An adversary is able to exploit the integrity of the Mobile Application <span>[CAPEC-122-MOBILE-INTEGRITY]</span></button></h5></div><div id="collapse193" class="collapse" aria-labelledby="heading193" data-parent="#threats"><div class="card-body"><p>An adversary is able to exploit features of the target that should be reserved for privileged users or administrators but are exposed to use by lower or non-privileged accounts. Access to sensitive information and functionality must be controlled to ensure that only authorized users are able to access these resources. If access control mechanisms are absent or misconfigured, a user may be able to access resources that are intended only for higher level users.&nbsp;</p> 
<p>An adversary may be able to exploit this to utilize a less trusted account to gain information and perform activities reserved for more trusted accounts. This attack differs from privilege escalation and other privilege stealing attacks in that the adversary never actually escalates their privileges but instead is able to use a lesser degree of privilege to access resources that should be (but are not) reserved for higher privilege accounts. Likewise, the adversary does not exploit trust or subvert systems - all control functionality is working as configured but the configuration does not adequately protect sensitive resources at an appropriate level.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading192"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse192" aria-expanded="true" aria-controls="collapse192">Weakness: Incorrect Permission Assignment for Critical Resource <span>[CWE-732]</span></button></h5></div><div id="collapse192" class="collapse" aria-labelledby="heading192" data-parent="#weaknesses"><div class="card-body">The software specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.

When a resource is given a permission setting that provides access to a wider range of actors than required, it could lead to the exposure of sensitive information, or the modification of that resource by unintended parties. This is especially dangerous when the resource is related to program configuration, execution or sensitive user data.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading191"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse191" aria-expanded="true" aria-controls="collapse191">Countermeasure: Any related databases or files are either tamper resistant or restricted in their access <span>[IOT2.4.11.3]</span></button></h5></div><div id="collapse191" class="collapse" aria-labelledby="heading191" data-parent="#controls"><div class="card-body"><p>The mobile application ensures that any related databases or files are either tamper resistant or restricted in their access.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Anti-tamper software is software which makes it harder for an attacker to modify it. Attackers can tamper with or install a backdoor on an app, re-sign it and publish the malicious version to third-party app marketplaces. Such attacks typically target popular apps and financial apps.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Employ anti-tamper and tamper-detection techniques to prevent illegitimate applications from executing. For example use checksums, digital signatures and other validation mechanisms to help detect file tampering. Upon detection of tampering, databases or files are re-initialized.</p> 
<p><b><font size="4">Impact:<br /></font></b> Anti-tampering technology typically makes the software somewhat larger and also has a performance impact.</p></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading196"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse196" aria-expanded="true" aria-controls="collapse196">Threat: Attackers gain access to user accounts by accessing the password database <span>[CSD-AUTH-HASH]</span></button></h5></div><div id="collapse196" class="collapse" aria-labelledby="heading196" data-parent="#threats"><div class="card-body">	<p>An attacker with access to the plain, readable credential database would have access to the system as any of those users.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading195"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse195" aria-expanded="true" aria-controls="collapse195">Weakness: Password hashes can be reverted over a reasonable period of time <span>[CWE-916]</span></button></h5></div><div id="collapse195" class="collapse" aria-labelledby="heading195" data-parent="#weaknesses"><div class="card-body">The software generates a hash for a password, but it uses a scheme that does not provide a sufficient level of computational effort that would make password cracking attacks infeasible or expensive. Many password storage mechanisms compute a hash and store the hash, instead of storing the original password in plaintext. In this design, authentication involves accepting an incoming password, computing its hash, and comparing it to the stored hash.&nbsp; 
<div> 
 <br /> 
</div> 
<div>
  Many hash algorithms are designed to execute quickly with minimal overhead, even cryptographic hashes. However, this efficiency is a problem for password storage, because it can reduce an attacker's workload for brute-force password cracking. If an attacker can obtain the hashes through some other method (such as SQL injection on a database that stores hashes), then the attacker can store the hashes offline and use various techniques to crack the passwords by computing hashes efficiently. Without a built-in workload, modern attacks can compute large numbers of hashes, or even exhaust the entire space of all possible passwords, within a very short amount of time, using massively-parallel computing (such as cloud computing) and GPU, ASIC, or FPGA hardware. In such a scenario, an efficient hash algorithm helps the attacker. There are several properties of a hash scheme that are relevant to its strength against an offline, massively-parallel attack:&nbsp; 
</div> 
<div> 
 <ul> 
  <li>The amount of CPU time required to compute the hash (&quot;stretching&quot;)&nbsp;</li> 
  <li>The amount of memory required to compute the hash (&quot;memory-hard&quot; operations)&nbsp;</li> 
  <li>Including a random value, along with the password, as input to the hash computation (&quot;salting&quot;)&nbsp;</li> 
  <li>Given a hash, there is no known way of determining a password that produces this hash value, other than by guessing possible passwords (&quot;one-way&quot; hashing)&nbsp;</li> 
  <li>Relative to the number of all possible hashes that can be generated by the scheme, there is a low likelihood of producing the same hash for multiple different inputs (&quot;collision resistance&quot;)&nbsp;</li> 
 </ul>Note that the security requirements for the software may vary depending on the environment and the value of the passwords. Different schemes might not provide all of these properties, yet may still provide sufficient security for the environment. Conversely, a solution might be very strong in preserving one property, which still being very weak for an attack against another property, or it might not be able to significantly reduce the efficiency of a massively-parallel attack. 
</div><div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading194"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse194" aria-expanded="true" aria-controls="collapse194">Countermeasure: Store passwords in unrecoverable form to prevent disclosure <span>[CWE-256]</span></button></h5></div><div id="collapse194" class="collapse" aria-labelledby="heading194" data-parent="#controls"><div class="card-body"><p>To protect users passwords from accidental or deliberate exposure, the application should store cryptographic hashes of passwords instead of the passwords themselves.&nbsp;</p> 
<p></p> 
<ul> 
 <li>Do not store passwords themselves in the data store for verification at login.&nbsp;</li> 
 <li>Instead, create a cryptographic hash of the password using a strong hash function that includes a work factor and a built in ‘salt’ value, like bcrypt or scrypt. This reduces the risk of brute-force attacks and rainbow tables, and allows flexibility to adapt the hashing function to balance security and performance.&nbsp;</li> 
 <li>Alternatively, use a strong hash function like <span class="caps">SHA</span>-384 together with a unique ‘salt’ value for every account. Apply multiple iterations of the hash to create the additional computational work required to mitigate brute-force attacks.</li> 
</ul> 
<p></p></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading200"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse200" aria-expanded="true" aria-controls="collapse200">Threat: Attackers gain unauthorized access through Brute Force attacks against the mobile application's user interface <span>[CAPEC-112-MOBILE]</span></button></h5></div><div id="collapse200" class="collapse" aria-labelledby="heading200" data-parent="#threats"><div class="card-body"><p>In this attack, some asset (information, functionality, identity, etc.) is protected by a finite secret value. The attacker attempts to gain access to this asset by using trial-and-error to exhaustively explore all the possible secret values in the hope of finding the secret (or a value that is functionally equivalent) that will unlock the asset. Examples of secrets can include, but are not limited to, passwords, encryption keys, database lookup keys, and initial values to one-way functions. The key factor in this attack is the attackers' ability to explore the possible secret space rapidly. This, in turn, is a function of the size of the secret space and the computational power the attacker is able to bring to bear on the problem. If the attacker has modest resources and the secret space is large, the challenge facing the attacker is intractable. While the defender cannot control the resources available to an attacker, they can control the size of the secret space.&nbsp;</p> 
<p>Creating a large secret space involves selecting one's secret from as large a field of equally likely alternative secrets as possible and ensuring that an attacker is unable to reduce the size of this field using available clues or cryptanalysis. Doing this is more difficult than it sounds since elimination of patterns (which, in turn, would provide an attacker clues that would help them reduce the space of potential secrets) is difficult to do using deterministic machines, such as computers.&nbsp;</p> 
<p>Assuming a finite secret space, a brute force attack will eventually succeed. The defender must rely on making sure that the time and resources necessary to do so will exceed the value of the information. For example, a secret space that will likely take hundreds of years to explore is likely safe from raw-brute force attacks.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading199"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse199" aria-expanded="true" aria-controls="collapse199">Weakness: Poor quality passwords in use <span>[CWE-521]</span></button></h5></div><div id="collapse199" class="collapse" aria-labelledby="heading199" data-parent="#weaknesses"><div class="card-body">The product does not enforce a strong password policy, which makes it easier for attackers to compromise user accounts through brute force or dictionary based attacks.

An authentication mechanism is only as strong as its credentials. For this reason, it is important to require users to have strong passwords. Lack of password complexity significantly reduces the search space when trying to guess user's passwords, making brute-force attacks easier.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading197"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse197" aria-expanded="true" aria-controls="collapse197">Countermeasure: Require the use of strong passwords <span>[CWE-521]</span></button></h5></div><div id="collapse197" class="collapse" aria-labelledby="heading197" data-parent="#controls"><div class="card-body"><div>
                        Passwords used either as a sole verification credentials, or as part of a multi-factor
                        authentication, are a key aspect of application security, and strong password selection should
                        be encouraged and enforced. The application should allow flexibility in user password selection,
                        and enforce minimum criteria for password quality. This should include:
                        </div>
                        <div>
                        <ul>
                        <li>Minimum password length requirements, to mitigate brute-force and dictionary attacks.</li>
                        <li>Encourage use of pass-phrases using multiple words, achieving longer passwords more
                        resistant to attack.</li>
                        <li>Enforce use of mixed case, numeric and/or special characters to increase complexity.</li>
                        <li>Prevent or discourage use of dictionary words and common passwords through
                        black-lists. For example, a set of commonly used passwords can be found on SecLists at&nbsp;<a
                        href="https://github.com/danielmiessler/SecLists/tree/master/Passwords">https://github.com/danielmiessler/SecLists/tree/master/Passwords</a>&nbsp;</li>
                        </ul>
                        </div>
                        <div>
                        <p><b>Password length</b></p>
                        <p>Password length considers the minimum and maximum length of characters comprising the
                        password of your users. For ease of changing this length, its implementation can be configurable
                        possibly using a properties file or xml configuration file.</p>
                        <ul>
                        <li>Minimum length. Passwords should be at least ten (10) characters long. Combining this
                        length with complexity makes a password difficult to guess and/or brute force.</li>
                        <li>Maximum length. People tend to forget their passwords easily. The longer the password,
                        the more likely people are to enter them incorrectly for the system. However, long pass-phrases
                        can be easily remembered, and should not be prevented through unnecessarily strict upper
                        restrictions on length.</li>
                        </ul>
                        <p><b>Password Complexity</b></p>
                        <ul>
                        <li>Password characters should be a combination of alphanumeric characters. Alphanumeric
                        characters consist of letters, numbers, punctuation marks, mathematical and other conventional
                        symbols.</li>
                        <li>For change and reset password functionality it is recommended a history of old
                        password (salted) hashes used. This can be used to prevent password reuse, or an attacker
                        alternating between a selection of passwords (Monday1, Tuesday2 etc.)</li>
                        <li>Actual passwords must not be stored, to protect them against brute forcing if the
                        database is compromised.</li>
                        </ul>
                        </div>
                        <div>
                        <ul>
                        </ul>
                        <ul>
                        </ul>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading198"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse198" aria-expanded="true" aria-controls="collapse198">Countermeasure: Where a UI password is used for login authentication, the initial password or factory reset password is unique to each device <span>[IOT2.4.11.1]</span></button></h5></div><div id="collapse198" class="collapse" aria-labelledby="heading198" data-parent="#controls"><div class="card-body"><p>Where an application's user interface password is used for login authentication, the initial password or factory reset password is unique to each device in the product family.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Where a device needs a password to log in, a default password is usually provided that allows the device to be accessed during its initial setup, and then the user will be prompted to change it after he/she first logs on. An attacker with knowledge of the default password can log in, usually with root or administrative privileges and perform malicious actions. Therefore, all initial passwords and factory reset passwords issued should be unique to each user.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Apply a process which ensures that the initial password or factory reset password is unique to each device in the product family.</p></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading203"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse203" aria-expanded="true" aria-controls="collapse203">Threat: Attackers try to convince a target into performing actions or divulging confidential information in their benefit, often resulting in access to computer systems or facilities <span>[CAPEC-403]</span></button></h5></div><div id="collapse203" class="collapse" aria-labelledby="heading203" data-parent="#threats"><div class="card-body"><p>Attack patterns within this category focus on the manipulation and exploitation of people. The techniques defined by each pattern are used to convince a target into performing actions or divulging confidential information that benefit the adversary, often resulting in access to computer systems or facilities. While similar to a confidence trick or simple fraud, the term typically applies to trickery or deception for the purpose of information gathering, fraud, or computer system access. In most cases, the adversary never comes face-to-face with the victim.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading202"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse202" aria-expanded="true" aria-controls="collapse202">Weakness: Shoulder surfing attack <span>[SOCI-ENG-SS]</span></button></h5></div><div id="collapse202" class="collapse" aria-labelledby="heading202" data-parent="#weaknesses"><div class="card-body">Attacks leveraging social engineering such as monitoring the keyboard entry by the user or collecting her personal information to verify whether it is used as a password or forms part of the password.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading201"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse201" aria-expanded="true" aria-controls="collapse201">Countermeasure: Pass phrase is obscured by default where entered on a UI <span>[IOT2.4.11.6]</span></button></h5></div><div id="collapse201" class="collapse" aria-labelledby="heading201" data-parent="#controls"><div class="card-body"><p>Where passwords are entered on a user interface, the actual pass phrase is obscured by default to prevent the capture of passwords.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Password masking is the practice of obscuring the password characters when entered on a user interface, more often behind bullets (•), asterisks (*) or similar camouflaging characters. The idea behind password masking is primarily the protection against "shoulder surfing", in other words to prevent nearby observers reading the password "over the user's shoulder" and thus stolen, which is crucial for mobile devices. A second reason is to obscure the password in cases of shared screens, projectors, etc.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that the actual pass phrase is obscured by default where entered on a user interface.</p></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading206"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse206" aria-expanded="true" aria-controls="collapse206">Threat: Malicious applications gain access to unauthorised data or perform unauthorised actions <span>[CAPEC-1-ANDROID]</span></button></h5></div><div id="collapse206" class="collapse" aria-labelledby="heading206" data-parent="#threats"><div class="card-body">	<p>Attackers could use malicious mobile applications to attack legitimate applications that export their components improperly. The attacks and consequences of improperly exporting a component may depend on the exported component: If access to an exported Activity is not restricted, any application will be able to launch the activity. 
 This may allow a malicious application to gain access to sensitive information, modify the internal state of the application, or trick a user into interacting with the victim application whilst believing they are still interacting with the malicious application. If access to an exported Service is not restricted, any application may start and bind to the Service. </p>

 Depending on the exposed functionality, this may allow a malicious application to perform unauthorized actions, gain access to sensitive information, or corrupt the internal state of the application. If access to a Content Provider is not restricted to only the expected applications, then malicious applications might be able to access the sensitive data. Note that in Android before 4.2, the Content Provider is automatically exported unless it has been explicitly declared as <span class="caps">NOT</span> exported.<div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading205"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse205" aria-expanded="true" aria-controls="collapse205">Weakness: Improper Input Validation <span>[CWE-20]</span></button></h5></div><div id="collapse205" class="collapse" aria-labelledby="heading205" data-parent="#weaknesses"><div class="card-body">The product does not validate or incorrectly validates input that can affect the control flow or data flow of a program.

When software does not validate input properly, an attacker is able to craft the input in a form that is not expected by the rest of the application. This will lead to parts of the system receiving unintended input, which may result in altered control flow, arbitrary control of a resource, or arbitrary code execution.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading204"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse204" aria-expanded="true" aria-controls="collapse204">Countermeasure: Validate all input data sent to exported activities, intents or content providers <span>[CWE-20]</span></button></h5></div><div id="collapse204" class="collapse" aria-labelledby="heading204" data-parent="#controls"><div class="card-body">	<p>All data received from the client-side should be considered tainted and a potential risk, regardless of the source or transport method. This affects all application platforms, including mobile. All data from the client side must be subjected to strict validation, sanitization, and encoding against expected syntactic and semantic criteria. 
 Define a specification of the data that is expected at each input; both the syntax (e.g. alphanumeric only) and semantics (e.g. a word of between 1 and 25 characters, or a specific list). As an example of business rule logic, &quot;boat&quot; may be syntactically valid because it only contains alphanumeric characters, but it is not valid if the input is only expected to contain colors such as &quot;red&quot; or &quot;blue.&quot; </p>

 Implement a &#8216;known good&#8217; or white-list approach, where only inputs that meet the strict criteria for each input are accepted, and reject, transform, or encapsulate any non-compliant data. While useful for identifying malicious content, do not rely on looking for specific malformed or attack payloads (blacklists). It is almost impossible to maintain a comprehensive and accurate blacklist due to the complexity and evolving nature of attacks, opportunities to obfuscate payloads, and changes to the code&#8217;s execution environment. As noted, blacklists can be useful for detecting and logging potential attacks, or determining which inputs are so malformed that they should be rejected outright. Validate all data received from the client, including values such as <span class="caps">HTTP</span> headers and cookie values if these are used as input on the server side, X- headers, and other platform specific data objects passed between the client and server. 

 This validation and sanitization must be performed in context, for example, data sent to an <span class="caps">SQL</span> database must be escaped for <span class="caps">SQL</span> special characters whereas data sent as part of a shell command must be escaped for shell special characters.</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading211"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse211" aria-expanded="true" aria-controls="collapse211">Use case: General <span>[GENERAL]</span></button></h5></div><div id="collapse211" class="collapse" aria-labelledby="heading211" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading210"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse210" aria-expanded="true" aria-controls="collapse210">Threat: Attackers gain unauthorised access to data or services by accessing a client side secret <span>[CSD-CLIENT-SECRET]</span></button></h5></div><div id="collapse210" class="collapse" aria-labelledby="heading210" data-parent="#threats"><div class="card-body">	<p>Secrets stored in any client side components, such as a mobile application, thick client application or in JavaScript used by a browser, can be accessed by users/attackers who have access to this client. 
 Attackers could then gain access to the data or services that are protected by this secret, if no other credentials are required.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading209"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse209" aria-expanded="true" aria-controls="collapse209">Weakness: Client side code stores secret keys, sensitive business logic or other proprietary information <span>[CWE-798, CWE-603]</span></button></h5></div><div id="collapse209" class="collapse" aria-labelledby="heading209" data-parent="#weaknesses"><div class="card-body">Client side code is fully controlled by the user, a malicious user could read the code or reverse engineer it if it is compiled on any form. If the client side code includes secret keys, sensitive business logic (like client authentication) or proprietary information, all of this is directly exposed to the user, allowing him to get the sensitive information or study the business logic with the aim of bypassing it.&nbsp; 
<div> 
 <br /> 
</div> 
<div>
  Some examples of this which are Vulnerabilities are:&nbsp; 
 <div> 
  <ul> 
   <li>Perform an authentication on the client side without server side validation.&nbsp;</li> 
   <li>Make privileged calls from the client based solely on client side conditions (i.e. a cash check on client side and then to place a buy on an e-commerce platform).</li> 
   <li>&nbsp;Hard-coding keys and secrets on client side to make client-to-client calls without a proxy.</li> 
  </ul> 
 </div> 
</div><div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading208"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse208" aria-expanded="true" aria-controls="collapse208">Countermeasure: Implement sensitive logic and data validation on the server-side <span>[CS-CLIENT-SECRET]</span></button></h5></div><div id="collapse208" class="collapse" aria-labelledby="heading208" data-parent="#controls"><div class="card-body"><p>All data and functionality at the client-side must be considered tainted and subject to manipulation by a malicious actor, regardless of the controls in place (e.g. encryption or obfuscation of client-side code or content). </p> This includes application logic decisions, such as access controls, and data considered sensitive or secret, such as encryption keys. While controls may be duplicated at the client-side to improve the user experience, it is important these are enforced at the server-side.&nbsp; 
<div> 
 <ul> 
  <li>Business logic, in particular access controls, must be implemented at the server-side.</li> 
  <li>Secret data should be stored at the server-side, and only that which is explicitly required be duplicated at the client-side.&nbsp;</li> 
 </ul>All data provided from the client-side (even from binary clients) should be considered tainted, and security decisions should not be made solely on this data. For example, an insecure implementation could include a compiled application (e.g. Flash!) performing authentication at the client-side against a stored password. Decompilation of the binary (in this case flv file) or interception and modification of controls between the client and server could expose the password or allow unauthorised access to the authenticated application content. 
</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading215"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse215" aria-expanded="true" aria-controls="collapse215">Use case: Mobile user interface <span>[mobile-user-interface]</span></button></h5></div><div id="collapse215" class="collapse" aria-labelledby="heading215" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading214"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse214" aria-expanded="true" aria-controls="collapse214">Threat: Attackers gain access to the system exploiting insufficient or misconfigured security features <span>[IOT-INSUF-SEC]</span></button></h5></div><div id="collapse214" class="collapse" aria-labelledby="heading214" data-parent="#threats"><div class="card-body">	<p>Attackers will often attempt to exploit insufficient tampering protection, unprotected storage or other misconfigured features.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading213"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse213" aria-expanded="true" aria-controls="collapse213">Weakness: The product lacks key security features <span>[CWE-254-PROD]</span></button></h5></div><div id="collapse213" class="collapse" aria-labelledby="heading213" data-parent="#weaknesses"><div class="card-body">The product lack of key security features such as protection against tampering, unprotected storages or it has other misconfigurations and omissions during production.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading212"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse212" aria-expanded="true" aria-controls="collapse212">Countermeasure: Pass phrase is obscured by default where entered on a UI <span>[IOT2.4.11.6]</span></button></h5></div><div id="collapse212" class="collapse" aria-labelledby="heading212" data-parent="#controls"><div class="card-body"><p>Where passwords are entered on a user interface, the actual pass phrase is obscured by default to prevent the capture of passwords.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Password masking is the practice of obscuring the password characters when entered on a user interface, more often behind bullets (•), asterisks (*) or similar camouflaging characters. The idea behind password masking is primarily the protection against "shoulder surfing", in other words to prevent nearby observers reading the password "over the user's shoulder" and thus stolen, which is crucial for mobile devices. A second reason is to obscure the password in cases of shared screens, projectors, etc.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that the actual pass phrase is obscured by default where entered on a user interface.</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading225"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse225" aria-expanded="true" aria-controls="collapse225">Use case: Sensitive Read or Post data <span>[SENSITIVE READ OR POST DATA]</span></button></h5></div><div id="collapse225" class="collapse" aria-labelledby="heading225" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading218"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse218" aria-expanded="true" aria-controls="collapse218">Threat: An attacker monitors information transmitted between logical or physical nodes of a network <span>[CAPEC-157]</span></button></h5></div><div id="collapse218" class="collapse" aria-labelledby="heading218" data-parent="#threats"><div class="card-body"><p>An attacker monitors information transmitted between logical or physical nodes of a network. The attacker need not be able to prevent reception or change content but must simply be able to observe and read the traffic. The attacker might precipitate or indirectly influence the content of the observed transaction, but the attacker is never the intended recipient of the information. Any transmission medium can theoretically be sniffed if the attacker can listen to the contents between the sender and recipient.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading217"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse217" aria-expanded="true" aria-controls="collapse217">Weakness: Cleartext Transmission of Sensitive Information <span>[CWE-319]</span></button></h5></div><div id="collapse217" class="collapse" aria-labelledby="heading217" data-parent="#weaknesses"><div class="card-body">The software transmits sensitive or security-critical data in cleartext in a communication channel that can be sniffed by unauthorized actors.

Many communication channels can be "sniffed" by attackers during data transmission. For example, network traffic can often be sniffed by any attacker who has access to a network interface. This significantly lowers the difficulty of exploitation by attackers.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading216"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse216" aria-expanded="true" aria-controls="collapse216">Countermeasure: Application communicates with product related remote server(s) or device over a secure connection <span>[IOT2.4.11.4]</span></button></h5></div><div id="collapse216" class="collapse" aria-labelledby="heading216" data-parent="#controls"><div class="card-body"><p>Where the application communicates with a product related remote server(s) or device it does so over a secure connection.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Secure connections are a cornerstone for a client/server communication. Cryptographic protocols such as Transport Layer Security (<span class="caps">TLS</span>) are used to prevent eavesdropping and tampering. Therefore the application should always communicate over a secure connection.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that the application communicates with product related remote server(s) or device over a secure connection such as a <span class="caps">TLS</span> connection using certificate pinning.</p></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading221"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse221" aria-expanded="true" aria-controls="collapse221">Threat: Attackers gain access to the system through Server Side Code Injection <span>[CWE-94]</span></button></h5></div><div id="collapse221" class="collapse" aria-labelledby="heading221" data-parent="#threats"><div class="card-body">	<p>Server Side Code Injection happens when an attacker is able to direct input under his control and mix it with executed code on server side by modifying the logic executed on it. Depending on the code isolation, this event could grant the user with access to system resources and data.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading220"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse220" aria-expanded="true" aria-controls="collapse220">Weakness: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') <span>[CWE-78]</span></button></h5></div><div id="collapse220" class="collapse" aria-labelledby="heading220" data-parent="#weaknesses"><div class="card-body">The software constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component. This could allow attackers to execute unexpected, dangerous commands directly on the operating system. This weakness can lead to a vulnerability in environments in which the attacker does not have direct access to the operating system, such as in web applications.&nbsp; 
<div> 
 <br /> 
</div> 
<div>
  Alternately, if the weakness occurs in a privileged program, it could allow the attacker to specify commands that normally would not be accessible, or to call alternate commands with privileges that the attacker does not have. The problem is exacerbated if the compromised process does not follow the principle of least privilege, because the attacker-controlled commands may run with special system privileges that increases the amount of damage. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  There are at least two subtypes of OS command injection:&nbsp; 
</div> 
<div> 
 <ul> 
  <li>The application intends to execute a single, fixed program that is under its own control. It intends to use externally-supplied inputs as arguments to that program. For example, the program might use system(&quot;nslookup [HOSTNAME]&quot;) to run nslookup and allow the user to supply a HOSTNAME, which is used as an argument. Attackers cannot prevent nslookup from executing. However, if the program does not remove command separators from the HOSTNAME argument, attackers could place the separators into the arguments, which allows them to execute their own program after nslookup has finished executing.The application accepts an input that it uses to fully select which program to run, as well as which commands to use.&nbsp;</li> 
  <li>The application simply redirects this entire command to the operating system. For example, the program might use &quot;exec([COMMAND])&quot; to execute the [COMMAND] that was supplied by the user. If the COMMAND is under attacker control, then the attacker can execute arbitrary commands or programs. If the command is being executed using functions like exec() and CreateProcess(), the attacker might not be able to combine multiple commands together in the same line. From a weakness standpoint, these variants represent distinct programmer errors.&nbsp;</li> 
 </ul>In the first variant, the programmer clearly intends input from untrusted parties will be part of the arguments in the command to be executed. In the second variant, the programmer does not intend for the command to be accessible to any untrusted party, but the programmer probably has not accounted for alternate ways in which malicious attackers can provide input. 
</div><div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading219"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse219" aria-expanded="true" aria-controls="collapse219">Countermeasure: Validate all data received <span>[DATA-VAL]</span></button></h5></div><div id="collapse219" class="collapse" aria-labelledby="heading219" data-parent="#controls"><div class="card-body">	<p>All data received should be considered tainted and a potential risk, regardless of the source or transport method. For example, while hidden form fields, cookies, or other headers may be obfuscated from a user, along with parameters passed in ViewStates or other encapsulated forms, these can be modified by the user at the client-side in memory, or in transit on the network. Similarly, data passed from binary or compiled components can be modified in situ or in transit. 
 <i></i> 
 <i>Furthermore, encryption only secures the data in transit between the two ends of the encrypted tunnel (one end of which is typically controlled by the client); data passing through the link may still be malicious.</i> </p>

 As such, all data from the client side must be subjected to strict validation, sanitization, and encoding against expected syntactic and semantic criteria. 
 &#8211; Define a specification of the data that is expected at each input; both the syntax (e.g. alphanumeric only) and semantics (e.g. a word of between 1 and 25 characters, or a specific list). As an example of business rule logic, &quot;boat&quot; may be syntactically valid because it only contains alphanumeric characters, but it is not valid if the input is only expected to contain colors such as &quot;red&quot; or &quot;blue.&quot;
 &#8211; Implement a &#8216;known good&#8217; or white-list approach, where only inputs that meet the strict criteria for each input are accepted, and reject, transform, or encapsulate any non-compliant data.
 &#8211; While useful for identifying malicious content, do not rely on looking for specific malformed or attack payloads (blacklists). It is almost impossible to maintain a comprehensive and accurate blacklist due to the complexity and evolving nature of attacks, opportunities to obfuscate payloads, and changes to the code&#8217;s execution environment. As noted, blacklists can be useful for detecting and logging potential attacks, or determining which inputs are so malformed that they should be rejected outright.
 &#8211; Validate all data received from the client, including values such as <span class="caps">HTTP</span> headers and cookie values if these are used as input on the server side, X- headers, and other platform specific data objects passed between the client and server.</div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading224"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse224" aria-expanded="true" aria-controls="collapse224">Threat: Sensitive Data stored on the mobile device could be accessed by an attacker <span>[CAPEC-167]</span></button></h5></div><div id="collapse224" class="collapse" aria-labelledby="heading224" data-parent="#threats"><div class="card-body"><p>An attacker could retrieve sensitive data stored on a mobile device. This information may be stored in configuration files, embedded within the application itself, or stored in other ways. Sensitive information may include long-term keys, passwords, credit card or financial information, and other private material that the mobile app uses in its interactions with the server.&nbsp;</p> 
<p>In some cases, it may not even be necessary to gain access to another user's installation - if all instances of the client software are embedded with the same sensitive information (for example, long term keys for communication with the server) then the attacker must simply find a way to gain their own copy of the client software in order to perform this attack.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading223"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse223" aria-expanded="true" aria-controls="collapse223">Weakness: Secrets, API keys and or passwords are included in the source code or online repositories <span>[CWE-312]</span></button></h5></div><div id="collapse223" class="collapse" aria-labelledby="heading223" data-parent="#weaknesses"><div class="card-body">API keys, passwords or secrets included in the source code or in the configuration files can be leaked to users with access to the code. This access can be incidentally granted by publishing the source code on a package-form or an online, public repository.

          The unauthorized access to any of those secrets could lead to a compromise of sensitive data or a system.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading222"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse222" aria-expanded="true" aria-controls="collapse222">Countermeasure: Store sensitive data in a cryptographically secure (system provided) store <span>[CWE-312-ENCRYPT]</span></button></h5></div><div id="collapse222" class="collapse" aria-labelledby="heading222" data-parent="#controls"><div class="card-body"><p>Applications storing or caching data locally are at risk of attack and compromise of that data. Most mobile devices and operating systems offer built in <span class="caps">API</span>'s to store data in their encrypted stores, such as the Keychain on iOS. These stores are ultimately encrypted using a key derived from the device passcode and require the user to set a passcode. However, they do not enforce the quality of the passcode, nor is it possible to determine the quality of the passcode (and therefore, ultimately the key) from within the application.&nbsp;</p> 
<p></p> 
<ul> 
 <li>Data should not be stored locally unless there is an explicit requirement to do so. This includes restricting thumbnails or screenshots of pages in the application that contain private data.&nbsp;</li> 
 <li>Data that must be stored on the client side must be held in a cryptographically secure store.&nbsp;</li> 
 <li>Use OS provided stores to protect private data on the client side, acknowledging that the residual risk from users with weak passwords may affect that data.&nbsp;</li> 
 <li>Do not store highly sensitive/financial data on the client-side without implementing a provably strong cryptographic process. For example, it should be encrypted using a key derived from an independent password where the strength of this password can be verified.</li> 
</ul> 
<p></p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading254"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse254" aria-expanded="true" aria-controls="collapse254">Risk pattern: IoT Privacy <span>[iot-privacy]</span></button></h5></div><div id="collapse254" class="collapse" aria-labelledby="heading254" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading233"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse233" aria-expanded="true" aria-controls="collapse233">Use case: General <span>[GENERAL]</span></button></h5></div><div id="collapse233" class="collapse" aria-labelledby="heading233" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading232"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse232" aria-expanded="true" aria-controls="collapse232">Threat: Attackers gain access to personal information exploiting insufficient or misconfigured security features <span>[IOT-INSUF-SEC-PII]</span></button></h5></div><div id="collapse232" class="collapse" aria-labelledby="heading232" data-parent="#threats"><div class="card-body"><p>Attackers will often attempt to exploit insufficient tampering protection, unprotected storage or other misconfigured features.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading228"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse228" aria-expanded="true" aria-controls="collapse228">Weakness: The application has not been securely developed <span>[CWE-398]</span></button></h5></div><div id="collapse228" class="collapse" aria-labelledby="heading228" data-parent="#weaknesses"><div class="card-body"><div>
                        The code has features that do not directly introduce a&nbsp;weakness&nbsp;or&nbsp;vulnerability,
                        but indicate that the product has not been carefully developed or maintained.
                        </div>
                        <div>
                        <p>Programs are more likely to be secure when good development practices are followed. If
                        a program is complex, difficult to maintain, not portable, or shows evidence of neglect, then
                        there is a higher likelihood that&nbsp;weaknesses&nbsp;are buried in the code.</p>
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading227"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse227" aria-expanded="true" aria-controls="collapse227">Countermeasure: Devices and services should be designed with security usability in mind <span>[IOT2.4.12.13]</span></button></h5></div><div id="collapse227" class="collapse" aria-labelledby="heading227" data-parent="#controls"><div class="card-body"><p>Devices and services should be designed with security usability in mind, reducing where possible, security friction and decision points that may have a detrimental impact on security. Best practices on usable security should be followed, particularly for user interaction and user interfaces.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Usability and cybersecurity complement one another. A well-designed system needs to make it easy for the user to do the right thing, hard to do the wrong thing, and easy to recover when the wrong things happen anyway. Usability has only recently become an important concern in the cybersecurity field, due to growing recognition of the fact that users themselves are a key component in organizational security programs. If users find a cybersecurity measure too difficult, they will try to circumvent it - which harms organizational security.&nbsp;</p> 
<p>Therefore, it is in every organization's interest to design cybersecurity measures in such a way that they take into account the perceptions, characteristics, needs, abilities, and behaviors of users themselves.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that devices and services are designed with security usability in mind.</p></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading231"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse231" aria-expanded="true" aria-controls="collapse231">Weakness: The product lacks key security features <span>[CWE-254-PROD]</span></button></h5></div><div id="collapse231" class="collapse" aria-labelledby="heading231" data-parent="#weaknesses"><div class="card-body">The product lack of key security features such as protection against tampering, unprotected storages or it has other misconfigurations and omissions during production.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading229"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse229" aria-expanded="true" aria-controls="collapse229">Countermeasure: The product/service stores the minimum amount of user personal information <span>[IOT2.4.12.1]</span></button></h5></div><div id="collapse229" class="collapse" aria-labelledby="heading229" data-parent="#controls"><div class="card-body"><p>The product/service stores the minimum amount of user personal information.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Data can present unintended privacy concerns when aggregated. Therefore the product/service should collect and store the minimal amount of data possible.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Ensure that the product/service stores the minimum amount of personal information from users. Consult with data scientists, legal and compliance teams to determine risk of data collection and storage.&nbsp;</p> 
<p>Consider implications of consent and the fact that IoT devices may not present an interface for collecting consent and may passively collect data about people other than owners and operators. IoT may collect information about individuals who cannot provide consent (such as minors) and data collection should be modified accordingly.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading230"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse230" aria-expanded="true" aria-controls="collapse230">Countermeasure: The product/service can be made compliant with the local and/or regional Personal Information protection legislation where the product is to be sold <span>[IOT2.4.12.8]</span></button></h5></div><div id="collapse230" class="collapse" aria-labelledby="heading230" data-parent="#controls"><div class="card-body"><p>The product/service can be made compliant with the local and/or regional Personal Information protection legislation where the product is to be sold. Rationale: All data protection laws set out to protect personal data, however there is a fine line between what is and isn't personal data among local data regulations. Therefore in case a product or a service is about to be sold e.g. in the European Union, it has to be compliant with the General Data Protection Regulation (<span class="caps">GDPR</span>).&nbsp;</p> 
<p><b><font size="4">Remediation:</font></b></p> 
<p>Ensure that the product/service is compliant with the local and/or regional Personal Information protection legislation where the product is to be sold.&nbsp;</p> 
<p><b>Impact:</b> None&nbsp;</p> 
<p><b>Compliance Class:</b> 1 and above&nbsp;</p> 
<p><b>Applicability:</b> M</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading249"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse249" aria-expanded="true" aria-controls="collapse249">Use case: Personal data <span>[PERSONAL DATA]</span></button></h5></div><div id="collapse249" class="collapse" aria-labelledby="heading249" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading242"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse242" aria-expanded="true" aria-controls="collapse242">Threat: Data leakage or disclosure from IoT systems to unauthorized parties <span>[IOT-DATA_LEAKAGE-UNAUTHZ-PARTIES]</span></button></h5></div><div id="collapse242" class="collapse" aria-labelledby="heading242" data-parent="#threats"><div class="card-body">	<p>Unauthorized party might access/breach the personal data of the data subject from IoT systems.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading235"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse235" aria-expanded="true" aria-controls="collapse235">Weakness: Insufficient anonymisation or pseudonymisation <span>[EU-GDPR-NO-ANONYMISATION]</span></button></h5></div><div id="collapse235" class="collapse" aria-labelledby="heading235" data-parent="#weaknesses"><div class="card-body">Personal data which is not - or incorrectly - anonymized or pseudonymized is more vulnerable to malicious personal data processing because the data subjects are more easily identifiable. 
<div> 
 <br /> 
</div> 
<div>
  Data subject = person of whom data is processed. 
</div><div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading234"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse234" aria-expanded="true" aria-controls="collapse234">Countermeasure: Anonymisation/pseudonimisation the data <span>[EU-GDPR-ANONYMISATION]</span></button></h5></div><div id="collapse234" class="collapse" aria-labelledby="heading234" data-parent="#controls"><div class="card-body"><p>Implement anonymization/pseudonymization or give a risk based explanation (from the standpoint of the data subject) why anonymization and pseudonymization are not used. Anonymization makes it impossible to reidentify the data subject while pseudonymization uses randomization techniques to make personal data less identifiable.The following techniques provide a degree of anonymization and pseudonymization and might be used:&nbsp;</p> 
<p></p> 
<ul> 
 <li>noise addition&nbsp;</li> 
 <li>substitution&nbsp;</li> 
 <li>aggregation or K-anonymity</li> 
 <li>L-diversity</li> 
 <li>differential privacy</li> 
 <li>hashing or tokenization</li> 
 <li>dummy data</li> 
</ul> 
<p></p></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading237"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse237" aria-expanded="true" aria-controls="collapse237">Weakness: Missing Encryption of Sensitive Data <span>[EU-GDPR-MISSING-ENCRYPTION-SENSITIVE-DATA]</span></button></h5></div><div id="collapse237" class="collapse" aria-labelledby="heading237" data-parent="#weaknesses"><div class="card-body"><ul> 
 <li>Weak encryption algorithms&nbsp;</li> 
 <li>Loss of encryption keys&nbsp;</li> 
 <li>Compromised encryption keys&nbsp;</li> 
 <li>Revoked keys are still active (bad key lifecycle management)</li> 
</ul><div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading236"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse236" aria-expanded="true" aria-controls="collapse236">Countermeasure: Encrypt personal data <span>[EU-GDPR-ENCRYPT-PERSONAL-DATA]</span></button></h5></div><div id="collapse236" class="collapse" aria-labelledby="heading236" data-parent="#controls"><div class="card-body"><p>Implement encryption at rest (see guidance below) or give risk-based explanation why encryption was not implemented. Use well known encryption libraries, taking into account the data use, and do not invent your own.&nbsp;</p> 
<p></p> 
<ul> 
 <li>personal data must be encrypted&nbsp;</li> 
 <li>data that is not used by the application (e.g. passwords, …) should be hashed so they cannot be recovered easily</li> 
</ul> 
<p></p></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading239"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse239" aria-expanded="true" aria-controls="collapse239">Weakness: Production data used in a test environment <span>[EU-GDPR-PRODUCTION-DATA-TEST-DATA]</span></button></h5></div><div id="collapse239" class="collapse" aria-labelledby="heading239" data-parent="#weaknesses"><div class="card-body">Production data is stored in a less protected test environment where personal data is easier breached and other security controls are in place.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading238"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse238" aria-expanded="true" aria-controls="collapse238">Countermeasure: Use anonymised data in test environment <span>[EU-GDPR-ANONYMISED-DATA-TEST]</span></button></h5></div><div id="collapse238" class="collapse" aria-labelledby="heading238" data-parent="#controls"><div class="card-body">	<p>Implement anonymization/pseudonymization or give a risk based explanation (from the standpoint of the data subject) why anonymization and pseudonymization are not used. Anonymization makes it impossible to reidentify the data subject while pseudonymization uses randomization techniques to make personal data less identifiable.The following techniques provide a degree of anonymization and pseudonymization and might be used: &#8211; noise addition
 &#8211; substitution
 &#8211; aggregation or K-anonymity
 &#8211; L-diversity
 &#8211; differential privacy
 &#8211; hashing or tokenization
 &#8211; dummy data
 If anonymization/pseudonymization is not possible, other security controls should be implemented, such as: &#8211; strong logical access control to test environment
 &#8211; deletion of test environment data after tests have been conducted</p></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading241"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse241" aria-expanded="true" aria-controls="collapse241">Weakness: Unnecessary privileges to process the data <span>[EU-GDPR-UNNECESSARY-PRIVILEGES]</span></button></h5></div><div id="collapse241" class="collapse" aria-labelledby="heading241" data-parent="#weaknesses"><div class="card-body">Authorization can be bypassed<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading240"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse240" aria-expanded="true" aria-controls="collapse240">Countermeasure: Apply authorization checks to segregate and control access to user data <span>[CWE-285]</span></button></h5></div><div id="collapse240" class="collapse" aria-labelledby="heading240" data-parent="#controls"><div class="card-body"><div>
                        <div>
                        Applications protecting sensitive or otherwise restricted resources must ensure only appropriate
                        and authorized users may access the application data. It is important that an application
                        prevents unauthorized users gaining inappropriate access to each other's data; although user A
                        and user B may both be trusted to access data within the application, they may be authorized to
                        only access different subsets of the protected resources.&nbsp; E.g. user A should not be
                        able to access user B's personal data by manipulating a request (typical examples are
                        manipulation of an ID value or other object reference sent in the URL or body of an HTTP
                        request).
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        It is not sufficient to rely on obscurity, for example obfuscated or secret URLs or filenames.
                        The application must validate each request for protected data against the proven identity of the
                        user. Before providing access to restricted resources the application must:
                        </div>
                        <div>
                        <ul>
                        <li>Ensure the user has undergone appropriate authentication (identification and
                        verification, or ID&amp;V). E.g. they must have provided their identity and confirmed this
                        with a password, token, or other verification. Typically this will be through checking the
                        validity of the session token issued after login.</li>
                        <li>Confirm the user is entitled to access the data or resource they are requesting. E.g.
                        their confirmed identify checked against a server-side access control matrix to determine
                        whether they may access the requested resource.</li>
                        <li>Access controls should be granular, and allow for access to individual resources to be
                        issued to individual users or roles.</li>
                        </ul>
                        <div>
                        URL and asset based access control is provided by most web-frameworks, and it is preferable to
                        use an established and proven framework.
                        </div>
                        </div>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading245"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse245" aria-expanded="true" aria-controls="collapse245">Threat: Illegal processing of personal data <span>[EU-GDPR-ILLEGAL-PROCESSING-PERSONAL-DATA]</span></button></h5></div><div id="collapse245" class="collapse" aria-labelledby="heading245" data-parent="#threats"><div class="card-body">	<p>Processing personal data without legal grounds which makes it possible for data subjects to file a complaint at local Data Protection Authority which might lead to administrative fines.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading244"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse244" aria-expanded="true" aria-controls="collapse244">Weakness: No legal ground used for international data transfer to third countries <span>[EU-GDPR-NO-LEGAL-GROUND-INTERNATIONAL-TRANSFER]</span></button></h5></div><div id="collapse244" class="collapse" aria-labelledby="heading244" data-parent="#weaknesses"><div class="card-body"><ul> 
 <li>No binding corporate rules or standard model clauses with non-EU third party</li> 
 <li>Inadequate due diligence of third parties</li> 
</ul><div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading243"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse243" aria-expanded="true" aria-controls="collapse243">Countermeasure: Manage international data transfers <span>[EU-GDPR-MANAGE-INTERNATIONAL-DATA-TRANSFERS]</span></button></h5></div><div id="collapse243" class="collapse" aria-labelledby="heading243" data-parent="#controls"><div class="card-body">	<p>You must involve the <span class="caps">DPO</span>/Legal in order to ensure that the international transfer of data is legal. The <span class="caps">DPO</span> can make use of adequacy decisions, Binding Corporate Rules (<span class="caps">BCR</span>s), standard EU model clauses or derivatives (Privacy shield) whenever they apply.</p></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading248"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse248" aria-expanded="true" aria-controls="collapse248">Threat: Subjects cannot exercise their rights over their personal data <span>[EU-GDPR-SUBJECT-RIGTHS]</span></button></h5></div><div id="collapse248" class="collapse" aria-labelledby="heading248" data-parent="#threats"><div class="card-body"><p>Data subject cannot exercise their rights which makes it possible for data subjects to file a complaint at local Data Protection Authority which might lead to administrative fines.</p> 
<p>Data subject = person of whom personal data is processed</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading247"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse247" aria-expanded="true" aria-controls="collapse247">Weakness: Not data deletion functionality <span>[EU-GDPR-NO-DELETION-FUNCTIONALITY]</span></button></h5></div><div id="collapse247" class="collapse" aria-labelledby="heading247" data-parent="#weaknesses"><div class="card-body">Personal data is not automatically deleted when retention periods have expired, which means data must be manually deleted by an administrator who can easily forget this task.Personal data that was deleted becomes operational again after a restore because the data was not deleted from the back-ups nor was there a process in place to reidentify and delete personal data that was previously deleted.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading246"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse246" aria-expanded="true" aria-controls="collapse246">Countermeasure: Implement forget user functionality <span>[EU-GDPR-IMPLEMENT-FORGET]</span></button></h5></div><div id="collapse246" class="collapse" aria-labelledby="heading246" data-parent="#controls"><div class="card-body"><p>Make sure that your deletion functionality also facilitates the manual deletion of one data subject (person of whom personal data is processed) at any given point in time. All data of the data subject should be deleted from the operational databases as well as back-ups.</p> 
<p><font size="4"><b>Remediation:</b></font></p> 
<p>You should develop a script to ensure the re-deletion of data subjects (persons of whom personal data is processed) who exercised their right to be forgotten and run it after each database restore. The data subjects should be deleted from the script whenever the retention period of the data has expired.</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading253"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse253" aria-expanded="true" aria-controls="collapse253">Use case: User Authorization <span>[user-authorization]</span></button></h5></div><div id="collapse253" class="collapse" aria-labelledby="heading253" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading252"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse252" aria-expanded="true" aria-controls="collapse252">Threat: An attacker examines a target system to find sensitive data that has been embedded within it <span>[CAPEC-37]</span></button></h5></div><div id="collapse252" class="collapse" aria-labelledby="heading252" data-parent="#threats"><div class="card-body"><p>An attacker examines a target system to find sensitive data that has been embedded within it. This information can reveal confidential contents, such as account numbers or individual keys/credentials that can be used as an intermediate step in a larger attack.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading251"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse251" aria-expanded="true" aria-controls="collapse251">Weakness: Storage of Sensitive Data in a Mechanism without Access Control <span>[CWE-921]</span></button></h5></div><div id="collapse251" class="collapse" aria-labelledby="heading251" data-parent="#weaknesses"><div class="card-body">The software stores sensitive information in a file system or device that does not have built-in access control. While many modern file systems or devices utilize some form of access control in order to restrict access to data, not all storage mechanisms have this capability. For example, memory cards, floppy disks, CDs, and USB devices are typically made accessible to any user within the system. This can become a problem when sensitive data is stored in these mechanisms in a multi-user environment, because anybody on the system can read or write this data.&nbsp; 
<div> 
 <br /> 
</div> 
<div>
  On Android devices, external storage is typically globally readable and writable by other applications on the device. External storage may also be easily accessible through the mobile device's USB connection or physically accessible through the device's memory card port. 
</div><div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading250"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse250" aria-expanded="true" aria-controls="collapse250">Countermeasure: The product or service only records audio/visual data in accordance with the authorization of the user (e.g., no passive recording without explicit authorization) <span>[IOT2.4.12.14]</span></button></h5></div><div id="collapse250" class="collapse" aria-labelledby="heading250" data-parent="#controls"><div class="card-body">	<p>IoT provider should ensure the appropriate level of users' privacy. This includes the obligation to inform users about the collection of their personal information, receive consent to do so in certain cases, follow data minimization obligations, and much more.  Users' privacy must be implemented by design, considering data protection at the very early stages of development.</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading259"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse259" aria-expanded="true" aria-controls="collapse259">Risk pattern: IoT Secure Supply Chain and Production <span>[iot-secure-supply-chain-and-production]</span></button></h5></div><div id="collapse259" class="collapse" aria-labelledby="heading259" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading258"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse258" aria-expanded="true" aria-controls="collapse258">Use case: General <span>[GENERAL]</span></button></h5></div><div id="collapse258" class="collapse" aria-labelledby="heading258" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading257"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse257" aria-expanded="true" aria-controls="collapse257">Threat: Attackers try to take advantage of a wide attack surface <span>[IOT-WIDE-ATTACK-SURFACE]</span></button></h5></div><div id="collapse257" class="collapse" aria-labelledby="heading257" data-parent="#threats"><div class="card-body"><p>Every point of network interaction or other service is a potential part of the attack surface having exploitable vulnerabilities.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading256"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse256" aria-expanded="true" aria-controls="collapse256">Weakness: Information Exposure Through Debug Information <span>[CWE-215]</span></button></h5></div><div id="collapse256" class="collapse" aria-labelledby="heading256" data-parent="#weaknesses"><div class="card-body">The application contains debugging code that can expose sensitive information to untrusted parties.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading255"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse255" aria-expanded="true" aria-controls="collapse255">Countermeasure: All the production test and calibration software is erased, removed or secured before the product is dispatched from the factory <span>[IOT2.4.14.1]</span></button></h5></div><div id="collapse255" class="collapse" aria-labelledby="heading255" data-parent="#controls"><div class="card-body"><p>All the production test and calibration software used during manufacture is erased, removed or secured before the product is dispatched from the factory.</p> 
<p><b><font size="4">Rationale:<br /></font></b> The product should have all of the production test and calibration software used during manufacture erased, removed or secured before the product is dispatched from the factory. This is to prevent alteration of the product post manufacture when using authorized production software, for example, hacking of the RF characteristics for greater RF <span class="caps">ERP</span>. Where such functionality is required in a service center, it should be erased or removed upon completion of any servicing activities.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Erase, remove or secure all the production test and calibration software used during manufacture, before the product is dispatched from the factory.</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading290"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse290" aria-expanded="true" aria-controls="collapse290">Risk pattern: IoT Web User Interface <span>[iot-web-user-interface]</span></button></h5></div><div id="collapse290" class="collapse" aria-labelledby="heading290" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading263"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse263" aria-expanded="true" aria-controls="collapse263">Use case: Administration service <span>[ADMINISTRATION SERVICE]</span></button></h5></div><div id="collapse263" class="collapse" aria-labelledby="heading263" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading262"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse262" aria-expanded="true" aria-controls="collapse262">Threat: Attackers gain access to the system through an unprotected administration interface <span>[CSD-ADM-IFACE]</span></button></h5></div><div id="collapse262" class="collapse" aria-labelledby="heading262" data-parent="#threats"><div class="card-body">	<p>Administrative interfaces grant access to sensitive operations that can typically affect key security mechanisms, like modifying credentials and adding/removing user accounts.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading261"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse261" aria-expanded="true" aria-controls="collapse261">Weakness: Access to the administration interfaces is open to untrusted parties <span>[CSD-ADM-OPEN]</span></button></h5></div><div id="collapse261" class="collapse" aria-labelledby="heading261" data-parent="#weaknesses"><div class="card-body">The application does not restrict access to administration interfaces to untrusted parties. 
This fact could allow an attacker to chain vulnerabilities in order to gain unauthorized access to the system. <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading260"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse260" aria-expanded="true" aria-controls="collapse260">Countermeasure: Restrict access to administrative interfaces <span>[CSD-ADM-TRUST]</span></button></h5></div><div id="collapse260" class="collapse" aria-labelledby="heading260" data-parent="#controls"><div class="card-body"><p>Restrict access to administrative interfaces to trusted actors from trusted locations to reduce the application attack surface and likelihood of compromise.</p> 
<p>Restrict administrative access to specific networks or hosts.</p> 
<div>
  Use strong authentication for privileged access, for example a 2FA. 
</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading274"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse274" aria-expanded="true" aria-controls="collapse274">Use case: Authentication and Authorization <span>[AUTHENTICATION AND AUTHORIZATION]</span></button></h5></div><div id="collapse274" class="collapse" aria-labelledby="heading274" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading266"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse266" aria-expanded="true" aria-controls="collapse266">Threat: Anonymous users could gain access to sensitive data <span>[CAPEC-232]</span></button></h5></div><div id="collapse266" class="collapse" aria-labelledby="heading266" data-parent="#threats"><div class="card-body">	<p>Attackers could access data for which they are not authorized by connecting directly to the resource, without authenticating. E.g.: <span class="caps">GET</span> /userdetails?ID=145 to gain direct access to that user&#8217;s personal information.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading265"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse265" aria-expanded="true" aria-controls="collapse265">Weakness: Missing Authentication for Critical Function <span>[CWE-306]</span></button></h5></div><div id="collapse265" class="collapse" aria-labelledby="heading265" data-parent="#weaknesses"><div class="card-body">The software does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading264"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse264" aria-expanded="true" aria-controls="collapse264">Countermeasure: Apply authorization checks to segregate and control access to user data <span>[CWE-285]</span></button></h5></div><div id="collapse264" class="collapse" aria-labelledby="heading264" data-parent="#controls"><div class="card-body"><div>
                        <div>
                        Applications protecting sensitive or otherwise restricted resources must ensure only appropriate
                        and authorized users may access the application data. It is important that an application
                        prevents unauthorized users gaining inappropriate access to each other's data; although user A
                        and user B may both be trusted to access data within the application, they may be authorized to
                        only access different subsets of the protected resources.&nbsp; E.g. user A should not be
                        able to access user B's personal data by manipulating a request (typical examples are
                        manipulation of an ID value or other object reference sent in the URL or body of an HTTP
                        request).
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        It is not sufficient to rely on obscurity, for example obfuscated or secret URLs or filenames.
                        The application must validate each request for protected data against the proven identity of the
                        user. Before providing access to restricted resources the application must:
                        </div>
                        <div>
                        <ul>
                        <li>Ensure the user has undergone appropriate authentication (identification and
                        verification, or ID&amp;V). E.g. they must have provided their identity and confirmed this
                        with a password, token, or other verification. Typically this will be through checking the
                        validity of the session token issued after login.</li>
                        <li>Confirm the user is entitled to access the data or resource they are requesting. E.g.
                        their confirmed identify checked against a server-side access control matrix to determine
                        whether they may access the requested resource.</li>
                        <li>Access controls should be granular, and allow for access to individual resources to be
                        issued to individual users or roles.</li>
                        </ul>
                        <div>
                        URL and asset based access control is provided by most web-frameworks, and it is preferable to
                        use an established and proven framework.
                        </div>
                        </div>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading270"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse270" aria-expanded="true" aria-controls="collapse270">Threat: Attackers gain unauthorized access through Brute Force attacks against the Web User Interface <span>[CAPEC-112-WEB-UI]</span></button></h5></div><div id="collapse270" class="collapse" aria-labelledby="heading270" data-parent="#threats"><div class="card-body"><p>In this attack, some asset (information, functionality, identity, etc.) is protected by a finite secret value. The attacker attempts to gain access to this asset by using trial-and-error to exhaustively explore all the possible secret values in the hope of finding the secret (or a value that is functionally equivalent) that will unlock the asset.&nbsp;</p> 
<p>Examples of secrets can include, but are not limited to, passwords, encryption keys, database lookup keys, and initial values to one-way functions. The key factor in this attack is the attackers' ability to explore the possible secret space rapidly. This, in turn, is a function of the size of the secret space and the computational power the attacker is able to bring to bear on the problem. If the attacker has modest resources and the secret space is large, the challenge facing the attacker is intractable. While the defender cannot control the resources available to an attacker, they can control the size of the secret space.&nbsp;</p> 
<p>Creating a large secret space involves selecting one's secret from as large a field of equally likely alternative secrets as possible and ensuring that an attacker is unable to reduce the size of this field using available clues or cryptanalysis. Doing this is more difficult than it sounds since elimination of patterns (which, in turn, would provide an attacker clues that would help them reduce the space of potential secrets) is difficult to do using deterministic machines, such as computers. Assuming a finite secret space, a brute force attack will eventually succeed.&nbsp;</p> 
<p>The defender must rely on making sure that the time and resources necessary to do so will exceed the value of the information. For example, a secret space that will likely take hundreds of years to explore is likely safe from raw-brute force attacks.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading269"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse269" aria-expanded="true" aria-controls="collapse269">Weakness: Poor quality passwords in use <span>[CWE-521]</span></button></h5></div><div id="collapse269" class="collapse" aria-labelledby="heading269" data-parent="#weaknesses"><div class="card-body">The product does not enforce a strong password policy, which makes it easier for attackers to compromise user accounts through brute force or dictionary based attacks.

An authentication mechanism is only as strong as its credentials. For this reason, it is important to require users to have strong passwords. Lack of password complexity significantly reduces the search space when trying to guess user's passwords, making brute-force attacks easier.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading267"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse267" aria-expanded="true" aria-controls="collapse267">Countermeasure: Require the use of strong passwords <span>[CWE-521]</span></button></h5></div><div id="collapse267" class="collapse" aria-labelledby="heading267" data-parent="#controls"><div class="card-body"><div>
                        Passwords used either as a sole verification credentials, or as part of a multi-factor
                        authentication, are a key aspect of application security, and strong password selection should
                        be encouraged and enforced. The application should allow flexibility in user password selection,
                        and enforce minimum criteria for password quality. This should include:
                        </div>
                        <div>
                        <ul>
                        <li>Minimum password length requirements, to mitigate brute-force and dictionary attacks.</li>
                        <li>Encourage use of pass-phrases using multiple words, achieving longer passwords more
                        resistant to attack.</li>
                        <li>Enforce use of mixed case, numeric and/or special characters to increase complexity.</li>
                        <li>Prevent or discourage use of dictionary words and common passwords through
                        black-lists. For example, a set of commonly used passwords can be found on SecLists at&nbsp;<a
                        href="https://github.com/danielmiessler/SecLists/tree/master/Passwords">https://github.com/danielmiessler/SecLists/tree/master/Passwords</a>&nbsp;</li>
                        </ul>
                        </div>
                        <div>
                        <p><b>Password length</b></p>
                        <p>Password length considers the minimum and maximum length of characters comprising the
                        password of your users. For ease of changing this length, its implementation can be configurable
                        possibly using a properties file or xml configuration file.</p>
                        <ul>
                        <li>Minimum length. Passwords should be at least ten (10) characters long. Combining this
                        length with complexity makes a password difficult to guess and/or brute force.</li>
                        <li>Maximum length. People tend to forget their passwords easily. The longer the password,
                        the more likely people are to enter them incorrectly for the system. However, long pass-phrases
                        can be easily remembered, and should not be prevented through unnecessarily strict upper
                        restrictions on length.</li>
                        </ul>
                        <p><b>Password Complexity</b></p>
                        <ul>
                        <li>Password characters should be a combination of alphanumeric characters. Alphanumeric
                        characters consist of letters, numbers, punctuation marks, mathematical and other conventional
                        symbols.</li>
                        <li>For change and reset password functionality it is recommended a history of old
                        password (salted) hashes used. This can be used to prevent password reuse, or an attacker
                        alternating between a selection of passwords (Monday1, Tuesday2 etc.)</li>
                        <li>Actual passwords must not be stored, to protect them against brute forcing if the
                        database is compromised.</li>
                        </ul>
                        </div>
                        <div>
                        <ul>
                        </ul>
                        <ul>
                        </ul>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading268"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse268" aria-expanded="true" aria-controls="collapse268">Countermeasure: The initial password or factory reset password for web UIs is unique to each device in the product family <span>[IOT2.4.10.4]</span></button></h5></div><div id="collapse268" class="collapse" aria-labelledby="heading268" data-parent="#controls"><div class="card-body"><p>Where a web user interface password is used for login authentication, the initial password or factory reset password is unique to each device in the product family.</p> 
<p><b><font size="4">Rationale:<br /></font></b> Where a web user interface needs a password to log in, a default password is usually provided that allows the device to be accessed during its initial setup, and then the user will be prompted to change it after he/she first logs on. An attacker with knowledge of the default password can log in, usually with root or administrative privileges and perform malicious actions. Therefore, all initial passwords and factory reset passwords issued for web user interfaces should be unique to each user.</p> 
<p><b><font size="4">Remediation:<br /></font></b> Apply a process which ensures that the initial password or factory reset password for web user interfaces is unique to each device in the product family.</p></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading273"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse273" aria-expanded="true" aria-controls="collapse273">Threat: Users' passwords are compromised if the storage medium is compromised <span>[CWE-256]</span></button></h5></div><div id="collapse273" class="collapse" aria-labelledby="heading273" data-parent="#threats"><div class="card-body">	<p>A compromise of the storage system medium itself (device, server or database) could allow attackers full access to the data stored, including authentication credentials such as passwords.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading272"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse272" aria-expanded="true" aria-controls="collapse272">Weakness: Plaintext Storage of a Password <span>[CWE-257]</span></button></h5></div><div id="collapse272" class="collapse" aria-labelledby="heading272" data-parent="#weaknesses"><div class="card-body">The storage of passwords in a recoverable format makes them subject to password reuse attacks by malicious users. In fact, it should be noted that recoverable encrypted passwords provide no significant benefit over plaintext passwords since they are subject not only to reuse by malicious attackers but also by malicious insiders. If a system administrator can recover a password directly, or use a brute force search on the available information, the administrator can use the password on other accounts.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading271"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse271" aria-expanded="true" aria-controls="collapse271">Countermeasure: Store passwords in unrecoverable form to prevent disclosure <span>[CWE-256]</span></button></h5></div><div id="collapse271" class="collapse" aria-labelledby="heading271" data-parent="#controls"><div class="card-body"><p>To protect users passwords from accidental or deliberate exposure, the application should store cryptographic hashes of passwords instead of the passwords themselves.&nbsp;</p> 
<p></p> 
<ul> 
 <li>Do not store passwords themselves in the data store for verification at login.&nbsp;</li> 
 <li>Instead, create a cryptographic hash of the password using a strong hash function that includes a work factor and a built in ‘salt’ value, like bcrypt or scrypt. This reduces the risk of brute-force attacks and rainbow tables, and allows flexibility to adapt the hashing function to balance security and performance.&nbsp;</li> 
 <li>Alternatively, use a strong hash function like <span class="caps">SHA</span>-384 together with a unique ‘salt’ value for every account. Apply multiple iterations of the hash to create the additional computational work required to mitigate brute-force attacks.</li> 
</ul> 
<p></p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading278"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse278" aria-expanded="true" aria-controls="collapse278">Use case: General <span>[GENERAL]</span></button></h5></div><div id="collapse278" class="collapse" aria-labelledby="heading278" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading277"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse277" aria-expanded="true" aria-controls="collapse277">Threat: Attackers gain access to the system using Social Engineering attacks <span>[IOT-INSUF-SEC-SOC-ENG]</span></button></h5></div><div id="collapse277" class="collapse" aria-labelledby="heading277" data-parent="#threats"><div class="card-body"><p>Attackers will often attempt to exploit insufficient tampering protection, unprotected storage or other misconfigured features.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading276"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse276" aria-expanded="true" aria-controls="collapse276">Weakness: The product lacks key security features <span>[CWE-254-PROD]</span></button></h5></div><div id="collapse276" class="collapse" aria-labelledby="heading276" data-parent="#weaknesses"><div class="card-body">The product lack of key security features such as protection against tampering, unprotected storages or it has other misconfigurations and omissions during production.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading275"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse275" aria-expanded="true" aria-controls="collapse275">Countermeasure: Pass phrase is obscured by default where entered on a web UI <span>[IOT2.4.10.7]</span></button></h5></div><div id="collapse275" class="collapse" aria-labelledby="heading275" data-parent="#controls"><div class="card-body">	<p>Where passwords are entered on a web user interface, the actual pass phrase is obscured by default to prevent the capture of passwords.</p>

	<p>Rationale:<br />
Password masking is the practice of obscuring the password characters when entered on a user interface, more often behind bullets (•), asterisks (*) or similar camouflaging characters. The idea behind password masking is primarily the protection against &#8220;shoulder surfing&#8221;, in other words to prevent nearby observers reading the password &#8220;over the user&#8217;s shoulder&#8221; and thus stolen, which is crucial for mobile devices. A second reason is to obscure the password in cases of shared screens, projectors, etc.</p>

	<p>Remediation:<br />
Ensure that the actual pass phrase is obscured by default where entered on a web user interface.</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading289"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse289" aria-expanded="true" aria-controls="collapse289">Use case: Read or Post data <span>[READ OR POST DATA]</span></button></h5></div><div id="collapse289" class="collapse" aria-labelledby="heading289" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading281"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse281" aria-expanded="true" aria-controls="collapse281">Threat: Attackers could gain access to a users' browser through Cross Site Scripting attacks <span>[CAPEC-341]</span></button></h5></div><div id="collapse281" class="collapse" aria-labelledby="heading281" data-parent="#threats"><div class="card-body"><p>Cross Site Scripting vulnerabilities could allow attackers to gain control of users' browsers, which in turn would allow them to:</p> 
<p></p> 
<ul> 
 <li>Re-write browser content</li> 
 <li>Read the users' session cookie and thereby hijack their session</li> 
 <li>Read form data from the users' browser</li> 
 <li>Trick users into installing malware.</li> 
</ul> 
<p></p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading280"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse280" aria-expanded="true" aria-controls="collapse280">Weakness: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') <span>[CWE-79]</span></button></h5></div><div id="collapse280" class="collapse" aria-labelledby="heading280" data-parent="#weaknesses"><div class="card-body">The software does not neutralize or incorrectly neutralizes user-controllable input before it
                        is placed in output that is used as a web page that is served to other users. Cross-site
                        scripting (XSS) vulnerabilities occur when:
                        <ol>
                        <li>Untrusted data enters a web application, typically from a web request.</li>
                        <li>The web application dynamically generates a web page that contains this untrusted
                        data.</li>
                        <li>During page generation, the application does not prevent the data from containing
                        content that is executable by a web browser, such as JavaScript, HTML tags, HTML attributes,
                        mouse events, Flash, ActiveX, etc.</li>
                        <li>A victim visits the generated web page through a web browser, which contains malicious
                        script that was injected using the untrusted data.</li>
                        <li>Since the script comes from a web page that was sent by the web server, the victim's
                        web browser executes the malicious script in the context of the web server's domain.</li>
                        <li>This effectively violates the intention of the web browser's same-origin policy, which
                        states that scripts in one domain should not be able to access resources or run code in a
                        different domain.</li>
                        </ol>There are three main kinds of XSS:
                        <ul>
                        <li><b>Type 1: Reflected XSS (or Non-Persistent)</b></li>
                        </ul>
                        <blockquote>
                        The server reads data directly from the HTTP request and reflects it back in the HTTP response.
                        Reflected XSS exploits occur when an attacker causes a victim to supply dangerous content to a
                        vulnerable web application, which is then reflected back to the victim and executed by the web
                        browser. The most common mechanism for delivering malicious content is to include it as a
                        parameter in a URL that is posted publicly or e-mailed directly to the victim. URLs constructed
                        in this manner constitute the core of many phishing schemes, whereby an attacker convinces a
                        victim to visit a URL that refers to a vulnerable site. After the site reflects the attacker's
                        content back to the victim, the content is executed by the victim's browser.
                        </blockquote>
                        <ul>
                        <li><b>Type 2: Stored XSS (or Persistent)</b></li>
                        </ul>
                        <blockquote>
                        The application stores dangerous data in a database, message forum, visitor log, or other
                        trusted data store. At a later time, the dangerous data is subsequently read back into the
                        application and included in dynamic content. From an attacker's perspective, the optimal place
                        to inject malicious content is in an area that is displayed to either many users or particularly
                        interesting users. Interesting users typically have elevated privileges in the application or
                        interact with sensitive data that is valuable to the attacker. If one of these users executes
                        malicious content, the attacker may be able to perform privileged operations on behalf of the
                        user or gain access to sensitive data belonging to the user. For example, the attacker might
                        inject XSS into a log message, which might not be handled properly when an administrator views
                        the logs.
                        </blockquote>
                        <ul>
                        <li><b>Type 0: DOM-Based XSS</b></li>
                        </ul>
                        <blockquote>
                        In DOM-based XSS, the client performs the injection of XSS into the page; in the other types,
                        the server performs the injection. DOM-based XSS generally involves server-controlled, trusted
                        script that is sent to the client, such as Javascript that performs sanity checks on a form
                        before the user submits it. If the server-supplied script processes user-supplied data and then
                        injects it back into the web page (such as with dynamic HTML), then DOM-based XSS is
                        possible.Once the malicious script is injected, the attacker can perform a variety of malicious
                        activities. The attacker could transfer private information, such as cookies that may include
                        session information, from the victim's machine to the attacker. The attacker could send
                        malicious requests to a web site on behalf of the victim, which could be especially dangerous to
                        the site if the victim has administrator privileges to manage that site. Phishing attacks could
                        be used to emulate trusted web sites and trick the victim into entering a password, allowing the
                        attacker to compromise the victim's account on that web site. Finally, the script could exploit
                        a vulnerability in the web browser itself possibly taking over the victim's machine, sometimes
                        referred to as &quot;drive-by hacking&quot;.
                        </blockquote>
                        <blockquote>
                        <br />
                        </blockquote>In many cases, the attack can be launched without the victim even being aware
                        of it. Even with careful users, attackers frequently use a variety of methods to encode the
                        malicious portion of the attack, such as URL encoding or Unicode, so the request looks less
                        suspicious.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading279"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse279" aria-expanded="true" aria-controls="collapse279">Countermeasure: Perform contextual HTML encoding of all user submitted data <span>[CWE-79-ENCODE]</span></button></h5></div><div id="collapse279" class="collapse" aria-labelledby="heading279" data-parent="#controls"><div class="card-body">	<p>All data received from the client-side should be considered tainted and a potential risk. If handled properly at the point of input, this untrusted tainted data should have been sanitized and encoded safely. The context when returning the data to the user is important, however, as this will affect what metacharacters have significance, and how they will be interpreted at the client-side. </p>

 For example, if data is inserted into the <span class="caps">HTML</span> body then <span class="caps">HTML</span> Entity encoding should be performed, but if the data is inserted into a JavaScript block, then JavaScript escaping should be performed. Similarly, while JavaScript code should not be executed in the browser when returned in an application/json response, it may then be rendered in an unsafe manner. 
 &#8211; Apply contextual encoding to all tainted data when returned to the users (including secondary users if the application has multiple interfaces &#8211; e.g. an internal user viewing data entered by an external customer).
 &#8211; This should be in addition to, and in conjunction with, sanitization and encoding applied at the time of data acquisition.</div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading285"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse285" aria-expanded="true" aria-controls="collapse285">Threat: Attackers could gain access to an open session, if they have access to a user's browser <span>[ASVS-2014-3.3]</span></button></h5></div><div id="collapse285" class="collapse" aria-labelledby="heading285" data-parent="#threats"><div class="card-body">	<p>If a user steps away from their browser for a few minutes and there is an opportunity for an attacker to access the browser, then they could gain access to the user&#8217;s logged in session and perform operations on their behalf.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading284"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse284" aria-expanded="true" aria-controls="collapse284">Weakness: Insufficient Session Expiration <span>[CWE-613]</span></button></h5></div><div id="collapse284" class="collapse" aria-labelledby="heading284" data-parent="#weaknesses"><div class="card-body">Insufficient Session Expiration is when a web site permits an attacker to reuse old session credentials or session IDs for authorization.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading282"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse282" aria-expanded="true" aria-controls="collapse282">Countermeasure: Revoke user sessions after a period of inactivity <span>[ASVS-2014-3.3]</span></button></h5></div><div id="collapse282" class="collapse" aria-labelledby="heading282" data-parent="#controls"><div class="card-body"><p>Unattended authenticated sessions may be hijacked by a malicious user; for example on a shared terminal or an unlocked computer.</p> 
<p></p> 
<ul> 
 <li> User sessions should be invalidated and terminated after a period of inactivity.&nbsp;</li> 
 <li>This period should be defined by the project; time limit of between 5 and 30 mins is common in most online applications. Shorter periods for high-security applications, or longer periods dictated by the workflow may be appropriate.&nbsp;</li> 
 <li>The timeout should be triggered when the user is no longer interacting with the (web) application; e.g. the are no longer manually browsing or using the application functionality. Ensure that any background automated processes (e.g. heartbeats, pricing or data updates) are not considered activities that reset the timeout.&nbsp;</li> 
 <li>Session revocation must occur at the server-side; for example, the session associated with the session ID is terminated on the server, rather than simply resetting a client-side cookie containing the session ID.</li> 
</ul> 
<div> 
 <ul> 
 </ul> 
 <p></p> 
</div></div></div></div><div class="card border-success"><div class="card-header " id="heading283"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse283" aria-expanded="true" aria-controls="collapse283">Countermeasure: Revoke user sessions after a fixed time period <span>[ASVS-2014-3.4]</span></button></h5></div><div id="collapse283" class="collapse" aria-labelledby="heading283" data-parent="#controls"><div class="card-body"><p>User sessions that remain active for extended periods can expose them to attacks, or provide greater opportunities for a malicious actor to exploit a compromised session. For example, cryptographic or brute-force attacks against a session ID may become practical in a longer time-window. Similarly, if a user session has been compromised, an attacker may forcibly keep that session alive to maintain a foothold in the application or environment. These types of attack can be mitigated by setting a hard limit on user sessions, even where the user is (or appears to be) actively using the application.&nbsp;</p> 
<p>Invalidate all user sessions with the application after an extended period, even when they appear active (e.g. after 24 hours the user should be warned to complete their tasks or forced to re-authenticate)&nbsp;</p> 
<p>Ensure session revocation is enforced at the server-side rather than the client-side; for example, the session ID should be invalidated at the server rather than the client-side cookie being deleted or changed.</p></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading288"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse288" aria-expanded="true" aria-controls="collapse288">Threat: Attackers gain access to the system through Server Side Code Injection <span>[CWE-94]</span></button></h5></div><div id="collapse288" class="collapse" aria-labelledby="heading288" data-parent="#threats"><div class="card-body">	<p>Server Side Code Injection happens when an attacker is able to direct input under his control and mix it with executed code on server side by modifying the logic executed on it. Depending on the code isolation, this event could grant the user with access to system resources and data.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading287"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse287" aria-expanded="true" aria-controls="collapse287">Weakness: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') <span>[CWE-78]</span></button></h5></div><div id="collapse287" class="collapse" aria-labelledby="heading287" data-parent="#weaknesses"><div class="card-body">The software constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component. This could allow attackers to execute unexpected, dangerous commands directly on the operating system. This weakness can lead to a vulnerability in environments in which the attacker does not have direct access to the operating system, such as in web applications.&nbsp; 
<div> 
 <br /> 
</div> 
<div>
  Alternately, if the weakness occurs in a privileged program, it could allow the attacker to specify commands that normally would not be accessible, or to call alternate commands with privileges that the attacker does not have. The problem is exacerbated if the compromised process does not follow the principle of least privilege, because the attacker-controlled commands may run with special system privileges that increases the amount of damage. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  There are at least two subtypes of OS command injection:&nbsp; 
</div> 
<div> 
 <ul> 
  <li>The application intends to execute a single, fixed program that is under its own control. It intends to use externally-supplied inputs as arguments to that program. For example, the program might use system(&quot;nslookup [HOSTNAME]&quot;) to run nslookup and allow the user to supply a HOSTNAME, which is used as an argument. Attackers cannot prevent nslookup from executing. However, if the program does not remove command separators from the HOSTNAME argument, attackers could place the separators into the arguments, which allows them to execute their own program after nslookup has finished executing.The application accepts an input that it uses to fully select which program to run, as well as which commands to use.&nbsp;</li> 
  <li>The application simply redirects this entire command to the operating system. For example, the program might use &quot;exec([COMMAND])&quot; to execute the [COMMAND] that was supplied by the user. If the COMMAND is under attacker control, then the attacker can execute arbitrary commands or programs. If the command is being executed using functions like exec() and CreateProcess(), the attacker might not be able to combine multiple commands together in the same line. From a weakness standpoint, these variants represent distinct programmer errors.&nbsp;</li> 
 </ul>In the first variant, the programmer clearly intends input from untrusted parties will be part of the arguments in the command to be executed. In the second variant, the programmer does not intend for the command to be accessible to any untrusted party, but the programmer probably has not accounted for alternate ways in which malicious attackers can provide input. 
</div><div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading286"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse286" aria-expanded="true" aria-controls="collapse286">Countermeasure: Validate all data received <span>[DATA-VAL]</span></button></h5></div><div id="collapse286" class="collapse" aria-labelledby="heading286" data-parent="#controls"><div class="card-body"><p>All data received should be considered tainted and a potential risk, regardless of the source or transport method. For example, while hidden form fields, cookies, or other headers may be obfuscated from a user, along with parameters passed in ViewStates or other encapsulated forms, these can be modified by the user at the client-side in memory, or in transit on the network. Similarly, data passed from binary or compiled components can be modified in situ or in transit. <i></i> <i>Furthermore, encryption only secures the data in transit between the two ends of the encrypted tunnel (one end of which is typically controlled by the client); data passing through the link may still be malicious.</i> </p> As such, all data from the client side must be subjected to strict validation, sanitization, and encoding against expected syntactic and semantic criteria. 
<div> 
 <ul> 
  <li>Define a specification of the data that is expected at each input; both the syntax (e.g. alphanumeric only) and semantics (e.g. a word of between 1 and 25 characters, or a specific list). As an example of business rule logic, &quot;boat&quot; may be syntactically valid because it only contains alphanumeric characters, but it is not valid if the input is only expected to contain colors such as &quot;red&quot; or &quot;blue.&quot;&nbsp;</li> 
  <li>Implement a 'known good' or white-list approach, where only inputs that meet the strict criteria for each input are accepted, and reject, transform, or encapsulate any non-compliant data.&nbsp;</li> 
  <li>While useful for identifying malicious content, do not rely on looking for specific malformed or attack payloads (blacklists). It is almost impossible to maintain a comprehensive and accurate blacklist due to the complexity and evolving nature of attacks, opportunities to obfuscate payloads, and changes to the code's execution environment. As noted, blacklists can be useful for detecting and logging potential attacks, or determining which inputs are so malformed that they should be rejected outright.&nbsp;</li> 
  <li>Validate all data received from the client, including values such as <span class="caps">HTTP</span> headers and cookie values if these are used as input on the server side, X- headers, and other platform specific data objects passed between the client and server.</li> 
 </ul> 
</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading296"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse296" aria-expanded="true" aria-controls="collapse296">Risk pattern: RF-Bluetooth communication <span>[rf-bluetooh-communication]</span></button></h5></div><div id="collapse296" class="collapse" aria-labelledby="heading296" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading295"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse295" aria-expanded="true" aria-controls="collapse295">Use case: Networking <span>[NETWORKING]</span></button></h5></div><div id="collapse295" class="collapse" aria-labelledby="heading295" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading294"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse294" aria-expanded="true" aria-controls="collapse294">Threat: An attacker monitors information transmitted through a RF-Bluetooth network <span>[CAPEC-157-RF-BT]</span></button></h5></div><div id="collapse294" class="collapse" aria-labelledby="heading294" data-parent="#threats"><div class="card-body"><p>An attacker monitors information transmitted between logical or physical nodes of a network. The attacker need not be able to prevent reception or change content but must simply be able to observe and read the traffic. The attacker might precipitate or indirectly influence the content of the observed transaction, but the attacker is never the intended recipient of the information. Any transmission medium can theoretically be sniffed if the attacker can listen to the contents between the sender and recipient.</p><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading293"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse293" aria-expanded="true" aria-controls="collapse293">Weakness: Information Exposure <span>[CWE-200]</span></button></h5></div><div id="collapse293" class="collapse" aria-labelledby="heading293" data-parent="#weaknesses"><div class="card-body">An information exposure is the unintentional disclosure of information to an actor that is not explicitly authorized to have access to that information.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading291"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse291" aria-expanded="true" aria-controls="collapse291">Countermeasure: Where RF communications are enabled (e.g., ZigBee, etc.) antenna power is configured to limit ability of mapping assets to limit attacks such as WAR-Driving <span>[IOT2.4.7.22]</span></button></h5></div><div id="collapse291" class="collapse" aria-labelledby="heading291" data-parent="#controls"><div class="card-body">	<p>The cryptographic key chain used for signing production software is different from that used for any other test, development or other software images.</p>

	<p>Rationale:<br />
Often test or development images have fewer restrictions and/or more privileges. Therefore, to prevent the installation of non-production software into production devices, a different cryptographic key chain should be used for signing production software.</p>

	<p>Remediation:<br />
Use a different cryptographic key chain for signing production software from that used for any other test, development or other software images.</p></div></div></div><div class="card border-success"><div class="card-header " id="heading292"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse292" aria-expanded="true" aria-controls="collapse292">Countermeasure: Protocol anonymity features are enabled in protocols (e.g., Bluetooth) to limit location tracking capabilities <span>[IOT2.4.7.23]</span></button></h5></div><div id="collapse292" class="collapse" aria-labelledby="heading292" data-parent="#controls"><div class="card-body">	<p>Bluetooth anonymity mode, where the devices <span class="caps">BDADDR</span> is masked allowing use of services through access point without giving out device identity. Each time the active address is updated, it is sent to all the devices it is communicating or connected with. The use of the fixed Bluetooth hardware address is still supported in the Bluetooth anonymity mode. This is done to allow direct connections between two trusted devices.</p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>