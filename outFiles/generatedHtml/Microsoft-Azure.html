<!DOCTYPE html><html><head><title>Risk Patterns for Microsoft-Azure.xml</title><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous"><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script></head><body><center><h2>Risk patterns for Microsoft-Azure.xml<h2></center><div class="accordion" id="components"><div class="card border-primary"><div class="card-header " id="heading22"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse22" aria-expanded="true" aria-controls="collapse22">Risk pattern: Azure Identity & Access <span>[AZURE-IDENTITY-AND-ACCESS]</span></button></h5></div><div id="collapse22" class="collapse" aria-labelledby="heading22" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading13"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse13" aria-expanded="true" aria-controls="collapse13">Use case: Authentication <span>[AUTHENTICATION]</span></button></h5></div><div id="collapse13" class="collapse" aria-labelledby="heading13" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading8"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse8" aria-expanded="true" aria-controls="collapse8">Threat: Attackers gain unauthorized access to the root account due to the lack of configuration of the account <span>[AZURE-LOST-ACCESS-ROOT]</span></button></h5></div><div id="collapse8" class="collapse" aria-labelledby="heading8" data-parent="#threats"><div class="card-body"><div>
                                Attackers could gain unauthorized access to the administrator account due to the lack of
                                configuration of the account and its security mechanisms, like modifying credentials and
                                adding/removing user accounts.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading1"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse1" aria-expanded="true" aria-controls="collapse1">Weakness: Excessive use of administrator accounts <span>[AZURE-MON02]</span></button></h5></div><div id="collapse1" class="collapse" aria-labelledby="heading1" data-parent="#weaknesses"><div class="card-body">The administrator accounts are used for all actions, not only for administrative actions.&nbsp;<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading0"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse0" aria-expanded="true" aria-controls="collapse0">Countermeasure: Create Individual Accounts for the administrator users <span>[AZ-A03]</span></button></h5></div><div id="collapse0" class="collapse" aria-labelledby="heading0" data-parent="#controls"><div class="card-body"><div>
  Create an individual account for the administrator users and with this new accounts By creating individual Azure users for people accessing your account, you can give each Azure user a unique set of security credentials.&nbsp; 
</div> 
<div> 
 <br /> 
</div> 
<div>
  The administrator accounts shall be used for the administrative actions and for giving or revoke credentials to the user's account. The administrator account shall be not used as a normal user account. 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:&nbsp;</b> 
</div> 
<div> 
 <ol> 
  <li>Log into the Azure portal as an owner.</li> 
  <li>Select Azure Active Directory.</li> 
  <li>Go into &quot;Users and groups&quot; &gt; &quot;All users&quot;.</li> 
  <li>Select &quot;Add New User&quot;.</li> 
  <li>Fill the required information and click &quot;Create&quot;.</li> 
 </ol> 
</div> 
<div> 
</div></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading3"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse3" aria-expanded="true" aria-controls="collapse3">Weakness: Misconfigured Authentication Method for Administrator Accounts <span>[AZ-W04]</span></button></h5></div><div id="collapse3" class="collapse" aria-labelledby="heading3" data-parent="#weaknesses"><div class="card-body">The authentication method &quot;Multi-factor Authentication&quot; for the
                        Administrator accounts are not configured
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading2"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse2" aria-expanded="true" aria-controls="collapse2">Countermeasure: Enable MFA for Administrator & Co Administrator accounts <span>[AZ-A04]</span></button></h5></div><div id="collapse2" class="collapse" aria-labelledby="heading2" data-parent="#controls"><div class="card-body"><div>
  Enable multi-factor authentication (MFA) device enhances the security of the login process for the Administrator accounts. With MFA, users have a device that generates a unique authentication code (a one-time password, or OTP) and users must provide both their normal credentials (like their username and password) and the OTP. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  The MFA device can either be a special piece of hardware, or it can be a virtual device. The recommendation for the Service Administrator &amp; Co Administrator accounts is to use MFA to increase the level of security of the login process. 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:&nbsp;</b> 
</div> 
<div> 
 <ol> 
  <li>Log into the Azure portal as an owner.</li> 
  <li>Select Azure Active Directory.</li> 
  <li>Go into &quot;Users and groups&quot; &gt; &quot;All users&quot;.</li> 
  <li>Select &quot;Multi-Factor Authentication&quot;.</li> 
  <li>Choose all the Service Administrator &amp; Co Administrator accounts and enable MFA.&nbsp;</li> 
 </ol> 
</div> 
<div> 
 <div> 
 </div> 
</div></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading5"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse5" aria-expanded="true" aria-controls="collapse5">Weakness: Misconfigured Security contact details <span>[LOST-SECURITY-ALERTS]</span></button></h5></div><div id="collapse5" class="collapse" aria-labelledby="heading5" data-parent="#weaknesses"><div class="card-body">The security contact details for the Azure subscription are not properly configured.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading4"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse4" aria-expanded="true" aria-controls="collapse4">Countermeasure: Register a Security contact for your Azure account <span>[AZ-A01]</span></button></h5></div><div id="collapse4" class="collapse" aria-labelledby="heading4" data-parent="#controls"><div class="card-body"><div>
  Provide the security contact details for the Azure subscription. Microsoft Security Response Center (MSRC) performs security monitoring of the Azure network and infrastructure and receives threat intelligence and abuse complaints from third parties. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Microsoft will use this information provided to contact if the MSRC discovers that customer data has been accessed by an unlawful or unauthorized party. Also, this provides the means of ensuring these advisories are routed to the security team, especially if a distribution email address is used.&nbsp; 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:&nbsp;</b> 
</div> 
<div> 
 <ol> 
  <li>Access &quot;Azure Security Center&quot;.&nbsp;</li> 
  <li>In the &quot;Recommendations&quot; tab choose &quot;Provide security contact details&quot;.&nbsp;</li> 
  <li>Once filled, save changes.</li> 
 </ol> 
</div></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading7"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse7" aria-expanded="true" aria-controls="collapse7">Weakness: The Root Account is mis-configured <span>[LOST-ACCESS-ROOT-01]</span></button></h5></div><div id="collapse7" class="collapse" aria-labelledby="heading7" data-parent="#weaknesses"><div class="card-body">The administrator account is not configured. The security question to recover or reset the
                        password and the authentication method are not configured.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading6"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse6" aria-expanded="true" aria-controls="collapse6">Countermeasure: Configure the security challenge questions for the administrator account <span>[AZ-A02]</span></button></h5></div><div id="collapse6" class="collapse" aria-labelledby="heading6" data-parent="#controls"><div class="card-body"><div>
  Activate and configure the security challenge question and the possibility of resetting the password by confirming the user's identity is allowed. In case of being an owner account of the subscription that has full administration access, it is necessary to do this, as a security measure that this password is lost. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  The security confirmation measures will depend on those specified by the Active Directory administrator. Make sure that the security confirmation measures match the security criteria. Otherwise, it could make a weak confirmation and allow the password reset to malicious users. 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <ul> 
  <li>Using the console:&nbsp;</li> 
 </ul> 
 <ol> 
  <ol> 
   <li>Open https://aka.ms/ssprsetup and Log into the account.</li> 
   <li>Respond to security measures.&nbsp;</li> 
   <li>Once all needed controls are finished, click on accept.</li> 
  </ol> 
 </ol> 
 <ul> 
  <li>Using the portal:</li> 
  <ol> 
   <li>Log into the Azure portal as an owner.</li> 
   <li>Select Azure Active Directory.</li> 
   <li>Select &quot;Password reset&quot; &gt; &quot;Authentication Method&quot;.</li> 
   <li>Choose the security confirmation measures that match the security criteria and click &quot;Save&quot;.</li> 
  </ol> 
 </ul> 
</div> 
<div> 
 <br /> 
</div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading12"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse12" aria-expanded="true" aria-controls="collapse12">Threat: Attackers gain unauthorized access to the user account due to the lack of configuration of the account <span>[AZURE-LOST-ACCESS-USER]</span></button></h5></div><div id="collapse12" class="collapse" aria-labelledby="heading12" data-parent="#threats"><div class="card-body"><div>
                                Attackers could gain unauthorized access to the user account due to the lack of
                                configuration of the account, like the security question to reset the password was
                                configured incorrectly.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading11"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse11" aria-expanded="true" aria-controls="collapse11">Weakness: Misconfigured User Account <span>[AZURE-IDENTITY-03]</span></button></h5></div><div id="collapse11" class="collapse" aria-labelledby="heading11" data-parent="#weaknesses"><div class="card-body"><div>
                        Key security settings such as resetting the password and other password controls are not
                        configured.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading9"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse9" aria-expanded="true" aria-controls="collapse9">Countermeasure: Recertify user access <span>[AZ-A07]</span></button></h5></div><div id="collapse9" class="collapse" aria-labelledby="heading9" data-parent="#controls"><div class="card-body"><div>
                        Do regular reviews of accounts on the system and verify that it doesn't exist stoled or fake
                        accounts. With this process is ensured that there are not compromised accounts by former
                        employees or by attackers.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        At least every 90 days complete the following:&nbsp;
                        </div>
                        <div>
                        <ol>
                        <li>Log in to the Azure portal as an owner.</li>
                        <li>Select Azure Active Directory.</li>
                        <li>Go into &quot;Users and groups&quot; &gt; &quot;All users&quot;.</li>
                        <li>For any user that should not exist:</li>
                        <li>Select the user.</li>
                        <li>Click &quot;Delete&quot;.</li>
                        </ol>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading10"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse10" aria-expanded="true" aria-controls="collapse10">Countermeasure: Configure a strong security challenge questions for the user account. <span>[AZ-A08]</span></button></h5></div><div id="collapse10" class="collapse" aria-labelledby="heading10" data-parent="#controls"><div class="card-body"><div>
                        <div>
                        <div>
                        Activate and configure the security challenge question and the possibility of resetting the
                        password by confirming the user's identity is allowed. Make sure that the security confirmation
                        measures match the security criteria. Otherwise, it could make a weak confirmation and allow the&nbsp;password
                        reset to malicious users.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation: &nbsp;</b>
                        </div>
                        <div>
                        <ol>
                        <li>Log in to the Azure portal as an owner.</li>
                        <li>Select Azure Active Directory.</li>
                        <li>Select &quot;Password reset&quot; &gt; &quot;Authentication Method&quot;.</li>
                        <li>Choose the security confirmation measures that match the security criteria and click
                        &quot;Save&quot;.</li>
                        </ol>
                        </div>
                        </div>
                        </div>
                        <ol>
                        </ol>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading21"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse21" aria-expanded="true" aria-controls="collapse21">Use case: Authorization <span>[AUTHORIZATION]</span></button></h5></div><div id="collapse21" class="collapse" aria-labelledby="heading21" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading20"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse20" aria-expanded="true" aria-controls="collapse20">Threat: Attackers gain unauthorized access to the control of the environment <span>[LOSS-CONTROL_ENV]</span></button></h5></div><div id="collapse20" class="collapse" aria-labelledby="heading20" data-parent="#threats"><div class="card-body"><div>
                                Attackers could gain unauthorized access to the control of the environment, due of the
                                user accounts or role groups are not well defined and configured. Therefore, attackers
                                can make changes without the root approval.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading17"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse17" aria-expanded="true" aria-controls="collapse17">Weakness: Misconfigured credentials for groups and roles <span>[AZURE-ACCESS-01]</span></button></h5></div><div id="collapse17" class="collapse" aria-labelledby="heading17" data-parent="#weaknesses"><div class="card-body"><div>
                        The credentials for the groups and roles are not correctly configured and there are user
                        accounts with more privileges than the necessary.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading14"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse14" aria-expanded="true" aria-controls="collapse14">Countermeasure: Apply RBAC with pre-defined policies added into groups or roles <span>[AZ-A09]</span></button></h5></div><div id="collapse14" class="collapse" aria-labelledby="heading14" data-parent="#controls"><div class="card-body"><div>
                        Define and create groups that relate to job functions (administrators, developers, accounting,
                        etc.) and assign the relevant permissions for each group, and then assign IAM users to those
                        groups.&nbsp;
                        </div>
                        <div>
                        &nbsp;&nbsp;
                        </div>
                        <div>
                        All the users in an IAM group inherit the permissions assigned to the group. That way, you can
                        make changes for everyone in a group in just one place. As people move around in your company,
                        you can simply change what IAM group their IAM user belongs to. This method is known as Role
                        Based Access Control (RBAC).&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        <ul>
                        <li>Remove a user from a group:</li>
                        </ul>
                        <ol>
                        <ol>
                        <li>Log into the Azure portal as an owner.</li>
                        <li>Select Azure Active Directory.</li>
                        <li>Go into &quot;Users and groups&quot; &gt; &quot;All users&quot;.</li>
                        <li>Click on the user name. All the groups the user belongs are there.</li>
                        <li>Choose the group and &quot;Remove&quot;.</li>
                        </ol>
                        </ol>
                        <ul>
                        <li>Create a group and add user:</li>
                        </ul>
                        <ol>
                        <ol>
                        <li>Log into the Azure portal as an owner.</li>
                        <li>Select Azure Active Directory.</li>
                        <li>Go into &quot;Users and groups&quot; &gt; &quot;All groups&quot;.</li>
                        <li>Click &quot;New Group&quot; and fill the information.</li>
                        <li>Search and add the user.</li>
                        </ol>
                        </ol>
                        </div>
                        <div>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading15"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse15" aria-expanded="true" aria-controls="collapse15">Countermeasure: Create mechanisms to ensure the principle of least privilege is applied <span>[AZ-A10]</span></button></h5></div><div id="collapse15" class="collapse" aria-labelledby="heading15" data-parent="#controls"><div class="card-body"><div>
                        Create the mechanisms to review periodically the group and user permissions to ensure the least
                        privilege for the user accounts. Granting least privilege ensures that users only have the
                        permissions required to complete their jobs rather than additional privileges that are not
                        required.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        Following this model ensures that, should an account be compromised, the blast radius of damage
                        is limited&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        <ol>
                        <li>Allocate privileges via groups or roles via the recommendation in &quot;Use RBAC
                        with pre-defined policies added into groups or roles&quot;.</li>
                        </ol>
                        </div>
                        <div>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading16"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse16" aria-expanded="true" aria-controls="collapse16">Countermeasure: Configure roles for the Cloud Service <span>[AZ-A11]</span></button></h5></div><div id="collapse16" class="collapse" aria-labelledby="heading16" data-parent="#controls"><div class="card-body"><div>
                        Define and create the roles for the Azure Cloud Service. For each role, define the permissions
                        and also configure how that role runs. When you launch an Azure instance, you shall specify a
                        role for the instance as a launch parameter. Applications that run on the Cloud instance use the
                        role's credentials when they access Azure resources. This role's permissions determine what the
                        application is allowed to do.&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        <ul>
                        <li>Configure an Azure cloud service from Solution Explorer in Visual Studio.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading19"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse19" aria-expanded="true" aria-controls="collapse19">Weakness: Misconfigured password expiration <span>[AZURE-EXPIRATION-DATE]</span></button></h5></div><div id="collapse19" class="collapse" aria-labelledby="heading19" data-parent="#weaknesses"><div class="card-body">The password expiration is not configured and users are not obliged to change their passwords.
                        Not change frequently the passwords gives facilities to attackers to obtain them.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading18"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse18" aria-expanded="true" aria-controls="collapse18">Countermeasure: Configure password expiration <span>[AZ-A12]</span></button></h5></div><div id="collapse18" class="collapse" aria-labelledby="heading18" data-parent="#controls"><div class="card-body"><div>
                        <div>
                        Configure the password expiration to force after a determinate time, the password code shall be
                        changed for the users.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Configure password management to match security criteria. This value is configurable
                        using the Set-MsolPasswordPolicy cmdlet from the Azure Active Directory Module for Windows
                        PowerShell. With the following command as the example:</li>
                        </ol>
                        </div>
                        </div>
                        <blockquote>
                        <blockquote>
                        <div>
                        <div>
                        Set-MsolPasswordPolicy -ValidityPeriod 60 -NotificationDays 14&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        </div>
                        </blockquote>This command updates the tenant so that all users passwords expire after 60
                        days. The users receive notification 14 days prior to that expiry.
                        </blockquote>
                        <div>
                        <div>
                        More information:&nbsp;
                        <a
                        href="https://docs.microsoft.com/en-us/powershell/module/msonline/set-msolpasswordpolicy?view=azureadps-1.0">Doc
                        MS Azure</a>
                        </div>
                        </div>
                        <ul>
                        </ul>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading33"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse33" aria-expanded="true" aria-controls="collapse33">Risk pattern: Azure Logging <span>[AZURE-LOGS]</span></button></h5></div><div id="collapse33" class="collapse" aria-labelledby="heading33" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading32"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse32" aria-expanded="true" aria-controls="collapse32">Use case: API Logging and Auditing <span>[API LOGGING AND AUDITING]</span></button></h5></div><div id="collapse32" class="collapse" aria-labelledby="heading32" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading31"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse31" aria-expanded="true" aria-controls="collapse31">Threat: Attackers make undetected and unaudited changes to system configurations <span>[UNAUDITABLE-CHANGES-AZURE]</span></button></h5></div><div id="collapse31" class="collapse" aria-labelledby="heading31" data-parent="#threats"><div class="card-body"><div>
                                If audit trails are not properly protected, an attacker could gain access to the system,
                                modify the status of resources or exfiltrate sensitive data without being noticed.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading24"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse24" aria-expanded="true" aria-controls="collapse24">Weakness: Audit logs can be deleted <span>[AZURE-LOGS03]</span></button></h5></div><div id="collapse24" class="collapse" aria-labelledby="heading24" data-parent="#weaknesses"><div class="card-body">There is no external backups of log records. If logs are deleted, there is no way to recover
                        them.ed.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading23"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse23" aria-expanded="true" aria-controls="collapse23">Countermeasure: Export the Audit Logs to a storage account <span>[AZ-L05]</span></button></h5></div><div id="collapse23" class="collapse" aria-labelledby="heading23" data-parent="#controls"><div class="card-body"><div>
                        Export the information of Audit Logs to a storage account.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to &quot;Monitor&quot; and then to &quot;Activity Logs&quot;.</li>
                        <li>Push the button &quot;Export&quot;.</li>
                        <li>Select &quot;All Regions&quot;.</li>
                        <li>Select &quot;Export to a storage account&quot; and select your account.</li>
                        <li>Select the &quot;Retention (days)&quot; as minimum 90 days.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading27"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse27" aria-expanded="true" aria-controls="collapse27">Weakness: Non-auditable connections to the web application <span>[AZURE-LOGS02]</span></button></h5></div><div id="collapse27" class="collapse" aria-labelledby="heading27" data-parent="#weaknesses"><div class="card-body"><div>
                        The status connection or failed attempts cannot be audited because they are not recorded into
                        the logs.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading25"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse25" aria-expanded="true" aria-controls="collapse25">Countermeasure: Enable Detailed error messages <span>[AZ-L03]</span></button></h5></div><div id="collapse25" class="collapse" aria-labelledby="heading25" data-parent="#controls"><div class="card-body"><div>
                        Enable the detailed error information for HTTP status codes that indicate a failure (status code
                        400 or greater) is saved into the logs files. This may contain information that can help
                        determine why the server returned the error code.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to the Azure portal.</li>
                        <li>Go to the blade for your web app and in &quot;Monitoring&quot; &gt;&gt;
                        &quot;Diagnostics logs&quot;.</li>
                        <li>Enable the &quot;Detailed error messages&quot;.</li>
                        <li>Push &quot;Save&quot; to save the changes.</li>
                        </ol>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading26"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse26" aria-expanded="true" aria-controls="collapse26">Countermeasure: Enable Failed Request Tracing <span>[AZ-L04]</span></button></h5></div><div id="collapse26" class="collapse" aria-labelledby="heading26" data-parent="#controls"><div class="card-body"><div>
                        Enable to obtain the detailed information on failed requests, including a trace of the IIS
                        components used to process the request and the time taken in each component. This can be useful
                        if you are attempting to increase site performance or isolate what is causing a specific HTTP
                        error to be returned.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to the Azure portal.</li>
                        <li>Go to the blade for your web app and in &quot;Monitoring&quot; &gt;&gt;
                        &quot;Diagnostics logs&quot;.</li>
                        <li>Enable the &quot;Failed request tracing&quot;.</li>
                        <li>Push &quot;Save&quot; to save the changes.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading30"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse30" aria-expanded="true" aria-controls="collapse30">Weakness: Non-auditable resource changes <span>[AZURE-LOGS01]</span></button></h5></div><div id="collapse30" class="collapse" aria-labelledby="heading30" data-parent="#weaknesses"><div class="card-body"><div>
                        The Diagnostic Logs are not activated and configured. Therefore, the changes or the access to
                        the resources are not recorded into the logs.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading28"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse28" aria-expanded="true" aria-controls="collapse28">Countermeasure: Enable diagnostic logs auditing for Microsoft Azure <span>[AZ-L01]</span></button></h5></div><div id="collapse28" class="collapse" aria-labelledby="heading28" data-parent="#controls"><div class="card-body"><div>
                        Enable diagnostic logs to give the information over the operations of the resources.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to the Azure portal.</li>
                        <li>Go to the blade for your web app and in &quot;Monitoring&quot; &gt;&gt;
                        &quot;Diagnostics logs&quot;.</li>
                        <li>Enable the &quot;Application Logging (Filesystem)&quot; and &quot;Application
                        Logging (Blob)&quot;.</li>
                        <li>Push &quot;Save&quot; to save the changes.</li>
                        </ol>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading29"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse29" aria-expanded="true" aria-controls="collapse29">Countermeasure: Enable Web Server Logging <span>[AZ-L02]</span></button></h5></div><div id="collapse29" class="collapse" aria-labelledby="heading29" data-parent="#controls"><div class="card-body"><div>
                        Enable the Web Server logging to receive information about HTTP transactions using the W3C
                        extended log file format. This is useful when determining overall site metrics such as the
                        number of requests handled or how many requests are from a specific IP address. There are two
                        ways to save the data:
                        </div>
                        <div>
                        <ul>
                        <li><b>File system: </b>stores the application diagnostics information to the
                        web app file system. These files can be accessed by FTP, or downloaded as a Zip archive by using
                        the Azure PowerShell or Azure Command-Line Interface (Azure CLI).</li>
                        <li><b>Storage:</b> stores the application diagnostics information in the
                        specified Azure Storage Account and the logs are only accessible with a client account.</li>
                        </ul>
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to the Azure portal.</li>
                        <li>Go to the blade for your web app and in &quot;Monitoring&quot; &gt;&gt;
                        &quot;Diagnostics logs&quot;.</li>
                        <li>Enable the type &quot;Storage&quot; or &quot;File System&quot; to
                        activate this function.</li>
                        <li>Push &quot;Save&quot; to save the changes.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading57"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse57" aria-expanded="true" aria-controls="collapse57">Risk pattern: Azure Monitoring <span>[AZURE-MONITORING]</span></button></h5></div><div id="collapse57" class="collapse" aria-labelledby="heading57" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading56"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse56" aria-expanded="true" aria-controls="collapse56">Use case: Log Activity alerts <span>[LOG ACTIVITY ALERTS]</span></button></h5></div><div id="collapse56" class="collapse" aria-labelledby="heading56" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading44"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse44" aria-expanded="true" aria-controls="collapse44">Threat: Attackers access to the systems without being detected <span>[UNAUTHORIZED-ACCESS-SYSTEMS]</span></button></h5></div><div id="collapse44" class="collapse" aria-labelledby="heading44" data-parent="#threats"><div class="card-body"><div>
                                Attackers gain access to the systems and they are not detected and the changes of the
                                attackers couldn't be audited or detected.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading35"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse35" aria-expanded="true" aria-controls="collapse35">Weakness: Excessive use of administrator accounts <span>[AZURE-MON02]</span></button></h5></div><div id="collapse35" class="collapse" aria-labelledby="heading35" data-parent="#weaknesses"><div class="card-body">The administrator accounts are used for all actions, not only for administrative actions. This
                        is because these users have not got a personal or a user account to do the daily actions.&nbsp;
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading34"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse34" aria-expanded="true" aria-controls="collapse34">Countermeasure: Create alerts to notify a bad usage of the root account <span>[AZ-M10]</span></button></h5></div><div id="collapse34" class="collapse" aria-labelledby="heading34" data-parent="#controls"><div class="card-body"><div>
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the usage of the
                        root accounts to the correspondent personnel. It's vital that these unauthorized changes are
                        detected.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to &quot;Monitor&quot; and then to &quot;Alerts&quot;.</li>
                        <li>Push &quot;Add activity log alert&quot;.</li>
                        <li>Filling the fields with the corresponding values.</li>
                        <li>Select in actions the personnel should be received this information.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading37"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse37" aria-expanded="true" aria-controls="collapse37">Weakness: Lack of 2FA <span>[AZURE-MON03]</span></button></h5></div><div id="collapse37" class="collapse" aria-labelledby="heading37" data-parent="#weaknesses"><div class="card-body">Log into the console without using the Multi-factor Authentication (MFA) and they are not
                        detected. The connection without the MFA must be audited and monitored, the correct security
                        group must be informed and they must validate this connection.&nbsp;
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading36"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse36" aria-expanded="true" aria-controls="collapse36">Countermeasure: Create alerts to notify about the console login without MFA <span>[AZ-M11]</span></button></h5></div><div id="collapse36" class="collapse" aria-labelledby="heading36" data-parent="#controls"><div class="card-body"><div>
                        Create alerts for Activity Log changes to monitor, audit and notify about the user's login into
                        the console without Multi-factor Authentication to the correspondent personnel. It's vital that
                        these unauthorized changes are detected.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to &quot;Monitor&quot; and then to &quot;Alerts&quot;.</li>
                        <li>Push &quot;Add activity log alert&quot;.</li>
                        <li>Filling the fields with the corresponding values.</li>
                        <li>Select in actions the personnel should be received this information.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading39"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse39" aria-expanded="true" aria-controls="collapse39">Weakness: Undetected brute force attempts on MS Azure management console <span>[AZURE-MON06]</span></button></h5></div><div id="collapse39" class="collapse" aria-labelledby="heading39" data-parent="#weaknesses"><div class="card-body">The failure connection attempts (brute force) must be audited and monitored and correspondent
                        personnel must be alerted and informed.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading38"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse38" aria-expanded="true" aria-controls="collapse38">Countermeasure: Create alerts to notify the console login failure attempts <span>[AZ-M05]</span></button></h5></div><div id="collapse38" class="collapse" aria-labelledby="heading38" data-parent="#controls"><div class="card-body"><div>
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the console login
                        failure attempts to the correspondent personnel. It's vital that these unauthorized changes are
                        detected.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to &quot;Monitor&quot; and then to &quot;Alerts&quot;.</li>
                        <li>Push &quot;Add activity log alert&quot;.</li>
                        <li>Filling the fields with the corresponding values.</li>
                        <li>Select in actions the personnel should be received this information.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading41"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse41" aria-expanded="true" aria-controls="collapse41">Weakness: Undetected changes in data encryption configuration <span>[AZURE-MON05]</span></button></h5></div><div id="collapse41" class="collapse" aria-labelledby="heading41" data-parent="#weaknesses"><div class="card-body">The changes on the database encryption must be audited and monitored. When there are changes
                        on the database encryption, the security group must be alerted.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading40"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse40" aria-expanded="true" aria-controls="collapse40">Countermeasure: Create alerts due of Transparent Data Encryption Deletion <span>[AZ-M04]</span></button></h5></div><div id="collapse40" class="collapse" aria-labelledby="heading40" data-parent="#controls"><div class="card-body"><div>
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the changes of
                        Transparent Data Encryption to the correspondent personnel. It's vital that these unauthorized
                        changes are detected.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to &quot;Monitor&quot; and then to &quot;Alerts&quot;.</li>
                        <li>Push &quot;Add activity log alert&quot;.</li>
                        <li>Filling the fields with the corresponding values.</li>
                        <li>Select in actions the personnel should be received this information.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading43"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse43" aria-expanded="true" aria-controls="collapse43">Weakness: Undetected changes in security groups <span>[AZURE-MON04]</span></button></h5></div><div id="collapse43" class="collapse" aria-labelledby="heading43" data-parent="#weaknesses"><div class="card-body">The changes in security groups must be traced and monitored and the correspondent personnel
                        must approve these changes. If the situation is not the correct, attackers can access to
                        security systems.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading42"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse42" aria-expanded="true" aria-controls="collapse42">Countermeasure: Create alerts for changes in security groups and in security groups configurations <span>[AZ-M12]</span></button></h5></div><div id="collapse42" class="collapse" aria-labelledby="heading42" data-parent="#controls"><div class="card-body"><div>
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the changes in
                        the security groups or in security groups configurations to the correspondent personnel. It's
                        vital that these unauthorized changes are detected.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to &quot;Monitor&quot; and then to &quot;Alerts&quot;.</li>
                        <li>Push &quot;Add activity log alert&quot;.</li>
                        <li>Filling the fields with the corresponding values.</li>
                        <li>Select in actions the personnel should be received this information.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading50"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse50" aria-expanded="true" aria-controls="collapse50">Threat: Attackers gain undetected access to security system configurations <span>[UNAUTHORIZED-ACCESS-SECURITY-SYSTEMS]</span></button></h5></div><div id="collapse50" class="collapse" aria-labelledby="heading50" data-parent="#threats"><div class="card-body"><div>
                                Attackers could gain undetected access to security system configurations and the changes
                                of the attackers couldn't be audited or detected.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading49"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse49" aria-expanded="true" aria-controls="collapse49">Weakness: Undetected changes in security configurations <span>[AZURE-MON01]</span></button></h5></div><div id="collapse49" class="collapse" aria-labelledby="heading49" data-parent="#weaknesses"><div class="card-body"><div>
                        Monitoring and alerting for security configurations are not configured and changes cannot be
                        detected.&nbsp;
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading45"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse45" aria-expanded="true" aria-controls="collapse45">Countermeasure: Create alerts for changes on Activity Logs configuration <span>[AZ-M01]</span></button></h5></div><div id="collapse45" class="collapse" aria-labelledby="heading45" data-parent="#controls"><div class="card-body"><div>
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the changes to
                        the correspondent personnel. It's vital that these unauthorized changes are detected.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to &quot;Monitor&quot; and then to &quot;Alerts&quot;.</li>
                        <li>Push &quot;Add activity log alert&quot;.</li>
                        <li>Filling the fields with the corresponding values.</li>
                        <li>Select in actions the personnel should be received this information.</li>
                        </ol>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading46"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse46" aria-expanded="true" aria-controls="collapse46">Countermeasure: Create alerts for security policy changes <span>[AZ-M02]</span></button></h5></div><div id="collapse46" class="collapse" aria-labelledby="heading46" data-parent="#controls"><div class="card-body"><div>
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the Management
                        Security Policies changes to the correspondent personnel. It's vital that these unauthorized
                        changes are detected.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to &quot;Monitor&quot; and then to &quot;Alerts&quot;.</li>
                        <li>Push &quot;Add activity log alert&quot;.</li>
                        <li>Filling the fields with the corresponding values.</li>
                        <li>Select in actions the personnel should be received this information.</li>
                        </ol>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading47"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse47" aria-expanded="true" aria-controls="collapse47">Countermeasure: Create alerts to detect changes in the recommendation configurations <span>[AZ-M03]</span></button></h5></div><div id="collapse47" class="collapse" aria-labelledby="heading47" data-parent="#controls"><div class="card-body"><div>
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the changes in
                        the recommendation configurations to the correspondent personnel. It's vital that these
                        unauthorized changes are detected.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to &quot;Monitor&quot; and then to &quot;Alerts&quot;.</li>
                        <li>Push &quot;Add activity log alert&quot;.</li>
                        <li>Filling the fields with the corresponding values.</li>
                        <li>Select in actions the personnel should be received this information.</li>
                        </ol>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading48"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse48" aria-expanded="true" aria-controls="collapse48">Countermeasure: Create alerts to detect changes on activity alerts <span>[AZ-M09]</span></button></h5></div><div id="collapse48" class="collapse" aria-labelledby="heading48" data-parent="#controls"><div class="card-body"><div>
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the alert
                        modifications to the correspondent personnel. It's vital that these unauthorized changes are
                        detected.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to &quot;Monitor&quot; and then to &quot;Alerts&quot;.</li>
                        <li>Push &quot;Add activity log alert&quot;.</li>
                        <li>Filling the fields with the corresponding values.</li>
                        <li>Select in actions the personnel should be received this information.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading55"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse55" aria-expanded="true" aria-controls="collapse55">Threat: Sensitive data is compromised through network access <span>[UNAUTHORIZED-ACCESS-NETWORK]</span></button></h5></div><div id="collapse55" class="collapse" aria-labelledby="heading55" data-parent="#threats"><div class="card-body"><div>
                                Attackers gain undetected access to network systems and produced changes cannot be
                                audited or detected.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading54"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse54" aria-expanded="true" aria-controls="collapse54">Weakness: Undetected changes in network configuration <span>[AZURE-MON07]</span></button></h5></div><div id="collapse54" class="collapse" aria-labelledby="heading54" data-parent="#weaknesses"><div class="card-body"><div>
                        Changes in network configurations (NACLs, route and gateway tables) are not detected because
                        monitoring and alerting on the network is not configured to detect these changes.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading51"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse51" aria-expanded="true" aria-controls="collapse51">Countermeasure: Create alerts for VPC NACL changes <span>[AZ-M06]</span></button></h5></div><div id="collapse51" class="collapse" aria-labelledby="heading51" data-parent="#controls"><div class="card-body"><div>
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the changes in
                        the Network Access Control Lists (NACLs) to the correspondent personnel. It's vital that these
                        unauthorized changes are detected.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        The Network Access Control Lists (NACLs) control inbound and outbound access to &amp; from
                        MS Azure subnets and work like packet filters to protect the network. Therefore alerting on
                        changes to NACLs help ensure that the subnets protected by them are not exposed.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to &quot;Monitor&quot; and then to &quot;Alerts&quot;.</li>
                        <li>Push &quot;Add activity log alert&quot;.</li>
                        <li>Filling the fields with the corresponding values.</li>
                        <li>Select in actions the personnel should be received this information.</li>
                        </ol>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading52"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse52" aria-expanded="true" aria-controls="collapse52">Countermeasure: Create alerts for VPC route table changes <span>[AZ-M07]</span></button></h5></div><div id="collapse52" class="collapse" aria-labelledby="heading52" data-parent="#controls"><div class="card-body"><div>
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the changes in
                        the VPC route tables to the correspondent personnel. It's vital that these unauthorized changes
                        are detected.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        VPC route table provides a means of routing network traffic between subnets and via gateways and
                        ensures traffic flows via the correct path. Therefore alerting on changes to route tables
                        ensuring the traffic continues to flow as expected.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to &quot;Monitor&quot; and then to &quot;Alerts&quot;.</li>
                        <li>Push &quot;Add activity log alert&quot;.</li>
                        <li>Filling the fields with the corresponding values.</li>
                        <li>Select in actions the personnel should be received this information.</li>
                        </ol>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading53"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse53" aria-expanded="true" aria-controls="collapse53">Countermeasure: Create alerts for VPC gateway changes <span>[AZ-M08]</span></button></h5></div><div id="collapse53" class="collapse" aria-labelledby="heading53" data-parent="#controls"><div class="card-body"><div>
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the changes in
                        the VPC gateway tables to the correspondent personnel. It's vital that these unauthorized
                        changes are detected.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        &nbsp;VPC gateways are used as a means of sending traffic outside of VPC (ie to the
                        internet) and are vital in ensuring traffic flows to correct destination. Therefore alerting on
                        changes to VPC gateways ensuring traffic continues to flow as expected via the correct gateway.&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to &quot;Monitor&quot; and then to &quot;Alerts&quot;.</li>
                        <li>Push &quot;Add activity log alert&quot;.</li>
                        <li>Filling the fields with the corresponding values.</li>
                        <li>Select in actions the personnel should be received this information.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading63"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse63" aria-expanded="true" aria-controls="collapse63">Risk pattern: Azure Networking VNets <span>[AZURE-NETWORKING-VNETS]</span></button></h5></div><div id="collapse63" class="collapse" aria-labelledby="heading63" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading62"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse62" aria-expanded="true" aria-controls="collapse62">Use case: Networking <span>[NETWORKING]</span></button></h5></div><div id="collapse62" class="collapse" aria-labelledby="heading62" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading61"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse61" aria-expanded="true" aria-controls="collapse61">Threat: Attackers gain unauthorized connection to the resources <span>[UNAUTHORIZED-CONNECTION]</span></button></h5></div><div id="collapse61" class="collapse" aria-labelledby="heading61" data-parent="#threats"><div class="card-body"><div>
                                Attackers could gain unauthorized connection to the resources through misconfigured
                                ports or security network configurations.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading60"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse60" aria-expanded="true" aria-controls="collapse60">Weakness: Networks for Azure resources are not properly segmentated. <span>[AZURE-VNET01]</span></button></h5></div><div id="collapse60" class="collapse" aria-labelledby="heading60" data-parent="#weaknesses"><div class="card-body"><div>
                        Resources in the same VNet are compromised because when one of them is attacked and the
                        attackers gain access, they also gain access to all resources.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading58"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse58" aria-expanded="true" aria-controls="collapse58">Countermeasure: Isolate Azure resources into separate VNets by function <span>[AZ-N08]</span></button></h5></div><div id="collapse58" class="collapse" aria-labelledby="heading58" data-parent="#controls"><div class="card-body"><div>
                        Place the resources into separate VNets according to their use (production, development, test).
                        Placing such resources accordingly ensures that a resource of a higher security level is not
                        exposed by the security settings of a lower labeled VNet.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        <ol>
                        <li>Identify the resources that exist in an incorrect VNet.</li>
                        <li>Migrate or move it to the correct Vnet.</li>
                        </ol>
                        </div>
                        <div>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading59"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse59" aria-expanded="true" aria-controls="collapse59">Countermeasure: Isolate Azure instances into different VNets <span>[AZ-N09]</span></button></h5></div><div id="collapse59" class="collapse" aria-labelledby="heading59" data-parent="#controls"><div class="card-body"><div>
                        Specify a VNet for the Azure instance as a launch parameter. Applications that run on the Cloud
                        instance can use the VNet security configuration when they access Azure resources.&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        You can configure an Azure cloud service from Solution Explorer in Visual Studio.
                        </div>
                        <div>
                        <div>
                        </div>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading78"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse78" aria-expanded="true" aria-controls="collapse78">Risk pattern: Azure SQL <span>[AZURE-SQL]</span></button></h5></div><div id="collapse78" class="collapse" aria-labelledby="heading78" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading67"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse67" aria-expanded="true" aria-controls="collapse67">Use case: Access Data <span>[ACCESS DATA]</span></button></h5></div><div id="collapse67" class="collapse" aria-labelledby="heading67" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading66"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse66" aria-expanded="true" aria-controls="collapse66">Threat: Sensitive data is compromised through unauthorized access to SQL databases <span>[ACCESS-TO-DATA]</span></button></h5></div><div id="collapse66" class="collapse" aria-labelledby="heading66" data-parent="#threats"><div class="card-body">Attackers gain unauthorized connection to the SQL database resources through
                                misconfigured ports or security network configurations.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading65"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse65" aria-expanded="true" aria-controls="collapse65">Weakness: Sensitive data is accessible <span>[AZURE-ACCESS-DATA-01]</span></button></h5></div><div id="collapse65" class="collapse" aria-labelledby="heading65" data-parent="#weaknesses"><div class="card-body">Sensitive data is not encrypted and could be exposed.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading64"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse64" aria-expanded="true" aria-controls="collapse64">Countermeasure: Enable Transparent Data Encryption (TDE) for the SQL database <span>[AZ-Q03]</span></button></h5></div><div id="collapse64" class="collapse" aria-labelledby="heading64" data-parent="#controls"><div class="card-body"><div>
                        Enable the Azure SQL Database transparent data encryption (TDE) and encrypt automatically your
                        data at rest, without requiring any changes to the application accessing the encrypted database.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Select SQL databases from the left-hand menu, and click your database on the SQL
                        databases page.</li>
                        <li>Click on Transparent data encryption to open the configuration page for TDE.</li>
                        <li>Set Data encryption to ON and click Save.</li>
                        </ol>
                        </div>
                        <div>
                        <ol>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading72"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse72" aria-expanded="true" aria-controls="collapse72">Use case: API Logging and Auditing <span>[API LOGGING AND AUDITING]</span></button></h5></div><div id="collapse72" class="collapse" aria-labelledby="heading72" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading71"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse71" aria-expanded="true" aria-controls="collapse71">Threat: Attackers make undetected and unaudited changes to system configurations <span>[UNAUDITABLE-CHANGES-AZURE]</span></button></h5></div><div id="collapse71" class="collapse" aria-labelledby="heading71" data-parent="#threats"><div class="card-body">If audit trails are not properly protected, an attacker could gain access to the
                                system, modify the status of resources or exfiltrate sensitive data without being
                                noticed.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading70"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse70" aria-expanded="true" aria-controls="collapse70">Weakness: Undetected changes in the SQL database information and configuration <span>[AZURE-LOGS01]</span></button></h5></div><div id="collapse70" class="collapse" aria-labelledby="heading70" data-parent="#weaknesses"><div class="card-body"><div>
                        The changes in the SQL database information and configuration are not detected and audited, due
                        of the Azure mechanisms to notify the changes are disabled.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading68"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse68" aria-expanded="true" aria-controls="collapse68">Countermeasure: Enable SQL Database auditing <span>[AZ-Q04]</span></button></h5></div><div id="collapse68" class="collapse" aria-labelledby="heading68" data-parent="#controls"><div class="card-body"><div>
                        Enable Azure SQL Database Auditing to audit the database events into the audit log in your Azure
                        Storage account. Auditing can help you maintain regulatory compliance, understand database
                        activity, and gain insight into discrepancies and anomalies that could indicate potential
                        security violations.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Select SQL databases from the left-hand menu, and click your database on the SQL
                        databases page.</li>
                        <li>In the Settings blade, select Auditing &amp; Threat Detection.</li>
                        <li>In the database auditing configuration blade, you can check the Inherit settings from
                        server checkbox to designate that this database will be audited according to its server's
                        settings. If this option is checked, you will see a View server auditing settings link that
                        allows you to view or modify the server auditing settings from this context.</li>
                        <li>If you prefer to enable an Audit type (or location?) different from the one specified
                        at the server level, uncheck the Inherit Auditing settings from server option, turn ON Auditing,
                        and choose the Blob Auditing Type.</li>
                        <li>Select Storage Details to open the Audit Logs Storage Blade. Select the Azure storage
                        account where logs will be saved, and the retention period, after which the old logs will be
                        deleted, then click OK at the bottom. Tip: Use the same storage account for all audited
                        databases to get the most out of the auditing reports templates.</li>
                        <li>If you want to customize the audited events, you can do this via PowerShell or REST
                        API - see the Automation (PowerShell / REST API) section for more details.</li>
                        <li>Click Save.</li>
                        </ol>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading69"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse69" aria-expanded="true" aria-controls="collapse69">Countermeasure: Enable SQL Database threat detection <span>[AZ-Q05]</span></button></h5></div><div id="collapse69" class="collapse" aria-labelledby="heading69" data-parent="#controls"><div class="card-body"><div>
                        Enable SQL Database Threat Detection to provide a new layer of security, which enables customers
                        to detect and respond to potential threats as they occur by providing security alerts on
                        anomalous activities. Users can explore the suspicious events using SQL Database Auditing to
                        determine if the results from an attempt to access, breach or exploit data in the database.
                        Threat Detection makes it simple to address potential threats to the database without the need
                        to be a security expert or manage advanced security monitoring systems. For example, Threat
                        Detection detects certain anomalous database activities indicating potential SQL injection
                        attempts. SQL injection is one of the common Web application security issues on the Internet,
                        used to attack data-driven applications. Attackers take advantage of application vulnerabilities
                        to inject malicious SQL statements into application entry fields, for breaching or modifying
                        data in the database.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Navigate to the configuration blade of the SQL database you want to monitor. In the
                        Settings blade, select Auditing &amp; Threat Detection.</li>
                        <li>In the Auditing &amp; Threat Detection configuration blade turn ON auditing, which
                        will display the threat detection settings.</li>
                        <li>Turn ON threat detection.</li>
                        <li>Configure the list of emails that will receive security alerts upon detection of
                        anomalous database activities.</li>
                        <li>Click Save in the Auditing &amp; Threat detection blade to save the new or updated
                        auditing and threat detection policy.</li>
                        <li>In the email, click on the Azure SQL Auditing Log link, which will launch the Azure
                        portal and show the relevant auditing records around the time of the suspicious event.</li>
                        <li>Click on the audit records to view more details on the suspicious database activities
                        such as SQL statement, failure reason, and client IP.</li>
                        <li>In the Auditing Records blade, click Open in Excel to open a pre-configured excel
                        template to import and run a deeper analysis of the audit log around the time of the suspicious
                        event.</li>
                        <li>To configure the Fast Combine setting - In the POWER QUERY ribbon tab, select Options
                        to display the Options dialog. Select the Privacy section and choose the second option - 'Ignore
                        the Privacy Levels and potentially improve performance'.</li>
                        <li>To load SQL audit logs, ensure that the parameters in the settings tab are set
                        correctly and then select the 'Data' ribbon and click the 'Refresh All' button.</li>
                        <li>The results appear in the SQL Audit Logs sheet which enables you to run a deeper
                        analysis of the anomalous activities that were detected, and mitigate the impact of the security
                        event in your application.&quot;</li>
                        </ol>
                        </div>
                        <div>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading77"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse77" aria-expanded="true" aria-controls="collapse77">Use case: Networking <span>[NETWORKING]</span></button></h5></div><div id="collapse77" class="collapse" aria-labelledby="heading77" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading76"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse76" aria-expanded="true" aria-controls="collapse76">Threat: Sensitive data is compromised by unauthorized access to Virtual Machines <span>[UNAUTHORIZED-CONNECTION]</span></button></h5></div><div id="collapse76" class="collapse" aria-labelledby="heading76" data-parent="#threats"><div class="card-body"><div>
                                Attackers can gain unauthorized connection to the Virtual Machines through misconfigured
                                ports or security network configurations.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading75"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse75" aria-expanded="true" aria-controls="collapse75">Weakness: Unauthorised connection between the client and the SQL database <span>[AZURE-NET-21]</span></button></h5></div><div id="collapse75" class="collapse" aria-labelledby="heading75" data-parent="#weaknesses"><div class="card-body"><div>
                        All connections to SQL Database are allowed and the firewall and other security networks methods
                        are not configured to deny the connections.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading73"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse73" aria-expanded="true" aria-controls="collapse73">Countermeasure: Restrict network access to the database <span>[AZ-Q01]</span></button></h5></div><div id="collapse73" class="collapse" aria-labelledby="heading73" data-parent="#controls"><div class="card-body"><div>
                        Set up the firewall rules for the SQL databases in Azure. By default, all connections to the
                        server and the databases inside the server are rejected except for connections from other Azure
                        services. Set the secure configuration 'Allow access to Azure services' to OFF. To connect to
                        the database from an Azure VM or cloud service, create a Reserved IP and allow only the reserved
                        IP address access through the firewall.
                        </div>
                        <div>
                        <b><br /></b>
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Log in to the Azure portal.</li>
                        <li>Click SQL databases from the left-hand menu and click the database you would like to
                        configure the firewall rule for on the SQL databases page. The overview page for your database
                        opens, showing you the fully qualified server name (such as
                        mynewserver-20170313.database.windows.net) and provides options for further configuration.</li>
                        <li>Click Set server firewall on the toolbar as shown in the previous image. The Firewall
                        settings page for the SQL Database server opens.</li>
                        <li>Click Add client IP on the toolbar to add the public IP address of the computer
                        connected to the portal with or enter the firewall rule manually and then click Save.</li>
                        <li>Click OK and then click the X to close the Firewall settings page.</li>
                        </ol>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading74"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse74" aria-expanded="true" aria-controls="collapse74">Countermeasure: Encrypt the communication channel to your database <span>[AZ-Q02]</span></button></h5></div><div id="collapse74" class="collapse" aria-labelledby="heading74" data-parent="#controls"><div class="card-body"><div>
                        Configure and encrypt the string connection between the client and SQL Database with the
                        following configuration:&nbsp;
                        </div>
                        <div>
                        <ul>
                        <li>request an encrypted connection&nbsp;</li>
                        <li>to not trust the server certificate</li>
                        </ul>
                        </div>
                        <div>
                        This established connection usesTransport Layer Security (TLS) and reduces the risk of
                        man-in-the-middle attacks. Obtain the correctly configured connection strings for your SQL
                        Database for supported client drivers from the Azure portal as shown for ADO.net in this
                        screenshot.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Select SQL databases from the left-hand menu, and click your database on the SQL
                        databases page.</li>
                        <li>On the Overview page for your database, click Show database connection strings.</li>
                        <li>Review the complete ADO.NET connection string.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading87"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse87" aria-expanded="true" aria-controls="collapse87">Risk pattern: Azure Storage <span>[AZURE-STORAGE]</span></button></h5></div><div id="collapse87" class="collapse" aria-labelledby="heading87" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading82"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse82" aria-expanded="true" aria-controls="collapse82">Use case: Access Data <span>[ACCESS DATA]</span></button></h5></div><div id="collapse82" class="collapse" aria-labelledby="heading82" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading81"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse81" aria-expanded="true" aria-controls="collapse81">Threat: Sensitive data is compromised  thorough unauthorized access to data storage <span>[ACCESS-TO-DATA]</span></button></h5></div><div id="collapse81" class="collapse" aria-labelledby="heading81" data-parent="#threats"><div class="card-body"><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading80"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse80" aria-expanded="true" aria-controls="collapse80">Weakness: Sensitive data are accessible <span>[AZURE-ACCESS-DATA-01]</span></button></h5></div><div id="collapse80" class="collapse" aria-labelledby="heading80" data-parent="#weaknesses"><div class="card-body">Sensitive data are not encrypted and the sensitive data is exposed.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading79"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse79" aria-expanded="true" aria-controls="collapse79">Countermeasure: Enable the Storage Service Encryption (SSE) for data at Rest <span>[AZ-S01]</span></button></h5></div><div id="collapse79" class="collapse" aria-labelledby="heading79" data-parent="#controls"><div class="card-body"><div>
                        Enable Azure Storage Service Encryption (SSE) for Data at Rest to protect and safeguard the
                        data. With this feature, Azure Storage automatically encrypts the data prior to persisting to
                        storage and decrypts prior to retrieval. The encryption, decryption, and key management are
                        totally transparent to users.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Log into the Azure portal and select a storage account. On the Settings blade, look
                        for the Blob Service section as shown in this screenshot and click Encryption.</li>
                        <li>After you click the Encryption setting, you can enable or disable Storage Service
                        Encryption.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading86"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse86" aria-expanded="true" aria-controls="collapse86">Use case: API Logging and Auditing <span>[API LOGGING AND AUDITING]</span></button></h5></div><div id="collapse86" class="collapse" aria-labelledby="heading86" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading85"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse85" aria-expanded="true" aria-controls="collapse85">Threat: Attackers make undetected and unaudited changes to system configurations <span>[UNAUDITABLE-CHANGES-AZURE]</span></button></h5></div><div id="collapse85" class="collapse" aria-labelledby="heading85" data-parent="#threats"><div class="card-body">If audit trails are not properly protected, an attacker could gain access to the
                                system, modify the status of resources or exfiltrate sensitive data without being
                                noticed.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading84"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse84" aria-expanded="true" aria-controls="collapse84">Weakness: Unaudited resources changes <span>[AZURE-LOGS01]</span></button></h5></div><div id="collapse84" class="collapse" aria-labelledby="heading84" data-parent="#weaknesses"><div class="card-body"><div>
                        The Diagnostic Logs are not activated and not configured. Changes in the applications and in the
                        data bases could not be detected and audited.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading83"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse83" aria-expanded="true" aria-controls="collapse83">Countermeasure: Enable Azure Storage metrics <span>[AZ-S02]</span></button></h5></div><div id="collapse83" class="collapse" aria-labelledby="heading83" data-parent="#controls"><div class="card-body"><div>
                        Enable Storage Metrics to configure the monitoring alerts via the Azure portal or Windows
                        PowerShell, or programmatically via one of the storage client libraries. Configure a retention
                        period for the metrics data: this period determines for how long the storage service keeps the
                        metrics and charges you for the space required to store them.&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Navigate to your storage account.</li>
                        <li>Select Diagnostics on the Menu blade.</li>
                        <li>Ensure that Status is set to On.</li>
                        <li>Select the metrics for the services you wish to monitor.</li>
                        <li>Specify a retention policy to indicate how long to retain metrics and log data.</li>
                        <li>Select Save.</li>
                        </ol>
                        </div>
                        <div>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading117"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse117" aria-expanded="true" aria-controls="collapse117">Risk pattern: Azure Virtual Machines <span>[AZURE-VIRTUAL-MACHINES]</span></button></h5></div><div id="collapse117" class="collapse" aria-labelledby="heading117" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading91"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse91" aria-expanded="true" aria-controls="collapse91">Use case: Activity Logs alerts <span>[ACTIVITY LOGS ALERTS]</span></button></h5></div><div id="collapse91" class="collapse" aria-labelledby="heading91" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading90"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse90" aria-expanded="true" aria-controls="collapse90">Threat: Attackers gain undetected access to the system by changing Virtual Machine configurations  <span>[UNAUTHORIZED-ACCESS-VIRTUAL-MACHINES]</span></button></h5></div><div id="collapse90" class="collapse" aria-labelledby="heading90" data-parent="#threats"><div class="card-body">Attackers can gain undetected access to the virtual machine configurations and the
                                changes of the attackers couldn't be audited or detected.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading89"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse89" aria-expanded="true" aria-controls="collapse89">Weakness: Undetected changes in Virtual Machine configurations <span>[AZURE-VM02]</span></button></h5></div><div id="collapse89" class="collapse" aria-labelledby="heading89" data-parent="#weaknesses"><div class="card-body">The changes in virtual machines configurations are not detected because the monitorization and
                        alerts of the security configuration are not configured.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading88"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse88" aria-expanded="true" aria-controls="collapse88">Countermeasure: Create alerts for Virtual Machines <span>[AZ-V03]</span></button></h5></div><div id="collapse88" class="collapse" aria-labelledby="heading88" data-parent="#controls"><div class="card-body"><div>
                        Create alerts based on specific performance metrics:
                        </div>
                        <div>
                        <ol>
                        <li>Notify to the correspondent personnel when the average CPU usage exceeds a certain
                        threshold.</li>
                        <li>Notify to the correspondent personnel when the available free disk space drops below a
                        certain amount,</li>
                        <li>Notify to the correspondent personnel when the security configuration of the Virtual
                        Machines changes.</li>
                        </ol>
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>In the Azure portal, click Resource Groups, select myResourceGroup, and then select
                        myVM in the resource list.</li>
                        <li>Click Alert rules on the VM blade, then click Add metric alert across the top of the
                        alerts blade.</li>
                        <li>Provide a Name for your alert, such as myAlertRule</li>
                        <li>To trigger an alert when CPU percentage exceeds 1.0 for five minutes, leave all the
                        other defaults selected.</li>
                        <li>Optionally, check the box for Email owners, contributors, and readers to send an email
                        notification. The default action is to present a notification in the portal.</li>
                        <li>Click the OK button.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading95"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse95" aria-expanded="true" aria-controls="collapse95">Use case: API Logging and Auditing <span>[API LOGGING AND AUDITING]</span></button></h5></div><div id="collapse95" class="collapse" aria-labelledby="heading95" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading94"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse94" aria-expanded="true" aria-controls="collapse94">Threat: Attackers make undetected and unaudited changes to system configurations <span>[UNAUDITABLE-CHANGES-AZURE]</span></button></h5></div><div id="collapse94" class="collapse" aria-labelledby="heading94" data-parent="#threats"><div class="card-body">If audit trails are not properly protected, an attacker could gain access to the
                                system, modify the status of resources or exfiltrate sensitive data without being
                                noticed.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading93"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse93" aria-expanded="true" aria-controls="collapse93">Weakness: Undetected changes in audit logs <span>[AZURE-LOGS03]</span></button></h5></div><div id="collapse93" class="collapse" aria-labelledby="heading93" data-parent="#weaknesses"><div class="card-body">Changes in audit logs are not detected. Therefore, audit logs should be exported each a
                        determinate number of days to another place. The exporting of the audit files can help to fix
                        security fails when these logs are analyzed.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading92"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse92" aria-expanded="true" aria-controls="collapse92">Countermeasure: Set up data collection <span>[AZ-V01]</span></button></h5></div><div id="collapse92" class="collapse" aria-labelledby="heading92" data-parent="#controls"><div class="card-body"><div>
                        Set up the Security Center Data Collection to create an Azure storage account to hold the
                        collected data.&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>On the Security Center dashboard, click Security policy, and then select your
                        subscription.</li>
                        <li>For Data collection, select On.</li>
                        <li>To create a storage account, select Choose a storage account. Then, select OK.</li>
                        <li>On the Security Policy blade, select Save.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading99"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse99" aria-expanded="true" aria-controls="collapse99">Use case: General <span>[GENERAL]</span></button></h5></div><div id="collapse99" class="collapse" aria-labelledby="heading99" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading98"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse98" aria-expanded="true" aria-controls="collapse98">Threat: Attackers gain access to the system by exploiting weak security configurations <span>[UNCONFIGURED-SECURITY]</span></button></h5></div><div id="collapse98" class="collapse" aria-labelledby="heading98" data-parent="#threats"><div class="card-body"><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading97"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse97" aria-expanded="true" aria-controls="collapse97">Weakness: Exposed security policies for the resources <span>[AZURE-VM01]</span></button></h5></div><div id="collapse97" class="collapse" aria-labelledby="heading97" data-parent="#weaknesses"><div class="card-body">The security policies are not configured and the security configurations are exposed for the
                        attackers.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading96"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse96" aria-expanded="true" aria-controls="collapse96">Countermeasure: Set up the security policy <span>[AZ-V02]</span></button></h5></div><div id="collapse96" class="collapse" aria-labelledby="heading96" data-parent="#controls"><div class="card-body"><div>
                        Set up the security policies to define the items for which Security Center collects data and
                        makes recommendations. Apply different security policies to different sets of Azure resources.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>On the Security Center dashboard, select Security policy, and then select your
                        subscription.</li>
                        <li>Select Prevention policy.</li>
                        <li>Turn on or turn off policy items that you want to apply to all Azure resources.</li>
                        <li>When you're finished selecting your settings, select OK.</li>
                        <li>On the Security policy blade, select Save.</li>
                        </ol>
                        </div>
                        <div>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading112"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse112" aria-expanded="true" aria-controls="collapse112">Use case: Networking <span>[NETWORKING]</span></button></h5></div><div id="collapse112" class="collapse" aria-labelledby="heading112" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading111"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse111" aria-expanded="true" aria-controls="collapse111">Threat: Attackers gain access to the system through direct access to Virtual Machines <span>[UNAUTHORISED-CONNECTION]</span></button></h5></div><div id="collapse111" class="collapse" aria-labelledby="heading111" data-parent="#threats"><div class="card-body"><div>
                                Attackers can gain unauthorized connection to the Virtual Machines through misconfigured
                                ports or security network configurations.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading101"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse101" aria-expanded="true" aria-controls="collapse101">Weakness: Communication is not allowed from/to Virtual Machines <span>[AZURE-NET-05]</span></button></h5></div><div id="collapse101" class="collapse" aria-labelledby="heading101" data-parent="#weaknesses"><div class="card-body">IP allocation of virtual machines, DNS resolution, and node monitorization is performed by a
                        Microsoft host node. It is necessary to allow the communication with this virtual IP to be able
                        to make the communication from/to the virtual machine of Azure.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading100"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse100" aria-expanded="true" aria-controls="collapse100">Countermeasure: Allow Virtual IP of the Microsoft host node <span>[AZ-N05]</span></button></h5></div><div id="collapse100" class="collapse" aria-labelledby="heading100" data-parent="#controls"><div class="card-body"><div>
                        Allow inbound accesses in Network Security Groups from the IP address 168.63.129.16 to
                        communicate with the Azure Service. This IP belongs to Microsoft and acts as DHCP server, DNS
                        server and monitoring the host node hosting the Azure Virtual Machine.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        <ol>
                        <li>Log into the Azure portal as an owner.</li>
                        <li>Select Network Security Groups.</li>
                        <li>Choose the NSG to edit (or create a new one).</li>
                        <li>In &quot;Inbound security rules&quot;: Allow IP 168.63.129.16 inbound traffic.</li>
                        </ol>
                        </div>
                        <div>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading103"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse103" aria-expanded="true" aria-controls="collapse103">Weakness: Unauthorised connection attempts on Azure resources <span>[AZURE-NET-04]</span></button></h5></div><div id="collapse103" class="collapse" aria-labelledby="heading103" data-parent="#weaknesses"><div class="card-body">Receiving unauthorized connections to Azure resources is most likely to be receiving an
                        attack. To avoid this, access to the network must be as restricted as possible using Network
                        Access Control Lists for blacklisting.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading102"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse102" aria-expanded="true" aria-controls="collapse102">Countermeasure: Use Network Access Control Lists (NACLs) for blacklisting <span>[AZ-N07]</span></button></h5></div><div id="collapse102" class="collapse" aria-labelledby="heading102" data-parent="#controls"><div class="card-body"><div>
                        Use Network Access Control Lists (NACLs) as a method of blacklisting IP addresses to filters the
                        traffic across endpoints to allow or deny traffic per pre-created rules.&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation: &nbsp;</b>
                        </div>
                        <div>
                        <ol>
                        <li>Log into the Azure portal as an owner.</li>
                        <li>Select &quot;Network security groups&quot;.</li>
                        <li>Select the Network Security Group (NSG) for your virtual machine and click on &quot;Inbound
                        security rules&quot;.</li>
                        <li>Add a DENY rule that will restrict inbound access from a blacklisted IP address or
                        range to a designated port or port range.</li>
                        </ol>
                        </div>
                        <ol>
                        <ul>
                        </ul>
                        </ol>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading106"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse106" aria-expanded="true" aria-controls="collapse106">Weakness: Unauthorised connection attempts on open ports <span>[AZURE-NET-01]</span></button></h5></div><div id="collapse106" class="collapse" aria-labelledby="heading106" data-parent="#weaknesses"><div class="card-body"><div>
                        Receiving unauthorized connections to open ports is most likely to be receiving an attack. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading104"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse104" aria-expanded="true" aria-controls="collapse104">Countermeasure: Set Network Security Groups to be as restrictive as possible <span>[AZ-N01]</span></button></h5></div><div id="collapse104" class="collapse" aria-labelledby="heading104" data-parent="#controls"><div class="card-body"><div>
                        Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
                        resources. Set the limit all the traffic (ingress/egress) on the NSG in order to force the use
                        of least privilege into the NSG.&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        <ol>
                        <li>Identify Azure resources for each NSG.</li>
                        <li>Create a set of least privilege NSG for those resources.</li>
                        <li>Place the resources in those security groups.</li>
                        <li>Change the inbound/outbound security rules to fulfill the least privilege.</li>
                        </ol>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading105"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse105" aria-expanded="true" aria-controls="collapse105">Countermeasure: Use Network Security Groups to block inbound port traffic from 0.0.0.0/0 <span>[AZ-N02]</span></button></h5></div><div id="collapse105" class="collapse" aria-labelledby="heading105" data-parent="#controls"><div class="card-body"><div>
                        Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
                        resources. Set the limit inbound access to all TCP or all ports to avoid undue exposure to risk.&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        <ol>
                        <li>Log into the Azure portal as an owner.</li>
                        <li>Select Network Security Groups.</li>
                        <li>Choose the NSG to edit (or create a new one).</li>
                        <li>In &quot;Inbound security rules&quot;:</li>
                        </ol>
                        <ul>
                        <ul>
                        <li>Remove all rules that allow port traffic.</li>
                        <li>Add a rule to deny port traffic</li>
                        </ul>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading108"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse108" aria-expanded="true" aria-controls="collapse108">Weakness: Unauthorised connection attempts on port 22 <span>[AZURE-NET-02]</span></button></h5></div><div id="collapse108" class="collapse" aria-labelledby="heading108" data-parent="#weaknesses"><div class="card-body">Receiving unauthorized connections to port 22 is most likely to be receiving an SSH attack. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading107"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse107" aria-expanded="true" aria-controls="collapse107">Countermeasure: Use Network Security Groups to block ingress to port 22 from 0.0.0.0/0 <span>[AZ-N04]</span></button></h5></div><div id="collapse107" class="collapse" aria-labelledby="heading107" data-parent="#controls"><div class="card-body"><div>
                        Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
                        resources. Set the limit inbound access to port 22 (Secure Desk) to IP addresses that require
                        this access to avoid undue exposure to risk.&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>&nbsp;
                        </div>
                        <div>
                        <ol>
                        <li>Log into the Azure portal as an owner.</li>
                        <li>Select Network Security Groups.</li>
                        <li>Choose the NSG to edit (or create a new one).</li>
                        <li>In &quot;Inbound security rules&quot;:</li>
                        </ol>
                        </div>
                        <div>
                        <ul>
                        <ul>
                        <li>Allow SSH port traffic just to/from IPs that require the access.</li>
                        <li>Otherwise, remove all rules that allow port 22 traffic.</li>
                        </ul>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading110"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse110" aria-expanded="true" aria-controls="collapse110">Weakness: Unauthorised connection attempts on port 3389 <span>[AZURE-NET-03]</span></button></h5></div><div id="collapse110" class="collapse" aria-labelledby="heading110" data-parent="#weaknesses"><div class="card-body">Receiving unauthorized connections to port 3389 is most likely to be receiving an RDP attack.
                        To avoid this, access to the network must be as restricted as possible, so that only the
                        necessary ports are open and the minimum inbound traffic is accepted.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading109"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse109" aria-expanded="true" aria-controls="collapse109">Countermeasure: Use Network Security Groups to block ingress to port 3389 from 0.0.0.0/0 <span>[AZ-N03]</span></button></h5></div><div id="collapse109" class="collapse" aria-labelledby="heading109" data-parent="#controls"><div class="card-body"><div>
                        Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
                        resources. Set the limit inbound access to port 3389 (Remote Desk Protocol) to IP addresses that
                        require this access to avoid undue exposure to risk.&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        <ol>
                        <li>Log into the Azure portal as an owner.</li>
                        <li>Select Network Security Groups.</li>
                        <li>Choose the NSG to edit (or create a new one).</li>
                        <li>In &quot;Inbound security rules&quot;:</li>
                        </ol>
                        </div>
                        <div>
                        <ul>
                        <ul>
                        <li>Allow RDP port traffic just to/from IPs that require the access.</li>
                        <li>Otherwise, remove all rules that allow port 3389 traffic.</li>
                        </ul>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading116"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse116" aria-expanded="true" aria-controls="collapse116">Use case: Patching <span>[PATCHING]</span></button></h5></div><div id="collapse116" class="collapse" aria-labelledby="heading116" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading115"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse115" aria-expanded="true" aria-controls="collapse115">Threat: Attackers gain access to the system exploiting a known vulnerability <span>[UNAUTHZ-SERVICES-NOT-UPDATE]</span></button></h5></div><div id="collapse115" class="collapse" aria-labelledby="heading115" data-parent="#threats"><div class="card-body">Attackers can gain access to the systems because the security patches for each system
                                have not been applied or the licenses of the products have expired.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading114"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse114" aria-expanded="true" aria-controls="collapse114">Weakness: Unlicensed Virtual Machines <span>[AZURE-VM-NOT_LICENSE]</span></button></h5></div><div id="collapse114" class="collapse" aria-labelledby="heading114" data-parent="#weaknesses"><div class="card-body">Azure is a system formed by Microsoft machines, therefore, it is necessary that Microsoft
                        perform periodic verification of the licenses of the products.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading113"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse113" aria-expanded="true" aria-controls="collapse113">Countermeasure: Allow Key Management Service request <span>[AZ-N06]</span></button></h5></div><div id="collapse113" class="collapse" aria-labelledby="heading113" data-parent="#controls"><div class="card-body"><div>
                        Allow Key Management Service host server to handle the periodic request to ensure Microsoft
                        licensing. Set the limit outbound access to port 1688 (Service Request) in the Network Security
                        Groups to avoid undue exposure to risk.&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        <ol>
                        <li>Log into the Azure portal as an owner.</li>
                        <li>Select Network Security Groups.</li>
                        <li>Choose the NSG to edit (or create a new one).</li>
                        <li>In &quot;Outbound security rules&quot;: Allow port 1688 outbound traffic.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>