<!DOCTYPE html><html><head><title>Risk Patterns for CS-Default.xml</title><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous"><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script></head><body><center><h2>Risk patterns for CS-Default.xml<h2></center><div class="accordion" id="components"><div class="card border-primary"><div class="card-header " id="heading5"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse5" aria-expanded="true" aria-controls="collapse5">Risk pattern: 3rd Party Libraries <span>[EXT-LIBRARIES]</span></button></h5></div><div id="collapse5" class="collapse" aria-labelledby="heading5" data-parent="#components"><div class="card-body">External libraries used by both client and server side components.<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading4"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse4" aria-expanded="true" aria-controls="collapse4">Use case: General <span>[GENERAL]</span></button></h5></div><div id="collapse4" class="collapse" aria-labelledby="heading4" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading3"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse3" aria-expanded="true" aria-controls="collapse3">Threat: Attackers gain unauthorised access to data or services by exploiting weaknesses in third party libraries <span>[CWE-937]</span></button></h5></div><div id="collapse3" class="collapse" aria-labelledby="heading3" data-parent="#threats"><div class="card-body">Applications typically make extensive use of 3rd party libraries to provide common
                                functions. Attackers could target vulnerabilities in these libraries in order to gain
                                unauthorized access to data or services.&nbsp;
                                <div>
                                <br />
                                <div>
                                Since the use of particular libraries and even versions of those libraries can often be
                                determined remotely, attackers can sometimes employ automated scanning tools to identify
                                vulnerable software. This increases the likelihood of attack.
                                </div>
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading2"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse2" aria-expanded="true" aria-controls="collapse2">Weakness: Third party libraries contain security weaknesses <span>[CWE-937]</span></button></h5></div><div id="collapse2" class="collapse" aria-labelledby="heading2" data-parent="#weaknesses"><div class="card-body">In theory, it ought to be easy to figure out if you are currently using any vulnerable
                        components or libraries. Unfortunately, vulnerability reports for commercial or open source
                        software do not always specify exactly which versions of a component are vulnerable in a
                        standard, searchable way. Further, not all libraries use an understandable version numbering
                        system. Worst of all, not all vulnerabilities are reported to a central clearinghouse that is
                        easy to search, although sites like CVE and NVD are becoming easier to search.&nbsp;
                        <div>
                        &nbsp;
                        <br />Determining if you are vulnerable requires searching these databases, as well as
                        keeping abreast of project mailing lists and announcements for anything that might be a
                        vulnerability. If one of your components does have a vulnerability, you should carefully
                        evaluate whether you are actually vulnerable by checking to see if your code uses the part of
                        the component with the vulnerability and whether the flaw could result in an impact you care
                        about.&nbsp;
                        </div>
                        <div>
                        &nbsp;
                        <br />Component vulnerabilities can cause almost any type of risk imaginable, ranging from
                        the trivial to sophisticated malware designed to target a specific organization. Components
                        almost always run with the full privilege of the application, so flaws in any component can be
                        serious.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading0"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse0" aria-expanded="true" aria-controls="collapse0">Countermeasure: Regularly check for known vulnerabilities in the dependencies of your project <span>[CWE-937]</span></button></h5></div><div id="collapse0" class="collapse" aria-labelledby="heading0" data-parent="#controls"><div class="card-body"><div>
                        Vulnerabilities in common popular and shared libraries are published and recorded in a number of
                        online databases and services, including the MITRE CVE and CWE databases.
                        </div>
                        <div>
                        <ul>
                        <li>Perform regular checks for published vulnerabilities in third party components and the
                        IDE.</li>
                        <li>Test and apply appropriate recommended patches and mitigations.</li>
                        <li>Use subscription threat intelligence and alerting services to ensure timely
                        notification of possible threats</li>
                        <li>Use automated vulnerability scanning tools to identify and test for security threats
                        to the project.</li>
                        </ul>
                        </div>
                        <ul>
                        </ul>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading1"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse1" aria-expanded="true" aria-controls="collapse1">Countermeasure: Apply required security patches <span>[PATCH-SERVER]</span></button></h5></div><div id="collapse1" class="collapse" aria-labelledby="heading1" data-parent="#controls"><div class="card-body"><div>
                        Vendors and other maintainers of software release patches in response to security flaws and
                        other bugs in their products.
                        </div>
                        <div>
                        <ul>
                        <li>Apply patches and other software updates in a timely manner to prevent unexpected
                        failures or exploitation.</li>
                        <li>Clearly define an approach for testing and applying patches, in particular security
                        patches, with expected timescales. &nbsp;There is often a small window between release of a
                        patch, and potentially malicious actors reverse-engineering the patch to identify and exploit
                        the flaw.</li>
                        <li>Use a threat intelligence, vulnerability scanning, or other alerting service to ensure
                        the project team is aware of issues within the project or its components promptly.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading7"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse7" aria-expanded="true" aria-controls="collapse7">Risk pattern: Empty Pattern <span>[empty-pattern]</span></button></h5></div><div id="collapse7" class="collapse" aria-labelledby="heading7" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading6"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse6" aria-expanded="true" aria-controls="collapse6">Use case: General <span>[general]</span></button></h5></div><div id="collapse6" class="collapse" aria-labelledby="heading6" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading12"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse12" aria-expanded="true" aria-controls="collapse12">Risk pattern: 3rd Party Web Libraries <span>[3rd-partly-web-libraries]</span></button></h5></div><div id="collapse12" class="collapse" aria-labelledby="heading12" data-parent="#components"><div class="card-body">JavaScript or other external libraries dynamically included in web content<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading11"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse11" aria-expanded="true" aria-controls="collapse11">Use case: General <span>[general]</span></button></h5></div><div id="collapse11" class="collapse" aria-labelledby="heading11" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading10"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse10" aria-expanded="true" aria-controls="collapse10">Threat: Attackers gain unauthorised access to data by compromising third party web resources <span>[CWE-937-WEB]</span></button></h5></div><div id="collapse10" class="collapse" aria-labelledby="heading10" data-parent="#threats"><div class="card-body">Web applications typically make extensive use of 3rd party web resources such as
                                JavaScript and CSS files.&nbsp; Should attackers gain access to the source code
                                repositories, or even Content Delivery Networks that host these libraries, then they
                                could gain access to applications that use this content.
                                <div>
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading9"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse9" aria-expanded="true" aria-controls="collapse9">Weakness: Inclusion of Web Functionality from an Untrusted Source <span>[CWE-830]</span></button></h5></div><div id="collapse9" class="collapse" aria-labelledby="heading9" data-parent="#weaknesses"><div class="card-body">The software includes web functionality (such as a web widget)
                        from another domain, which causes it to operate within the domain of the
                        software, potentially granting total access and control of the software to the
                        untrusted source.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading8"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse8" aria-expanded="true" aria-controls="collapse8">Countermeasure: Ensure that all application assets are hosted by the application <span>[ASSETS-HOSTED-BY-APP]</span></button></h5></div><div id="collapse8" class="collapse" aria-labelledby="heading8" data-parent="#controls"><div class="card-body">Review periodically all assets which are accessed by the application and ensure that these
                        assets are hosted by the application. If this is not the case and there are assets in external
                        providers or a CDN, you shall move these assets to be hosted by the application and remove them
                        from external providers or CDNs.
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading13"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse13" aria-expanded="true" aria-controls="collapse13">Risk pattern: Active Directory <span>[ACTIVE-DIRECTORY]</span></button></h5></div><div id="collapse13" class="collapse" aria-labelledby="heading13" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading14"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse14" aria-expanded="true" aria-controls="collapse14">Risk pattern: Adobe Flash Client <span>[CLIENT:FLASH]</span></button></h5></div><div id="collapse14" class="collapse" aria-labelledby="heading14" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading15"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse15" aria-expanded="true" aria-controls="collapse15">Risk pattern: Apache Server <span>[SERVER:APACHE]</span></button></h5></div><div id="collapse15" class="collapse" aria-labelledby="heading15" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading22"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse22" aria-expanded="true" aria-controls="collapse22">Risk pattern: Binary <span>[BINARY]</span></button></h5></div><div id="collapse22" class="collapse" aria-labelledby="heading22" data-parent="#components"><div class="card-body">A component that uses binary, i.e. unmanaged code<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading21"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse21" aria-expanded="true" aria-controls="collapse21">Use case: General <span>[GENERAL]</span></button></h5></div><div id="collapse21" class="collapse" aria-labelledby="heading21" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading20"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse20" aria-expanded="true" aria-controls="collapse20">Threat: Attackers gain unauthorised access to the application through buffer overflow flaws <span>[CAPEC-100]</span></button></h5></div><div id="collapse20" class="collapse" aria-labelledby="heading20" data-parent="#threats"><div class="card-body">Buffer Overflow attacks target improper or missing bounds checking on buffer
                                operations, typically triggered by input injected by an attacker. As a consequence, an
                                attacker is able to write past the boundaries of allocated buffer regions in memory,
                                causing a program crash or potentially redirection of execution as per the attackers'
                                choice.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading19"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse19" aria-expanded="true" aria-controls="collapse19">Weakness: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') <span>[CWE-120]</span></button></h5></div><div id="collapse19" class="collapse" aria-labelledby="heading19" data-parent="#weaknesses"><div class="card-body">The program copies an input buffer to an output buffer without verifying that the size of the
                        input buffer is less than the size of the output buffer, leading to a buffer overflow.
                        <br />A buffer overflow condition exists when a program attempts to put more data in a
                        buffer than it can hold, or when a program attempts to put data in a memory area outside of the
                        boundaries of a buffer. The simplest type of error, and the most common cause of buffer
                        overflows, is the &quot;classic&quot; case in which the program copies the buffer
                        without restricting how much is copied. Other variants exist, but the existence of a classic
                        overflow strongly suggests that the programmer is not considering even the most basic of
                        security protections.
                        <br />
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading16"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse16" aria-expanded="true" aria-controls="collapse16">Countermeasure: Develop using a language with integrated memory protection <span>[CWE-120-MANAGED]</span></button></h5></div><div id="collapse16" class="collapse" aria-labelledby="heading16" data-parent="#controls"><div class="card-body"><div>
                        Use of a language that manages memory and disallows direct access greatly reduces the likelihood
                        of presence and exploitation of overflow vulnerabilities.
                        </div>
                        <div>
                        <ul>
                        <li>Use a memory managed platform such as the JVM or .NET.</li>
                        <li>Alternatively, use of an interpreted language such Python, Perl or Ruby can also
                        mitigate the risk.</li>
                        <li>Ensure that the runtime environment is patched to the latest recommended levels so
                        flaws within it do not undermine these protections.</li>
                        </ul>
                        </div>
                        <div>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading17"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse17" aria-expanded="true" aria-controls="collapse17">Countermeasure: Enable and enforce Address Space Layout Randomisation (ASLR) <span>[CWE-120-RANDOM]</span></button></h5></div><div id="collapse17" class="collapse" aria-labelledby="heading17" data-parent="#controls"><div class="card-body"><div>
                        Modern operating systems offer randomization of process address space to reduce the
                        predictability of the location of code elements in memory, and inhibit exploitation of overflow
                        vulnerabilities.&nbsp;
                        </div>
                        <div>
                        However, it is often possible to disable or otherwise at least partially opt out of these
                        protections at a system or process level.
                        </div>
                        <div>
                        <ul>
                        <li>Ensure ASLR is enabled and enforced at the operating system level where possible.</li>
                        <li>Enable ASLR controls in the project.</li>
                        <li>Review dependencies to ensure they utilize ASLR, and if not, consider alternatives
                        that do.</li>
                        </ul>
                        </div>
                        <div></div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading18"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse18" aria-expanded="true" aria-controls="collapse18">Countermeasure: Enforce stack and heap protection measures, including disabling stack execution <span>[CWE-120-STACK]</span></button></h5></div><div id="collapse18" class="collapse" aria-labelledby="heading18" data-parent="#controls"><div class="card-body">Many modern operating systems offer protections to disallow code from executing from the
                        stack, inhibiting overflow attacks which rely on executing user code on the stack.
                        <div>
                        <ul>
                        <li>Enable stack protection at the operating system level, and verify opt out is not
                        permitted.</li>
                        <li>Ensure project components are developed with DEP / NX or equivalent stack protections.</li>
                        <li>Review all libraries and dependencies to ensure they also enforce stack protection,
                        and if not, consider alternatives that do.</li>
                        </ul>
                        </div>
                        <div></div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading23"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse23" aria-expanded="true" aria-controls="collapse23">Risk pattern: Client <span>[CLIENT:THICK]</span></button></h5></div><div id="collapse23" class="collapse" aria-labelledby="heading23" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading24"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse24" aria-expanded="true" aria-controls="collapse24">Risk pattern: Cloud Storage <span>[CLOUD-STORAGE]</span></button></h5></div><div id="collapse24" class="collapse" aria-labelledby="heading24" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading196"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse196" aria-expanded="true" aria-controls="collapse196">Risk pattern: CWE 7 Kingdoms <span>[CWE-7-KINGDOMS]</span></button></h5></div><div id="collapse196" class="collapse" aria-labelledby="heading196" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading195"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse195" aria-expanded="true" aria-controls="collapse195">Use case: General <span>[GENERAL]</span></button></h5></div><div id="collapse195" class="collapse" aria-labelledby="heading195" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading46"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse46" aria-expanded="true" aria-controls="collapse46">Threat: Attackers gain unauthorised access to the application because of  inadequate security features <span>[7k-CWE-SecF]</span></button></h5></div><div id="collapse46" class="collapse" aria-labelledby="heading46" data-parent="#threats"><div class="card-body">Software security is not security software. Here we're concerned with topics like
                                authentication, access control, confidentiality, cryptography, and privilege management.&nbsp;
                                <div>
                                <b>Insecure Randomness.&nbsp;</b>
                                </div>
                                <div>
                                <ul>
                                <li>Standard pseudo-random number generators cannot withstand cryptographic
                                attacks.</li>
                                </ul>
                                </div>
                                <div>
                                <b>Least Privilege Violation.&nbsp;</b>
                                </div>
                                <div>
                                <ul>
                                <li>The elevated privilege level required to perform operations such as chroot()
                                should be dropped immediately after the operation is performed.</li>
                                </ul>
                                </div>
                                <div>
                                <b>Missing Access Control.&nbsp;</b>
                                </div>
                                <div>
                                <ul>
                                <li>The program does not perform access control checks in a consistent manner
                                across all potential execution paths.</li>
                                </ul>
                                </div>
                                <div>
                                <b>Password Management.&nbsp;</b>
                                </div>
                                <div>
                                <ul>
                                <li>Storing a password in plaintext may result in a system compromise.&nbsp;</li>
                                <li>Empty Password in Config File. Using an empty string as a password is
                                insecure.</li>
                                </ul>
                                </div>
                                <div>
                                <b>Hard-Coded Password.&nbsp;</b>
                                </div>
                                <div>
                                <ul>
                                <li>Hard coded passwords may compromise system security in a way that cannot be
                                easily remedied.&nbsp;</li>
                                <li>Password in Config File. Storing a password in a configuration file may result
                                in system compromise.&nbsp;</li>
                                </ul>
                                </div>
                                <div>
                                <b>Weak Cryptography.</b>&nbsp;
                                </div>
                                <div>
                                <ul>
                                <li>Obscuring a password with a trivial encoding does not protect the password.</li>
                                </ul>
                                </div>
                                <div>
                                <b>Privacy Violation.&nbsp;</b>
                                </div>
                                <div>
                                <ul>
                                <li>Mishandling private information, such as customer passwords or social security
                                numbers, can compromise user privacy and is often illegal.&nbsp;</li>
                                </ul>
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading25"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse25" aria-expanded="true" aria-controls="collapse25">Weakness: 2009 Top 25 - Porous Defenses <span>[CWE-753]</span></button></h5></div><div id="collapse25" class="collapse" aria-labelledby="heading25" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are listed in the "Porous Defenses"
                        section of the 2009 CWE/SANS Top 25 Programming Errors.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading26"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse26" aria-expanded="true" aria-controls="collapse26">Weakness: 2010 Top 25 - Porous Defenses <span>[CWE-803]</span></button></h5></div><div id="collapse26" class="collapse" aria-labelledby="heading26" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are listed in the "Porous Defenses"
                        section of the 2010 CWE/SANS Top 25 Programming Errors.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading27"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse27" aria-expanded="true" aria-controls="collapse27">Weakness: 2011 Top 25 - Porous Defenses <span>[CWE-866]</span></button></h5></div><div id="collapse27" class="collapse" aria-labelledby="heading27" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are listed in the "Porous Defenses"
                        section of the 2011 CWE/SANS Top 25 Most Dangerous Software
                        Errors.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading28"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse28" aria-expanded="true" aria-controls="collapse28">Weakness: CERT Java Secure Coding Section 14 - Platform Security (SEC) <span>[CWE-859]</span></button></h5></div><div id="collapse28" class="collapse" aria-labelledby="heading28" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the
                        Platform Security (SEC) section of the CERT Java Secure Coding Standard. Since
                        not all rules map to specific weaknesses, this category may be
                        incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading29"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse29" aria-expanded="true" aria-controls="collapse29">Weakness: OWASP Top Ten 2004 Category A2 - Broken Access Control <span>[CWE-723]</span></button></h5></div><div id="collapse29" class="collapse" aria-labelledby="heading29" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to the A2 category in
                        the OWASP Top Ten 2004.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading30"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse30" aria-expanded="true" aria-controls="collapse30">Weakness: SFP Primary Cluster: Memory Access <span>[CWE-890]</span></button></h5></div><div id="collapse30" class="collapse" aria-labelledby="heading30" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Memory Access cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading31"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse31" aria-expanded="true" aria-controls="collapse31">Weakness: SFP Secondary Cluster: Access Management <span>[CWE-944]</span></button></h5></div><div id="collapse31" class="collapse" aria-labelledby="heading31" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Access Management cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading32"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse32" aria-expanded="true" aria-controls="collapse32">Weakness: SFP Secondary Cluster: Covert Channel <span>[CWE-968]</span></button></h5></div><div id="collapse32" class="collapse" aria-labelledby="heading32" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Covert Channel cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading33"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse33" aria-expanded="true" aria-controls="collapse33">Weakness: SFP Secondary Cluster: Digital Certificate <span>[CWE-948]</span></button></h5></div><div id="collapse33" class="collapse" aria-labelledby="heading33" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Digital Certificate cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading34"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse34" aria-expanded="true" aria-controls="collapse34">Weakness: SFP Secondary Cluster: Hard-coded Sensitive Data <span>[CWE-950]</span></button></h5></div><div id="collapse34" class="collapse" aria-labelledby="heading34" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Hard-coded Sensitive Data cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading35"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse35" aria-expanded="true" aria-controls="collapse35">Weakness: SFP Secondary Cluster: Improper NULL Termination <span>[CWE-973]</span></button></h5></div><div id="collapse35" class="collapse" aria-labelledby="heading35" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Improper NULL Termination cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading36"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse36" aria-expanded="true" aria-controls="collapse36">Weakness: SFP Secondary Cluster: Insecure Authentication Policy <span>[CWE-951]</span></button></h5></div><div id="collapse36" class="collapse" aria-labelledby="heading36" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Insecure Authentication Policy cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading37"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse37" aria-expanded="true" aria-controls="collapse37">Weakness: SFP Secondary Cluster: Insecure Resource Access <span>[CWE-945]</span></button></h5></div><div id="collapse37" class="collapse" aria-labelledby="heading37" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Insecure Resource Access cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading38"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse38" aria-expanded="true" aria-controls="collapse38">Weakness: SFP Secondary Cluster: Insecure Session Management <span>[CWE-965]</span></button></h5></div><div id="collapse38" class="collapse" aria-labelledby="heading38" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Insecure Session Management cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading39"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse39" aria-expanded="true" aria-controls="collapse39">Weakness: SFP Secondary Cluster: Missing Authentication <span>[CWE-952]</span></button></h5></div><div id="collapse39" class="collapse" aria-labelledby="heading39" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Missing Authentication cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading40"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse40" aria-expanded="true" aria-controls="collapse40">Weakness: SFP Secondary Cluster: Missing Endpoint Authentication <span>[CWE-953]</span></button></h5></div><div id="collapse40" class="collapse" aria-labelledby="heading40" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Missing Endpoint Authentication cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading41"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse41" aria-expanded="true" aria-controls="collapse41">Weakness: SFP Secondary Cluster: Multiple Binds to the Same Port <span>[CWE-954]</span></button></h5></div><div id="collapse41" class="collapse" aria-labelledby="heading41" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Multiple Binds to the Same Port cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading42"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse42" aria-expanded="true" aria-controls="collapse42">Weakness: SFP Secondary Cluster: Other Exposures <span>[CWE-966]</span></button></h5></div><div id="collapse42" class="collapse" aria-labelledby="heading42" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Other Exposures cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading43"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse43" aria-expanded="true" aria-controls="collapse43">Weakness: SFP Secondary Cluster: State Disclosure <span>[CWE-967]</span></button></h5></div><div id="collapse43" class="collapse" aria-labelledby="heading43" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the State Disclosure cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading45"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse45" aria-expanded="true" aria-controls="collapse45">Weakness: The application lacks key security features <span>[CWE-254]</span></button></h5></div><div id="collapse45" class="collapse" aria-labelledby="heading45" data-parent="#weaknesses"><div class="card-body"><div>
                        Software security is not security software. Here we're concerned with topics like
                        authentication, access control, confidentiality, cryptography, and privilege management.&nbsp;
                        <div>
                        <b>Insecure Randomness.&nbsp;</b>
                        </div>
                        <div>
                        <ul>
                        <li>Standard pseudo-random number generators cannot withstand cryptographic attacks.</li>
                        </ul>
                        </div>
                        <div>
                        <b>Least Privilege Violation.&nbsp;</b>
                        </div>
                        <div>
                        <ul>
                        <li>The elevated privilege level required to perform operations such as chroot() should be
                        dropped immediately after the operation is performed.</li>
                        </ul>
                        </div>
                        <div>
                        <b>Missing Access Control.&nbsp;</b>
                        </div>
                        <div>
                        <ul>
                        <li>The program does not perform access control checks in a consistent manner across all
                        potential execution paths.</li>
                        </ul>
                        </div>
                        <div>
                        <b>Password Management.&nbsp;</b>
                        </div>
                        <div>
                        <ul>
                        <li>Storing a password in plaintext may result in a system compromise.&nbsp;</li>
                        <li>Empty Password in Config File. Using an empty string as a password is insecure.</li>
                        </ul>
                        </div>
                        <div>
                        <b>Hard-Coded Password.&nbsp;</b>
                        </div>
                        <div>
                        <ul>
                        <li>Hard coded passwords may compromise system security in a way that cannot be easily
                        remedied.&nbsp;</li>
                        <li>Password in Config File. Storing a password in a configuration file may result in
                        system compromise.&nbsp;</li>
                        </ul>
                        </div>
                        <div>
                        <b>Weak Cryptography.</b>&nbsp;
                        </div>
                        <div>
                        <ul>
                        <li>Obscuring a password with a trivial encoding does not protect the password.</li>
                        </ul>
                        </div>
                        <div>
                        <b>Privacy Violation.&nbsp;</b>
                        </div>
                        <div>
                        <ul>
                        <li>Mishandling private information, such as customer passwords or social security
                        numbers, can compromise user privacy and is often illegal.&nbsp;</li>
                        </ul>
                        </div>
                        </div>
                        <div>
                        <br />
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading44"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse44" aria-expanded="true" aria-controls="collapse44">Countermeasure: Verify the application correctly implements the security features needed according to its security level <span>[SEC-FEATURES]</span></button></h5></div><div id="collapse44" class="collapse" aria-labelledby="heading44" data-parent="#controls"><div class="card-body"><div>
                        The security controls in place will in part be defined by the nature of the application. A low
                        security unauthenticated application will have different requirements to an application
                        providing transactional capabilities in a finance system, for example.
                        </div>
                        <div>
                        <ul>
                        <li>Features around security like authentication, access control, confidentiality,
                        cryptography, and privilege management should be correctly implemented and appropriate to the
                        application - 'fit for purpose'.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading61"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse61" aria-expanded="true" aria-controls="collapse61">Threat: Attackers gain unauthorised access to the application because of time and state management issues <span>[7k-CWE-TimeState]</span></button></h5></div><div id="collapse61" class="collapse" aria-labelledby="heading61" data-parent="#threats"><div class="card-body"><div>
                                This weakness is related to the&nbsp;improper&nbsp;management of time and state
                                in an environment that supports simultaneous or near-simultaneous computation by
                                multiple systems, processes, or threads.
                                </div>
                                <div>
                                <p>Distributed computation is about time and state. That is, in order for more
                                than one component to communicate, state must be shared, and all that takes time. Most
                                programmers anthropomorphize their work. They think about one thread of control carrying
                                out the entire program in the same way they would if they had to do the job themselves.
                                Modern computers, however, switch between tasks very quickly, and in multi-core,
                                multi-CPU, or distributed systems, two events may take place at exactly the same time.
                                Defects rush to fill the gap between the programmer's model of how a program executes
                                and what happens in reality. These defects are related to&nbsp;unexpected&nbsp;interactions
                                between threads, processes, time, and information. These interactions happen through
                                shared state: semaphores, variables, the file system, and, basically, anything that can
                                store information.</p>
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading47"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse47" aria-expanded="true" aria-controls="collapse47">Weakness: Behavioral Problems <span>[CWE-438]</span></button></h5></div><div id="collapse47" class="collapse" aria-labelledby="heading47" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to unexpected behaviors
                        from code that an application uses.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading48"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse48" aria-expanded="true" aria-controls="collapse48">Weakness: CERT C Secure Coding Section 02 - Declarations and Initialization (DCL) <span>[CWE-736]</span></button></h5></div><div id="collapse48" class="collapse" aria-labelledby="heading48" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the
                        declarations and initialization section of the CERT C Secure Coding Standard.
                        Since not all rules map to specific weaknesses, this category may be incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading49"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse49" aria-expanded="true" aria-controls="collapse49">Weakness: CERT C++ Secure Coding Section 02 - Declarations and Initialization (DCL) <span>[CWE-870]</span></button></h5></div><div id="collapse49" class="collapse" aria-labelledby="heading49" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the
                        Declarations and Initialization (DCL) section of the CERT C++ Secure Coding
                        Standard. Since not all rules map to specific weaknesses, this category may be
                        incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading50"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse50" aria-expanded="true" aria-controls="collapse50">Weakness: CERT C++ Secure Coding Section 14 - Concurrency (CON) <span>[CWE-882]</span></button></h5></div><div id="collapse50" class="collapse" aria-labelledby="heading50" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the
                        Concurrency (CON) section of the CERT C++ Secure Coding Standard. Since not all
                        rules map to specific weaknesses, this category may be
                        incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading51"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse51" aria-expanded="true" aria-controls="collapse51">Weakness: CERT Java Secure Coding Section 01 - Declarations and Initialization (DCL) <span>[CWE-846]</span></button></h5></div><div id="collapse51" class="collapse" aria-labelledby="heading51" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the
                        Declarations and Initialization (DCL) section of the CERT Java Secure Coding
                        Standard. Since not all rules map to specific weaknesses, this category may be
                        incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading52"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse52" aria-expanded="true" aria-controls="collapse52">Weakness: CERT Java Secure Coding Section 08 - Locking (LCK) <span>[CWE-853]</span></button></h5></div><div id="collapse52" class="collapse" aria-labelledby="heading52" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the Locking
                        (LCK) section of the CERT Java Secure Coding Standard. Since not all rules map
                        to specific weaknesses, this category may be incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading53"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse53" aria-expanded="true" aria-controls="collapse53">Weakness: CERT Java Secure Coding Section 10 - Thread Pools (TPS) <span>[CWE-855]</span></button></h5></div><div id="collapse53" class="collapse" aria-labelledby="heading53" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the Thread
                        Pools (TPS) section of the CERT Java Secure Coding Standard. Since not all rules
                        map to specific weaknesses, this category may be
                        incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading54"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse54" aria-expanded="true" aria-controls="collapse54">Weakness: Concurrency Issues <span>[CWE-557]</span></button></h5></div><div id="collapse54" class="collapse" aria-labelledby="heading54" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to concurrent use of
                        shared resources.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading56"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse56" aria-expanded="true" aria-controls="collapse56">Weakness: Improper management of Time and state <span>[CWE-361]</span></button></h5></div><div id="collapse56" class="collapse" aria-labelledby="heading56" data-parent="#weaknesses"><div class="card-body"><div>
                        <br />
                        </div>
                        <div>
                        This weakness is related to the&nbsp;improper&nbsp;management of time and state in an
                        environment that supports simultaneous or near-simultaneous computation by multiple systems,
                        processes, or threads.
                        </div>
                        <div>
                        <p>Distributed computation is about time and state. That is, in order for more than one
                        component to communicate, state must be shared, and all that takes time. Most programmers
                        anthropomorphize their work. They think about one thread of control carrying out the entire
                        program in the same way they would if they had to do the job themselves. Modern computers,
                        however, switch between tasks very quickly, and in multi-core, multi-CPU, or distributed
                        systems, two events may take place at exactly the same time. Defects rush to fill the gap
                        between the programmer's model of how a program executes and what happens in reality. These
                        defects are related to&nbsp;unexpected&nbsp;interactions between threads, processes,
                        time, and information. These interactions happen through shared state: semaphores, variables,
                        the file system, and, basically, anything that can store information.</p>
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading55"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse55" aria-expanded="true" aria-controls="collapse55">Countermeasure: Verify concurrent systems does not introduce unexpected behaviour <span>[TIME-STATE]</span></button></h5></div><div id="collapse55" class="collapse" aria-labelledby="heading55" data-parent="#controls"><div class="card-body"><div>
                        Failure to enforce proper access and locking of resources can result in race-conditions, where
                        concurrent calls can subvert the security controls or logical flow within an application. For
                        example, in a financial system, parallel threads may simultaneously check an account balance
                        before making a withdrawal to ensure adequate funds are present, before both conduct a
                        transaction and take the account overdrawn.
                        </div>
                        <div>
                        <ul>
                        <li>Verify that controls related to the proper management of time and state in an
                        environment that supports simultaneous or near-simultaneous computation by multiple systems,
                        processes, or threads are properly implemented.</li>
                        <li>Verify the safeguards in place, and the logical sequence of checking, locking, and
                        transacting are resistant to race-conditions.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading57"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse57" aria-expanded="true" aria-controls="collapse57">Weakness: J2EE Time and State Issues <span>[CWE-381]</span></button></h5></div><div id="collapse57" class="collapse" aria-labelledby="heading57" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to improper handling of
                        time or state within J2EE.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading58"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse58" aria-expanded="true" aria-controls="collapse58">Weakness: OWASP Top Ten 2004 Category A9 - Denial of Service <span>[CWE-730]</span></button></h5></div><div id="collapse58" class="collapse" aria-labelledby="heading58" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to the A9 category in
                        the OWASP Top Ten 2004.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading59"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse59" aria-expanded="true" aria-controls="collapse59">Weakness: Technology-Specific Time and State Issues <span>[CWE-380]</span></button></h5></div><div id="collapse59" class="collapse" aria-labelledby="heading59" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to improper handling of
                        time or state within particular technologies.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading60"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse60" aria-expanded="true" aria-controls="collapse60">Weakness: Temporary File Issues <span>[CWE-376]</span></button></h5></div><div id="collapse60" class="collapse" aria-labelledby="heading60" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to improper handling of
                        temporary files.
                    <div class="accordion" id="controls"></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading67"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse67" aria-expanded="true" aria-controls="collapse67">Threat: Attackers gain unauthorised access to the application through API Abuse <span>[7k-CWE-API]</span></button></h5></div><div id="collapse67" class="collapse" aria-labelledby="heading67" data-parent="#threats"><div class="card-body">An API is a contract between a caller and a callee. The most common forms of API abuse
                                are caused by the caller failing to honor its end of this contract. For example, if a
                                program fails to call chdir() after calling chroot(), it violates the contract that
                                specifies how to change the active root directory in a secure fashion. Another good
                                example of library abuse is expecting the callee to return trustworthy DNS information
                                to the caller. In this case, the caller abuses the callee API by making certain
                                assumptions about its behavior (that the return value can be used for authentication
                                purposes). One can also violate the caller-callee contract from the other side. For
                                example, if a coder subclasses SecureRandom and returns a non-random value, the contract
                                is violated.&nbsp;
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading62"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse62" aria-expanded="true" aria-controls="collapse62">Weakness: CERT Java Secure Coding Section 09 - Thread APIs (THI) <span>[CWE-854]</span></button></h5></div><div id="collapse62" class="collapse" aria-labelledby="heading62" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the Thread
                        APIs (THI) section of the CERT Java Secure Coding Standard. Since not all rules
                        map to specific weaknesses, this category may be
                        incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading64"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse64" aria-expanded="true" aria-controls="collapse64">Weakness: Improper Fulfillment of API Contract (API Abuse) <span>[CWE-227]</span></button></h5></div><div id="collapse64" class="collapse" aria-labelledby="heading64" data-parent="#weaknesses"><div class="card-body"><div>
                        The software uses an API in a manner contrary to its intended use.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <p>An API is a contract between a caller and a callee. The most common forms of API misuse
                        occurs when the caller does not honor its end of this contract. For example, if a program does
                        not call chdir() after calling chroot(), it violates the contract that specifies how to change
                        the active root directory in a secure fashion. Another good example of library abuse is
                        expecting the callee to return trustworthy DNS information to the caller. In this case, the
                        caller misuses the callee API by making certain assumptions about its&nbsp;behavior&nbsp;(that
                        the return value can be used for&nbsp;authentication&nbsp;purposes). One can also
                        violate the caller-callee contract from the other side. For example, if a coder subclasses
                        SecureRandom and returns a non-random value, the contract is violated.</p>
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading63"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse63" aria-expanded="true" aria-controls="collapse63">Countermeasure: Verify that the application is using the API following the specifications <span>[API-USE]</span></button></h5></div><div id="collapse63" class="collapse" aria-labelledby="heading63" data-parent="#controls"><div class="card-body"><div>
                        Insecure API implementations may allow subversion of application controls or safeguards.
                        Furthermore, use of the API in an undocumented manner can result in issues if bugs or
                        functionality are remediated in the future.
                        </div>
                        <div>
                        <ul>
                        <li>The application must follow the specifications of the API, even where workarounds or
                        shortcuts have been identified.</li>
                        <li>The API should be properly implemented and safely handle unexpected input and use, but
                        this should not be relied upon by the client.</li>
                        <li>The application should following standard call sequences and logical flow to support
                        security and functionality of the API implementation</li>
                        </ul>
                        </div>
                        <div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <br />
                        </div>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading65"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse65" aria-expanded="true" aria-controls="collapse65">Weakness: SFP Primary Cluster: API <span>[CWE-887]</span></button></h5></div><div id="collapse65" class="collapse" aria-labelledby="heading65" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the API cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading66"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse66" aria-expanded="true" aria-controls="collapse66">Weakness: SFP Secondary Cluster: Use of an Improper API <span>[CWE-1001]</span></button></h5></div><div id="collapse66" class="collapse" aria-labelledby="heading66" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Use of an Improper API cluster.
                    <div class="accordion" id="controls"></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading114"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse114" aria-expanded="true" aria-controls="collapse114">Threat: Attackers gain unauthorised access to the application through a Poor Code Quality flaw <span>[7k-CWE-PoorCQ]</span></button></h5></div><div id="collapse114" class="collapse" aria-labelledby="heading114" data-parent="#threats"><div class="card-body">Poor code quality leads to unpredictable behavior. From a user perspective that
                                often manifests itself as poor usability. For an adversary it provides an opportunity to
                                stress the system in unexpected ways.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading68"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse68" aria-expanded="true" aria-controls="collapse68">Weakness: 2009 Top 25 - Risky Resource Management <span>[CWE-752]</span></button></h5></div><div id="collapse68" class="collapse" aria-labelledby="heading68" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are listed in the "Risky Resource
                        Management" section of the 2009 CWE/SANS Top 25 Programming
                        Errors.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading69"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse69" aria-expanded="true" aria-controls="collapse69">Weakness: 2010 Top 25 - Risky Resource Management <span>[CWE-802]</span></button></h5></div><div id="collapse69" class="collapse" aria-labelledby="heading69" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are listed in the "Risky Resource
                        Management" section of the 2010 CWE/SANS Top 25 Programming
                        Errors.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading70"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse70" aria-expanded="true" aria-controls="collapse70">Weakness: 2010 Top 25 - Weaknesses On the Cusp <span>[CWE-808]</span></button></h5></div><div id="collapse70" class="collapse" aria-labelledby="heading70" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are not part of the general Top 25,
                        but they were part of the original nominee list from which the Top 25 was
                        drawn.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading71"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse71" aria-expanded="true" aria-controls="collapse71">Weakness: 2011 Top 25 - Weaknesses On the Cusp <span>[CWE-867]</span></button></h5></div><div id="collapse71" class="collapse" aria-labelledby="heading71" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are not part of the general Top 25,
                        but they were part of the original nominee list from which the Top 25 was
                        drawn.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading72"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse72" aria-expanded="true" aria-controls="collapse72">Weakness: Byte/Object Code <span>[CWE-503]</span></button></h5></div><div id="collapse72" class="collapse" aria-labelledby="heading72" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are typically found within byte
                        code or object code.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading73"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse73" aria-expanded="true" aria-controls="collapse73">Weakness: CERT C Secure Coding Section 01 - Preprocessor (PRE) <span>[CWE-735]</span></button></h5></div><div id="collapse73" class="collapse" aria-labelledby="heading73" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the
                        preprocessor section of the CERT C Secure Coding Standard. Since not all rules
                        map to specific weaknesses, this category may be incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading74"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse74" aria-expanded="true" aria-controls="collapse74">Weakness: CERT C Secure Coding Section 05 - Floating Point (FLP) <span>[CWE-739]</span></button></h5></div><div id="collapse74" class="collapse" aria-labelledby="heading74" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the
                        floating point section of the CERT C Secure Coding Standard. Since not all rules
                        map to specific weaknesses, this category may be incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading75"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse75" aria-expanded="true" aria-controls="collapse75">Weakness: CERT C Secure Coding Section 07 - Characters and Strings (STR) <span>[CWE-741]</span></button></h5></div><div id="collapse75" class="collapse" aria-labelledby="heading75" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the
                        characters and strings section of the CERT C Secure Coding Standard. Since not
                        all rules map to specific weaknesses, this category may be incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading76"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse76" aria-expanded="true" aria-controls="collapse76">Weakness: CERT C Secure Coding Section 49 - Miscellaneous (MSC) <span>[CWE-747]</span></button></h5></div><div id="collapse76" class="collapse" aria-labelledby="heading76" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the
                        miscellaneous section of the CERT C Secure Coding Standard. Since not all rules
                        map to specific weaknesses, this category may be incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading77"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse77" aria-expanded="true" aria-controls="collapse77">Weakness: CERT C Secure Coding Section 50 - POSIX (POS) <span>[CWE-748]</span></button></h5></div><div id="collapse77" class="collapse" aria-labelledby="heading77" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the POSIX
                        section of the CERT C Secure Coding Standard. Since not all rules map to
                        specific weaknesses, this category may be incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading78"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse78" aria-expanded="true" aria-controls="collapse78">Weakness: CERT C++ Secure Coding Section 01 - Preprocessor (PRE) <span>[CWE-869]</span></button></h5></div><div id="collapse78" class="collapse" aria-labelledby="heading78" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the
                        Preprocessor (PRE) section of the CERT C++ Secure Coding Standard. Since not all
                        rules map to specific weaknesses, this category may be
                        incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading79"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse79" aria-expanded="true" aria-controls="collapse79">Weakness: CERT C++ Secure Coding Section 07 - Characters and Strings (STR) <span>[CWE-875]</span></button></h5></div><div id="collapse79" class="collapse" aria-labelledby="heading79" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the
                        Characters and Strings (STR) section of the CERT C++ Secure Coding Standard.
                        Since not all rules map to specific weaknesses, this category may be
                        incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading80"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse80" aria-expanded="true" aria-controls="collapse80">Weakness: CERT C++ Secure Coding Section 13 - Object Oriented Programming (OOP) <span>[CWE-881]</span></button></h5></div><div id="collapse80" class="collapse" aria-labelledby="heading80" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the Object
                        Oriented Programming (OOP) section of the CERT C++ Secure Coding Standard. Since
                        not all rules map to specific weaknesses, this category may be
                        incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading81"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse81" aria-expanded="true" aria-controls="collapse81">Weakness: CERT C++ Secure Coding Section 49 - Miscellaneous (MSC) <span>[CWE-883]</span></button></h5></div><div id="collapse81" class="collapse" aria-labelledby="heading81" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the
                        Miscellaneous (MSC) section of the CERT C++ Secure Coding Standard. Since not
                        all rules map to specific weaknesses, this category may be
                        incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading82"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse82" aria-expanded="true" aria-controls="collapse82">Weakness: CERT Java Secure Coding Section 04 - Object Orientation (OBJ) <span>[CWE-849]</span></button></h5></div><div id="collapse82" class="collapse" aria-labelledby="heading82" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the Object
                        Orientation (OBJ) section of the CERT Java Secure Coding Standard. Since not all
                        rules map to specific weaknesses, this category may be
                        incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading83"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse83" aria-expanded="true" aria-controls="collapse83">Weakness: CERT Java Secure Coding Section 05 - Methods (MET) <span>[CWE-850]</span></button></h5></div><div id="collapse83" class="collapse" aria-labelledby="heading83" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the Methods
                        (MET) section of the CERT Java Secure Coding Standard. Since not all rules map
                        to specific weaknesses, this category may be incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading84"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse84" aria-expanded="true" aria-controls="collapse84">Weakness: CERT Java Secure Coding Section 07 - Visibility and Atomicity (VNA) <span>[CWE-852]</span></button></h5></div><div id="collapse84" class="collapse" aria-labelledby="heading84" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the
                        Visibility and Atomicity (VNA) section of the CERT Java Secure Coding Standard.
                        Since not all rules map to specific weaknesses, this category may be
                        incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading85"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse85" aria-expanded="true" aria-controls="collapse85">Weakness: CERT Java Secure Coding Section 11 - Thread-Safety Miscellaneous (TSM) <span>[CWE-856]</span></button></h5></div><div id="collapse85" class="collapse" aria-labelledby="heading85" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the
                        Thread-Safety Miscellaneous (TSM) section of the CERT Java Secure Coding
                        Standard. Since not all rules map to specific weaknesses, this category may be
                        incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading86"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse86" aria-expanded="true" aria-controls="collapse86">Weakness: CERT Java Secure Coding Section 13 - Serialization (SER) <span>[CWE-858]</span></button></h5></div><div id="collapse86" class="collapse" aria-labelledby="heading86" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the
                        Serialization (SER) section of the CERT Java Secure Coding Standard. Since not
                        all rules map to specific weaknesses, this category may be
                        incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading87"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse87" aria-expanded="true" aria-controls="collapse87">Weakness: CERT Java Secure Coding Section 15 - Runtime Environment (ENV) <span>[CWE-860]</span></button></h5></div><div id="collapse87" class="collapse" aria-labelledby="heading87" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the Runtime
                        Environment (ENV) section of the CERT Java Secure Coding Standard. Since not all
                        rules map to specific weaknesses, this category may be
                        incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading88"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse88" aria-expanded="true" aria-controls="collapse88">Weakness: CERT Java Secure Coding Section 49 - Miscellaneous (MSC) <span>[CWE-861]</span></button></h5></div><div id="collapse88" class="collapse" aria-labelledby="heading88" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the
                        Miscellaneous (MSC) section of the CERT Java Secure Coding Standard. Since not
                        all rules map to specific weaknesses, this category may be
                        incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading89"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse89" aria-expanded="true" aria-controls="collapse89">Weakness: Code <span>[CWE-17]</span></button></h5></div><div id="collapse89" class="collapse" aria-labelledby="heading89" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are typically introduced during
                        code development, including specification, design, and
                        implementation.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading90"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse90" aria-expanded="true" aria-controls="collapse90">Weakness: Coding Standards Violation <span>[CWE-710]</span></button></h5></div><div id="collapse90" class="collapse" aria-labelledby="heading90" data-parent="#weaknesses"><div class="card-body">The software does not follow certain coding rules for
                        development, which can lead to resultant weaknesses or increase the severity of
                        the associated vulnerabilities.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading91"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse91" aria-expanded="true" aria-controls="collapse91">Weakness: DEPRECATED: Failure to Protect Stored Data from Modification <span>[CWE-217]</span></button></h5></div><div id="collapse91" class="collapse" aria-labelledby="heading91" data-parent="#weaknesses"><div class="card-body">This weakness has been deprecated because it incorporated and
                        confused multiple weaknesses. The issues formerly covered in this weakness can
                        be found at CWE-766 and CWE-767.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading92"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse92" aria-expanded="true" aria-controls="collapse92">Weakness: Embedded Malicious Code <span>[CWE-506]</span></button></h5></div><div id="collapse92" class="collapse" aria-labelledby="heading92" data-parent="#weaknesses"><div class="card-body">The application contains code that appears to be malicious in
                        nature.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading93"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse93" aria-expanded="true" aria-controls="collapse93">Weakness: Hidden Functionality <span>[CWE-912]</span></button></h5></div><div id="collapse93" class="collapse" aria-labelledby="heading93" data-parent="#weaknesses"><div class="card-body">The software contains functionality that is not documented, not
                        part of the specification, and not accessible through an interface or command
                        sequence that is obvious to the software's users or
                        administrators.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading94"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse94" aria-expanded="true" aria-controls="collapse94">Weakness: Inadvertently Introduced Weakness <span>[CWE-518]</span></button></h5></div><div id="collapse94" class="collapse" aria-labelledby="heading94" data-parent="#weaknesses"><div class="card-body">The software contains a weakness that was inadvertently
                        introduced by the developer.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading95"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse95" aria-expanded="true" aria-controls="collapse95">Weakness: Intentionally Introduced Nonmalicious Weakness <span>[CWE-513]</span></button></h5></div><div id="collapse95" class="collapse" aria-labelledby="heading95" data-parent="#weaknesses"><div class="card-body">Non-malicious introduction of weaknesses into software can still
                        render it vulnerable to various attacks.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading96"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse96" aria-expanded="true" aria-controls="collapse96">Weakness: Intentionally Introduced Weakness <span>[CWE-505]</span></button></h5></div><div id="collapse96" class="collapse" aria-labelledby="heading96" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category were intentionally introduced by
                        the developer, typically as a result of prioritizing other aspects of the
                        program over security, such as maintenance.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading97"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse97" aria-expanded="true" aria-controls="collapse97">Weakness: Lack of Administrator Control over Security <span>[CWE-671]</span></button></h5></div><div id="collapse97" class="collapse" aria-labelledby="heading97" data-parent="#weaknesses"><div class="card-body">The product uses security features in a way that prevents the
                        product's administrator from tailoring security settings to reflect the
                        environment in which the product is being used. This introduces resultant
                        weaknesses or prevents it from operating at a level of security that is desired
                        by the administrator.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading98"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse98" aria-expanded="true" aria-controls="collapse98">Weakness: Logic/Time Bomb <span>[CWE-511]</span></button></h5></div><div id="collapse98" class="collapse" aria-labelledby="heading98" data-parent="#weaknesses"><div class="card-body">The software contains code that is designed to disrupt the
                        legitimate operation of the software (or its environment) when a certain time
                        passes, or when a certain logical condition is met.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading99"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse99" aria-expanded="true" aria-controls="collapse99">Weakness: Mobile Code Issues <span>[CWE-490]</span></button></h5></div><div id="collapse99" class="collapse" aria-labelledby="heading99" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are frequently found in mobile
                        code.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading100"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse100" aria-expanded="true" aria-controls="collapse100">Weakness: Non-Replicating Malicious Code <span>[CWE-508]</span></button></h5></div><div id="collapse100" class="collapse" aria-labelledby="heading100" data-parent="#weaknesses"><div class="card-body">Non-replicating malicious code only resides on the target
                        system or software that is attacked; it does not attempt to spread to other
                        systems.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading101"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse101" aria-expanded="true" aria-controls="collapse101">Weakness: Other Intentional, Nonmalicious Weakness <span>[CWE-517]</span></button></h5></div><div id="collapse101" class="collapse" aria-labelledby="heading101" data-parent="#weaknesses"><div class="card-body">Other kinds of intentional but non-malicious security flaws are
                        possible. Functional requirements that are written without regard to security
                        requirements can lead to such flaws.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading102"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse102" aria-expanded="true" aria-controls="collapse102">Weakness: Reliance on Undefined, Unspecified, or Implementation-Defined Behavior <span>[CWE-758]</span></button></h5></div><div id="collapse102" class="collapse" aria-labelledby="heading102" data-parent="#weaknesses"><div class="card-body">The software uses an API function, data structure, or other
                        entity in a way that relies on properties that are not always guaranteed to hold
                        for that entity.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading103"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse103" aria-expanded="true" aria-controls="collapse103">Weakness: SFP Primary Cluster: Malware <span>[CWE-904]</span></button></h5></div><div id="collapse103" class="collapse" aria-labelledby="heading103" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Malware cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading104"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse104" aria-expanded="true" aria-controls="collapse104">Weakness: SFP Secondary Cluster: Architecture <span>[CWE-975]</span></button></h5></div><div id="collapse104" class="collapse" aria-labelledby="heading104" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Architecture cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading105"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse105" aria-expanded="true" aria-controls="collapse105">Weakness: SFP Secondary Cluster: Compiler <span>[CWE-976]</span></button></h5></div><div id="collapse105" class="collapse" aria-labelledby="heading105" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Compiler cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading106"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse106" aria-expanded="true" aria-controls="collapse106">Weakness: SFP Secondary Cluster: Implementation <span>[CWE-978]</span></button></h5></div><div id="collapse106" class="collapse" aria-labelledby="heading106" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Implementation cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading107"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse107" aria-expanded="true" aria-controls="collapse107">Weakness: Source Code <span>[CWE-18]</span></button></h5></div><div id="collapse107" class="collapse" aria-labelledby="heading107" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are typically found within source
                        code.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading108"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse108" aria-expanded="true" aria-controls="collapse108">Weakness: Spyware <span>[CWE-512]</span></button></h5></div><div id="collapse108" class="collapse" aria-labelledby="heading108" data-parent="#weaknesses"><div class="card-body">The software collects personally identifiable information about
                        a human user or the user's activities, but the software accesses this
                        information using other resources besides itself, and it does not require that
                        user's explicit approval or direct input into the
                        software.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading110"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse110" aria-expanded="true" aria-controls="collapse110">Weakness: The application has not been securely developed <span>[CWE-398]</span></button></h5></div><div id="collapse110" class="collapse" aria-labelledby="heading110" data-parent="#weaknesses"><div class="card-body"><div>
                        The code has features that do not directly introduce a&nbsp;weakness&nbsp;or&nbsp;vulnerability,
                        but indicate that the product has not been carefully developed or maintained.
                        </div>
                        <div>
                        <p>Programs are more likely to be secure when good development practices are followed. If
                        a program is complex, difficult to maintain, not portable, or shows evidence of neglect, then
                        there is a higher likelihood that&nbsp;weaknesses&nbsp;are buried in the code.</p>
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading109"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse109" aria-expanded="true" aria-controls="collapse109">Countermeasure: Verify the code has been developed accordingly to secure coding standards <span>[SEC-CODING]</span></button></h5></div><div id="collapse109" class="collapse" aria-labelledby="heading109" data-parent="#controls"><div class="card-body"><div>
                        Secure development should be an integral part of any development process to ensure robust,
                        secure, and stable systems are built. Functional and non-functional security requirements, and
                        supporting coding standards and guidelines should be in place and enforced. If the application
                        does not follow secure coding practices, there is a higher chance that an attacker could exploit
                        this fact to gain access to the application.&nbsp;
                        </div>
                        <div>
                        <ul>
                        <li>Confirm secure coding standards are in place, integrated into the development
                        lifecycle, and are sufficient to protect the application.</li>
                        <li>Verify the code has been developed accordingly to secure coding standards</li>
                        <li>The code should be developed with security in mind.</li>
                        </ul>
                        </div>
                        <div>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading111"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse111" aria-expanded="true" aria-controls="collapse111">Weakness: Trojan Horse <span>[CWE-507]</span></button></h5></div><div id="collapse111" class="collapse" aria-labelledby="heading111" data-parent="#weaknesses"><div class="card-body">The software appears to contain benign or useful functionality,
                        but it also contains code that is hidden from normal operation that violates the
                        intended security policy of the user or the system
                        administrator.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading112"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse112" aria-expanded="true" aria-controls="collapse112">Weakness: Unnecessary Complexity in Protection Mechanism (Not Using 'Economy of Mechanism') <span>[CWE-637]</span></button></h5></div><div id="collapse112" class="collapse" aria-labelledby="heading112" data-parent="#weaknesses"><div class="card-body">The software uses a more complex mechanism than necessary,
                        which could lead to resultant weaknesses when the mechanism is not correctly
                        understood, modeled, configured, implemented, or used.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading113"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse113" aria-expanded="true" aria-controls="collapse113">Weakness: Weaknesses that Affect System Processes <span>[CWE-634]</span></button></h5></div><div id="collapse113" class="collapse" aria-labelledby="heading113" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category affect system process resources
                        during process invocation or inter-process communication
                        (IPC).
                    <div class="accordion" id="controls"></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading118"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse118" aria-expanded="true" aria-controls="collapse118">Threat: Attackers gain unauthorised access to the application through a lack of boundaries <span>[7k-CWE-InsufE]</span></button></h5></div><div id="collapse118" class="collapse" aria-labelledby="heading118" data-parent="#threats"><div class="card-body">Encapsulation is about drawing strong boundaries. In a web browser that might mean
                                ensuring that your mobile code cannot be abused by other mobile code. On the server it
                                might mean differentiation between validated data and unvalidated data, between one
                                user's data and another's, or between data users are allowed to see and data that they
                                are not.&nbsp;
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading115"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse115" aria-expanded="true" aria-controls="collapse115">Weakness: DEPRECATED (Duplicate): Failure to provide confidentiality for stored data <span>[CWE-218]</span></button></h5></div><div id="collapse115" class="collapse" aria-labelledby="heading115" data-parent="#weaknesses"><div class="card-body">This weakness has been deprecated because it was a duplicate of
                        CWE-493. All content has been transferred to CWE-493.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading117"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse117" aria-expanded="true" aria-controls="collapse117">Weakness: The application does not define isolated boundaries (Insufficient Encapsulation) <span>[CWE-485]</span></button></h5></div><div id="collapse117" class="collapse" aria-labelledby="heading117" data-parent="#weaknesses"><div class="card-body"><div>
                        The application does not sufficiently encapsulate critical data or functionality.
                        </div>
                        <p>Encapsulation is about drawing strong boundaries. In a web browser that might mean
                        ensuring that your mobile code cannot be abused by other mobile code. On the server it might
                        mean differentiation between validated data and unvalidated data, between one user's data and
                        another's, or between data users are allowed to see and data that they are not.</p>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading116"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse116" aria-expanded="true" aria-controls="collapse116">Countermeasure: Verify the application implements strong logical boundaries <span>[INS-ENC]</span></button></h5></div><div id="collapse116" class="collapse" aria-labelledby="heading116" data-parent="#controls"><div class="card-body"><div>
                        It is important to compartmentalize or encapsulate critical data and functionality within the
                        application. This paradigm mitigates the threat from a malicious application accessing code or
                        data from the victim application, or from low-privileged users gaining access to sensitive
                        functionality or data.
                        </div>
                        <div>
                        <ul>
                        <li>Define and enforce strong logical boundaries, for example:</li>
                        <ul>
                        <li>In a web browser that might mean ensuring that mobile code cannot be abused by other
                        mobile code.</li>
                        <li>On the server it might mean differentiation between validated data and unvalidated
                        data, between one user's data and another's, or between data users are allowed to see and data
                        that they are not.</li>
                        </ul>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading142"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse142" aria-expanded="true" aria-controls="collapse142">Threat: Attackers gain unauthorised access to the application through an environment flaw <span>[7k-CWE-Environment]</span></button></h5></div><div id="collapse142" class="collapse" aria-labelledby="heading142" data-parent="#threats"><div class="card-body">This section includes everything that is outside of the source code but is still
                                critical to the security of the product that is being created. Because the issues
                                covered by this kingdom are not directly related to source code, we separated it from
                                the rest of the kingdoms.&nbsp;
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading119"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse119" aria-expanded="true" aria-controls="collapse119">Weakness: .NET Environment Issues <span>[CWE-519]</span></button></h5></div><div id="collapse119" class="collapse" aria-labelledby="heading119" data-parent="#weaknesses"><div class="card-body">This category lists weaknesses related to environmental
                        problems in .NET framework applications.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading120"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse120" aria-expanded="true" aria-controls="collapse120">Weakness: 2011 Top 25 - Risky Resource Management <span>[CWE-865]</span></button></h5></div><div id="collapse120" class="collapse" aria-labelledby="heading120" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are listed in the "Risky Resource
                        Management" section of the 2011 CWE/SANS Top 25 Most Dangerous Software
                        Errors.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading121"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse121" aria-expanded="true" aria-controls="collapse121">Weakness: Business Logic Errors <span>[CWE-840]</span></button></h5></div><div id="collapse121" class="collapse" aria-labelledby="heading121" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category identify some of the underlying
                        problems that commonly allow attackers to manipulate the business logic of an
                        application.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading122"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse122" aria-expanded="true" aria-controls="collapse122">Weakness: CERT C Secure Coding Section 08 - Memory Management (MEM) <span>[CWE-742]</span></button></h5></div><div id="collapse122" class="collapse" aria-labelledby="heading122" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the memory
                        management section of the CERT C Secure Coding Standard. Since not all rules map
                        to specific weaknesses, this category may be incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading123"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse123" aria-expanded="true" aria-controls="collapse123">Weakness: CERT C Secure Coding Section 10 - Environment (ENV) <span>[CWE-744]</span></button></h5></div><div id="collapse123" class="collapse" aria-labelledby="heading123" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the
                        environment section of the CERT C Secure Coding Standard. Since not all rules
                        map to specific weaknesses, this category may be incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading124"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse124" aria-expanded="true" aria-controls="collapse124">Weakness: CERT C++ Secure Coding Section 08 - Memory Management (MEM) <span>[CWE-876]</span></button></h5></div><div id="collapse124" class="collapse" aria-labelledby="heading124" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the Memory
                        Management (MEM) section of the CERT C++ Secure Coding Standard. Since not all
                        rules map to specific weaknesses, this category may be
                        incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading125"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse125" aria-expanded="true" aria-controls="collapse125">Weakness: CERT C++ Secure Coding Section 10 - Environment (ENV) <span>[CWE-878]</span></button></h5></div><div id="collapse125" class="collapse" aria-labelledby="heading125" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the
                        Environment (ENV) section of the CERT C++ Secure Coding Standard. Since not all
                        rules map to specific weaknesses, this category may be
                        incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading126"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse126" aria-expanded="true" aria-controls="collapse126">Weakness: Configuration <span>[CWE-16]</span></button></h5></div><div id="collapse126" class="collapse" aria-labelledby="heading126" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are typically introduced during the
                        configuration of the software.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading127"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse127" aria-expanded="true" aria-controls="collapse127">Weakness: Location <span>[CWE-1]</span></button></h5></div><div id="collapse127" class="collapse" aria-labelledby="heading127" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are organized based on which phase
                        they are introduced during the software development and deployment
                        process.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading128"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse128" aria-expanded="true" aria-controls="collapse128">Weakness: Motivation/Intent <span>[CWE-504]</span></button></h5></div><div id="collapse128" class="collapse" aria-labelledby="heading128" data-parent="#weaknesses"><div class="card-body">This category intends to capture the motivations and intentions
                        of developers that lead to weaknesses that are found within
                        CWE.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading129"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse129" aria-expanded="true" aria-controls="collapse129">Weakness: OWASP Top Ten 2010 Category A6 - Security Misconfiguration <span>[CWE-815]</span></button></h5></div><div id="collapse129" class="collapse" aria-labelledby="heading129" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to the A6 category in
                        the OWASP Top Ten 2010.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading130"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse130" aria-expanded="true" aria-controls="collapse130">Weakness: OWASP Top Ten 2013 Category A5 - Security Misconfiguration <span>[CWE-933]</span></button></h5></div><div id="collapse130" class="collapse" aria-labelledby="heading130" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to the A5 category in
                        the OWASP Top Ten 2013.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading131"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse131" aria-expanded="true" aria-controls="collapse131">Weakness: SFP Primary Cluster: Memory Management <span>[CWE-891]</span></button></h5></div><div id="collapse131" class="collapse" aria-labelledby="heading131" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Memory Management cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading132"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse132" aria-expanded="true" aria-controls="collapse132">Weakness: SFP Primary Cluster: Other <span>[CWE-907]</span></button></h5></div><div id="collapse132" class="collapse" aria-labelledby="heading132" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Other cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading133"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse133" aria-expanded="true" aria-controls="collapse133">Weakness: SFP Primary Cluster: Resource Management <span>[CWE-892]</span></button></h5></div><div id="collapse133" class="collapse" aria-labelledby="heading133" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Resource Management cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading134"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse134" aria-expanded="true" aria-controls="collapse134">Weakness: SFP Secondary Cluster: Failure to Release Resource <span>[CWE-982]</span></button></h5></div><div id="collapse134" class="collapse" aria-labelledby="heading134" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Failure to Release Resource cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading135"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse135" aria-expanded="true" aria-controls="collapse135">Weakness: SFP Secondary Cluster: Faulty Memory Release <span>[CWE-969]</span></button></h5></div><div id="collapse135" class="collapse" aria-labelledby="heading135" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Faulty Memory Release cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading136"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse136" aria-expanded="true" aria-controls="collapse136">Weakness: SFP Secondary Cluster: Faulty Resource Use <span>[CWE-983]</span></button></h5></div><div id="collapse136" class="collapse" aria-labelledby="heading136" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Faulty Resource Use cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading137"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse137" aria-expanded="true" aria-controls="collapse137">Weakness: SFP Secondary Cluster: Life Cycle <span>[CWE-984]</span></button></h5></div><div id="collapse137" class="collapse" aria-labelledby="heading137" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Life Cycle cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading138"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse138" aria-expanded="true" aria-controls="collapse138">Weakness: Technology-specific Environment Issues <span>[CWE-3]</span></button></h5></div><div id="collapse138" class="collapse" aria-labelledby="heading138" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are typically introduced during
                        unexpected environmental conditions in particular
                        technologies.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading140"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse140" aria-expanded="true" aria-controls="collapse140">Weakness: Unexpected Environment Condition <span>[CWE-2]</span></button></h5></div><div id="collapse140" class="collapse" aria-labelledby="heading140" data-parent="#weaknesses"><div class="card-body">This is a generic weakness that includes several different situations, they are all related to
                        unexpected environmental conditions and they could be related to:&nbsp;
                        <div>
                        <ul>
                        <li>Misconfiguration.</li>
                        <li>Uncleared buffers, shared memory, files, etc.&nbsp;</li>
                        <li>Problems between the interaction of two different entities that cause unexpected
                        behavior.</li>
                        </ul>
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading139"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse139" aria-expanded="true" aria-controls="collapse139">Countermeasure: Ensure there are no environmental security weaknesses <span>[ENV-USE]</span></button></h5></div><div id="collapse139" class="collapse" aria-labelledby="heading139" data-parent="#controls"><div class="card-body"><div>
                        Application security can be undermined by misconfiguration of the underlying server or
                        development environment.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        Ensure that vendor and best-practice guidelines have been applied, in particular affecting areas
                        such as:
                        </div>
                        <div>
                        <ul>
                        <li>Cryptographic strength of elements such as session tokens, GUIDs, and protection of
                        data in transit and at rest.</li>
                        <li>Removal of debugging and compiler options and artifacts used during development.</li>
                        <li>Configuration of error trapping and use of generic error messages and pages (e.g.
                        stack traces should not be returned to users).</li>
                        <li>Appropriate access controls over software components, variables (e.g. EJBs and
                        methods).</li>
                        <li>Insecure or inappropriate storage of data in configuration files or other data
                        structures (e.g. passwords in config files).</li>
                        <li>Use of compilation/build features or security enhancements provided by the IDE</li>
                        </ul>
                        </div>
                        <div></div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading141"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse141" aria-expanded="true" aria-controls="collapse141">Weakness: Weaknesses that Affect Memory <span>[CWE-633]</span></button></h5></div><div id="collapse141" class="collapse" aria-labelledby="heading141" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category affect memory
                        resources.
                    <div class="accordion" id="controls"></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading171"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse171" aria-expanded="true" aria-controls="collapse171">Threat: Attackers gain unauthorised access to the application through an error handling flaw <span>[7k-CWE-ErrorH]</span></button></h5></div><div id="collapse171" class="collapse" aria-labelledby="heading171" data-parent="#threats"><div class="card-body">Errors and error handling represent a class of API. Errors related to error handling
                                are so common that they deserve a special kingdom of their own. As with API Abuse, there are two ways to introduce an error-related security vulnerability: the most common
                                one is handling errors poorly (or not at all). The second is producing errors that either give out too much information (to possible attackers) or are difficult to handle.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading144"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse144" aria-expanded="true" aria-controls="collapse144">Weakness: An error condition is not properly handled (Error Handling) <span>[CWE-388]</span></button></h5></div><div id="collapse144" class="collapse" aria-labelledby="heading144" data-parent="#weaknesses"><div class="card-body"><div>
                        Errors and error handling represent a class of API. Errors related to error handling are so
                        common that they deserve a special kingdom of their own. As with API Abuse, there are two ways
                        to introduce an error-related security vulnerability: the most common one is handling errors
                        poorly (or not at all). The second is producing errors that either give out too much information
                        (to possible attackers) or are difficult to handle
                        </div>
                        <div>
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading143"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse143" aria-expanded="true" aria-controls="collapse143">Countermeasure: Ensure application error handling is securely and consistently implemented <span>[ERR-HAND]</span></button></h5></div><div id="collapse143" class="collapse" aria-labelledby="heading143" data-parent="#controls"><div class="card-body"><div>
                        Verbose error messages can reveal information of use to an attacker, particularly in the case of
                        debug messages or stack traces. &nbsp;Even small variations in errors returned to the user
                        can be used to infer how the application operates, or enforces security controls.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        To prevent a malicious user using error conditions to determine how the application functions in
                        order to subvert it:
                        </div>
                        <div>
                        <ul>
                        <li>Trap and log all known error conditions at the server-side</li>
                        <li>Create a generic trap for unexpected errors</li>
                        <li>Ensure the error message returned to the user is generic, or contains only an
                        obfuscated reference that can be correlated with the logged errors at the server-side. &nbsp;In
                        the case of applications delivered over HTTP, the HTTP header should also be generic to prevent
                        enumeration (e.g. all error pages should produce a consistent HTTP 500 error)</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading145"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse145" aria-expanded="true" aria-controls="collapse145">Weakness: CERT C Secure Coding Section 12 - Error Handling (ERR) <span>[CWE-746]</span></button></h5></div><div id="collapse145" class="collapse" aria-labelledby="heading145" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the error
                        handling section of the CERT C Secure Coding Standard. Since not all rules map
                        to specific weaknesses, this category may be incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading146"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse146" aria-expanded="true" aria-controls="collapse146">Weakness: CERT C++ Secure Coding Section 12 - Exceptions and Error Handling (ERR) <span>[CWE-880]</span></button></h5></div><div id="collapse146" class="collapse" aria-labelledby="heading146" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the
                        Exceptions and Error Handling (ERR) section of the CERT C++ Secure Coding
                        Standard. Since not all rules map to specific weaknesses, this category may be
                        incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading147"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse147" aria-expanded="true" aria-controls="collapse147">Weakness: CERT Java Secure Coding Section 06 - Exceptional Behavior (ERR) <span>[CWE-851]</span></button></h5></div><div id="collapse147" class="collapse" aria-labelledby="heading147" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the
                        Exceptional Behavior (ERR) section of the CERT Java Secure Coding Standard.
                        Since not all rules map to specific weaknesses, this category may be
                        incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading148"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse148" aria-expanded="true" aria-controls="collapse148">Weakness: DEPRECATED (Duplicate): General Information Management Problems <span>[CWE-225]</span></button></h5></div><div id="collapse148" class="collapse" aria-labelledby="heading148" data-parent="#weaknesses"><div class="card-body">This weakness can be found at CWE-199.<div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading149"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse149" aria-expanded="true" aria-controls="collapse149">Weakness: Failure to Handle Incomplete Element <span>[CWE-239]</span></button></h5></div><div id="collapse149" class="collapse" aria-labelledby="heading149" data-parent="#weaknesses"><div class="card-body">The software does not properly handle when a particular element
                        is not completely specified.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading150"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse150" aria-expanded="true" aria-controls="collapse150">Weakness: Failure to Handle Missing Parameter <span>[CWE-234]</span></button></h5></div><div id="collapse150" class="collapse" aria-labelledby="heading150" data-parent="#weaknesses"><div class="card-body">If too few arguments are sent to a function, the function will
                        still pop the expected number of arguments from the stack. Potentially, a
                        variable number of arguments could be exhausted in a function as
                        well.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading151"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse151" aria-expanded="true" aria-controls="collapse151">Weakness: Handler Errors <span>[CWE-429]</span></button></h5></div><div id="collapse151" class="collapse" aria-labelledby="heading151" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to improper management
                        of handlers.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading152"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse152" aria-expanded="true" aria-controls="collapse152">Weakness: Improper Check or Handling of Exceptional Conditions <span>[CWE-703]</span></button></h5></div><div id="collapse152" class="collapse" aria-labelledby="heading152" data-parent="#weaknesses"><div class="card-body">The software does not properly anticipate or handle exceptional
                        conditions that rarely occur during normal operation of the
                        software.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading153"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse153" aria-expanded="true" aria-controls="collapse153">Weakness: Improper Handling of Exceptional Conditions <span>[CWE-755]</span></button></h5></div><div id="collapse153" class="collapse" aria-labelledby="heading153" data-parent="#weaknesses"><div class="card-body">The software does not handle or incorrectly handles an
                        exceptional condition.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading154"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse154" aria-expanded="true" aria-controls="collapse154">Weakness: Improper Handling of Extra Values <span>[CWE-231]</span></button></h5></div><div id="collapse154" class="collapse" aria-labelledby="heading154" data-parent="#weaknesses"><div class="card-body">The software does not handle or incorrectly handles when more
                        values are provided than expected.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading155"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse155" aria-expanded="true" aria-controls="collapse155">Weakness: Improper Handling of Incomplete Structural Elements <span>[CWE-238]</span></button></h5></div><div id="collapse155" class="collapse" aria-labelledby="heading155" data-parent="#weaknesses"><div class="card-body">The software does not handle or incorrectly handles when a
                        particular structural element is not completely specified.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading156"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse156" aria-expanded="true" aria-controls="collapse156">Weakness: Improper Handling of Inconsistent Structural Elements <span>[CWE-240]</span></button></h5></div><div id="collapse156" class="collapse" aria-labelledby="heading156" data-parent="#weaknesses"><div class="card-body">The software does not handle or incorrectly handles when two or
                        more structural elements should be consistent, but are
                        not.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading157"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse157" aria-expanded="true" aria-controls="collapse157">Weakness: Improper Handling of Missing Values <span>[CWE-230]</span></button></h5></div><div id="collapse157" class="collapse" aria-labelledby="heading157" data-parent="#weaknesses"><div class="card-body">The software does not handle or incorrectly handles when a
                        parameter, field, or argument name is specified, but the associated value is
                        missing, i.e. it is empty, blank, or null.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading158"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse158" aria-expanded="true" aria-controls="collapse158">Weakness: Improper Handling of Structural Elements <span>[CWE-237]</span></button></h5></div><div id="collapse158" class="collapse" aria-labelledby="heading158" data-parent="#weaknesses"><div class="card-body">The software does not handle or incorrectly handles inputs that
                        are related to complex structures.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading159"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse159" aria-expanded="true" aria-controls="collapse159">Weakness: Improper Handling of Syntactically Invalid Structure <span>[CWE-228]</span></button></h5></div><div id="collapse159" class="collapse" aria-labelledby="heading159" data-parent="#weaknesses"><div class="card-body">The product does not handle or incorrectly handles input that
                        is not syntactically well-formed with respect to the associated specification.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading160"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse160" aria-expanded="true" aria-controls="collapse160">Weakness: Improper Handling of Undefined Parameters <span>[CWE-236]</span></button></h5></div><div id="collapse160" class="collapse" aria-labelledby="heading160" data-parent="#weaknesses"><div class="card-body">The software does not handle or incorrectly handles when a
                        particular parameter, field, or argument name is not defined or supported by the
                        product.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading161"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse161" aria-expanded="true" aria-controls="collapse161">Weakness: Improper Handling of Undefined Values <span>[CWE-232]</span></button></h5></div><div id="collapse161" class="collapse" aria-labelledby="heading161" data-parent="#weaknesses"><div class="card-body">The software does not handle or incorrectly handles when a
                        value is not defined or supported for the associated parameter, field, or
                        argument name.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading162"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse162" aria-expanded="true" aria-controls="collapse162">Weakness: Improper Handling of Values <span>[CWE-229]</span></button></h5></div><div id="collapse162" class="collapse" aria-labelledby="heading162" data-parent="#weaknesses"><div class="card-body">The software does not properly handle when the expected number
                        of values for parameters, fields, or arguments is not provided in input, or if
                        those values are undefined.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading163"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse163" aria-expanded="true" aria-controls="collapse163">Weakness: Information Management Errors <span>[CWE-199]</span></button></h5></div><div id="collapse163" class="collapse" aria-labelledby="heading163" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to improper handling of
                        sensitive information.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading164"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse164" aria-expanded="true" aria-controls="collapse164">Weakness: SFP Primary Cluster: Exception Management <span>[CWE-889]</span></button></h5></div><div id="collapse164" class="collapse" aria-labelledby="heading164" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Exception Management cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading165"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse165" aria-expanded="true" aria-controls="collapse165">Weakness: SFP Secondary Cluster: Ambiguous Exception Type <span>[CWE-960]</span></button></h5></div><div id="collapse165" class="collapse" aria-labelledby="heading165" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Ambiguous Exception Type cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading166"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse166" aria-expanded="true" aria-controls="collapse166">Weakness: SFP Secondary Cluster: Incorrect Exception Behavior <span>[CWE-961]</span></button></h5></div><div id="collapse166" class="collapse" aria-labelledby="heading166" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Incorrect Exception Behavior cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading167"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse167" aria-expanded="true" aria-controls="collapse167">Weakness: SFP Secondary Cluster: Unchecked Status Condition <span>[CWE-962]</span></button></h5></div><div id="collapse167" class="collapse" aria-labelledby="heading167" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Unchecked Status Condition cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading168"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse168" aria-expanded="true" aria-controls="collapse168">Weakness: Type Errors <span>[CWE-136]</span></button></h5></div><div id="collapse168" class="collapse" aria-labelledby="heading168" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are caused by improper data type
                        transformation or improper handling of multiple data
                        types.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading169"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse169" aria-expanded="true" aria-controls="collapse169">Weakness: UNIX Path Link Problems <span>[CWE-60]</span></button></h5></div><div id="collapse169" class="collapse" aria-labelledby="heading169" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to improper handling of
                        links within Unix-based operating systems.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading170"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse170" aria-expanded="true" aria-controls="collapse170">Weakness: Windows Path Link Problems <span>[CWE-63]</span></button></h5></div><div id="collapse170" class="collapse" aria-labelledby="heading170" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to improper handling of
                        links within Windows-based operating systems.
                    <div class="accordion" id="controls"></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading194"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse194" aria-expanded="true" aria-controls="collapse194">Threat: Attackers gain unauthorised access to the application through an input validation or representation flaw <span>[7k-CWE-InputVR]</span></button></h5></div><div id="collapse194" class="collapse" aria-labelledby="heading194" data-parent="#threats"><div class="card-body">Input validation and representation problems are caused by metacharacters, alternate
                                encodings and numeric representations. Security problems result from trusting input. The
                                issues include: Buffer Overflows, Cross-Site Scripting attacks, SQL Injection, and many others.&nbsp;
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading172"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse172" aria-expanded="true" aria-controls="collapse172">Weakness: CERT Java Secure Coding Section 00 - Input Validation and Data Sanitization (IDS) <span>[CWE-845]</span></button></h5></div><div id="collapse172" class="collapse" aria-labelledby="heading172" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to rules in the Input
                        Validation and Data Sanitization section of the CERT Java Secure Coding
                        Standard. Since not all rules map to specific weaknesses, this category may be
                        incomplete.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading173"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse173" aria-expanded="true" aria-controls="collapse173">Weakness: Incomplete Blacklist to Cross-Site Scripting <span>[CWE-692]</span></button></h5></div><div id="collapse173" class="collapse" aria-labelledby="heading173" data-parent="#weaknesses"><div class="card-body"><span style=", Arial, Helvetica, Geneva, sans-serif;">The product uses a blacklist-based
                        protection mechanism to defend against XSS attacks, but the blacklist is incomplete, allowing
                        XSS variants to succeed.</span>
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading174"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse174" aria-expanded="true" aria-controls="collapse174">Weakness: OWASP Top Ten 2004 Category A1 - Unvalidated Input <span>[CWE-722]</span></button></h5></div><div id="collapse174" class="collapse" aria-labelledby="heading174" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to the A1 category in
                        the OWASP Top Ten 2004.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading175"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse175" aria-expanded="true" aria-controls="collapse175">Weakness: OWASP Top Ten 2004 Category A6 - Injection Flaws <span>[CWE-727]</span></button></h5></div><div id="collapse175" class="collapse" aria-labelledby="heading175" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to the A6 category in
                        the OWASP Top Ten 2004.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading176"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse176" aria-expanded="true" aria-controls="collapse176">Weakness: OWASP Top Ten 2010 Category A1 - Injection <span>[CWE-810]</span></button></h5></div><div id="collapse176" class="collapse" aria-labelledby="heading176" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to the A1 category in
                        the OWASP Top Ten 2010.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading177"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse177" aria-expanded="true" aria-controls="collapse177">Weakness: OWASP Top Ten 2013 Category A1 - Injection <span>[CWE-929]</span></button></h5></div><div id="collapse177" class="collapse" aria-labelledby="heading177" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to the A1 category in
                        the OWASP Top Ten 2013.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading178"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse178" aria-expanded="true" aria-controls="collapse178">Weakness: Representation Errors <span>[CWE-137]</span></button></h5></div><div id="collapse178" class="collapse" aria-labelledby="heading178" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are introduced when inserting or
                        converting data from one representation into another.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading179"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse179" aria-expanded="true" aria-controls="collapse179">Weakness: SFP Primary Cluster: Risky Values <span>[CWE-885]</span></button></h5></div><div id="collapse179" class="collapse" aria-labelledby="heading179" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Risky Values cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading180"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse180" aria-expanded="true" aria-controls="collapse180">Weakness: SFP Primary Cluster: Tainted Input <span>[CWE-896]</span></button></h5></div><div id="collapse180" class="collapse" aria-labelledby="heading180" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Tainted Input cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading181"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse181" aria-expanded="true" aria-controls="collapse181">Weakness: SFP Primary Cluster: Unused entities <span>[CWE-886]</span></button></h5></div><div id="collapse181" class="collapse" aria-labelledby="heading181" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Unused entities cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading182"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse182" aria-expanded="true" aria-controls="collapse182">Weakness: SFP Secondary Cluster: Faulty Input Transformation <span>[CWE-992]</span></button></h5></div><div id="collapse182" class="collapse" aria-labelledby="heading182" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Faulty Input Transformation cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading183"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse183" aria-expanded="true" aria-controls="collapse183">Weakness: SFP Secondary Cluster: Glitch in Computation <span>[CWE-998]</span></button></h5></div><div id="collapse183" class="collapse" aria-labelledby="heading183" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Glitch in Computation cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading184"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse184" aria-expanded="true" aria-controls="collapse184">Weakness: SFP Secondary Cluster: Incorrect Input Handling <span>[CWE-993]</span></button></h5></div><div id="collapse184" class="collapse" aria-labelledby="heading184" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Incorrect Input Handling cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading185"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse185" aria-expanded="true" aria-controls="collapse185">Weakness: SFP Secondary Cluster: Tainted Input to Command <span>[CWE-990]</span></button></h5></div><div id="collapse185" class="collapse" aria-labelledby="heading185" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Tainted Input to Command cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading186"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse186" aria-expanded="true" aria-controls="collapse186">Weakness: SFP Secondary Cluster: Tainted Input to Environment <span>[CWE-991]</span></button></h5></div><div id="collapse186" class="collapse" aria-labelledby="heading186" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Tainted Input to Environment cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading187"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse187" aria-expanded="true" aria-controls="collapse187">Weakness: SFP Secondary Cluster: Tainted Input to Variable <span>[CWE-994]</span></button></h5></div><div id="collapse187" class="collapse" aria-labelledby="heading187" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Tainted Input to Variable cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading188"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse188" aria-expanded="true" aria-controls="collapse188">Weakness: SFP Secondary Cluster: Unexpected Entry Points <span>[CWE-1002]</span></button></h5></div><div id="collapse188" class="collapse" aria-labelledby="heading188" data-parent="#weaknesses"><div class="card-body">This category identifies Software Fault Patterns (SFPs) within
                        the Unexpected Entry Points cluster.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading189"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse189" aria-expanded="true" aria-controls="collapse189">Weakness: Struts Validation Problems <span>[CWE-101]</span></button></h5></div><div id="collapse189" class="collapse" aria-labelledby="heading189" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are caused by inadequately
                        implemented protection mechanisms that use the STRUTS
                        framework.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading190"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse190" aria-expanded="true" aria-controls="collapse190">Weakness: Technology-Specific Special Elements <span>[CWE-169]</span></button></h5></div><div id="collapse190" class="collapse" aria-labelledby="heading190" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to improper handling of
                        special elements within particular technologies.
                    <div class="accordion" id="controls"></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading192"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse192" aria-expanded="true" aria-controls="collapse192">Weakness: The application does not perform correct Input Validation and Representation <span>[CWE-1005]</span></button></h5></div><div id="collapse192" class="collapse" aria-labelledby="heading192" data-parent="#weaknesses"><div class="card-body">This weakness exist when an application does not properly validate or represent input. &nbsp;Input
                        validation and representation problems are caused by meta-characters, alternate encodings and
                        numeric representations. Security problems result from trusting input. The issues include: Buffer Overflows, Cross-Site Scripting attacks, SQL Injection, and many others.&nbsp;
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading191"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse191" aria-expanded="true" aria-controls="collapse191">Countermeasure: Verify the application considers the source and destination of the user data and escapes it accordingly <span>[INPUT-VAL]</span></button></h5></div><div id="collapse191" class="collapse" aria-labelledby="heading191" data-parent="#controls"><div class="card-body"><div>
                        All data received from the client-side should be considered tainted and a potential risk,
                        regardless of the source or transport method.&nbsp;As such, all data from the client side
                        must be subjected to strict validation, sanitization, and encoding against expected syntactic
                        and semantic criteria.
                        </div>
                        <div>
                        <ul>
                        <li>The user input data or data coming from other untrusted sources (tainted data) must be
                        identified and classified.</li>
                        <li>The source and destination of this data must be clearly defined.</li>
                        <li>Appropriate sanitization mechanisms should be put in place between the data flow. For
                        example,&nbsp;data sent to an SQL database must be escaped for SQL special characters,
                        whereas data sent as part of a shell command must be escaped for shell special characters.&nbsp;</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading193"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse193" aria-expanded="true" aria-controls="collapse193">Weakness: Unchecked Return Value to NULL Pointer Dereference <span>[CWE-690]</span></button></h5></div><div id="collapse193" class="collapse" aria-labelledby="heading193" data-parent="#weaknesses"><div class="card-body">The product does not check for an error after calling a function that can return with a NULL
                        pointer if the function fails, which leads to a resultant NULL pointer dereference.
                    <div class="accordion" id="controls"></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading201"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse201" aria-expanded="true" aria-controls="collapse201">Risk pattern: Datastore <span>[DATASTORE]</span></button></h5></div><div id="collapse201" class="collapse" aria-labelledby="heading201" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading200"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse200" aria-expanded="true" aria-controls="collapse200">Use case: Authentication <span>[authentication]</span></button></h5></div><div id="collapse200" class="collapse" aria-labelledby="heading200" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading199"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse199" aria-expanded="true" aria-controls="collapse199">Threat: Attackers who compromise the application or application server could directly access and modify the data store <span>[AUTH-DATASTORE-LEAST-PRIV]</span></button></h5></div><div id="collapse199" class="collapse" aria-labelledby="heading199" data-parent="#threats"><div class="card-body">If attackers gain access to the application or the application server, then they could
                                directly access the data store using the privilege assigned to the application.
                                <div>
                                If the data store user account used by the application has elevated privileges then this
                                could allow attackers to perform unauthorized operations such as dropping tables,
                                modifying the database schema or modifying data.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading198"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse198" aria-expanded="true" aria-controls="collapse198">Weakness: Execution with Unnecessary Privileges <span>[CWE-250]</span></button></h5></div><div id="collapse198" class="collapse" aria-labelledby="heading198" data-parent="#weaknesses"><div class="card-body">The software performs an operation at a privilege level that is higher than the minimum level
                        required, which creates new weaknesses or amplifies the consequences of other weaknesses.

                        New weaknesses can be exposed because running with extra privileges, such as root or
                        Administrator, can disable the normal security checks being performed by the operating system or
                        surrounding environment. Other pre-existing weaknesses can turn into security vulnerabilities if
                        they occur while operating at raised privileges. Privilege management functions can behave in
                        some less-than-obvious ways, and they have different quirks on different platforms. These
                        inconsistencies are particularly pronounced if you are transitioning from one non-root user to
                        another. Signal handlers and spawned processes run at the privilege of the owning process, so if
                        a process is running as root when a signal fires or a sub-process is executed, the signal
                        handler or sub-process will operate with root privileges.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading197"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse197" aria-expanded="true" aria-controls="collapse197">Countermeasure: Access the data store from an account with the least privileges necessary <span>[RESTRICT-ACCESS-DATABASE]</span></button></h5></div><div id="collapse197" class="collapse" aria-labelledby="heading197" data-parent="#controls"><div class="card-body">Use an account with only the minimum set of permissions required to access the data store.&nbsp;
                        The account should not be able to perform operations that are not explicitly required by the
                        component that performs these operations.
                        <div>
                        For example, if a web application needs to read data from certain tables and insert and update
                        data from others, then a database account with only those specific permissions should be used by
                        the application server.
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading202"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse202" aria-expanded="true" aria-controls="collapse202">Risk pattern: Environment Deployment <span>[DEPLOYMENT-ENVIRONMENT]</span></button></h5></div><div id="collapse202" class="collapse" aria-labelledby="heading202" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading216"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse216" aria-expanded="true" aria-controls="collapse216">Risk pattern: Generic Client <span>[GENERIC-CLIENT]</span></button></h5></div><div id="collapse216" class="collapse" aria-labelledby="heading216" data-parent="#components"><div class="card-body">Generic client component, e.g. thick client, client to an API or web service<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading208"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse208" aria-expanded="true" aria-controls="collapse208">Use case: General <span>[GENERAL]</span></button></h5></div><div id="collapse208" class="collapse" aria-labelledby="heading208" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading207"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse207" aria-expanded="true" aria-controls="collapse207">Threat: Attackers gain unauthorised access to data or services by accessing a client side secret <span>[CSD-CLIENT-SECRET]</span></button></h5></div><div id="collapse207" class="collapse" aria-labelledby="heading207" data-parent="#threats"><div class="card-body">Secrets stored in any client side components, such as a mobile application, thick
                                client application or in JavaScript used by a browser, can be accessed by
                                users/attackers who have access to this client.
                                <div>
                                <br />
                                </div>
                                <div>
                                Attackers could then gain access to the data or services that are protected by this
                                secret, if no other credentials are required.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading204"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse204" aria-expanded="true" aria-controls="collapse204">Weakness: Client side code stores secret keys, sensitive business logic or other proprietary information <span>[CWE-798, CWE-603]</span></button></h5></div><div id="collapse204" class="collapse" aria-labelledby="heading204" data-parent="#weaknesses"><div class="card-body">Client side code is fully controlled by the user, a malicious user could read the code or
                        reverse engineer it if it is compiled on any form.&nbsp;&nbsp;
                        <div>
                        &nbsp;
                        <br />If the client side code includes secret keys, sensitive business logic &nbsp;(like
                        client authentication) or proprietary information, all of this is directly exposed to the user,
                        allowing him to get the sensitive information or study the business logic with the aim of
                        bypassing it. Some examples of this which are Vulnerabilities are:
                        <ul>
                        <li>Perform an authentication on the client side without server side validation.&nbsp;</li>
                        <li>Make privileged calls from the client based solely on client side conditions (i.e. a
                        cash check on client side and then to place a buy on an e-commerce platform).</li>
                        <li>Hard-coding keys and secrets on client side to make client-to-client calls without a
                        proxy.</li>
                        </ul>
                        <br />
                        <br />
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading203"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse203" aria-expanded="true" aria-controls="collapse203">Countermeasure: Implement sensitive logic and data validation on the server-side <span>[CS-CLIENT-SECRET]</span></button></h5></div><div id="collapse203" class="collapse" aria-labelledby="heading203" data-parent="#controls"><div class="card-body"><div>
                        All data and functionality at the client-side must be considered tainted and subject to
                        manipulation by a malicious actor, regardless of the controls in place (e.g. encryption or
                        obfuscation of client-side code or content). &nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        This includes application logic decisions, such as access controls, and data considered
                        sensitive or secret, such as encryption keys.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        While controls may be duplicated at the client-side to improve the user experience, it is
                        important these are enforced at the server-side.
                        </div>
                        <div>
                        <ul>
                        <li>Business logic, in particular access controls, must be implemented at the server-side.
                        &nbsp;</li>
                        <li>Secret data should be stored at the server-side, and only that which is explicitly
                        required be duplicated at the client-side.</li>
                        <li>All data provided from the client-side (even from binary clients) should be considered
                        tainted, and security decisions should not be made solely on this data.</li>
                        </ul>
                        </div>
                        <div>
                        For example, an insecure implementation could include a compiled application (e.g. Flash!)
                        performing authentication at the client-side against a stored password. &nbsp;Decompilation
                        of the binary (in this case flv file) or interception and modification of controls between the
                        client and server could expose the password or allow unauthorized access to the authenticated
                        application content.
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading206"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse206" aria-expanded="true" aria-controls="collapse206">Weakness: Secrets, API keys and or passwords are included in the source code or online repositories <span>[CWE-312]</span></button></h5></div><div id="collapse206" class="collapse" aria-labelledby="heading206" data-parent="#weaknesses"><div class="card-body">API keys, passwords or secrets included in the source code or in the configuration files can be leaked to users with access to the code. This access can be incidentally granted by publishing the source code on a package-form or an online, public repository.

          The unauthorized access to any of those secrets could lead to a compromise of sensitive data or a system.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading205"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse205" aria-expanded="true" aria-controls="collapse205">Countermeasure: Review code, configuration, and online repositories for secrets and sensitive information systemically <span>[CSD-CLIENT-SECRET]</span></button></h5></div><div id="collapse205" class="collapse" aria-labelledby="heading205" data-parent="#controls"><div class="card-body"><div>
                        Secret or sensitive information should not be exposed in the source-code or client-side
                        software.
                        </div>
                        <div>
                        <ul>
                        <li>Code and online repositories must not contain secrets or sensitive information.</li>
                        <li>Configuration files at the client- and server-side must not contain hard-coded
                        credentials or other sensitive data.</li>
                        <li>Online repositories, services, and other associated restricted content must have
                        appropriate access controls in place.</li>
                        <li>Where sensitive information must be stored at the server side, it should be in memory
                        for transient data, or encrypted if persistent. &nbsp;Depending on the use case, this
                        encryption may be asymmetric or public key, or symmetric using a shared secret. Note however
                        that reversible encryption at the client-side and in-memory storage are still susceptible to
                        client-side attacks.</li>
                        </ul>
                        </div>
                        <div></div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading215"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse215" aria-expanded="true" aria-controls="collapse215">Use case: Read or Post data <span>[READ OR POST DATA]</span></button></h5></div><div id="collapse215" class="collapse" aria-labelledby="heading215" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading214"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse214" aria-expanded="true" aria-controls="collapse214">Threat: Attackers could gain access to sensitive data through a man in the middle attack <span>[NTW-MITM]</span></button></h5></div><div id="collapse214" class="collapse" aria-labelledby="heading214" data-parent="#threats"><div class="card-body">This type of attack targets the communication between two components (typically client
                                and server). The attacker places himself in the communication channel between the two
                                components. Whenever one component attempts to communicate with the other (data flow,
                                authentication challenges, etc.), the data first goes to the attacker, who has the
                                opportunity to observe or alter it, and it is then passed on to the other component as
                                if it was never intercepted. This interposition is transparent leaving the two
                                compromised components unaware of the potential corruption or leakage of their
                                communications. The potential for Man-in-the-Middle attacks yields an implicit lack of
                                trust in communication or identify between two components.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading211"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse211" aria-expanded="true" aria-controls="collapse211">Weakness: A connection to an external system is performed in plain text <span>[CWE-311]</span></button></h5></div><div id="collapse211" class="collapse" aria-labelledby="heading211" data-parent="#weaknesses"><div class="card-body">Connections made in plain text are not only target for interception but, even when the component is not dealing with sensitive data, a man in the middle attack is possible and the attacker could pretend to be, i.e. an authentication system to gain the user's credentials.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading209"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse209" aria-expanded="true" aria-controls="collapse209">Countermeasure: Validate the certificate presented by the server <span>[CWE-295-CLIENT]</span></button></h5></div><div id="collapse209" class="collapse" aria-labelledby="heading209" data-parent="#controls"><div class="card-body"><div>
  Certificates presented by the server must be valid, provable, and cryptographically secure in order to derive the benefits of TLS encrypted communications.&nbsp; Invalid certificates expose the application and its users to spoofing attacks such as Man In The Middle (MITM) where data may be intercepted or redirected to a malicious site, and undermine confidence in the site. 
</div> 
<div> 
 <ul> 
  <li> 
   <div>
     Validate that the certificate presented by the server is signed by a trusted Certificate Authority. 
   </div></li> 
  <li> 
   <div>
     Ensure the certificate chain of trust is legitimate and secure. 
   </div></li> 
  <li> 
   <div>
     Verify cryptographically secure ciphers are in use throughout the chain, in particular strong hashing algorithms are in use for certificate signatures.&nbsp; 
   </div></li> 
 </ul> 
</div></div></div></div><div class="card border-success"><div class="card-header " id="heading210"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse210" aria-expanded="true" aria-controls="collapse210">Countermeasure: Encrypt data between the client and server/service <span>[CWE-319-TRANSPORT]</span></button></h5></div><div id="collapse210" class="collapse" aria-labelledby="heading210" data-parent="#controls"><div class="card-body"><div>
  Data passed between the client and server should be protected by encryption in transit. 
</div> 
<div> 
 <ul> 
  <li>Implement cryptographically strong TLS end-to-end encryption between the client and server, terminating within a secure environment on the server-side.</li> 
  <li>Consider use of client certificates to prevent interception of (or man-in-the-middle attacks on) the encrypted connection.</li> 
  <li>Alternatively, asymmetric (public-key) encryption could be utilized, although a recognized, proven, and tested implementation/library should be used</li> 
 </ul> 
</div></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading213"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse213" aria-expanded="true" aria-controls="collapse213">Weakness: The component uses a weak TLS implementeation <span>[CWE-327]</span></button></h5></div><div id="collapse213" class="collapse" aria-labelledby="heading213" data-parent="#weaknesses"><div class="card-body">The use of an unverified TLS library could lead to the use of weak or faulty implementations
                        of the TLS protocol and cipher suites.
                        <br />
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading212"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse212" aria-expanded="true" aria-controls="collapse212">Countermeasure: Validate the TLS implementation in use <span>[CWE-327]</span></button></h5></div><div id="collapse212" class="collapse" aria-labelledby="heading212" data-parent="#controls"><div class="card-body"><div>
  There are a number of established open- and closed- source TLS implementations in use, which have undergone extensive review and testing by the developers, as well as third-parties in the development, security, and cryptography space. Typically, these widely used implementations have a lower risk of exploitation to internally developed or less known implementations (although vulnerabilities such as Heartbleed highlight that this is not universally true) due to this additional scrutiny. 
</div> 
<div> 
 <ul> 
  <li>Identify the TLS and other cryptographic libraries, implementations, and technologies in use.</li> 
  <li>Verify the progeny of the implementations, and review third party validation together with security advisories or best-practice relating to them.</li> 
  <li>Some well-known TLS libraries are NSS from Mozilla, and OpenSSL.</li> 
  <li>Where an unknown or unproven implementation is in use, review use of an established option.</li> 
 </ul> 
</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading229"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse229" aria-expanded="true" aria-controls="collapse229">Risk pattern: Generic Client: Authentication <span>[GENERIC-CLIENT:AUTHN]</span></button></h5></div><div id="collapse229" class="collapse" aria-labelledby="heading229" data-parent="#components"><div class="card-body">Authentication from a client component, such as web service or other API client<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading228"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse228" aria-expanded="true" aria-controls="collapse228">Use case: Authentication <span>[AUTHENTICATION]</span></button></h5></div><div id="collapse228" class="collapse" aria-labelledby="heading228" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading219"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse219" aria-expanded="true" aria-controls="collapse219">Threat: Attackers bypass authentication implemented on the client side <span>[CAPEC-21]</span></button></h5></div><div id="collapse219" class="collapse" aria-labelledby="heading219" data-parent="#threats"><div class="card-body">If a predictable token is used to authorize requests to read or post data, or if the
                                token can easily be compromised, then an attacker could use this token to impersonate
                                the user.&nbsp;
                                <div>
                                &nbsp;
                                <br />In mobile applications, using seemingly unique values such as the IMEI or
                                UDID numbers to authorize users can be abused since any application on the device can
                                read these values.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading218"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse218" aria-expanded="true" aria-controls="collapse218">Weakness: Client-side Enforcement of Server-Side Security <span>[CWE-602]</span></button></h5></div><div id="collapse218" class="collapse" aria-labelledby="heading218" data-parent="#weaknesses"><div class="card-body">The software is composed of a server that relies on the client to implement a mechanism that
                        is intended to protect the server.&nbsp;
                        <div>
                        &nbsp;
                        <br />When the server relies on protection mechanisms placed on the client side, an
                        attacker can modify the client-side behavior to bypass the protection mechanisms resulting in
                        potentially unexpected interactions between the client and server. The consequences will vary,
                        depending on what the mechanisms are trying to protect.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading217"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse217" aria-expanded="true" aria-controls="collapse217">Countermeasure: Enforce authentication on the server-side <span>[CWE-592]</span></button></h5></div><div id="collapse217" class="collapse" aria-labelledby="heading217" data-parent="#controls"><div class="card-body"><div>
                        All data at the client-side must be considered tainted. &nbsp;As such, decisions on
                        authentication (or Identification and Verification - ID&amp;V) must be made or validated at
                        the server-side to prevent their subversion.
                        </div>
                        <div>
                        <ul>
                        <li>The server should compare the credentials with those stored at the server-side (e.g.
                        the hashed password compared against those stored for the claimed identity).</li>
                        <li>Messages returned to the user during authentication, in particular when the process
                        fails, should not reveal to the user whether the username was valid. &nbsp;Returning generic
                        errors prevents an attacker enumerating valid account IDs for subsequent attacks.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading222"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse222" aria-expanded="true" aria-controls="collapse222">Threat: Attackers gain access to in-memory passwords/credentials <span>[CSD-PWD-MEM]</span></button></h5></div><div id="collapse222" class="collapse" aria-labelledby="heading222" data-parent="#threats"><div class="card-body">If the component handles credentials and it does not do a proper clean-up of them in
                                memory, they could be accessed by an attacker by inspecting the memory or reading
                                segments of the disk in which a swapped memory page could have been saved.&nbsp;
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading221"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse221" aria-expanded="true" aria-controls="collapse221">Weakness: The application does not wipe used and not needed passwords or key material <span>[CWE-255]</span></button></h5></div><div id="collapse221" class="collapse" aria-labelledby="heading221" data-parent="#weaknesses"><div class="card-body">When using password or key material within an application, these are copied in memory and can be copied back to the disk depending on several factors.

If the application handles passwords or key material, an attacker with access to the system could inspect the memory or the hard disk to retrieve back those secrets on its original form.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading220"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse220" aria-expanded="true" aria-controls="collapse220">Countermeasure: Overwrite passwords, key material, and other secrets maintained in memory when no longer required <span>[CSD-PWD-MEM]</span></button></h5></div><div id="collapse220" class="collapse" aria-labelledby="heading220" data-parent="#controls"><div class="card-body"><div>
                        A number of significant attacks rely on accessing sensitive data in the memory of targeted
                        servers and end-user systems. Attacks typically require physical or local access, but remote
                        instances such as the Heartbleed bug in OpenSSL were exploitable remotely. The vulnerability
                        exists as memory occupied by sensitive data is not overwritten when freed, which allows an
                        attacker to subsequently inspect the memory used by the process, or read data through an
                        uninitialized variable to gain access to the sensitive data.
                        </div>
                        <div>
                        <ul>
                        <li>Overwrite sensitive information (in particular keys, passwords, and other secret
                        values) with random data or zeros immediately they are not required to mitigate the threat.</li>
                        </ul>
                        </div>
                        <div>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading227"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse227" aria-expanded="true" aria-controls="collapse227">Threat: Attackers with access to a victim's client could read locally stored credentials <span>[CAPEC-204-AUTOCOMPLETE]</span></button></h5></div><div id="collapse227" class="collapse" aria-labelledby="heading227" data-parent="#threats"><div class="card-body">If the application accepts sensitive data through forms, then browsers could cache
                                that data and redisplay it if an attacker views the same form in the same browser. This
                                requires the attacker to have access to the victim's browser.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading224"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse224" aria-expanded="true" aria-controls="collapse224">Weakness: Cleartext or reversible Storage of Credentials <span>[CWE-312]</span></button></h5></div><div id="collapse224" class="collapse" aria-labelledby="heading224" data-parent="#weaknesses"><div class="card-body">The application stores sensitive information in cleartext within a resource that might be
                        accessible to another control sphere.&nbsp;
                        <div>
                        &nbsp;
                        <br />Because the information is stored in cleartext, attackers could potentially read it.
                        Even if the information is encoded in a way that is not human-readable, certain techniques could
                        determine which encoding is being used, then decode the information.&nbsp;
                        </div>
                        <div>
                        &nbsp;
                        <br />Cache objects are another source of this weakness, an attacker can examine a target
                        application's cache for sensitive information. Many applications that communicate with remote
                        entities or which perform intensive calculations utilize caches to improve efficiency. However,
                        if the application computes or receives sensitive information and the cache is not appropriately
                        protected, an attacker can browse the cache and retrieve this information. This can result in
                        the disclosure of sensitive information.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading223"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse223" aria-expanded="true" aria-controls="collapse223">Countermeasure: Disable authentication form autocomplete / pre-fill <span>[CWE-312]</span></button></h5></div><div id="collapse223" class="collapse" aria-labelledby="heading223" data-parent="#controls"><div class="card-body"><div>
                        Auto-completion or pre-filling of authentication details by the browser implies that credentials
                        are stored in plaintext or a reversible format. This may be in violation of security
                        best-practice, or application security expectations. The application should attempt to mitigate
                        this risk by requesting the browser does not cache or store credentials.
                        </div>
                        <div>
                        <ul>
                        <li>All forms handling sensitive data should be protected using the autocomplete=off HTML
                        directive at the form or field level.</li>
                        <li>Issue browser specific directives to request auto-fill or completion is disabled; The
                        AUTOCOMPLETE attribute should be set to &quot;OFF&quot;.</li>
                        </ul>
                        <div>
                        It should be noted that compliance with these requests at the client-side is optional, and many
                        browsers and clients override these directives to use operating system, browser, or third party
                        password managers or key-safes to store secrets.
                        </div>
                        </div>
                        <div></div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading226"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse226" aria-expanded="true" aria-controls="collapse226">Weakness: Use of Hard-coded Credentials <span>[CWE-798]</span></button></h5></div><div id="collapse226" class="collapse" aria-labelledby="heading226" data-parent="#weaknesses"><div class="card-body">The software contains hard-coded credentials, such as a
                        password or cryptographic key, which it uses for its own inbound authentication,
                        outbound communication to external components, or encryption of internal
                        data.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading225"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse225" aria-expanded="true" aria-controls="collapse225">Countermeasure: Avoid the usage of static "API keys" and similar <span>[AVOID-API-KEYS]</span></button></h5></div><div id="collapse225" class="collapse" aria-labelledby="heading225" data-parent="#controls"><div class="card-body">Avoid to use of static &quot;API keys&quot; or similar when we have to access to
                        external systems. We have to create a mechanisms to generate, manage and delete API keys to
                        grant access to external systems.
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading238"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse238" aria-expanded="true" aria-controls="collapse238">Risk pattern: Generic Off the Shelf Service <span>[GENERIC-OTS-SERVICE]</span></button></h5></div><div id="collapse238" class="collapse" aria-labelledby="heading238" data-parent="#components"><div class="card-body">An off the shelf service that was not developed internally.  The controls associated with this pattern are aimed at managing a service where the code cannot be changed.<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading237"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse237" aria-expanded="true" aria-controls="collapse237">Use case: Access service <span>[ACCESS SERVICE]</span></button></h5></div><div id="collapse237" class="collapse" aria-labelledby="heading237" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading233"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse233" aria-expanded="true" aria-controls="collapse233">Threat: Attackers gain access to unauthorised data by exploiting vulnerabilities in the service <span>[VULN-SERVICE]</span></button></h5></div><div id="collapse233" class="collapse" aria-labelledby="heading233" data-parent="#threats"><div class="card-body">Attackers exploit vulnerabilities in the service and gain access to data, or to
                                services for which they are not authorized.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading232"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse232" aria-expanded="true" aria-controls="collapse232">Weakness: The service contains vulnerabilities that could grant access to data <span>[CWE-284]</span></button></h5></div><div id="collapse232" class="collapse" aria-labelledby="heading232" data-parent="#weaknesses"><div class="card-body">The services may contain security vulnerabilities that can be exploited by attackers to gain unauthorized access to data or additional services.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading230"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse230" aria-expanded="true" aria-controls="collapse230">Countermeasure: Apply required security patches to the service <span>[PATCH-SERVICE]</span></button></h5></div><div id="collapse230" class="collapse" aria-labelledby="heading230" data-parent="#controls"><div class="card-body"><div>
                        <div>
                        Vendors and other maintainers of software release patches in response to security flaws and
                        other bugs in their products.&nbsp; The longer a system is exposed with a known security
                        vulnerability, the easier to compromise it is as the exploit became public, they get included
                        into automated exploitation suites like Metasploit and a wider audience is able to exploit them.&nbsp;
                        &nbsp;
                        </div>
                        <div>
                        <ul>
                        <li>Apply patches and other software updates in a timely manner to prevent unexpected
                        failures or exploitation.</li>
                        <li>Clearly define an approach for testing and applying patches, in particular security
                        patches, with expected timescales. &nbsp;There is often a small window between release of a
                        patch, and potentially malicious actors reverse-engineering the patch to identify and exploit
                        the flaw.</li>
                        <li>Use a threat intelligence, vulnerability scanning, or other alerting service to ensure
                        the project team is aware of issues within the project or its components promptly.</li>
                        </ul>
                        </div>
                        </div>
                        <div>
                        <br />
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading231"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse231" aria-expanded="true" aria-controls="collapse231">Countermeasure: Restrict access to the service at the network layer to reduce exposure <span>[RESTRICT-SERVICE]</span></button></h5></div><div id="collapse231" class="collapse" aria-labelledby="heading231" data-parent="#controls"><div class="card-body"><div>
                        Access to services should be restricted to expected sources, limiting exposure of the service
                        and its attack surface; and the likelihood of a malicious actor gaining access to the system.
                        </div>
                        <div>
                        <ul>
                        <li>Apply network layer security controls so that only the necessary and expected IP
                        addresses are permitted access to connect to the service.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading236"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse236" aria-expanded="true" aria-controls="collapse236">Threat: Attackers obtain unauthorised access by connecting directly to the service <span>[CAPEC-115]</span></button></h5></div><div id="collapse236" class="collapse" aria-labelledby="heading236" data-parent="#threats"><div class="card-body">If the component does not require authentication then an attacker can simply connect
                                directly to the service to obtain the data.&nbsp;
                                <div>
                                &nbsp;
                                <br />This risk may also apply to data that is not necessarily sensitive, but is
                                non-public. &nbsp;For example, obtaining timely market information which is not
                                freely available through any other service.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading235"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse235" aria-expanded="true" aria-controls="collapse235">Weakness: Missing Authentication for Critical Function <span>[CWE-306]</span></button></h5></div><div id="collapse235" class="collapse" aria-labelledby="heading235" data-parent="#weaknesses"><div class="card-body">The software does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading234"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse234" aria-expanded="true" aria-controls="collapse234">Countermeasure: Require authentication before presenting restricted data <span>[CWE-306-SERVICE]</span></button></h5></div><div id="collapse234" class="collapse" aria-labelledby="heading234" data-parent="#controls"><div class="card-body"><div>
              The application should ensure users have undergone an Identification and Verification (ID&amp;V) process before allowing access to secret, sensitive or otherwise restricted data. For less sensitive but still restricted data, simple verification of the location of the user may suffice
              (e.g. IP restrictions).
              </div>
              <div>
              <ul>
              <li>For non-sensitive but non-public data, access could be restricted by IP address, for example limiting access to internal networks, workstations, or gateways</li>
              <li>For more sensitive data, TLS client-side certificates may be appropriate</li>
              <li>Where secret or other sensitive data is handled, a full authentication process to identify and validate users with single or multi-factor authentication may be required</li>
              </ul>
              </div>
          </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading249"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse249" aria-expanded="true" aria-controls="collapse249">Risk pattern: Generic Off the Shelf Service: Single factor Authentication <span>[GENERIC-OTS-SERVICE:AUTHN-SF]</span></button></h5></div><div id="collapse249" class="collapse" aria-labelledby="heading249" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading248"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse248" aria-expanded="true" aria-controls="collapse248">Use case: Authentication <span>[AUTHENTICATION]</span></button></h5></div><div id="collapse248" class="collapse" aria-labelledby="heading248" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading242"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse242" aria-expanded="true" aria-controls="collapse242">Threat: Attacks against the authentication system may go undetected <span>[CWE-778-AUTH]</span></button></h5></div><div id="collapse242" class="collapse" aria-labelledby="heading242" data-parent="#threats"><div class="card-body">Automated attacks against many user accounts, or successful attacks against an account
                                require a response. &nbsp;If audit logs are not kept of both successful and
                                unsuccessful authentication operations, then post attack forensics will be hampered.&nbsp;&nbsp;
                                <div>
                                &nbsp;
                                <br />Without a dynamic response to mass automated attacks against the
                                authentication system, attackers stand a greater chance of success.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading241"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse241" aria-expanded="true" aria-controls="collapse241">Weakness: Insufficient Logging <span>[CWE-778]</span></button></h5></div><div id="collapse241" class="collapse" aria-labelledby="heading241" data-parent="#weaknesses"><div class="card-body">When a security-critical event occurs, the software either does not record the event or omits important details about the event when logging it.

When security-critical events are not logged properly, such as a failed login attempt, this can make malicious behavior more difficult to detect and may hinder forensic analysis after an attack succeeds.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading239"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse239" aria-expanded="true" aria-controls="collapse239">Countermeasure: Log details of user actions within the system <span>[CDS-USER-TRACK]</span></button></h5></div><div id="collapse239" class="collapse" aria-labelledby="heading239" data-parent="#controls"><div class="card-body"><p>To maintain proper accountability, logs should be maintained with sufficient information to track user actions within the system. These logs should be forensically sound, non-repudiable, and contain comprehensive details about activity. While the exact data for an event may vary, the following should be captured at a minimum:</p> 
<ul> 
 <li>Timestamps against a proven external source (e.g. an NTP server)</li> 
 <li>Origin, with this field we mark if the logs are provided by a trusted or untrusted source.</li> 
 <li>Event, status, and/or&nbsp;error codes (with sensitive data masked as appropriate or not introduced in logs)</li> 
 <li>Service, command, application or function name and details</li> 
 <li>User or system account associated with an event</li> 
 <li>Devices used (e.g. source and destination IPs, terminal session ID, web browser, etc)</li> 
</ul> 
<div>
  Source:&nbsp;&nbsp; 
 <a href="https://security.berkeley.edu/security-audit-logging-guideline">https://security.berkeley.edu/security-audit-logging-guideline</a> 
</div></div></div></div><div class="card border-success"><div class="card-header " id="heading240"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse240" aria-expanded="true" aria-controls="collapse240">Countermeasure: Use a synchronised time source <span>[CWE-662]</span></button></h5></div><div id="collapse240" class="collapse" aria-labelledby="heading240" data-parent="#controls"><div class="card-body"><div>
                        In order to correlate logs and data from different internal and external systems, and to
                        preserve forensic quality of the logs, it is important a unified and trusted synchronized time
                        source is used throughout the environment.&nbsp;&nbsp;
                        </div>
                        <div>
                        <ul>
                        <li>Servers should be synchronize to an internal or external NTP server</li>
                        <li>The centralized source should in turn use (or be) a trusted central time source.</li>
                        </ul>
                        </div>
                        <div>
                        This control is critical in identifying application events (including attacks) through logging,
                        and in conduction post-event analysis, in particular to track the whole user (or attacker)
                        journey through the system should it be compromised.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        It is good practice to use the concept of Indicators of Compromise (IoC) should be used to
                        detect possible situations in which the system has been compromised and to give an appropriate
                        response.&nbsp; IoCs are often tracked through logs, and accurate time is often essential.
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading247"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse247" aria-expanded="true" aria-controls="collapse247">Threat: Dictionary-based or brute force password attack <span>[CAPEC-16]</span></button></h5></div><div id="collapse247" class="collapse" aria-labelledby="heading247" data-parent="#threats"><div class="card-body">An attacker tries each of the words in a dictionary as passwords to gain access to
                                the system via some user's account. If the password chosen by the user was a word
                                within the dictionary, this attack will be successful (in the absence of other
                                mitigations). This is a specific instance of the password brute forcing attack
                                pattern.</br>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading244"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse244" aria-expanded="true" aria-controls="collapse244">Weakness: Poor quality passwords in use <span>[CWE-521]</span></button></h5></div><div id="collapse244" class="collapse" aria-labelledby="heading244" data-parent="#weaknesses"><div class="card-body">The product does not enforce a strong password policy, which makes it easier for attackers to
                        compromise user accounts through brute force or dictionary based attacks.&nbsp;
                        <div>
                        &nbsp;
                        <br />An authentication mechanism is only as strong as its credentials. For this reason,
                        it is important to require users to have strong passwords. Lack of password complexity
                        significantly reduces the search space when trying to guess user's passwords, making brute-force
                        attacks easier.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading243"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse243" aria-expanded="true" aria-controls="collapse243">Countermeasure: Require the use of strong passwords <span>[CWE-521]</span></button></h5></div><div id="collapse243" class="collapse" aria-labelledby="heading243" data-parent="#controls"><div class="card-body"><div>
                        Passwords used either as a sole verification credentials, or as part of a multi-factor
                        authentication, are a key aspect of application security, and strong password selection should
                        be encouraged and enforced. The application should allow flexibility in user password selection,
                        and enforce minimum criteria for password quality. This should include:
                        </div>
                        <div>
                        <ul>
                        <li>Minimum password length requirements, to mitigate brute-force and dictionary attacks.</li>
                        <li>Encourage use of pass-phrases using multiple words, achieving longer passwords more
                        resistant to attack.</li>
                        <li>Enforce use of mixed case, numeric and/or special characters to increase complexity.</li>
                        <li>Prevent or discourage use of dictionary words and common passwords through
                        black-lists. For example, a set of commonly used passwords can be found on SecLists at&nbsp;<a
                        href="https://github.com/danielmiessler/SecLists/tree/master/Passwords">https://github.com/danielmiessler/SecLists/tree/master/Passwords</a>&nbsp;</li>
                        </ul>
                        </div>
                        <div>
                        <p><b>Password length</b></p>
                        <p>Password length considers the minimum and maximum length of characters comprising the
                        password of your users. For ease of changing this length, its implementation can be configurable
                        possibly using a properties file or xml configuration file.</p>
                        <ul>
                        <li>Minimum length. Passwords should be at least ten (10) characters long. Combining this
                        length with complexity makes a password difficult to guess and/or brute force.</li>
                        <li>Maximum length. People tend to forget their passwords easily. The longer the password,
                        the more likely people are to enter them incorrectly for the system. However, long pass-phrases
                        can be easily remembered, and should not be prevented through unnecessarily strict upper
                        restrictions on length.</li>
                        </ul>
                        <p><b>Password Complexity</b></p>
                        <ul>
                        <li>Password characters should be a combination of alphanumeric characters. Alphanumeric
                        characters consist of letters, numbers, punctuation marks, mathematical and other conventional
                        symbols.</li>
                        <li>For change and reset password functionality it is recommended a history of old
                        password (salted) hashes used. This can be used to prevent password reuse, or an attacker
                        alternating between a selection of passwords (Monday1, Tuesday2 etc.)</li>
                        <li>Actual passwords must not be stored, to protect them against brute forcing if the
                        database is compromised.</li>
                        </ul>
                        </div>
                        <div>
                        <ul>
                        </ul>
                        <ul>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading246"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse246" aria-expanded="true" aria-controls="collapse246">Weakness: Service is exposed to a wide attack surface <span>[UNRESTRICTED-NETWORK]</span></button></h5></div><div id="collapse246" class="collapse" aria-labelledby="heading246" data-parent="#weaknesses"><div class="card-body">The product is exposed or reachable to an unnecessarily large group of potential attackers. An
                        over-exposure of a component increases the chance of an attacker gaining access to the system
                        through a vulnerability.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading245"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse245" aria-expanded="true" aria-controls="collapse245">Countermeasure: Restrict access to the service at the network layer <span>[RESTRICT-SERVICE]</span></button></h5></div><div id="collapse245" class="collapse" aria-labelledby="heading245" data-parent="#controls"><div class="card-body"><div>
                        Access to APIs should be restricted to expected sources, limiting exposure of the service and
                        its attack surface, and therefore likelihood of a malicious party gaining access to the system.
                        </div>
                        <div>
                        <ul>
                        <li>Apply network layer security controls so that only the necessary and expected IP
                        addresses are permitted access to connect to the service.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading265"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse265" aria-expanded="true" aria-controls="collapse265">Risk pattern: Generic Service <span>[GENERIC-SERVICE]</span></button></h5></div><div id="collapse265" class="collapse" aria-labelledby="heading265" data-parent="#components"><div class="card-body">Generic Service<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading260"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse260" aria-expanded="true" aria-controls="collapse260">Use case: General <span>[GENERAL]</span></button></h5></div><div id="collapse260" class="collapse" aria-labelledby="heading260" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading252"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse252" aria-expanded="true" aria-controls="collapse252">Threat: Attackers gain control of the system through a source code leakage <span>[SOURCE-LEAK]</span></button></h5></div><div id="collapse252" class="collapse" aria-labelledby="heading252" data-parent="#threats"><div class="card-body">Attackers gain unauthorized access to a service by reading raw source code returned by
                                the service, if this code contains confidential information such as authentication
                                credentials or other secrets that can be used to access the service.&nbsp;
                                <div>
                                <br />
                                </div>
                                <div>
                                Configuration files that can be downloaded from the service could also be used to gain
                                access to sensitive information.&nbsp;
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading251"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse251" aria-expanded="true" aria-controls="collapse251">Weakness: The service returns back-end source code without interpreting it <span>[CWE-541]</span></button></h5></div><div id="collapse251" class="collapse" aria-labelledby="heading251" data-parent="#weaknesses"><div class="card-body">If an include file source is accessible, the file can contain usernames and passwords, as well
                        as sensitive information pertaining to the application and system. The source code can also be
                        sent back to a client because of an error condition or an improperly configured handler.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading250"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse250" aria-expanded="true" aria-controls="collapse250">Countermeasure: Prevent unauthorised access to source code through the service <span>[CWE-541]</span></button></h5></div><div id="collapse250" class="collapse" aria-labelledby="heading250" data-parent="#controls"><div class="card-body"><div>
                        Access to the source-code for the application can aid an attacker in determined bugs or
                        vulnerabilities in the code or logic. For closed-source projects it is therefore important to
                        control and restrict access to the source. Application services may unexpectedly expose code,
                        for example a service providing files to a user could be manipulated to access source code if
                        implemented insecurely.
                        </div>
                        <div>
                        <p></p>
                        <ul>
                        <li>Ensure that source code is not inadvertently disclosed through misconfiguration or
                        vulnerabilities in the service.</li>
                        <li>Check that configuration files are not downloadable directly from the service, and
                        cannot be read and viewed through the service itself.</li>
                        <li>Ensure backups, operating system, and version control artifacts do not expose code.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading256"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse256" aria-expanded="true" aria-controls="collapse256">Threat: Attackers subvert the intended workflow of the application in order to perform unauthorised operations <span>[CAPEC-172]</span></button></h5></div><div id="collapse256" class="collapse" aria-labelledby="heading256" data-parent="#threats"><div class="card-body">If an application enforces an order in workflows, then attackers could attempt to
                                bypass this order so that they can perform operations for which they are not authorized.
                                <div>
                                The technique can also be used to gain access to unauthorized data.&nbsp;
                                <br />
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading255"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse255" aria-expanded="true" aria-controls="collapse255">Weakness: Improper Enforcement of Behavioral Workflow <span>[CWE-841]</span></button></h5></div><div id="collapse255" class="collapse" aria-labelledby="heading255" data-parent="#weaknesses"><div class="card-body">The software supports a session in which more than one behavior
                        must be performed by an actor, but it does not properly ensure that the actor
                        performs the behaviors in the required sequence.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading253"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse253" aria-expanded="true" aria-controls="collapse253">Countermeasure: Detect and notify the usage of automated tools or unusual behavior <span>[OTG-BUSLOGIC]</span></button></h5></div><div id="collapse253" class="collapse" aria-labelledby="heading253" data-parent="#controls"><div class="card-body"><div>
                        Don't allow users to manipulate a system or guess its behavior based on input or output timing
                        and detect the usage of automated tools or unusual behavior, such as actions not performed in
                        reasonable &quot;human time&quot; or other abnormal time patterns.&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        When the usage of automated tools is detected, the application shall respond with denying the
                        access and notifying the security group.
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading254"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse254" aria-expanded="true" aria-controls="collapse254">Countermeasure: Restrict actions of users that follow unusual patterns. <span>[OTG-BUSLOGIC-006]</span></button></h5></div><div id="collapse254" class="collapse" aria-labelledby="heading254" data-parent="#controls"><div class="card-body"><div>
                        Restrict actions that users can do outside of the approved/required business process flow.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        This is important because without this safeguard in place attackers may be able to bypass or
                        circumvent work-flows and checks allowing them to prematurely enter or skip required sections
                        of the application potentially allowing action/transaction to be completed without successfully
                        completing the entire business process, leaving the system with incomplete back-end tracking
                        information.
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading259"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse259" aria-expanded="true" aria-controls="collapse259">Threat: Denial of service through resource exhaustion <span>[CAPEC-130]</span></button></h5></div><div id="collapse259" class="collapse" aria-labelledby="heading259" data-parent="#threats"><div class="card-body">An attacker causes the target to allocate excessive resources to servicing the
                                attackers' request, thereby reducing the resources available for legitimate services and
                                degrading or denying services. Usually, this attack focuses on memory allocation, but
                                any finite resource on the target could be the attacked, including bandwidth, processing
                                cycles, or other resources. This attack does not attempt to force this allocation
                                through a large number of requests (that would be Resource Depletion through Flooding)
                                but instead uses one or a small number of requests that are carefully formatted to force
                                the target to allocate excessive resources to service this request(s). Often this attack
                                takes advantage of a bug in the target to cause the target to allocate resources vastly
                                beyond what would be needed for a normal request. For example, using an Integer Attack,
                                the attacker could cause a variable that controls allocation for a request to hold an
                                excessively large value. Excessive allocation of resources can render a service degraded
                                or unavailable to legitimate users and can even lead to crashing of the target.
                                <br />
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading258"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse258" aria-expanded="true" aria-controls="collapse258">Weakness: Allocation of Resources Without Limits or Throttling <span>[CWE-770]</span></button></h5></div><div id="collapse258" class="collapse" aria-labelledby="heading258" data-parent="#weaknesses"><div class="card-body">The software allocates a reusable resource or group of
                        resources on behalf of an actor without imposing any restrictions on how many
                        resources can be allocated, in violation of the intended security policy for
                        that actor.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading257"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse257" aria-expanded="true" aria-controls="collapse257">Countermeasure: Implement application and network rate limiting <span>[CWE-799]</span></button></h5></div><div id="collapse257" class="collapse" aria-labelledby="heading257" data-parent="#controls"><div class="card-body"><p>A number of attacks rely on brute-force techniques to send large volumes of requests to enumerate or attempt to exploit flaws in an application, for example, sending common passwords to multiple target accounts within an application. By profiling normal traffic volumes, and applying rate limiting, the application can be built to actively mitigate such attacks.</p> 
<p></p> 
<ul> 
 <li>Connection rate-limiting based on the source IP address can be used to restrict attacks against the authentication or registration systems. Multiple failures (or attempts) from a single IP should result in temporarily blocking or dropping traffic from the source. Note however that some corporate and <span class="caps">ISP</span> environment may place multiple valid and discrete clients behind the same IP address, resulting in false-positives.&nbsp;</li> 
 <li>Attackers may use botnets and other IP masking techniques to deliver attacks from multiple sources to avoid IP based rate-limiting. To mitigate this class of attack, Indicators of Compromise should be monitored (for example a higher rate of login failures than usual), and appropriate actions taken. For example, when the application detects active brute-force attacks, a Web Application Firewall (<span class="caps">WAF</span>) or other intermediate devices could be used to block attacks sharing a signature from pattern matching or deep packet inspection (e.g. <span class="caps">HTTP</span> headers or common passwords across multiple accounts). Similarly, the application could respond by requiring a <span class="caps">CAPTCHA</span>, cookie, or Javascript challenge when an attack is detected.</li> 
</ul> 
<p></p> 
<b><font size="4"> Remediation:</font></b> 
<div> 
 <b><font size="4"></font></b>Implement the mechanisms to lockout accounts:&nbsp; 
</div> 
<div> 
 <ul> 
  <li>When the application detects a set number of failure login attempts, the account shall be locked for a certain time period.&nbsp;</li> 
  <li>When the application detects that an account is locked more times than usual, this account shall be disabled. A disabled account shall only be restored by an administrator.&nbsp;</li> 
  <li>When the application detects active brute-force attacks, the application shall require a <span class="caps">CAPTCHA</span>, cookie, or JavaScript challenge.</li> 
 </ul> 
</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading264"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse264" aria-expanded="true" aria-controls="collapse264">Use case: Read or Post data <span>[READ OR POST DATA]</span></button></h5></div><div id="collapse264" class="collapse" aria-labelledby="heading264" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading263"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse263" aria-expanded="true" aria-controls="collapse263">Threat: Attackers gain control of the connection through a Man In The Middle attack <span>[CAPEC-300]</span></button></h5></div><div id="collapse263" class="collapse" aria-labelledby="heading263" data-parent="#threats"><div class="card-body"><div>
                                This type of attack targets the communication between two components (typically client
                                and server). The attacker places himself in the communication channel between the two
                                components. Whenever one component attempts to communicate with the other (data flow,
                                authentication challenges, etc.), the data first goes to the attacker, who has the
                                opportunity to observe or alter it, and it is then passed on to the other component as
                                if it was never intercepted. This interposition is transparent leaving the two
                                compromised components unaware of the potential corruption or leakage of their
                                communications. The potential for Man-in-the-Middle attacks yields an implicit lack of
                                trust in communication or identify between two components.&nbsp; &nbsp;
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading262"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse262" aria-expanded="true" aria-controls="collapse262">Weakness: Cleartext Transmission of Sensitive Information <span>[CWE-319]</span></button></h5></div><div id="collapse262" class="collapse" aria-labelledby="heading262" data-parent="#weaknesses"><div class="card-body">The software transmits sensitive or security-critical data in cleartext in a communication channel that can be sniffed by unauthorized actors.

Many communication channels can be "sniffed" by attackers during data transmission. For example, network traffic can often be sniffed by any attacker who has access to a network interface. This significantly lowers the difficulty of exploitation by attackers.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading261"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse261" aria-expanded="true" aria-controls="collapse261">Countermeasure: Encrypt data between the client and server/service <span>[CWE-319-TRANSPORT]</span></button></h5></div><div id="collapse261" class="collapse" aria-labelledby="heading261" data-parent="#controls"><div class="card-body"><div>
  Data passed between the client and server should be protected by encryption in transit. 
</div> 
<div> 
 <ul> 
  <li>Implement cryptographically strong TLS end-to-end encryption between the client and server, terminating within a secure environment on the server-side.</li> 
  <li>Consider use of client certificates to prevent interception of (or man-in-the-middle attacks on) the encrypted connection.</li> 
  <li>Alternatively, asymmetric (public-key) encryption could be utilized, although a recognized, proven, and tested implementation/library should be used</li> 
 </ul> 
</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading270"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse270" aria-expanded="true" aria-controls="collapse270">Risk pattern: Generic Service: 2-Factor Authentication <span>[GENERIC-SERVICE:AUTHN-2FA]</span></button></h5></div><div id="collapse270" class="collapse" aria-labelledby="heading270" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading269"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse269" aria-expanded="true" aria-controls="collapse269">Use case: Authentication <span>[AUTHENTICATION]</span></button></h5></div><div id="collapse269" class="collapse" aria-labelledby="heading269" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading268"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse268" aria-expanded="true" aria-controls="collapse268">Threat: Second authentication factor is compromised <span>[2FA-Token-compromise]</span></button></h5></div><div id="collapse268" class="collapse" aria-labelledby="heading268" data-parent="#threats"><div class="card-body">The second authentication factor, such as the digital certificate or hardware or
                                software token is compromised by attackers. Attackers would additionally have to
                                compromise the first factor (e.g. the password) in order to completely compromise the
                                authentication system.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading267"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse267" aria-expanded="true" aria-controls="collapse267">Weakness: There is no quick revocation mechanism in place <span>[2FA-Token-compromise]</span></button></h5></div><div id="collapse267" class="collapse" aria-labelledby="heading267" data-parent="#weaknesses"><div class="card-body">When using a second factor authentication, an attacker who gains access to this second factor
                        and could guess the first one could gain persistent access to the system if there are no
                        mechanisms in place to avoid this.&nbsp;
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading266"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse266" aria-expanded="true" aria-controls="collapse266">Countermeasure: Implement an effective process to revoke compromised authentication tokens <span>[2FA-Token-compromise]</span></button></h5></div><div id="collapse266" class="collapse" aria-labelledby="heading266" data-parent="#controls"><div class="card-body"><div>
                        Theft or loss of an authentication token can undermine security in any multi-factor
                        authentication process. Loss of a physical token or mobile device with soft-tokens, or
                        compromise of a client-side certificate could mean an attacker has all of the factors required
                        to authenticate to a system and bypass the protections provided by multi-factor authentication.
                        </div>
                        <div>
                        <ul>
                        <li>Define an organization process to identify or report lost or compromised
                        authentication tokens/factors</li>
                        <li>Implement technical controls to suspend or revoke compromised tokens or accounts</li>
                        <li>These processes should be implementable in a timely manner to reduce the attack window</li>
                        </ul>
                        </div>
                        <div></div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading277"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse277" aria-expanded="true" aria-controls="collapse277">Risk pattern: Generic Service: Administration <span>[CSD-GS-ADM]</span></button></h5></div><div id="collapse277" class="collapse" aria-labelledby="heading277" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading276"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse276" aria-expanded="true" aria-controls="collapse276">Use case: Administer service <span>[ADMINISTER SERVICE]</span></button></h5></div><div id="collapse276" class="collapse" aria-labelledby="heading276" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading275"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse275" aria-expanded="true" aria-controls="collapse275">Threat: Attackers gain access to the system through an unprotected administration interface <span>[CSD-ADM-IFACE]</span></button></h5></div><div id="collapse275" class="collapse" aria-labelledby="heading275" data-parent="#threats"><div class="card-body">Administrative interfaces grant access to sensitive operations that can typically
                                affect key security mechanisms, like modifying credentials and adding/removing user
                                accounts.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading272"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse272" aria-expanded="true" aria-controls="collapse272">Weakness: Access to management functions is not limited to web service administrators <span>[WEB-SRV-ADM]</span></button></h5></div><div id="collapse272" class="collapse" aria-labelledby="heading272" data-parent="#weaknesses"><div class="card-body">The software does not perform any authentication for functionality that requires a provable
                        user identity or consumes a significant amount of resources, gives access to sensitive data or
                        sensitive business logic.
                        <br />
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading271"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse271" aria-expanded="true" aria-controls="collapse271">Countermeasure: Restrict access to administrative functionality <span>[WEB-SRV-ADM-AUTH]</span></button></h5></div><div id="collapse271" class="collapse" aria-labelledby="heading271" data-parent="#controls"><div class="card-body"><div>
                        If inadequate controls are in place, lower privileged users may be able to access higher
                        privilege or administrative functionality to subvert security within the application.
                        </div>
                        <div>
                        <ul>
                        <li>Restrict administration functions to designated administrators only through robust
                        access controls.</li>
                        <li>Ensure this restriction is applied at the server-side; do not rely on 'secret' areas
                        of the application, menu hiding, or other client-side techniques to protect the functionality.</li>
                        <li>Measures to prevent cross-site request forgery must be present on administrative
                        functions.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading274"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse274" aria-expanded="true" aria-controls="collapse274">Weakness: Access to the administration interfaces is open to untrusted parties <span>[CSD-ADM-OPEN]</span></button></h5></div><div id="collapse274" class="collapse" aria-labelledby="heading274" data-parent="#weaknesses"><div class="card-body">The application does not restrict access to administration interfaces to untrusted parties.&nbsp;
                        <br />This fact could allow an attacker to chain vulnerabilities to gain unauthorized
                        access to the system.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading273"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse273" aria-expanded="true" aria-controls="collapse273">Countermeasure: Restrict access to administrative interfaces <span>[CSD-ADM-TRUST]</span></button></h5></div><div id="collapse273" class="collapse" aria-labelledby="heading273" data-parent="#controls"><div class="card-body"><p>Restrict access to administrative interfaces to trusted actors from trusted locations to reduce the application attack surface and likelihood of compromise.</p> 
<p>Restrict administrative access to specific networks or hosts.</p> 
<div>
  Use strong authentication for privileged access, for example a 2FA. 
</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading284"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse284" aria-expanded="true" aria-controls="collapse284">Risk pattern: Generic Service: Authentication <span>[GENERIC-SERVICE:AUTHN]</span></button></h5></div><div id="collapse284" class="collapse" aria-labelledby="heading284" data-parent="#components"><div class="card-body">A generic service that requires authentication<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading283"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse283" aria-expanded="true" aria-controls="collapse283">Use case: Authentication <span>[AUTHENTICATION]</span></button></h5></div><div id="collapse283" class="collapse" aria-labelledby="heading283" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading282"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse282" aria-expanded="true" aria-controls="collapse282">Threat: Attackers gain access to user accounts by exploiting flaws in the authentication function <span>[CSD-AUTH_BYPASS]</span></button></h5></div><div id="collapse282" class="collapse" aria-labelledby="heading282" data-parent="#threats"><div class="card-body">The authentication mechanism itself can be attacked to exploit flaws in its design or
                                implementation.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading279"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse279" aria-expanded="true" aria-controls="collapse279">Weakness: Authentication controls are enforced on the client side but not on server side <span>[CWE-603]</span></button></h5></div><div id="collapse279" class="collapse" aria-labelledby="heading279" data-parent="#weaknesses"><div class="card-body">Open authenticated endpoints that rely on authentication performed by a client are easily
                        identifiable and exploitable by accessing them directly. Clients can be subverted as an attacker
                        usually has full control over them so they have to be treated as an untrusted component.
                        <div>
                        &nbsp;
                        <br />A client/server product that performs authentication within client code but not in
                        server code, allows server-side authentication to be bypassed via a modified client that omits
                        the authentication check. client-side authentication is extremely weak and may be breached
                        easily. Any attacker may read the source code and reverse-engineer the authentication mechanism
                        to access parts of the application which would otherwise be protected.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading278"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse278" aria-expanded="true" aria-controls="collapse278">Countermeasure: Enforce authentication on the server-side <span>[CWE-603]</span></button></h5></div><div id="collapse278" class="collapse" aria-labelledby="heading278" data-parent="#controls"><div class="card-body"><div>
  All data at the client-side must be considered tainted. &nbsp;As such, decisions on authentication (or Identification and Verification - ID&amp;V) must be made or validated at the server-side to prevent their subversion. 
</div> 
<div> 
 <ul> 
  <li>Ensure credentials are passed securely from the client-to server.</li> 
  <li>The server should compare the credentials with those stored at the server-side (e.g. the hashed password compared against those stored for the claimed identity).</li> 
  <li>Implement controls to mitigate brute-force attacks; for example through rate-limiting, account lockouts, or escalating timeouts.</li> 
  <li>Once authenticated, a non-predictable and cryptographically secure token should be passed securely to the client-side to validate further interaction with the server.</li> 
  <li>Messages returned to the user during authentication, in particular when the process fails, should not reveal to the user whether the username was valid. &nbsp;Returning generic errors prevents an attacker enumerating valid account IDs for subsequent attacks.</li> 
 </ul> 
</div></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading281"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse281" aria-expanded="true" aria-controls="collapse281">Weakness: The authentication function does not fail safe in the event of an error condition <span>[CWE-636]</span></button></h5></div><div id="collapse281" class="collapse" aria-labelledby="heading281" data-parent="#weaknesses"><div class="card-body">When the product encounters an error condition or failure, its design requires it to fall back
                        to a state that is less secure than other options that are available, such as selecting the
                        weakest encryption algorithm or using the most permissive access control restrictions.&nbsp;
                        <div>
                        &nbsp;
                        <br />By entering a less secure state, the product inherits the weaknesses associated with
                        that state, making it easier to compromise. At the least, it causes administrators to have a
                        false sense of security. This weakness typically occurs as a result of wanting to &quot;fail
                        functional&quot; to minimize administration and support costs, instead of &quot;failing
                        safe.&quot;
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading280"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse280" aria-expanded="true" aria-controls="collapse280">Countermeasure: Ensure authentication fails securely on the server-side <span>[CWE-636]</span></button></h5></div><div id="collapse280" class="collapse" aria-labelledby="heading280" data-parent="#controls"><div class="card-body"><div>
                        The authenticated state at the server-side should default to failed (fail closed). This prevents
                        attacks that subvert the authentication system by causing errors in the process at a point the
                        application considers the user to be authenticated without having logged in successfully (fail
                        open).
                        </div>
                        <div>
                        <ul>
                        <li>Unless the authentication process has completed successfully (i.e. the user has been
                        identified and the correct authentication credentials or tokens have been provided to verify
                        that identity), the status of any subsequent error path should be an authentication failure.</li>
                        </ul>
                        </div>
                        <div>
                        <br />
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading301"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse301" aria-expanded="true" aria-controls="collapse301">Risk pattern: Generic Service: Authorization for sensitive data <span>[GENERIC-SERVICE:DATA-SENS:AUTHZ]</span></button></h5></div><div id="collapse301" class="collapse" aria-labelledby="heading301" data-parent="#components"><div class="card-body">Server side access control for sensitive data<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading300"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse300" aria-expanded="true" aria-controls="collapse300">Use case: Access sensitive data <span>[ACCESS SENSITIVE DATA]</span></button></h5></div><div id="collapse300" class="collapse" aria-labelledby="heading300" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading290"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse290" aria-expanded="true" aria-controls="collapse290">Threat: Anonymous users could gain access to sensitive data <span>[CAPEC-232]</span></button></h5></div><div id="collapse290" class="collapse" aria-labelledby="heading290" data-parent="#threats"><div class="card-body">Attackers could access data for which they are not authorized by connecting directly
                                to the resource, without authenticating. E.g.: GET /userdetails?ID=145 to gain direct
                                access to that user's personal information.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading287"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse287" aria-expanded="true" aria-controls="collapse287">Weakness: Missing Authentication for Critical Function <span>[CWE-306]</span></button></h5></div><div id="collapse287" class="collapse" aria-labelledby="heading287" data-parent="#weaknesses"><div class="card-body">The software does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading285"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse285" aria-expanded="true" aria-controls="collapse285">Countermeasure: Apply authorization checks to segregate and control access to user data <span>[CWE-285]</span></button></h5></div><div id="collapse285" class="collapse" aria-labelledby="heading285" data-parent="#controls"><div class="card-body"><div>
                        <div>
                        Applications protecting sensitive or otherwise restricted resources must ensure only appropriate
                        and authorized users may access the application data. It is important that an application
                        prevents unauthorized users gaining inappropriate access to each other's data; although user A
                        and user B may both be trusted to access data within the application, they may be authorized to
                        only access different subsets of the protected resources.&nbsp; E.g. user A should not be
                        able to access user B's personal data by manipulating a request (typical examples are
                        manipulation of an ID value or other object reference sent in the URL or body of an HTTP
                        request).
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        It is not sufficient to rely on obscurity, for example obfuscated or secret URLs or filenames.
                        The application must validate each request for protected data against the proven identity of the
                        user. Before providing access to restricted resources the application must:
                        </div>
                        <div>
                        <ul>
                        <li>Ensure the user has undergone appropriate authentication (identification and
                        verification, or ID&amp;V). E.g. they must have provided their identity and confirmed this
                        with a password, token, or other verification. Typically this will be through checking the
                        validity of the session token issued after login.</li>
                        <li>Confirm the user is entitled to access the data or resource they are requesting. E.g.
                        their confirmed identify checked against a server-side access control matrix to determine
                        whether they may access the requested resource.</li>
                        <li>Access controls should be granular, and allow for access to individual resources to be
                        issued to individual users or roles.</li>
                        </ul>
                        <div>
                        URL and asset based access control is provided by most web-frameworks, and it is preferable to
                        use an established and proven framework.
                        </div>
                        </div>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading286"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse286" aria-expanded="true" aria-controls="collapse286">Countermeasure: Authenticate users (single factor authentication) <span>[CWE-306-SF]</span></button></h5></div><div id="collapse286" class="collapse" aria-labelledby="heading286" data-parent="#controls"><div class="card-body"><div>
                        The application should ensure users have undergone an Identification and Verification (ID&amp;V)
                        process before allowing access to secret, sensitive or otherwise restricted data. A common and
                        simple form is Single Factor Authentication, requiring the user asserts who they are, and
                        provides evidence (for example in the form of a previously established password or PIN).
                        </div>
                        <div>
                        <ul>
                        <li>Require users provide authentication credentials before accessing restricted
                        application data or functionality</li>
                        </ul>
                        </div>
                        <div>
                        <br />
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading289"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse289" aria-expanded="true" aria-controls="collapse289">Weakness: Reliance on a Single Factor in a Security Decision <span>[CWE-654]</span></button></h5></div><div id="collapse289" class="collapse" aria-labelledby="heading289" data-parent="#weaknesses"><div class="card-body">A protection mechanism relies exclusively, or to a large extent, on the evaluation of a single condition or the integrity of a single object or entity in order to make a decision about granting access to restricted resources or functionality.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading288"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse288" aria-expanded="true" aria-controls="collapse288">Countermeasure: Authenticate users (multi- or two-factor authentication [2FA]) <span>[CWE-654]</span></button></h5></div><div id="collapse288" class="collapse" aria-labelledby="heading288" data-parent="#controls"><div class="card-body"><div>
  The application should ensure users have undergone an Identification and Verification (ID&amp;V) process before allowing access to secret, sensitive or otherwise restricted data. For more sensitive applications hosting data or functionality requiring greater assurance over the identification of users, a multi- or two-factor authentication process is recommended. Together with asserting their identity and a password/phrase/PIN (something you know), such systems require additional factors, such as biometric validation (something you are) or a token (something you have). 
</div> 
<div> 
 <ul> 
  <li>Implement multi-factor authentication for applications providing access to sensitive data or functionality, and for highly privileged user access (e.g. administrators).</li> 
  <li>This should utilize a factor such as a soft or hard-token verification in addition to the secret password/pass-phrase for example.</li> 
 </ul> 
</div> 
<div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading295"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse295" aria-expanded="true" aria-controls="collapse295">Threat: Attackers gain access to services or data by sending malformed, or otherwise unexpected messages to a target application <span>[CAPEC-215]</span></button></h5></div><div id="collapse295" class="collapse" aria-labelledby="heading295" data-parent="#threats"><div class="card-body">An attacker sends random, malformed, or otherwise unexpected messages to a target
                                application and observes the application's log or error messages returned. Fuzzing
                                techniques involve sending random or malformed messages to a target and monitoring the
                                target's response. The attacker does not initially know how a target will respond to
                                individual messages but by attempting a large number of message variants they may find a
                                variant that trigger's desired behavior. In this attack, the purpose of the fuzzing is
                                to observe the application's log and error messages, although fuzzing a target can also
                                sometimes cause the target to enter an unstable state, causing a crash. By observing
                                logs and error messages, the attacker can learn details about the configuration of the
                                target application and might be able to cause the target to disclose sensitive
                                information.
                                <br />
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading292"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse292" aria-expanded="true" aria-controls="collapse292">Weakness: Information Exposure Through an Error Message <span>[CWE-209]</span></button></h5></div><div id="collapse292" class="collapse" aria-labelledby="heading292" data-parent="#weaknesses"><div class="card-body">The software generates an error message that includes sensitive information about its
                        environment, users, or associated data.&nbsp;
                        <div>
                        &nbsp;
                        <br />The sensitive information may be valuable information on its own (such as a
                        password), or it may be useful for launching other, more deadly attacks. If an attack fails, an
                        attacker may use error information provided by the server to launch another more focused attack.
                        For example, an attempt to exploit a path traversal weakness (CWE-22) might yield the full
                        pathname of the installed application. In turn, this could be used to select the proper number
                        of &quot;..&quot; sequences to navigate to the targeted file. An attack using SQL
                        injection (CWE-89) might not initially succeed, but an error message could reveal the malformed
                        query, which would expose query logic and possibly even passwords or other sensitive information
                        used within the query.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading291"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse291" aria-expanded="true" aria-controls="collapse291">Countermeasure: Ensure sensitive data is not revealed through error output messages. <span>[ASVS-8.1]</span></button></h5></div><div id="collapse291" class="collapse" aria-labelledby="heading291" data-parent="#controls"><div class="card-body">Ensure the application does not output error messages or stack traces containing sensitive
                        data that could assist an attacker, including session id, software/framework versions and
                        personal information.
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading294"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse294" aria-expanded="true" aria-controls="collapse294">Weakness: Not Failing Securely ('Failing Open') <span>[CWE-636]</span></button></h5></div><div id="collapse294" class="collapse" aria-labelledby="heading294" data-parent="#weaknesses"><div class="card-body">When the product encounters an error condition or failure, its
                        design requires it to fall back to a state that is less secure than other
                        options that are available, such as selecting the weakest encryption algorithm
                        or using the most permissive access control restrictions.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading293"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse293" aria-expanded="true" aria-controls="collapse293">Countermeasure: Deny access by default if a security control fails with an exception. <span>[ASVS-8.2]</span></button></h5></div><div id="collapse293" class="collapse" aria-labelledby="heading293" data-parent="#controls"><div class="card-body"><div>
                        If a security control fails, the application shall not allow the user access to the application.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        Therefore, if in the security control an exception is launched the system should stay in a
                        secure state, meaning access is denied to the user.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        Conversely, access will only be granted if there is no security failure / exception.
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading299"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse299" aria-expanded="true" aria-controls="collapse299">Threat: Authenticated attackers could gain unauthorised access to sensitive data <span>[CAPEC-122]</span></button></h5></div><div id="collapse299" class="collapse" aria-labelledby="heading299" data-parent="#threats"><div class="card-body">Users who have successfully authenticated to the application could manipulate
                                parameters in the requests to gain access to unauthorized data, such as data belonging
                                to other users.&nbsp;
                                <div>
                                &nbsp;
                                <br />If the server side bases authorization decisions on predictable or
                                non-secret values sent from the client (such as the UDID or IMEI number in mobile
                                devices), then an attacker could guess or otherwise compromise such a value and
                                impersonate the user.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading298"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse298" aria-expanded="true" aria-controls="collapse298">Weakness: Authorization Bypass Through User-Controlled Key <span>[CWE-639]</span></button></h5></div><div id="collapse298" class="collapse" aria-labelledby="heading298" data-parent="#weaknesses"><div class="card-body">The system's authorization functionality does not prevent one user from gaining access to
                        another user's data or record by modifying the key value identifying the data.&nbsp;
                        <div>
                        &nbsp;
                        <br />Retrieval of a user record occurs in the system based on some key value that is
                        under user control. The key would typically identify a user related record stored in the system
                        and would be used to lookup that record for presentation to the user. It is likely that an
                        attacker would have to be an authenticated user in the system. However, the authorization
                        process would not properly check the data access operation to ensure that the authenticated user
                        performing the operation has sufficient entitlements to perform the requested data access, hence
                        bypassing any other authorization checks present in the system. One manifestation of this
                        weakness would be if a system used sequential or otherwise easily guessable session ids that
                        would allow one user to easily switch to another user's session and read/modify their data.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading296"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse296" aria-expanded="true" aria-controls="collapse296">Countermeasure: Ensure that access control mechanisms are centralized <span>[ACCESS-CONTROL-CENTRALIZED]</span></button></h5></div><div id="collapse296" class="collapse" aria-labelledby="heading296" data-parent="#controls"><div class="card-body">The access control, authentication and authorization procedures shall be centralized, as all
                        roles, permissions, groups and users shall be controlled - or gain access - through this
                        mechanism.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        To ensure roles, groups and permissions are assigned properly to users, we need to have
                        centralized access control, to grant or deny access easily and securely.
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading297"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse297" aria-expanded="true" aria-controls="collapse297">Countermeasure: Apply authorization checks to segregate and control access to user data <span>[CWE-285]</span></button></h5></div><div id="collapse297" class="collapse" aria-labelledby="heading297" data-parent="#controls"><div class="card-body"><div>
                        <div>
                        Applications protecting sensitive or otherwise restricted resources must ensure only appropriate
                        and authorized users may access the application data. It is important that an application
                        prevents unauthorized users gaining inappropriate access to each other's data; although user A
                        and user B may both be trusted to access data within the application, they may be authorized to
                        only access different subsets of the protected resources.&nbsp; E.g. user A should not be
                        able to access user B's personal data by manipulating a request (typical examples are
                        manipulation of an ID value or other object reference sent in the URL or body of an HTTP
                        request).
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        It is not sufficient to rely on obscurity, for example obfuscated or secret URLs or filenames.
                        The application must validate each request for protected data against the proven identity of the
                        user. Before providing access to restricted resources the application must:
                        </div>
                        <div>
                        <ul>
                        <li>Ensure the user has undergone appropriate authentication (identification and
                        verification, or ID&amp;V). E.g. they must have provided their identity and confirmed this
                        with a password, token, or other verification. Typically this will be through checking the
                        validity of the session token issued after login.</li>
                        <li>Confirm the user is entitled to access the data or resource they are requesting. E.g.
                        their confirmed identify checked against a server-side access control matrix to determine
                        whether they may access the requested resource.</li>
                        <li>Access controls should be granular, and allow for access to individual resources to be
                        issued to individual users or roles.</li>
                        </ul>
                        <div>
                        URL and asset based access control is provided by most web-frameworks, and it is preferable to
                        use an established and proven framework.
                        </div>
                        </div>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading310"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse310" aria-expanded="true" aria-controls="collapse310">Risk pattern: Generic Service: File Upload <span>[GENERIC-SERVICE:FILE-UPLOAD]</span></button></h5></div><div id="collapse310" class="collapse" aria-labelledby="heading310" data-parent="#components"><div class="card-body">A service that provides a file upload function<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading309"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse309" aria-expanded="true" aria-controls="collapse309">Use case: Upload Files <span>[UPLOAD FILES]</span></button></h5></div><div id="collapse309" class="collapse" aria-labelledby="heading309" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading308"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse308" aria-expanded="true" aria-controls="collapse308">Threat: Attackers gain unauthorised access through malicious file upload <span>[FILE-MAL-UPLOAD]</span></button></h5></div><div id="collapse308" class="collapse" aria-labelledby="heading308" data-parent="#threats"><div class="card-body">Files that contain malicious content could cause the application to execute the
                                content and therefore grant unauthorized access to the service or the data it contains.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading303"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse303" aria-expanded="true" aria-controls="collapse303">Weakness: The application execute code retrieved from untrusted data sources <span>[CWE-94]</span></button></h5></div><div id="collapse303" class="collapse" aria-labelledby="heading303" data-parent="#weaknesses"><div class="card-body">The execution of untrusted code grants direct control over the application; allowing an
                        attacker to perform arbitrary operations, steal sensitive data, gain control over the system or
                        use the application to launch malicious attacks.&nbsp;
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading302"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse302" aria-expanded="true" aria-controls="collapse302">Countermeasure: Do not execute files received from untrusted sources <span>[WEB-EXEC-DATA]</span></button></h5></div><div id="collapse302" class="collapse" aria-labelledby="heading302" data-parent="#controls"><div class="card-body"><div></div>
                        <div>
                        Untrusted file data sources could contain malicious software, data sources should not be
                        executed even if an anti-malware scanner has been run against the file.&nbsp;&nbsp;
                        </div>This includes use of pre-processing that may result in execution (e.g. eval of
                        tainted content).
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading307"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse307" aria-expanded="true" aria-controls="collapse307">Weakness: The system fails to validate file contents before processing it <span>[UNTRUSTED-FILE-HANDLING]</span></button></h5></div><div id="collapse307" class="collapse" aria-labelledby="heading307" data-parent="#weaknesses"><div class="card-body">Files uploaded from untrusted sources could contain malicious data that subverts the loading
                        mechanism itself or grants unauthorized access to the system when executed.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading304"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse304" aria-expanded="true" aria-controls="collapse304">Countermeasure: Validate the file format before processing <span>[FILE-DATA-CHECK]</span></button></h5></div><div id="collapse304" class="collapse" aria-labelledby="heading304" data-parent="#controls"><div class="card-body"><div>
                        Attackers may attempt to bypass controls on uploaded content by renaming, embedding, or
                        otherwise manipulating benign files with malicious content. As with client-side data, the
                        application should screen uploaded content before processing it.
                        </div>
                        <div>
                        <ul>
                        <li>File contents and and file-system path data must to be checked for sanity.</li>
                        <li>Consider directory traversal, local file inclusion, and OS injection attacks when
                        validating filenames.</li>
                        <li>Verify MIME type is correct and appropriate, and matches content.</li>
                        <li>Files with an structured format should be checked against the expected
                        format/definition (e.g. XML against a XSD or DTD).</li>
                        </ul>
                        </div>
                        <div>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading305"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse305" aria-expanded="true" aria-controls="collapse305">Countermeasure: Perform content scanning on untrusted files when uploaded <span>[FILE-SCAN]</span></button></h5></div><div id="collapse305" class="collapse" aria-labelledby="heading305" data-parent="#controls"><div class="card-body"><div>
                        The application should perform validation and sanitization on all tainted content from the
                        client-side, including uploaded files.&nbsp;
                        </div>
                        <div>
                        <ul>
                        <li>Content/malware scanning performed against the file (e.g. next generation anti-virus)
                        to detect suspicious, dangerous, or unexpected content.</li>
                        <li>Content analysis should also be used to reject unexpected or dangerous file formats
                        that may harbor malicious code, for example encrypted word, pdf or other office documents or
                        archives, or other files with hidden or executable payloads.</li>
                        </ul>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading306"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse306" aria-expanded="true" aria-controls="collapse306">Countermeasure: Do not use untrusted client-side data in server-side file operations <span>[WEB-FILE-DATA]</span></button></h5></div><div id="collapse306" class="collapse" aria-labelledby="heading306" data-parent="#controls"><div class="card-body"><div>
                        The application may be required to base server-side file operations based on client-side
                        actions. This can expose the application to attack through remote or local file-inclusion, or
                        remote code execution attacks if unsafe data is used in file inclusion, class loader, or
                        reflection capabilities.
                        </div>
                        <div>
                        <ul>
                        <li>Tainted, untrusted, client-side data must not be used directly in server-side file
                        load operations.</li>
                        <li>Where server-side operations are dependent on client-side input, this should be mapped
                        to pre-defined operations on the server-side rather than using tainted client-side input
                        directly.</li>
                        </ul>
                        </div>
                        <div></div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading315"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse315" aria-expanded="true" aria-controls="collapse315">Risk pattern: Generic Service: JSON processing <span>[GENERIC-SERVICE:JSON]</span></button></h5></div><div id="collapse315" class="collapse" aria-labelledby="heading315" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading314"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse314" aria-expanded="true" aria-controls="collapse314">Use case: Read data <span>[READ DATA]</span></button></h5></div><div id="collapse314" class="collapse" aria-labelledby="heading314" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading313"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse313" aria-expanded="true" aria-controls="collapse313">Threat: Attackers gain access to user data by tampering data in transit <span>[SRV-JSON-SIG]</span></button></h5></div><div id="collapse313" class="collapse" aria-labelledby="heading313" data-parent="#threats"><div class="card-body">If the integrity of the data in transit is not protected, an attacker could modify the
                                data in transit to make the recipient behave unexpectedly and gain access to user data.&nbsp;
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading312"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse312" aria-expanded="true" aria-controls="collapse312">Weakness: The application does not implement any integrity control on transmitted JSON data <span>[SRV-JSON-SIG]</span></button></h5></div><div id="collapse312" class="collapse" aria-labelledby="heading312" data-parent="#weaknesses"><div class="card-body">If JSON data is not validated for authenticity and integrity then the application
                        functionality could be subverted which could lead to sensitive data leaks or bypassing of
                        critical business logic.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading311"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse311" aria-expanded="true" aria-controls="collapse311">Countermeasure: Implement JSON Web Signing for sensitive or authentication-decision data <span>[SRV-JSON-WEB-SIGN]</span></button></h5></div><div id="collapse311" class="collapse" aria-labelledby="heading311" data-parent="#controls"><div class="card-body"><div>
                        Data received from the client-side may have been modified at source or in transit. JSON Web
                        Signing functionality is available to prevent (or rather detect) such modification.
                        </div>
                        <div>
                        <ul>
                        <li>Sensitive data, in particular any relied on for making access control or other
                        security decisions, should be signed. This provides assurance that:</li>
                        <ul>
                        <li>The data comes from the trusted source and not from an untrusted actor.&nbsp;</li>
                        <li>The data received is that produced by the trusted party and has not been modified in
                        transit.</li>
                        </ul>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading320"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse320" aria-expanded="true" aria-controls="collapse320">Risk pattern: Generic Service: Read sensitive data <span>[GENERIC-SERVICE:SENS-DATA:TRANSMITTED]</span></button></h5></div><div id="collapse320" class="collapse" aria-labelledby="heading320" data-parent="#components"><div class="card-body">Service where sensitive data is read by clients<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading319"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse319" aria-expanded="true" aria-controls="collapse319">Use case: Access sensitive data <span>[ACCESS SENSITIVE DATA]</span></button></h5></div><div id="collapse319" class="collapse" aria-labelledby="heading319" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading318"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse318" aria-expanded="true" aria-controls="collapse318">Threat: Attackers obtain unauthorised access by connecting directly to the service <span>[CAPEC-115]</span></button></h5></div><div id="collapse318" class="collapse" aria-labelledby="heading318" data-parent="#threats"><div class="card-body">If the component does not require authentication then an attacker can simply connect
                                directly to the service to obtain the data.&nbsp;
                                <div>
                                &nbsp;
                                <br />This risk may also apply to data that is not necessarily sensitive, but is
                                non-public. &nbsp;For example, obtaining timely market information which is not
                                freely available through any other service.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading317"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse317" aria-expanded="true" aria-controls="collapse317">Weakness: Missing Authentication for Critical Function <span>[CWE-306]</span></button></h5></div><div id="collapse317" class="collapse" aria-labelledby="heading317" data-parent="#weaknesses"><div class="card-body">The software does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading316"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse316" aria-expanded="true" aria-controls="collapse316">Countermeasure: Require authentication before presenting restricted data <span>[CWE-306-SERVICE]</span></button></h5></div><div id="collapse316" class="collapse" aria-labelledby="heading316" data-parent="#controls"><div class="card-body"><div>
              The application should ensure users have undergone an Identification and Verification (ID&amp;V) process before allowing access to secret, sensitive or otherwise restricted data. For less sensitive but still restricted data, simple verification of the location of the user may suffice
              (e.g. IP restrictions).
              </div>
              <div>
              <ul>
              <li>For non-sensitive but non-public data, access could be restricted by IP address, for example limiting access to internal networks, workstations, or gateways</li>
              <li>For more sensitive data, TLS client-side certificates may be appropriate</li>
              <li>Where secret or other sensitive data is handled, a full authentication process to identify and validate users with single or multi-factor authentication may be required</li>
              </ul>
              </div>
          </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading344"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse344" aria-expanded="true" aria-controls="collapse344">Risk pattern: Generic Service: Session ID <span>[GENERIC-SERVICE:SESSION]</span></button></h5></div><div id="collapse344" class="collapse" aria-labelledby="heading344" data-parent="#components"><div class="card-body">A service that uses a session ID to maintain session state<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading343"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse343" aria-expanded="true" aria-controls="collapse343">Use case: Authentication <span>[AUTHENTICATION]</span></button></h5></div><div id="collapse343" class="collapse" aria-labelledby="heading343" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading326"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse326" aria-expanded="true" aria-controls="collapse326">Threat: An attacker induces a client to establish a session with the target software using a session identifier provided by the attacker <span>[CAPEC-61]</span></button></h5></div><div id="collapse326" class="collapse" aria-labelledby="heading326" data-parent="#threats"><div class="card-body">The attacker induces a client to establish a session with the target software using a
                                session identifier provided by the attacker. Once the user successfully authenticates to
                                the target software, the attacker uses the (now privileged) session identifier in their
                                own transactions. This attack leverages the fact that the target software either relies
                                on client-generated session identifiers or maintains the same session identifiers after
                                privilege elevation.
                                <br />
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading325"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse325" aria-expanded="true" aria-controls="collapse325">Weakness: Application allows user to use a session ID not produced by the application <span>[CWE-384]</span></button></h5></div><div id="collapse325" class="collapse" aria-labelledby="heading325" data-parent="#weaknesses"><div class="card-body"><div>
  Authenticating a user, or otherwise establishing a new user session, without invalidating any session identifier gives an attacker the opportunity to steal authenticated sessions. Such a scenario is commonly observed when: 
</div> 
<div> 
 <ul> 
  <li>A web application authenticates a user without first invalidating the existing session, thereby continuing to use the session already associated with the user.</li> 
  <li>An attacker is able to force a known session identifier on a user so that, once the user authenticates, the attacker has access to the authenticated session.</li> 
  <li>The application or container uses predictable session identifiers. In the generic exploit of session fixation vulnerabilities, an attacker creates a new session on a web application and records the associated session identifier. The attacker then causes the victim to associate, and possibly authenticate, against the server using that session identifier, giving the attacker access to the user's account through the active session.</li> 
 </ul> 
</div><div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading321"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse321" aria-expanded="true" aria-controls="collapse321">Countermeasure: Give the user an option to terminate all active sessions when a password change event is triggered <span>[CSD-PWD-CHG]</span></button></h5></div><div id="collapse321" class="collapse" aria-labelledby="heading321" data-parent="#controls"><div class="card-body">A password change could be the event of a possible password compromise. The user must have the
                        option of invalidating all the active sessions when performing the password change.
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading322"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse322" aria-expanded="true" aria-controls="collapse322">Countermeasure: Actively reject Session IDs that have not been generated by the application <span>[CWE-384]</span></button></h5></div><div id="collapse322" class="collapse" aria-labelledby="heading322" data-parent="#controls"><div class="card-body"><div>
                        The application should recognize previously issued Session IDs and reject every session ID that
                        has not been generated by the application.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        Some types of attacks rely on session fixation. This involves an attacker making up a Session ID
                        not generated by the application and then deceiving the user into clicking a link and
                        authenticating using this Session ID. As the attacker has knowledge of this Session ID he/she
                        will have access if that Session ID is accepted and not invalidated and changed after
                        authentication.
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading323"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse323" aria-expanded="true" aria-controls="collapse323">Countermeasure: Limit the number of active concurrent sessions <span>[LIMIT-ACTIVE-SESSIONS]</span></button></h5></div><div id="collapse323" class="collapse" aria-labelledby="heading323" data-parent="#controls"><div class="card-body">The number of active sessions shall be limited to avoid several active sessions at the same
                        time. If there are several active sessions, one of them may be used by the real user and another
                        session by attackers who are able to implement changes without the real user being aware.
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading324"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse324" aria-expanded="true" aria-controls="collapse324">Countermeasure: Implement mechanisms to renew the session and session id <span>[RENEW-SESSION]</span></button></h5></div><div id="collapse324" class="collapse" aria-labelledby="heading324" data-parent="#controls"><div class="card-body">Implement a mechanism to generate a new session and new session id, when a successful
                        authentication or re-authentication occurs. After this creation, the old session and session ID
                        shall be removed securely.
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading329"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse329" aria-expanded="true" aria-controls="collapse329">Threat: An attacker reuses a valid session ID to spoof the target system in order to gain privileges <span>[CAPEC-60]</span></button></h5></div><div id="collapse329" class="collapse" aria-labelledby="heading329" data-parent="#threats"><div class="card-body">This attack targets the reuse of valid session ID to spoof the target system in order
                                to gain privileges. The attacker tries to reuse a stolen session ID used previously
                                during a transaction to perform spoofing and session hijacking. Another name for this
                                type of attack is Session Replay.
                                <br />
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading328"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse328" aria-expanded="true" aria-controls="collapse328">Weakness: Application allows user to use a session ID not produced by the application <span>[CWE-384]</span></button></h5></div><div id="collapse328" class="collapse" aria-labelledby="heading328" data-parent="#weaknesses"><div class="card-body"><div>
  Authenticating a user, or otherwise establishing a new user session, without invalidating any session identifier gives an attacker the opportunity to steal authenticated sessions. Such a scenario is commonly observed when: 
</div> 
<div> 
 <ul> 
  <li>A web application authenticates a user without first invalidating the existing session, thereby continuing to use the session already associated with the user.</li> 
  <li>An attacker is able to force a known session identifier on a user so that, once the user authenticates, the attacker has access to the authenticated session.</li> 
  <li>The application or container uses predictable session identifiers. In the generic exploit of session fixation vulnerabilities, an attacker creates a new session on a web application and records the associated session identifier. The attacker then causes the victim to associate, and possibly authenticate, against the server using that session identifier, giving the attacker access to the user's account through the active session.</li> 
 </ul> 
</div><div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading327"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse327" aria-expanded="true" aria-controls="collapse327">Countermeasure: Implement mechanisms to renew the session and session id <span>[RENEW-SESSION]</span></button></h5></div><div id="collapse327" class="collapse" aria-labelledby="heading327" data-parent="#controls"><div class="card-body">Implement a mechanism to generate a new session and new session id, when a successful
                        authentication or re-authentication occurs. After this creation, the old session and session ID
                        shall be removed securely.
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading334"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse334" aria-expanded="true" aria-controls="collapse334">Threat: Attackers gain access to critical functions by compromising the session ID <span>[CSD-SESSION-ID]</span></button></h5></div><div id="collapse334" class="collapse" aria-labelledby="heading334" data-parent="#threats"><div class="card-body">If a session ID is leaked through a flaw in the application, then attackers could
                                perform sensitive operations or hijack the session of the affected user. This type of
                                attack does not usually result in mass-compromise of ID's.&nbsp;
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading331"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse331" aria-expanded="true" aria-controls="collapse331">Weakness: Insufficient Session Logout <span>[CWE-613-LOGOUT]</span></button></h5></div><div id="collapse331" class="collapse" aria-labelledby="heading331" data-parent="#weaknesses"><div class="card-body">Insufficient Session Expiration is when a web site permits an attacker to reuse old session
                        credentials or session IDs for authorization.
                        <br />
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading330"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse330" aria-expanded="true" aria-controls="collapse330">Countermeasure: Terminate user sessions on the server-side after a logout operation <span>[CWE-613-LOGOUT]</span></button></h5></div><div id="collapse330" class="collapse" aria-labelledby="heading330" data-parent="#controls"><div class="card-body"><div>
  When a user chooses to log out (or otherwise has their session terminated), the user session must be terminated at the server-side, not solely at the client-side (for example by deleting or reissuing a session ID token/cookie). 
</div> 
<div> 
 <ul> 
  <li>Revoke user sessions at the server-side.</li> 
  <li>Redirect users to the login page, or provide a login prompt to them in context.</li> 
  <li>Where possible, ensure the session is not reused by the application server.</li> 
 </ul> 
</div></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading333"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse333" aria-expanded="true" aria-controls="collapse333">Weakness: The application does not re-authenticate on critical functions <span>[CSD-SESS-REAUTH]</span></button></h5></div><div id="collapse333" class="collapse" aria-labelledby="heading333" data-parent="#weaknesses"><div class="card-body">The application does not require the user to re-authenticate for specific critical functions,
                        like password change or changes to sensitive security settings.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading332"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse332" aria-expanded="true" aria-controls="collapse332">Countermeasure: Require additional authentication for sensitive operations / high value transactions <span>[CSD-SESS-REAUTH]</span></button></h5></div><div id="collapse332" class="collapse" aria-labelledby="heading332" data-parent="#controls"><div class="card-body"><div>
                        Having gained access to an account, for example through session hijack or cross-site scripting,
                        an attack can compromise data and functionality accessible to the victim. This may include
                        elevated privilege or sensitive data and functionality, such as changing passwords, creating
                        accounts, or transferring funds.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        These functions and data should be further protected from attack using a risk-based
                        authentication model requiring re-authentication, multi-factor authentication, or use of a token
                        to sign transactions or operations.
                        </div>
                        <div>
                        <ul>
                        <li>Implement re-authentication on key functions (such as requiring the old password
                        before setting a new one).</li>
                        <li>Use secondary authentication such as a transaction PIN to allow financial transfers.</li>
                        <li>Critical administrative functionality should require multi-factor authentication (such
                        as a hard or soft token).</li>
                        <li>Consider use of signing technologies or tokens that enable the server-side to verify
                        the authenticity of a request and mitigate Man in the Middle (MiTM) or Man in the Browser (MiTB)
                        attacks.</li>
                        </ul>
                        </div>
                        <div>
                        <br />
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading342"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse342" aria-expanded="true" aria-controls="collapse342">Threat: The session ID, and hence the users' session is compromised through brute force attack <span>[CAPEC-59]</span></button></h5></div><div id="collapse342" class="collapse" aria-labelledby="heading342" data-parent="#threats"><div class="card-body">Attackers could use brute force techniques to attempt to guess valid session
                                IDs.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading336"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse336" aria-expanded="true" aria-controls="collapse336">Weakness: Application allows user to use a session ID not produced by the application <span>[CWE-384]</span></button></h5></div><div id="collapse336" class="collapse" aria-labelledby="heading336" data-parent="#weaknesses"><div class="card-body"><div>
  Authenticating a user, or otherwise establishing a new user session, without invalidating any session identifier gives an attacker the opportunity to steal authenticated sessions. Such a scenario is commonly observed when: 
</div> 
<div> 
 <ul> 
  <li>A web application authenticates a user without first invalidating the existing session, thereby continuing to use the session already associated with the user.</li> 
  <li>An attacker is able to force a known session identifier on a user so that, once the user authenticates, the attacker has access to the authenticated session.</li> 
  <li>The application or container uses predictable session identifiers. In the generic exploit of session fixation vulnerabilities, an attacker creates a new session on a web application and records the associated session identifier. The attacker then causes the victim to associate, and possibly authenticate, against the server using that session identifier, giving the attacker access to the user's account through the active session.</li> 
 </ul> 
</div><div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading335"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse335" aria-expanded="true" aria-controls="collapse335">Countermeasure: Implement mechanisms to renew the session and session id <span>[RENEW-SESSION]</span></button></h5></div><div id="collapse335" class="collapse" aria-labelledby="heading335" data-parent="#controls"><div class="card-body">Implement a mechanism to generate a new session and new session id, when a successful
                        authentication or re-authentication occurs. After this creation, the old session and session ID
                        shall be removed securely.
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading339"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse339" aria-expanded="true" aria-controls="collapse339">Weakness: Insufficient Entropy <span>[CWE-331]</span></button></h5></div><div id="collapse339" class="collapse" aria-labelledby="heading339" data-parent="#weaknesses"><div class="card-body">The software uses an algorithm or scheme that produces
                        insufficient entropy, leaving patterns or clusters of values that are more
                        likely to occur than others.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading337"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse337" aria-expanded="true" aria-controls="collapse337">Countermeasure: Use the session management functionality provided by the web framework <span>[ASVS-3.1]</span></button></h5></div><div id="collapse337" class="collapse" aria-labelledby="heading337" data-parent="#controls"><div class="card-body"><div>
                        Server side frameworks often provide session management facilities that will automatically
                        generate and manage a cryptographically strong session ID value.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        Verify that the framework in use offers this facility and that the session ID generated is
                        cryptographically strong.
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading338"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse338" aria-expanded="true" aria-controls="collapse338">Countermeasure: Session tokens should contain sufficient entropy <span>[CWE-331]</span></button></h5></div><div id="collapse338" class="collapse" aria-labelledby="heading338" data-parent="#controls"><div class="card-body"><div>
                        Tokens used to authorize the user should contain at least 128 bits of random data generated from
                        a secure random source, such as java.util.SecureRandom.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        Preference should be given to using framework provided session IDs such as the JSESSIONID
                        provided by JEE web containers.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        Values which are easily compromised by other mobile applications such as the IMEI or UDID
                        numbers should not be used for authorization decisions.
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading341"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse341" aria-expanded="true" aria-controls="collapse341">Weakness: Use of Insufficiently Random Values <span>[CWE-330]</span></button></h5></div><div id="collapse341" class="collapse" aria-labelledby="heading341" data-parent="#weaknesses"><div class="card-body">The software may use insufficiently random numbers or values in
                        a security context that depends on unpredictable numbers.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading340"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse340" aria-expanded="true" aria-controls="collapse340">Countermeasure: Use a cryptographically secure pseudo-random number generator <span>[CWE-330]</span></button></h5></div><div id="collapse340" class="collapse" aria-labelledby="heading340" data-parent="#controls"><div class="card-body"><div>
  Use a well-vetted algorithm that is currently considered to be strong and secure by experts in the field and ensure well-tested implementation with adequate length seeds. In general, if a pseudo-random number generator is not advertised as being cryptographically secure, then it is probably a statistical PRNG and should not be used in a security-sensitive context.&nbsp; 
</div> 
<div> 
 <div> 
  <div> 
   <br /> 
  </div> 
  <div>
    Pseudo-random number generators can produce predictable numbers if the generator is known and the seed can be guessed. A 256-bit seed is a good starting point for producing a &quot;random enough&quot; number. 
  </div> 
  <div> 
   <br /> 
  </div> 
  <div> 
   <b>Remediation:</b> 
  </div> 
  <div>
    Ensure that all random numbers, especially those used for cryptographic parameters (keys, IV’s, MAC tags), random file names, random GUIDs, and random strings are generated in a cryptographically strong fashion. 
   <br /> 
   <br />Ensure that random algorithms are seeded with sufficient entropy. 
  </div> 
  <div> 
   <br /> 
  </div> 
  <div>
    Use a secure pseudo-random number generator ensuring it leverages an appropriate length seed. The recommendation by FIPS 140-2 is 256-bit seed. 
  </div> 
  <div> 
   <br />Tools like NIST RNG Test tool (as used in PCI PTS Derived Test Requirements) can be used to comprehensively assess the quality of a Random Number Generator by reading e.g. 128MB of data from the RNG source and then assessing its randomness properties with the tool. 
   <br /> 
   <br />The following libraries are considered weak random numbers generators and should not be used. 
   <br /> 
  </div> 
  <div> 
   <br /> 
  </div> 
  <div> 
   <ul> 
    <li>C library: random(), rand() instead use getrandom(2) instead</li> 
    <li>Java library: java.util.Random() instead use java.security.SecureRandom instead</li> 
   </ul> 
   <br />For secure random number generation, refer to NIST SP 800-90A. CTR-DRBG, HASH-DRBG, HMAC-DRBG are recommended. Refer to NIST SP800-22 A Statistical Test Suite for Random and Pseudorandom Number Generators for Cryptographic Applications, and the testing toolkit. 
   <br /> 
  </div> 
 </div> 
</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading370"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse370" aria-expanded="true" aria-controls="collapse370">Risk pattern: Generic Service: Single factor Authentication <span>[GENERIC-SERVICE:AUTHN-SF]</span></button></h5></div><div id="collapse370" class="collapse" aria-labelledby="heading370" data-parent="#components"><div class="card-body">The server side login functions for single factor authentication for any type of service<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading369"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse369" aria-expanded="true" aria-controls="collapse369">Use case: Authentication <span>[AUTHENTICATION]</span></button></h5></div><div id="collapse369" class="collapse" aria-labelledby="heading369" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading347"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse347" aria-expanded="true" aria-controls="collapse347">Threat: Attackers gain access to the system using default passwords <span>[CSD-DEF-PWD]</span></button></h5></div><div id="collapse347" class="collapse" aria-labelledby="heading347" data-parent="#threats"><div class="card-body">Default passwords are usually public or can be obtained from manuals or technical data
                                sheets. An attacker could easily use them to gain access to the system or user data.&nbsp;
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading346"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse346" aria-expanded="true" aria-controls="collapse346">Weakness: The application does not wipe used and not needed passwords or key material <span>[CWE-255]</span></button></h5></div><div id="collapse346" class="collapse" aria-labelledby="heading346" data-parent="#weaknesses"><div class="card-body">When using password or key material within an application, these are copied in memory and can be copied back to the disk depending on several factors.

If the application handles passwords or key material, an attacker with access to the system could inspect the memory or the hard disk to retrieve back those secrets on its original form.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading345"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse345" aria-expanded="true" aria-controls="collapse345">Countermeasure: Remove default credentials and role-based accounts from the application <span>[CWE-255]</span></button></h5></div><div id="collapse345" class="collapse" aria-labelledby="heading345" data-parent="#controls"><div class="card-body"><div>
                        Security is often compromised through default or predictable account credentials, such as
                        'admin/admin'. Best-practice dictates that accounts are only enabled when required, do not have
                        common account names, and force users to choose unique strong passwords rather than using vendor
                        defaults.
                        </div>
                        <div>
                        <ul>
                        <li>Ensure all default application and software accounts are disabled or removed if not
                        required</li>
                        <li>Strong passwords should be set on accounts that are required, default credentials must
                        be changed.</li>
                        <li>Build application accounts from a least-privilege perspective.&nbsp;</li>
                        <ul>
                        <li>Accounts should only be enabled if required.&nbsp;</li>
                        <li>Users should have individual accounts rather than role-based ones (e.g. dave-admin,
                        sue-admin rather than a shared 'admin' user)</li>
                        </ul>
                        </ul>
                        </div>
                        <div>
                        <br />
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading350"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse350" aria-expanded="true" aria-controls="collapse350">Threat: Attackers gain access to user accounts by accessing the password database <span>[CSD-AUTH-HASH]</span></button></h5></div><div id="collapse350" class="collapse" aria-labelledby="heading350" data-parent="#threats"><div class="card-body">An attacker with access to the plain, readable credential database would have access
                                to the system as any of those users.&nbsp;
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading349"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse349" aria-expanded="true" aria-controls="collapse349">Weakness: Password hashes can be reverted over a reasonable period of time <span>[CWE-916]</span></button></h5></div><div id="collapse349" class="collapse" aria-labelledby="heading349" data-parent="#weaknesses"><div class="card-body">The software generates a hash for a password, but it uses a scheme that does not provide a
                        sufficient level of computational effort that would make password cracking attacks infeasible or
                        expensive.
                        <div>
                        <br />
                        </div>
                        <div>
                        Many password storage mechanisms compute a hash and store the hash, instead of storing the
                        original password in plaintext. In this design, authentication involves accepting an incoming
                        password, computing its hash, and comparing it to the stored hash. Many hash algorithms are
                        designed to execute quickly with minimal overhead, even cryptographic hashes. However, this
                        efficiency is a problem for password storage, because it can reduce an attacker's workload for
                        brute-force password cracking. If an attacker can obtain the hashes through some other method
                        (such as SQL injection on a database that stores hashes), then the attacker can store the hashes
                        off-line and use various techniques to crack the passwords by computing hashes efficiently.
                        Without a built-in workload, modern attacks can compute large numbers of hashes, or even exhaust
                        the entire space of all possible passwords, within a very short amount of time, using
                        massively-parallel computing (such as cloud computing) and GPU, ASIC, or FPGA hardware. In such
                        a scenario, an efficient hash algorithm helps the attacker.&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        There are several properties of a hash scheme that are relevant to its strength against an
                        off-line, massively-parallel attack:&nbsp;
                        </div>
                        <div>
                        <ul>
                        <li>The amount of CPU time required to compute the hash (&quot;stretching&quot;)</li>
                        <li>The amount of memory required to compute the hash (&quot;memory-hard&quot;
                        operations)&nbsp;</li>
                        <li>Including a random value, along with the password, as input to the hash computation (&quot;salting&quot;)&nbsp;</li>
                        <li>Given a hash, there is no known way of determining a password that produces this hash
                        value, other than by guessing possible passwords (&quot;one-way&quot; hashing)&nbsp;</li>
                        <li>Relative to the number of all possible hashes that can be generated by the scheme,
                        there is a low likelihood of producing the same hash for multiple different inputs (&quot;collision
                        resistance&quot;)&nbsp;</li>
                        </ul>Note that the security requirements for the software may vary depending on the
                        environment and the value of the passwords. Different schemes might not provide all of these
                        properties, yet may still provide sufficient security for the environment. Conversely, a
                        solution might be very strong in preserving one property, which still being very weak for an
                        attack against another property, or it might not be able to significantly reduce the efficiency
                        of a massively-parallel attack.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading348"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse348" aria-expanded="true" aria-controls="collapse348">Countermeasure: Store passwords in unrecoverable form to prevent disclosure <span>[CWE-256]</span></button></h5></div><div id="collapse348" class="collapse" aria-labelledby="heading348" data-parent="#controls"><div class="card-body"><p>To protect users passwords from accidental or deliberate exposure, the application should store cryptographic hashes of passwords instead of the passwords themselves.&nbsp;</p> 
<p></p> 
<ul> 
 <li>Do not store passwords themselves in the data store for verification at login.&nbsp;</li> 
 <li>Instead, create a cryptographic hash of the password using a strong hash function that includes a work factor and a built in ‘salt’ value, like bcrypt or scrypt. This reduces the risk of brute-force attacks and rainbow tables, and allows flexibility to adapt the hashing function to balance security and performance.&nbsp;</li> 
 <li>Alternatively, use a strong hash function like <span class="caps">SHA</span>-384 together with a unique ‘salt’ value for every account. Apply multiple iterations of the hash to create the additional computational work required to mitigate brute-force attacks.</li> 
</ul> 
<p></p></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading359"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse359" aria-expanded="true" aria-controls="collapse359">Threat: Dictionary-based or brute force password attack <span>[CAPEC-16]</span></button></h5></div><div id="collapse359" class="collapse" aria-labelledby="heading359" data-parent="#threats"><div class="card-body">An attacker tries each of the words in a dictionary as passwords to gain access to
                                the system via some user's account. If the password chosen by the user was a word
                                within the dictionary, this attack will be successful (in the absence of other
                                mitigations). This is a specific instance of the password brute forcing attack
                                pattern.</br>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading352"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse352" aria-expanded="true" aria-controls="collapse352">Weakness: Application does not distinguish between upper and lower case passwords <span>[CWE-178-AUTH]</span></button></h5></div><div id="collapse352" class="collapse" aria-labelledby="heading352" data-parent="#weaknesses"><div class="card-body">The complexity of guessing a password is directly related to the character set being used. To
                        not differentiate between upper and lower case passwords dramatically reduces this complexity.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading351"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse351" aria-expanded="true" aria-controls="collapse351">Countermeasure: The login function should distinguish between upper and lower case passwords <span>[CWE-178-AUTH]</span></button></h5></div><div id="collapse351" class="collapse" aria-labelledby="heading351" data-parent="#controls"><div class="card-body"><div>
                        Passwords used either as a sole verification credentials, or as part of a multi-factor
                        authentication, are a key aspect of application security, and use of strong passwords in
                        critical. In addition to password quality criteria, it is important that the verification of
                        passwords by the application does not reduce the character space, and therefore quality.
                        </div>
                        <div>
                        <ul>
                        <li>The login function should distinguish between upper and lowercase passwords; for
                        example PASSWORD should be considered different to password, Password, PASSword etc.<br /></li>
                        <li>Reducing the character set by considering an uppercase or a lowercase being the same,
                        also reduces the Computational Complexity.</li>
                        <li>Reduction in character space reduces computational cost of brute-force or dictionary
                        attacks against the credentials.</li>
                        </ul>
                        </div>
                        <div>
                        <div>
                        <ul></ul>
                        </div>
                        </div>
                        <br />
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading354"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse354" aria-expanded="true" aria-controls="collapse354">Weakness: Lack of password change facility <span>[NO-PASSWORD-CHANGE]</span></button></h5></div><div id="collapse354" class="collapse" aria-labelledby="heading354" data-parent="#weaknesses"><div class="card-body">When the application does not offer a password change facility, a compromise of the current
                        user password will lead to an attacker having persistent access to the account.&nbsp;
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading353"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse353" aria-expanded="true" aria-controls="collapse353">Countermeasure: Offer a password change facility <span>[CWE-255-PWD-CHANGE]</span></button></h5></div><div id="collapse353" class="collapse" aria-labelledby="heading353" data-parent="#controls"><div class="card-body"><div>
                        Users must retain control of their credentials in a single factor system, and to facilitate this
                        they must have the ability to change their password. This is particularly important should the
                        user determine their password has been compromised, potentially allowing a third party to access
                        the system impersonating them. Furthermore, accountability is adversely affected where users
                        cannot change their passwords, as they can plausibly claim that even though they knew their
                        account credentials were compromised, there was no way for them to prevent unauthorized use of
                        the account.
                        </div>
                        <div>
                        <ul>
                        <li>Users should be allowed to change their passwords, ideally within the application</li>
                        <li>Password change should require re-authentication to prevent abuse of a compromised or
                        unattended session. I.e. the user should be required to enter their existing password in order
                        to change it.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading356"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse356" aria-expanded="true" aria-controls="collapse356">Weakness: Lack of password quality checks <span>[CWE-521]</span></button></h5></div><div id="collapse356" class="collapse" aria-labelledby="heading356" data-parent="#weaknesses"><div class="card-body">The product does not enforce the use of strong passwords by users, which makes it easier for
                        attackers to compromise user accounts. Lack of password complexity significantly reduces the
                        search space when trying to guess user's passwords, making brute-force attacks easier.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading355"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse355" aria-expanded="true" aria-controls="collapse355">Countermeasure: Require the use of strong passwords <span>[CWE-521]</span></button></h5></div><div id="collapse355" class="collapse" aria-labelledby="heading355" data-parent="#controls"><div class="card-body"><div>
                        Passwords used either as a sole verification credentials, or as part of a multi-factor
                        authentication, are a key aspect of application security, and strong password selection should
                        be encouraged and enforced. The application should allow flexibility in user password selection,
                        and enforce minimum criteria for password quality. This should include:
                        </div>
                        <div>
                        <ul>
                        <li>Minimum password length requirements, to mitigate brute-force and dictionary attacks.</li>
                        <li>Encourage use of pass-phrases using multiple words, achieving longer passwords more
                        resistant to attack.</li>
                        <li>Enforce use of mixed case, numeric and/or special characters to increase complexity.</li>
                        <li>Prevent or discourage use of dictionary words and common passwords through
                        black-lists. For example, a set of commonly used passwords can be found on SecLists at&nbsp;<a
                        href="https://github.com/danielmiessler/SecLists/tree/master/Passwords">https://github.com/danielmiessler/SecLists/tree/master/Passwords</a>&nbsp;</li>
                        </ul>
                        </div>
                        <div>
                        <p><b>Password length</b></p>
                        <p>Password length considers the minimum and maximum length of characters comprising the
                        password of your users. For ease of changing this length, its implementation can be configurable
                        possibly using a properties file or xml configuration file.</p>
                        <ul>
                        <li>Minimum length. Passwords should be at least ten (10) characters long. Combining this
                        length with complexity makes a password difficult to guess and/or brute force.</li>
                        <li>Maximum length. People tend to forget their passwords easily. The longer the password,
                        the more likely people are to enter them incorrectly for the system. However, long pass-phrases
                        can be easily remembered, and should not be prevented through unnecessarily strict upper
                        restrictions on length.</li>
                        </ul>
                        <p><b>Password Complexity</b></p>
                        <ul>
                        <li>Password characters should be a combination of alphanumeric characters. Alphanumeric
                        characters consist of letters, numbers, punctuation marks, mathematical and other conventional
                        symbols.</li>
                        <li>For change and reset password functionality it is recommended a history of old
                        password (salted) hashes used. This can be used to prevent password reuse, or an attacker
                        alternating between a selection of passwords (Monday1, Tuesday2 etc.)</li>
                        <li>Actual passwords must not be stored, to protect them against brute forcing if the
                        database is compromised.</li>
                        </ul>
                        </div>
                        <div>
                        <ul>
                        </ul>
                        <ul>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading358"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse358" aria-expanded="true" aria-controls="collapse358">Weakness: Reliance on a Single Factor in a Security Decision <span>[CWE-654]</span></button></h5></div><div id="collapse358" class="collapse" aria-labelledby="heading358" data-parent="#weaknesses"><div class="card-body">A protection mechanism relies exclusively, or to a large extent, on the evaluation of a single condition or the integrity of a single object or entity in order to make a decision about granting access to restricted resources or functionality.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading357"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse357" aria-expanded="true" aria-controls="collapse357">Countermeasure: Authenticate users (multi- or two-factor authentication [2FA]) <span>[CWE-654]</span></button></h5></div><div id="collapse357" class="collapse" aria-labelledby="heading357" data-parent="#controls"><div class="card-body"><div>
  The application should ensure users have undergone an Identification and Verification (ID&amp;V) process before allowing access to secret, sensitive or otherwise restricted data. For more sensitive applications hosting data or functionality requiring greater assurance over the identification of users, a multi- or two-factor authentication process is recommended. Together with asserting their identity and a password/phrase/PIN (something you know), such systems require additional factors, such as biometric validation (something you are) or a token (something you have). 
</div> 
<div> 
 <ul> 
  <li>Implement multi-factor authentication for applications providing access to sensitive data or functionality, and for highly privileged user access (e.g. administrators).</li> 
  <li>This should utilize a factor such as a soft or hard-token verification in addition to the secret password/pass-phrase for example.</li> 
 </ul> 
</div> 
<div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading364"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse364" aria-expanded="true" aria-controls="collapse364">Threat: User accounts compromised through username guessing <span>[CAPEC-112-USERNAME]</span></button></h5></div><div id="collapse364" class="collapse" aria-labelledby="heading364" data-parent="#threats"><div class="card-body">Attackers could perform a brute force attack against the login function by choosing a
                                simple password that users are likely to use for the site, and that meets the site's
                                password policy.
                                <div>
                                &nbsp;
                                <br />Then they could use an automated script to iterate through a list of
                                possible usernames. &nbsp;These could be obtained from a dictionary, or generated
                                through pure brute force means. &nbsp;
                                </div>
                                <div>
                                <br />
                                </div>
                                <div>
                                This type of attack cannot be defended against using an account lockout policy because
                                each username is only attempted once.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading361"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse361" aria-expanded="true" aria-controls="collapse361">Weakness: Lack of password quality checks <span>[CWE-521]</span></button></h5></div><div id="collapse361" class="collapse" aria-labelledby="heading361" data-parent="#weaknesses"><div class="card-body">The product does not enforce the use of strong passwords by users, which makes it easier for
                        attackers to compromise user accounts. Lack of password complexity significantly reduces the
                        search space when trying to guess user's passwords, making brute-force attacks easier.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading360"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse360" aria-expanded="true" aria-controls="collapse360">Countermeasure: Require the use of strong passwords <span>[CWE-521]</span></button></h5></div><div id="collapse360" class="collapse" aria-labelledby="heading360" data-parent="#controls"><div class="card-body"><div>
                        Passwords used either as a sole verification credentials, or as part of a multi-factor
                        authentication, are a key aspect of application security, and strong password selection should
                        be encouraged and enforced. The application should allow flexibility in user password selection,
                        and enforce minimum criteria for password quality. This should include:
                        </div>
                        <div>
                        <ul>
                        <li>Minimum password length requirements, to mitigate brute-force and dictionary attacks.</li>
                        <li>Encourage use of pass-phrases using multiple words, achieving longer passwords more
                        resistant to attack.</li>
                        <li>Enforce use of mixed case, numeric and/or special characters to increase complexity.</li>
                        <li>Prevent or discourage use of dictionary words and common passwords through
                        black-lists. For example, a set of commonly used passwords can be found on SecLists at&nbsp;<a
                        href="https://github.com/danielmiessler/SecLists/tree/master/Passwords">https://github.com/danielmiessler/SecLists/tree/master/Passwords</a>&nbsp;</li>
                        </ul>
                        </div>
                        <div>
                        <p><b>Password length</b></p>
                        <p>Password length considers the minimum and maximum length of characters comprising the
                        password of your users. For ease of changing this length, its implementation can be configurable
                        possibly using a properties file or xml configuration file.</p>
                        <ul>
                        <li>Minimum length. Passwords should be at least ten (10) characters long. Combining this
                        length with complexity makes a password difficult to guess and/or brute force.</li>
                        <li>Maximum length. People tend to forget their passwords easily. The longer the password,
                        the more likely people are to enter them incorrectly for the system. However, long pass-phrases
                        can be easily remembered, and should not be prevented through unnecessarily strict upper
                        restrictions on length.</li>
                        </ul>
                        <p><b>Password Complexity</b></p>
                        <ul>
                        <li>Password characters should be a combination of alphanumeric characters. Alphanumeric
                        characters consist of letters, numbers, punctuation marks, mathematical and other conventional
                        symbols.</li>
                        <li>For change and reset password functionality it is recommended a history of old
                        password (salted) hashes used. This can be used to prevent password reuse, or an attacker
                        alternating between a selection of passwords (Monday1, Tuesday2 etc.)</li>
                        <li>Actual passwords must not be stored, to protect them against brute forcing if the
                        database is compromised.</li>
                        </ul>
                        </div>
                        <div>
                        <ul>
                        </ul>
                        <ul>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading363"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse363" aria-expanded="true" aria-controls="collapse363">Weakness: The application does not implement anti-automation mechanisms to prevent automated long time-sustained probes <span>[CWE-307]</span></button></h5></div><div id="collapse363" class="collapse" aria-labelledby="heading363" data-parent="#weaknesses"><div class="card-body">The software does not properly limit the number or frequency of interactions that it has with
                        an actor, such as the number of incoming requests.&nbsp;
                        <div>
                        &nbsp;
                        <br />This can allow the actor to perform actions more frequently than expected. The actor
                        could be a human or an automated process such as a virus or bot. This could be used to cause a
                        denial of service, compromise program logic (such as limiting humans to a single vote), or other
                        consequences. For example, an authentication routine might not limit the number of times an
                        attacker can guess a password. Or, a web site might conduct a poll but only expect humans to
                        vote a maximum of once a day.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading362"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse362" aria-expanded="true" aria-controls="collapse362">Countermeasure: Implement application and network rate limiting on the login function <span>[CWE-799-LOGIN]</span></button></h5></div><div id="collapse362" class="collapse" aria-labelledby="heading362" data-parent="#controls"><div class="card-body"><div>
                        <div>
                        <div>
                        A number of attacks rely on brute-force techniques to send large volumes of requests to
                        enumerate or attempt to exploit flaws in an application, for example, sending common passwords
                        to multiple target accounts within an application. By profiling normal traffic volumes, and
                        applying rate limiting, the application can be built to actively mitigate such attacks.
                        </div>
                        <div>
                        <ul>
                        <li>Connection rate-limiting based on the source IP address can be used to restrict
                        attacks against the authentication or registration systems. Multiple failures (or attempts) from
                        a single IP should result in temporarily blocking or dropping traffic from the source. Note
                        however that some corporate and ISP environment may place multiple valid and discrete clients
                        behind the same IP address, resulting in false-positives.</li>
                        <li>Attackers may use botnets and other IP masking techniques to deliver attacks from
                        multiple sources to avoid IP based rate-limiting. To mitigate this class of attack, Indicators
                        of Compromise should be monitored (for example a higher rate of login failures than usual), and
                        appropriate actions taken. For example, when the application detects active brute-force attacks,
                        a Web Application Firewall (WAF) or other intermediate devices could be used to block attacks
                        sharing a signature from pattern matching or deep packet inspection (e.g. HTTP headers or common
                        passwords across multiple accounts). Similarly, the application could respond by requiring a
                        CAPTCHA, cookie, or Javascript challenge when an attack is detected.</li>
                        </ul>
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        Implement the mechanisms to lockout accounts:
                        </div>
                        <div>
                        <ul>
                        <li>When the application detects a set number of failure login attempts, the account shall
                        be locked for a certain time period.</li>
                        <li>When the application detects that an account is locked more times than usual, this
                        account shall be disabled. A disabled account shall only be restored by an administrator.</li>
                        <li>When the application detects active brute-force attacks, the application shall require
                        a CAPTCHA, cookie, or JavaScript challenge.</li>
                        </ul>
                        </div>
                        </div>
                        </div>
                        <div>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading368"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse368" aria-expanded="true" aria-controls="collapse368">Threat: Usernames could be enumerated through login responses <span>[CWE-204-USERNAME-LOGIN]</span></button></h5></div><div id="collapse368" class="collapse" aria-labelledby="heading368" data-parent="#threats"><div class="card-body">Usernames could be enumerated through the login feature, if it returns error messages
                                that allow attackers to infer whether the username or password was incorrect.&nbsp;
                                <div>
                                &nbsp;
                                <br />For example, consider the following behavior:An attacker attempts a
                                username that existed on the system, but an incorrect password, and the system responds
                                with the message: &quot;Incorrect password&quot;. Then the attacker attempts a
                                username that definitely does not exist in the system, and the system responds with the
                                message: &quot;Username not recognized&quot;.&nbsp;
                                <div>
                                &nbsp;
                                <br />Then the attacker can use automated scripts and typical usernames to create
                                a list of usernames registered in the system.
                                </div>
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading367"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse367" aria-expanded="true" aria-controls="collapse367">Weakness: Response Discrepancy Information Exposure <span>[CWE-204]</span></button></h5></div><div id="collapse367" class="collapse" aria-labelledby="heading367" data-parent="#weaknesses"><div class="card-body">The software provides different responses to incoming requests in a way that allows an actor
                        to determine system state information that is outside of that actor's control sphere.
                        <br />This issue frequently occurs during authentication, where a difference in
                        failed-login messages could allow an attacker to determine if the username is valid or not.
                        These exposures can be inadvertent (bug) or intentional (design).
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading365"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse365" aria-expanded="true" aria-controls="collapse365">Countermeasure: Ensure application errors do not reveal account status <span>[CWE-204-USERNAME-LOGIN]</span></button></h5></div><div id="collapse365" class="collapse" aria-labelledby="heading365" data-parent="#controls"><div class="card-body"><div>
                        Error messages can reveal information of use to an attacker, particularly in the case of
                        relating to login, registration and recovery processes.&nbsp; Explicit errors stating
                        accounts are valid or not, or whether then are locked out are useful to an attacker in
                        enumerating usernames for subsequent attack. Even small variations in errors returned to the
                        user can be used to infer how the application operates, or enforces security controls.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        To prevent a malicious user using error conditions to determine how the application functions in
                        order to subvert it:
                        </div>
                        <div>
                        <ul>
                        <li>Trap and log all known error conditions at the server-side</li>
                        <li>Create a generic trap for unexpected errors</li>
                        <li>E.g. Error messages during the login process should not disclose which authentication
                        token was incorrect, instead a generic message simply stating that authentication failed should
                        be displayed.</li>
                        <li>Ensure the error message returned to the user is generic, or contains only an
                        obfuscated reference that can be correlated with the logged errors at the server-side. &nbsp;In
                        the case of applications delivered over HTTP, the HTTP header should also be generic to prevent
                        enumeration (e.g. all error pages should produce a consistent HTTP 500 error)</li>
                        </ul>
                        </div>
                        <div>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading366"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse366" aria-expanded="true" aria-controls="collapse366">Countermeasure: Ensure failed login timings do not reveal account status <span>[CWE-204-USERNAME-TIMING]</span></button></h5></div><div id="collapse366" class="collapse" aria-labelledby="heading366" data-parent="#controls"><div class="card-body"><div>
                        As with variations in error codes and messages, the timing of responses from the application can
                        be used by an attacker to infer information about user accounts and the system. For example, it
                        may be computationally more expensive to check a valid username against its password in the
                        back-end than to reject a login based on an unknown username. This computational cost may be
                        reflected in the delay between attempting to authenticate, and being rejected, which an attacker
                        may be able to detect and use to enumerate accounts.&nbsp;
                        </div>
                        <div>
                        <ul>
                        <li>The solution will vary depending on the individual implementation, but in general a
                        random time delay should be introduced if a predictable time difference is detectable between
                        valid and invalid accounts</li>
                        <li>For example, login functions that first perform a database select on the username and
                        then on the password could cause the response time to be consistently different for existent and
                        non-existent usernames. If so, a random time delay should be included in the response to mask
                        this difference</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading375"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse375" aria-expanded="true" aria-controls="collapse375">Risk pattern: Generic Service: Transport of auth credentials <span>[AUTHN-SF:DATA-TRANSPORT]</span></button></h5></div><div id="collapse375" class="collapse" aria-labelledby="heading375" data-parent="#components"><div class="card-body">The data transport mechanism between the client and server components that transmits authentication credentials<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading374"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse374" aria-expanded="true" aria-controls="collapse374">Use case: Authentication <span>[AUTHENTICATION]</span></button></h5></div><div id="collapse374" class="collapse" aria-labelledby="heading374" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading373"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse373" aria-expanded="true" aria-controls="collapse373">Threat: Authentication credentials compromised through network sniffing <span>[CAPEC-158-AUTH]</span></button></h5></div><div id="collapse373" class="collapse" aria-labelledby="heading373" data-parent="#threats"><div class="card-body">An attacker with access to the network path between the user and the server could use
                                network sniffing to read clear text data traversing the network.
                                <div>
                                <br />The networks used by users are the most likely points of attack since these
                                are often shared by many other users, e.g. corporate networks or are public and
                                untrusted such as public WiFi access points.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading372"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse372" aria-expanded="true" aria-controls="collapse372">Weakness: Cleartext Transmission of Authentication Credentials <span>[CWE-319-AUTH]</span></button></h5></div><div id="collapse372" class="collapse" aria-labelledby="heading372" data-parent="#weaknesses"><div class="card-body">The software transmits sensitive or security-critical data in cleartext in a communication
                        channel that can be sniffed by unauthorized actors.&nbsp;&nbsp;
                        <div>
                        &nbsp;
                        <br />Many communication channels can be &quot;sniffed&quot; by attackers during
                        data transmission. For example, network traffic can often be sniffed by any attacker who has
                        access to a network interface. This significantly lowers the difficulty of exploitation by
                        attackers.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading371"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse371" aria-expanded="true" aria-controls="collapse371">Countermeasure: Encrypt data between the client and server/service <span>[CWE-319-TRANSPORT]</span></button></h5></div><div id="collapse371" class="collapse" aria-labelledby="heading371" data-parent="#controls"><div class="card-body"><div>
  Data passed between the client and server should be protected by encryption in transit. 
</div> 
<div> 
 <ul> 
  <li>Implement cryptographically strong TLS end-to-end encryption between the client and server, terminating within a secure environment on the server-side.</li> 
  <li>Consider use of client certificates to prevent interception of (or man-in-the-middle attacks on) the encrypted connection.</li> 
  <li>Alternatively, asymmetric (public-key) encryption could be utilized, although a recognized, proven, and tested implementation/library should be used</li> 
 </ul> 
</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading382"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse382" aria-expanded="true" aria-controls="collapse382">Risk pattern: Generic Service: XML processing <span>[GENERIC-SERVICE:XML]</span></button></h5></div><div id="collapse382" class="collapse" aria-labelledby="heading382" data-parent="#components"><div class="card-body">Generic Service that processes an XML document<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading381"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse381" aria-expanded="true" aria-controls="collapse381">Use case: Read or Post data <span>[READ OR POST DATA]</span></button></h5></div><div id="collapse381" class="collapse" aria-labelledby="heading381" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading380"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse380" aria-expanded="true" aria-controls="collapse380">Threat: Attackers access system files through XML related Attacks <span>[CAPEC-201]</span></button></h5></div><div id="collapse380" class="collapse" aria-labelledby="heading380" data-parent="#threats"><div class="card-body">An attacker creates an XML document that with an external entity reference. External
                                entity references can take the form of tags in a DTD. Because processors may not
                                validate documents with external entities, there may be no checks on the nature of the
                                reference in the external entity. This can allow an attacker to open arbitrary files or
                                connections. For example, the following DTD would attempt to open the /dev/tty device:
                                <br />
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading377"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse377" aria-expanded="true" aria-controls="collapse377">Weakness: Improper Restriction of XML External Entity Reference ('XXE') <span>[CWE-611]</span></button></h5></div><div id="collapse377" class="collapse" aria-labelledby="heading377" data-parent="#weaknesses"><div class="card-body">The software processes an XML document that can contain XML entities with URIs that resolve to
                        documents outside of the intended sphere of control, causing the product to embed incorrect
                        documents into its output.&nbsp;
                        <div>
                        &nbsp;
                        <br />XML documents optionally contain a Document Type Definition (DTD), which, among
                        other features, enables the definition of XML entities. It is possible to define an entity by
                        providing a substitution string in the form of a URI. The XML parser can access the contents of
                        this URI and embed these contents back into the XML document for further processing. By
                        submitting an XML file that defines an external entity with a file:// URI, an attacker can cause
                        the processing application to read the contents of a local file. For example, a URI such as
                        &quot;file:///c:/winnt/win.ini&quot; designates (in Windows) the file C:\Winnt\win.ini,
                        or file:///etc/passwd designates the password file in Unix-based systems.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        Using URIs with other schemes such as http://, the attacker can force the application to make
                        outgoing requests to servers that the attacker cannot reach directly, which can be used to
                        bypass firewall restrictions or hide the source of attacks such as port scanning. Once the
                        content of the URI is read, it is fed back into the application that is processing the XML. This
                        application may echo back the data (e.g. in an error message), there by exposing the file
                        contents.
                        <br />
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading376"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse376" aria-expanded="true" aria-controls="collapse376">Countermeasure: Disable external XML entity references in the processor <span>[cwe-611-validate]</span></button></h5></div><div id="collapse376" class="collapse" aria-labelledby="heading376" data-parent="#controls"><div class="card-body"><div>
                        The XML standards provide for formal validation criteria to be specified in a schema (XSD or
                        DTD). The XML data itself may include DTD specifications, which a skilled attacked could use to
                        attempt to subvert data validation controls.
                        </div>
                        <div>
                        <ul>
                        <li>Configure the XML processor to use a local static DTD.</li>
                        <li>Disallow any declared DTD included in the XML document.&nbsp;</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading379"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse379" aria-expanded="true" aria-controls="collapse379">Weakness: The application does not validate the XML structure <span>[CWE-112]</span></button></h5></div><div id="collapse379" class="collapse" aria-labelledby="heading379" data-parent="#weaknesses"><div class="card-body">An application which does not validate the authenticity and integrity of a received XML data
                        can make wrong decisions that can lead to sensitive data leak or critical business logic bypass.
                        &nbsp;
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading378"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse378" aria-expanded="true" aria-controls="collapse378">Countermeasure: Define and enforce secure validation through an XSD or DSD schema on XML input data <span>[WEB-SRV-XML]</span></button></h5></div><div id="collapse378" class="collapse" aria-labelledby="heading378" data-parent="#controls"><div class="card-body"><div>
                        The XML standards provide for formal validation criteria to be specified in a schema (XSD or
                        DTD). Defining a schema with security in mind, and enforcing it on input data, will mitigate
                        many attacks.
                        </div>
                        <div>
                        <ul>
                        <li>Define an XSD or DTD schema with secure input validation criteria.</li>
                        <li>Validate all XML input data against the schema before processing it.</li>
                        <li>The acceptance of unvalidated or non compliant data could have unexpected effects
                        behavior of the application, and may facilitate attacks such as SQL injection.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading388"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse388" aria-expanded="true" aria-controls="collapse388">Risk pattern: Generic Service: XPATH Queries <span>[GENERIC-SERVICE:XPATH]</span></button></h5></div><div id="collapse388" class="collapse" aria-labelledby="heading388" data-parent="#components"><div class="card-body">A service that performs XPATH queries<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading387"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse387" aria-expanded="true" aria-controls="collapse387">Use case: Read or Post data <span>[READ OR POST DATA]</span></button></h5></div><div id="collapse387" class="collapse" aria-labelledby="heading387" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading386"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse386" aria-expanded="true" aria-controls="collapse386">Threat: Attackers gain access to unauthorised data through XPATH injection <span>[CAPEC-83]</span></button></h5></div><div id="collapse386" class="collapse" aria-labelledby="heading386" data-parent="#threats"><div class="card-body">An attacker can craft special user-controllable input consisting of XPath expressions
                                to inject the XML database and bypass authentication or glean information that he
                                normally would not be able to.&nbsp;
                                <div>
                                <br />
                                </div>
                                <div>
                                XPath Injection enables an attacker to talk directly to the XML database, thus bypassing
                                the application completely. XPath Injection results from the failure of an application
                                to properly sanitize input used as part of dynamic XPath expressions used to query an
                                XML database.&nbsp;
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading385"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse385" aria-expanded="true" aria-controls="collapse385">Weakness: XML Injection through XPATH <span>[CWE-91]</span></button></h5></div><div id="collapse385" class="collapse" aria-labelledby="heading385" data-parent="#weaknesses"><div class="card-body">The software does not properly neutralize special elements that are used in XML, allowing
                        attackers to modify the syntax, content, or commands of the XML before it is processed by an end
                        system.&nbsp;
                        <div>
                        &nbsp;
                        <br />Within XML, special elements could include reserved words or characters such as
                        &quot;&lt;&quot;, &quot;&gt;&quot;, &quot;&quot;&quot;, and
                        &quot;&amp;&quot;, which could then be used to add new data or modify XML syntax.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading383"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse383" aria-expanded="true" aria-controls="collapse383">Countermeasure: Validate all data received from the client side <span>[DATA-VAL]</span></button></h5></div><div id="collapse383" class="collapse" aria-labelledby="heading383" data-parent="#controls"><div class="card-body"><div>
                        All data received from the client-side should be considered tainted and a potential risk,
                        regardless of the source or transport method. &nbsp;For example, while hidden form fields,
                        cookies, or other headers may be obfuscated from a user, along with parameters passed in
                        ViewStates or other encapsulated forms, these can be modified by the user at the client-side in
                        memory, or in transit on the network. Similarly, data passed from binary or compiled components
                        can be modified in situ or in transit.&nbsp;
                        </div>
                        <div>
                        <i><br /></i>
                        </div>
                        <div>
                        <i>Furthermore, encryption only secures the data in transit between the two ends of the
                        encrypted tunnel (one end of which is typically controlled by the client); data passing through
                        the link may still be malicious.</i>
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        As such, all data from the client side must be subjected to strict validation, sanitization, and
                        encoding against expected syntactic and semantic criteria.
                        </div>
                        <div>
                        <ul>
                        <li>Define a specification of the data that is expected at each input; both the syntax
                        (e.g. alphanumeric only) and semantics (e.g. a word of between 1 and 25 characters, or a
                        specific list). As an example of business rule logic, &quot;boat&quot; may be
                        syntactically valid because it only contains alphanumeric characters, but it is not valid if the
                        input is only expected to contain colors such as &quot;red&quot; or &quot;blue.&quot;</li>
                        <li>Implement a 'known good' or white-list approach, where only inputs that meet the
                        strict criteria for each input are accepted, and reject, transform, or encapsulate any
                        non-compliant data.</li>
                        <li>While useful for identifying malicious content, do not rely on looking for specific
                        malformed or attack payloads (blacklists). It is almost impossible to maintain a comprehensive
                        and accurate blacklist due to the complexity and evolving nature of attacks, opportunities to
                        obfuscate payloads, and changes to the code's execution environment. As noted, blacklists can be
                        useful for detecting and logging potential attacks, or determining which inputs are so malformed
                        that they should be rejected outright.&nbsp;</li>
                        <li>Validate all data received from the client, including values such as HTTP headers and
                        cookie values if these are used as input on the server side, X- headers, and other platform
                        specific data objects passed between the client and server.</li>
                        </ul>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading384"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse384" aria-expanded="true" aria-controls="collapse384">Countermeasure: Escape XPATH characters in untrusted input <span>[XPATH-ESCAPE]</span></button></h5></div><div id="collapse384" class="collapse" aria-labelledby="heading384" data-parent="#controls"><div class="card-body"><div>
                        All data received from the client-side should be considered tainted and a potential risk,
                        regardless of the source or transport method.&nbsp;As such, all data from the client side
                        must be subjected to strict validation, sanitization, and encoding against expected syntactic
                        and semantic criteria.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        When using untrusted input data in an XPath query:
                        </div>
                        <div>
                        <div>
                        <ul>
                        <li>Use a parametrized XPath interface if one is available</li>
                        <li>Ensure that XPath specific meta-characters are escaped to make it safe to include in a
                        dynamically constructed query.</li>
                        <li>If single quote characters are used to terminate untrusted input in a dynamically
                        constructed XPath query, the quote should be escaped in tainted input to ensure the untrusted
                        data can't try to break out of quoted context.</li>
                        </ul>
                        <div></div>
                        </div>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading414"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse414" aria-expanded="true" aria-controls="collapse414">Risk pattern: HTTP Service <span>[HTTP-SERVICE]</span></button></h5></div><div id="collapse414" class="collapse" aria-labelledby="heading414" data-parent="#components"><div class="card-body">General server-side web application functions<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading413"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse413" aria-expanded="true" aria-controls="collapse413">Use case: Read or Post data <span>[READ OR POST DATA]</span></button></h5></div><div id="collapse413" class="collapse" aria-labelledby="heading413" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading391"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse391" aria-expanded="true" aria-controls="collapse391">Threat: An adversary crafts a request to a target that results in the target listing/indexing the content of a directory as output <span>[CAPEC-127]</span></button></h5></div><div id="collapse391" class="collapse" aria-labelledby="heading391" data-parent="#threats"><div class="card-body">An adversary crafts a request to a target that results in the target listing/indexing
                                the content of a directory as output. One common method of triggering directory contents
                                as output is to construct a request containing a path that terminates in a directory
                                name rather than a file name since many applications are configured to provide a list of
                                the directory's contents when such a request is received. An adversary can use this to
                                explore the directory tree on a target as well as learn the names of files. This can
                                often end up revealing test files, backup files, temporary files, hidden files,
                                configuration files, user accounts, script contents, as well as naming conventions, all
                                of which can be used by an attacker to mount additional attacks.
                                <br />
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading390"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse390" aria-expanded="true" aria-controls="collapse390">Weakness: Information Exposure Through Directory Listing <span>[CWE-548]</span></button></h5></div><div id="collapse390" class="collapse" aria-labelledby="heading390" data-parent="#weaknesses"><div class="card-body">A directory listing is inappropriately exposed, yielding
                        potentially sensitive information to attackers.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading389"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse389" aria-expanded="true" aria-controls="collapse389">Countermeasure: Disable web server directory listing and ensure file metadata (e.g. .git) and backup files are not present within web roots <span>[DIRECTORY_LISTING]</span></button></h5></div><div id="collapse389" class="collapse" aria-labelledby="heading389" data-parent="#controls"><div class="card-body"><div>
                        Indexable directories allow an attacker to easily discover the existence of content on your web
                        server that should remain private.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Disable directory listings in the web - or application-server configuration by
                        default.</li>
                        <li>Restrict access to unnecessary directories and files.</li>
                        <li>Create an index (default) file for each directory.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading394"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse394" aria-expanded="true" aria-controls="collapse394">Threat: An attacker monitors HTTP headers from a target in order to gather information <span>[CAPEC-117]</span></button></h5></div><div id="collapse394" class="collapse" aria-labelledby="heading394" data-parent="#threats"><div class="card-body">An attacker monitors data streams to or from a target in order to gather information.
                                This attack may be undertaken in order to gather information to support a later attack,
                                or the data collected may be the end goal of the attack. This attack usually involves
                                sniffing network traffic, but may include observing other types of data streams, such as
                                radio. In most varieties of this attack, the attacker is passive and simply observes
                                regular communication, however in some variants the attacker may attempt to initiate the
                                establishment of a data stream or influence the nature of the data transmitted. However,
                                in all variants of this attack, and distinguishing this attack from other data
                                collection methods, the attacker is not the intended recipient of the data stream.
                                Unlike some other data leakage attacks, the attacker is observing explicit data channels
                                (e.g. network traffic) and reading the content. This differs from attacks that collect
                                more qualitative information, such as communication volume, or other information not
                                explicitly communicated via a data stream.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading393"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse393" aria-expanded="true" aria-controls="collapse393">Weakness: Information Exposure <span>[CWE-200]</span></button></h5></div><div id="collapse393" class="collapse" aria-labelledby="heading393" data-parent="#weaknesses"><div class="card-body">An information exposure is the intentional or unintentional disclosure of information to an
                        actor that is not explicitly authorized to have access to that information.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading392"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse392" aria-expanded="true" aria-controls="collapse392">Countermeasure: Do not share system information in HTTP headers and responses <span>[ASVS-11.5]</span></button></h5></div><div id="collapse392" class="collapse" aria-labelledby="heading392" data-parent="#controls"><div class="card-body">The application shall not share detailed version information of system components or other
                        information that would assist attackers in the HTTP header or HTTP responses.
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading397"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse397" aria-expanded="true" aria-controls="collapse397">Threat: An uses redirection functionality in the application to conduct more convincing phishing attacks <span>[open-redirect-threat]</span></button></h5></div><div id="collapse397" class="collapse" aria-labelledby="heading397" data-parent="#threats"><div class="card-body">An http parameter may contain a URL value and could cause the web application to
                                redirect the request to the specified URL. By modifying the URL value to a malicious
                                site, an attacker may successfully launch a phishing scam and steal user credentials.
                                Because the server name in the modified link is identical to the original site, phishing
                                attempts have a more trustworthy appearance.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading396"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse396" aria-expanded="true" aria-controls="collapse396">Weakness: URL Redirection to Untrusted Site ('Open Redirect') <span>[CWE-601]</span></button></h5></div><div id="collapse396" class="collapse" aria-labelledby="heading396" data-parent="#weaknesses"><div class="card-body">A web application accepts a user-controlled input that
                        specifies a link to an external site, and uses that link in a Redirect. This
                        simplifies phishing attacks.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading395"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse395" aria-expanded="true" aria-controls="collapse395">Countermeasure: Whitelist to which URLs the application can redirect to <span>[CWE-601]</span></button></h5></div><div id="collapse395" class="collapse" aria-labelledby="heading395" data-parent="#controls"><div class="card-body">The application should maintain a list of the URLs to which it can redirect. This whitelisting
                        can also be done by applying a regular expression. The application should only allow redirects
                        to trusted URLS.
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading402"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse402" aria-expanded="true" aria-controls="collapse402">Threat: Execute arbitrary code on the server by manipulating parameters <span>[CAPEC-77-RCE]</span></button></h5></div><div id="collapse402" class="collapse" aria-labelledby="heading402" data-parent="#threats"><div class="card-body">In this pattern the attacker is able to execute arbitrary code remotely available from
                                the application by sending specially crafted attack strings to the application's input.
                                <br />
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading399"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse399" aria-expanded="true" aria-controls="collapse399">Weakness: Improper Control of Filename for Include/Require Statement <span>[CWE-98]</span></button></h5></div><div id="collapse399" class="collapse" aria-labelledby="heading399" data-parent="#weaknesses"><div class="card-body">The application receives input from an upstream component, but it does not restrict or
                        incorrectly restricts the input before its usage in &quot;require,&quot; &quot;include,&quot;
                        or similar functions.&nbsp;
                        <div>
                        &nbsp;
                        <br />In certain versions and configurations, this can allow an attacker to specify a URL
                        to a remote location from which the software will obtain the code to execute. In other cases in
                        association with path traversal, the attacker can specify a local file that may contain
                        executable statements that can be parsed by the interpreter.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading398"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse398" aria-expanded="true" aria-controls="collapse398">Countermeasure: Use a library that is not vulnerable to Remote File Inclusion <span>[CWE-98-LIB]</span></button></h5></div><div id="collapse398" class="collapse" aria-labelledby="heading398" data-parent="#controls"><div class="card-body"><div>
                        The Remote File Inclusion (RFI) attack vector is prevalent, and has affected a number of
                        libraries. It can lead to remote code execution, data exposure, and other compromise of the
                        application and underlying server.
                        </div>
                        <div>
                        <ul>
                        <li>Use a library that is not known to be susceptible to Remote File Inclusion (RFI)
                        vulnerabilities.</li>
                        <li>Use an independently vetted library or framework that does not allow this weakness to
                        occur or provides constructs that make this weakness easier to avoid.&nbsp;</li>
                        <li>Follow rigorous data validation and sanitization processes.</li>
                        <li>Perform regular checks for published vulnerabilities the libraries in use.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading401"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse401" aria-expanded="true" aria-controls="collapse401">Weakness: Improper Input Validation <span>[CWE-20]</span></button></h5></div><div id="collapse401" class="collapse" aria-labelledby="heading401" data-parent="#weaknesses"><div class="card-body">The product does not validate or incorrectly validates input that can affect the control flow
                        or data flow of a program.&nbsp;
                        <div>
                        &nbsp;
                        <br />When software does not validate input properly, an attacker is able to craft the
                        input in a form that is not expected by the rest of the application. This will lead to parts of
                        the system receiving unintended input, which may result in altered control flow, arbitrary
                        control of a resource, or arbitrary code execution.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading400"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse400" aria-expanded="true" aria-controls="collapse400">Countermeasure: Validate input parameters to prevent HTTP Parameter Pollution <span>[CWE-147]</span></button></h5></div><div id="collapse400" class="collapse" aria-labelledby="heading400" data-parent="#controls"><div class="card-body">All data received from external sources should be considered tainted and a potential risk,
                        regardless of the source or transport method. HTTP Parameter Pollution attacks result when
                        parameters are added or inserted into requests, and are inappropriately or unsafely handled by
                        the server. For example, injection of parameters into strings or cookies sent to the application
                        can result in the variables being interpreted out of sequence, exploiting flaws in the business
                        logic and flow.
                        <div>
                        <div>
                        <ul>
                        </ul>
                        </div>
                        <div>
                        <p>For example, there was a bug in the Blogger platform which illustrates this
                        vulnerability. The bug allowed malicious users to take ownership of the victim's blog by using the following HTTP request:</p>
                        <blockquote>
                        <p><code>POST /add-authors.do HTTP/1.1</code></p>
                        </blockquote>
                        <blockquote>
                        <p><code>security_token=attackertoken&amp;<b>blogID=attackerblogidvalue</b>&amp;<b>blogID=victimblogidvalue</b>&amp;authorsList=goldshlager19test%40gmail.com(attacker
                        email)&amp;ok=Invite</code></p>
                        </blockquote>
                        <p>The flaw resided in the authentication mechanism used by the web application, as the
                        security check was performed on the first&nbsp;<code>blogID</code>&nbsp;parameter,
                        whereas the actual operation used the second occurrence.</p>
                        </div>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading405"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse405" aria-expanded="true" aria-controls="collapse405">Threat: Functionality could be subverted through mass assignment <span>[CAPEC-137-MASS]</span></button></h5></div><div id="collapse405" class="collapse" aria-labelledby="heading405" data-parent="#threats"><div class="card-body">If the application binds parameters to backend objects, then attackers could
                                potentially
                                set fields on those objects that were not designed to be modified by the user.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading404"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse404" aria-expanded="true" aria-controls="collapse404">Weakness: Improperly Controlled Modification of Dynamically-Determined Object Attributes <span>[CWE-915]</span></button></h5></div><div id="collapse404" class="collapse" aria-labelledby="heading404" data-parent="#weaknesses"><div class="card-body">The software receives input from an upstream component that specifies multiple attributes,
                        properties, or fields that are to be initialized or updated in an object, but it does not
                        properly control which attributes can be modified.&nbsp;
                        <div>
                        &nbsp;
                        <br />If the object contains attributes that were only intended for internal use, then
                        their unexpected modification could lead to a vulnerability. This weakness is sometimes known by
                        the language-specific mechanisms that make it possible, such as mass assignment, auto-binding, or
                        object injection.+ Applicable Platforms
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading403"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse403" aria-expanded="true" aria-controls="collapse403">Countermeasure: Use a white-list approach to assign values to variables <span>[ASSIGN-WHITE]</span></button></h5></div><div id="collapse403" class="collapse" aria-labelledby="heading403" data-parent="#controls"><div class="card-body"><p>All data received from the client-side should be considered tainted and a potential
                        risk, regardless of the source or transport method.&nbsp;Using mass-assignment or
                        auto-binding when accepting values from an untrusted source and mapping them to trusted server
                        side values increases the risk of tainted data being used unsafely.</p>
                        <p></p>
                        <ul>
                        <li>Bind individual values to specific fields, instead of binding whole objects.</li>
                        <li>Use available features of the language or framework that allow specification of white
                        lists of attributes or fields that are allowed to be modified.&nbsp;</li>
                        <ul>
                        <li>For example, applications written with Ruby on Rails can use the attr_accessible
                        (white list) or attr_protected (black list) macros in each class that may be used in mass
                        assignment.</li>
                        </ul>
                        </ul>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading412"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse412" aria-expanded="true" aria-controls="collapse412">Threat: Unauthorised data could be accessed by manipulating parameters sent to the application <span>[CAPEC-101]</span></button></h5></div><div id="collapse412" class="collapse" aria-labelledby="heading412" data-parent="#threats"><div class="card-body">The application could be tricked into exposing data to unauthorized users by
                                manipulating the parameters it accepts. All data received from the client side could be
                                subject to manipulation, including fields like cookies and HTTP headers, if these are
                                used as inputs to the application.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading407"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse407" aria-expanded="true" aria-controls="collapse407">Weakness: Improper Input Validation <span>[CWE-20]</span></button></h5></div><div id="collapse407" class="collapse" aria-labelledby="heading407" data-parent="#weaknesses"><div class="card-body">The product does not validate or incorrectly validates input that can affect the control flow
                        or data flow of a program.&nbsp;
                        <div>
                        &nbsp;
                        <br />When software does not validate input properly, an attacker is able to craft the
                        input in a form that is not expected by the rest of the application. This will lead to parts of
                        the system receiving unintended input, which may result in altered control flow, arbitrary
                        control of a resource, or arbitrary code execution.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading406"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse406" aria-expanded="true" aria-controls="collapse406">Countermeasure: Validate input parameters to prevent HTTP Parameter Pollution <span>[CWE-147]</span></button></h5></div><div id="collapse406" class="collapse" aria-labelledby="heading406" data-parent="#controls"><div class="card-body">All data received from external sources should be considered tainted and a potential risk,
                        regardless of the source or transport method. HTTP Parameter Pollution attacks result when
                        parameters are added or inserted into requests, and are inappropriately or unsafely handled by
                        the server. For example, injection of parameters into strings or cookies sent to the application
                        can result in the variables being interpreted out of sequence, exploiting flaws in the business
                        logic and flow.
                        <div>
                        <div>
                        <ul>
                        </ul>
                        </div>
                        <div>
                        <p>For example, there was a bug in the Blogger platform which illustrates this
                        vulnerability. The bug allowed malicious users to take ownership of the victim's blog by using the following HTTP request:</p>
                        <blockquote>
                        <p><code>POST /add-authors.do HTTP/1.1</code></p>
                        </blockquote>
                        <blockquote>
                        <p><code>security_token=attackertoken&amp;<b>blogID=attackerblogidvalue</b>&amp;<b>blogID=victimblogidvalue</b>&amp;authorsList=goldshlager19test%40gmail.com(attacker
                        email)&amp;ok=Invite</code></p>
                        </blockquote>
                        <p>The flaw resided in the authentication mechanism used by the web application, as the
                        security check was performed on the first&nbsp;<code>blogID</code>&nbsp;parameter,
                        whereas the actual operation used the second occurrence.</p>
                        </div>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading409"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse409" aria-expanded="true" aria-controls="collapse409">Weakness: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') <span>[CWE-22]</span></button></h5></div><div id="collapse409" class="collapse" aria-labelledby="heading409" data-parent="#weaknesses"><div class="card-body">The software uses external input to construct a pathname that is intended to identify a file
                        or directory that is located underneath a restricted parent directory, but the software does not
                        properly neutralize special elements within the pathname that can cause the pathname to resolve
                        to a location that is outside of the restricted directory.&nbsp;&nbsp;
                        <div>
                        &nbsp;
                        <br />Many file operations are intended to take place within a restricted directory. By
                        using special elements such as &quot;..&quot; and &quot;/&quot; separators,
                        attackers can escape outside of the restricted location to access files or directories that are
                        elsewhere on the system. One of the most common special elements is the &quot;../&quot;
                        sequence, which in most modern operating systems is interpreted as the parent directory of the
                        current location. This is referred to as relative path traversal.&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        Path traversal also covers the use of absolute pathnames such as &quot;/usr/local/bin&quot;,
                        which may also be useful in accessing unexpected files. This is referred to as absolute path
                        traversal.In many programming languages, the injection of a null byte (the 0 or NUL) may allow
                        an attacker to truncate a generated filename to widen the scope of attack. For example, the
                        software may add &quot;.txt&quot; to any pathname, thus limiting the attacker to text
                        files, but a null injection may effectively remove this restriction.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading408"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse408" aria-expanded="true" aria-controls="collapse408">Countermeasure: Avoid using direct references to files <span>[CWE-639]</span></button></h5></div><div id="collapse408" class="collapse" aria-labelledby="heading408" data-parent="#controls"><div class="card-body"><div>
                        All data received from the client-side should be considered tainted and a potential risk,
                        regardless of the source or transport method. Many flaws in applications result from unsafe
                        handling of filenames or path data, for example directory traversal and arbitrary file
                        disclosure. Use of filenames or other direct references to objects such as files at the
                        server-side increases the risk of compromise of the system or unauthorized access to other
                        files, content, or functionality.
                        </div>
                        <div>
                        <ul>
                        <li>Avoid using direct references to files or validate file name.</li>
                        <li>For example instead of using:&nbsp;<a>www.example.com/open.jsp?file=details.txt&nbsp;</a>use:&nbsp;<a>www.example.com/open.jsp?file=[GUID]</a>&nbsp;and
                        then use a lookup table on the server to associate the [GUID] value with file details.txt.</li>
                        <li>Files should be stored outside the web-root to prevent an attacker browsing directly
                        to them.</li>
                        <li>Do not use obscurity to prevent access; for example do not rely on renaming a file to
                        include a random string to prevent direct download or disclosure.</li>
                        </ul>If direct references are used to access files from within the web-root deviating from
                        recommended security practice, the following must be implemented:
                        </div>
                        <div>
                        <ul>
                        <li>String input validation must be applied.&nbsp; Identify and filter for directory
                        traversal meta-characters such as &quot;../&quot; or &quot;..\&quot; or &quot;/&quot;,
                        together with encoded variations and derivations.</li>
                        <li>Use of a strict white-list of files that may be downloaded.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading411"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse411" aria-expanded="true" aria-controls="collapse411">Weakness: Trusting HTTP Permission Methods on the Server Side <span>[CWE-650]</span></button></h5></div><div id="collapse411" class="collapse" aria-labelledby="heading411" data-parent="#weaknesses"><div class="card-body">The server contains a protection mechanism that assumes that
                        any URI that is accessed using HTTP GET will not cause a state change to the
                        associated resource. This might allow attackers to bypass intended access
                        restrictions and conduct resource modification and deletion attacks, since some
                        applications allow GET to modify state.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading410"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse410" aria-expanded="true" aria-controls="collapse410">Countermeasure: Ensure that the application accepts only a defined set of required HTTP request methods <span>[RESTRICT-HTTP-METHODS]</span></button></h5></div><div id="collapse410" class="collapse" aria-labelledby="heading410" data-parent="#controls"><div class="card-body"><div>
                        HTTP offers a number of methods that can be used to perform actions on the web server. Many of
                        theses methods are designed to aid developers in deploying and testing HTTP applications. These
                        HTTP methods can be used for nefarious purposes if the web server is misconfigured.
                        Additionally, Cross Site Tracing (XST), a form of cross site scripting using the server's HTTP
                        TRACE method, is examined.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        While GET and POST are by far the most common methods that are used to access information
                        provided by a web server, the Hypertext Transfer Protocol (HTTP) allows several other (and
                        somewhat less known) methods. RFC 2616 (which describes HTTP version 1.1 which is the standard
                        today) defines the following eight methods:
                        </div>
                        <div>
                        <ul>
                        <li>HEAD</li>
                        <li>GET</li>
                        <li>POST</li>
                        <li>PUT</li>
                        <li>DELETE</li>
                        <li>TRACE</li>
                        <li>OPTIONS</li>
                        <li>CONNECT</li>
                        </ul>
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        Some of these methods can potentially pose a security risk for a web application, as they allow
                        an attacker to modify the files stored on the web server and, in some scenarios, steal the
                        credentials of legitimate users. More specifically, the methods that should be disabled are the
                        following:
                        </div>
                        <div>
                        <ul>
                        <li><b>PUT: </b>This method allows a client to upload new files on the web
                        server. An attacker can exploit it by uploading malicious files (e.g.: an asp file that executes
                        commands by invoking cmd.exe), or by simply using the victim's server as a file repository.</li>
                        <li><b>DELETE:</b> This method allows a client to delete a file on the web
                        server. An attacker can exploit it as a very simple and direct way to deface a web site or to
                        mount a DoS attack.</li>
                        <li><b>CONNECT: </b>This method could allow a client to use the web server as
                        a proxy.</li>
                        <li><b>TRACE: </b>This method simply echoes back to the client whatever string
                        has been sent to the server, and is used mainly for debugging purposes. This method, originally
                        assumed harmless, can be used to mount an attack known as Cross Site Tracing, which has been
                        discovered by Jeremiah Grossman (see links at the bottom of the page).</li>
                        </ul>
                        </div>
                        <div>
                        If an application needs one or more of these methods, such as REST Web Services (which may
                        require PUT or DELETE), it is important to check that their usage is properly limited to trusted
                        users and safe conditions.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        Ensure that the application accepts only the HTTP requests GET and POST. The HTTP requests
                        TRACE, PUT and DELETE are blocked.
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading419"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse419" aria-expanded="true" aria-controls="collapse419">Risk pattern: HTTP-Service: Authorization <span>[HTTP-SERVICE:AUTHZ]</span></button></h5></div><div id="collapse419" class="collapse" aria-labelledby="heading419" data-parent="#components"><div class="card-body">Server side access control functions for a web application<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading418"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse418" aria-expanded="true" aria-controls="collapse418">Use case: Access sensitive data <span>[ACCESS SENSITIVE DATA]</span></button></h5></div><div id="collapse418" class="collapse" aria-labelledby="heading418" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading417"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse417" aria-expanded="true" aria-controls="collapse417">Threat: Attackers gain access to data or services by directly accessing the resources <span>[CAPEC-87]</span></button></h5></div><div id="collapse417" class="collapse" aria-labelledby="heading417" data-parent="#threats"><div class="card-body">An attacker employs forceful browsing to access portions of a website that are
                                otherwise unreachable through direct URL entry.&nbsp;
                                <div>
                                &nbsp;
                                <br />Usually, a front controller or similar design pattern is employed to protect
                                access to portions of a web application.&nbsp;
                                </div>
                                <div>
                                &nbsp;
                                <br />Forceful browsing enables an attacker to access information, perform
                                privileged operations and otherwise reach sections of the web application that have been
                                improperly protected.
                                <br />
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading416"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse416" aria-expanded="true" aria-controls="collapse416">Weakness: Direct Request ('Forced Browsing') <span>[CWE-425]</span></button></h5></div><div id="collapse416" class="collapse" aria-labelledby="heading416" data-parent="#weaknesses"><div class="card-body">The web application does not adequately enforce appropriate authorization on all restricted
                        URLs, scripts, or files.&nbsp;
                        <div>
                        &nbsp;
                        <br />Web applications susceptible to direct request attacks often make the false
                        assumption that such resources can only be reached through a given navigation path and so only
                        apply authorization at certain points in the path.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading415"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse415" aria-expanded="true" aria-controls="collapse415">Countermeasure: Apply authorization checks to segregate and control access to user data <span>[CWE-285]</span></button></h5></div><div id="collapse415" class="collapse" aria-labelledby="heading415" data-parent="#controls"><div class="card-body"><div>
                        <div>
                        Applications protecting sensitive or otherwise restricted resources must ensure only appropriate
                        and authorized users may access the application data. It is important that an application
                        prevents unauthorized users gaining inappropriate access to each other's data; although user A
                        and user B may both be trusted to access data within the application, they may be authorized to
                        only access different subsets of the protected resources.&nbsp; E.g. user A should not be
                        able to access user B's personal data by manipulating a request (typical examples are
                        manipulation of an ID value or other object reference sent in the URL or body of an HTTP
                        request).
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        It is not sufficient to rely on obscurity, for example obfuscated or secret URLs or filenames.
                        The application must validate each request for protected data against the proven identity of the
                        user. Before providing access to restricted resources the application must:
                        </div>
                        <div>
                        <ul>
                        <li>Ensure the user has undergone appropriate authentication (identification and
                        verification, or ID&amp;V). E.g. they must have provided their identity and confirmed this
                        with a password, token, or other verification. Typically this will be through checking the
                        validity of the session token issued after login.</li>
                        <li>Confirm the user is entitled to access the data or resource they are requesting. E.g.
                        their confirmed identify checked against a server-side access control matrix to determine
                        whether they may access the requested resource.</li>
                        <li>Access controls should be granular, and allow for access to individual resources to be
                        issued to individual users or roles.</li>
                        </ul>
                        <div>
                        URL and asset based access control is provided by most web-frameworks, and it is preferable to
                        use an established and proven framework.
                        </div>
                        </div>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading430"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse430" aria-expanded="true" aria-controls="collapse430">Risk pattern: HTTP Service: File Upload <span>[HTTP-SERVICE:FILEUPLOAD]</span></button></h5></div><div id="collapse430" class="collapse" aria-labelledby="heading430" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading429"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse429" aria-expanded="true" aria-controls="collapse429">Use case: Upload Files <span>[UPLOAD FILES]</span></button></h5></div><div id="collapse429" class="collapse" aria-labelledby="heading429" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading428"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse428" aria-expanded="true" aria-controls="collapse428">Threat: Attackers gain unauthorised access through malicious file upload <span>[FILE-MAL-UPLOAD]</span></button></h5></div><div id="collapse428" class="collapse" aria-labelledby="heading428" data-parent="#threats"><div class="card-body">Files that contain malicious content could cause the application to execute the
                                content and therefore grant unauthorized access to the service or the data it contains.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading421"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse421" aria-expanded="true" aria-controls="collapse421">Weakness: The application execute code retrieved from untrusted data sources <span>[CWE-94]</span></button></h5></div><div id="collapse421" class="collapse" aria-labelledby="heading421" data-parent="#weaknesses"><div class="card-body">The execution of untrusted code grants direct control over the application; allowing an
                        attacker to perform arbitrary operations, steal sensitive data, gain control over the system or
                        use the application to launch malicious attacks.&nbsp;
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading420"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse420" aria-expanded="true" aria-controls="collapse420">Countermeasure: Do not execute files received from untrusted sources <span>[WEB-EXEC-DATA]</span></button></h5></div><div id="collapse420" class="collapse" aria-labelledby="heading420" data-parent="#controls"><div class="card-body"><div></div> 
<div>
  Untrusted file data sources could contain malicious software, data sources should not be executed even if an anti-malware scanner has been run against the file.&nbsp;&nbsp; 
</div>This includes use of pre-processing that may result in execution (e.g. eval of tainted content).</div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading425"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse425" aria-expanded="true" aria-controls="collapse425">Weakness: The system fails to validate file contents before processing it <span>[UNTRUSTED-FILE-HANDLING]</span></button></h5></div><div id="collapse425" class="collapse" aria-labelledby="heading425" data-parent="#weaknesses"><div class="card-body">Files uploaded from untrusted sources could contain malicious data that subverts the loading
                        mechanism itself or grants unauthorized access to the system when executed.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading422"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse422" aria-expanded="true" aria-controls="collapse422">Countermeasure: Validate the file format before processing <span>[FILE-DATA-CHECK]</span></button></h5></div><div id="collapse422" class="collapse" aria-labelledby="heading422" data-parent="#controls"><div class="card-body"><div>
  Attackers may attempt to bypass controls on uploaded content by renaming, embedding, or otherwise manipulating benign files with malicious content. As with client-side data, the application should screen uploaded content before processing it. 
</div> 
<div> 
 <ul> 
  <li>File contents and and file-system path data must to be checked for sanity.</li> 
  <li>Consider directory traversal, local file inclusion, and OS injection attacks when validating filenames.</li> 
  <li>Verify MIME type is correct and appropriate, and matches content.</li> 
  <li>Files with an structured format should be checked against the expected format/definition (e.g. XML against a XSD or DTD).</li> 
 </ul> 
</div> 
<div> 
</div></div></div></div><div class="card border-success"><div class="card-header " id="heading423"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse423" aria-expanded="true" aria-controls="collapse423">Countermeasure: Perform content scanning on untrusted files when uploaded <span>[FILE-SCAN]</span></button></h5></div><div id="collapse423" class="collapse" aria-labelledby="heading423" data-parent="#controls"><div class="card-body"><div>
  The application should perform validation and sanitization on all tainted content from the client-side, including uploaded files.&nbsp; 
</div> 
<div> 
 <ul> 
  <li>Content/malware scanning performed against the file (e.g. next generation anti-virus) to detect suspicious, dangerous, or unexpected content.</li> 
  <li>Content analysis should also be used to reject unexpected or dangerous file formats that may harbor malicious code, for example encrypted word, pdf or other office documents or archives, or other files with hidden or executable payloads.</li> 
 </ul> 
</div></div></div></div><div class="card border-success"><div class="card-header " id="heading424"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse424" aria-expanded="true" aria-controls="collapse424">Countermeasure: Do not use untrusted client-side data in server-side file operations <span>[WEB-FILE-DATA]</span></button></h5></div><div id="collapse424" class="collapse" aria-labelledby="heading424" data-parent="#controls"><div class="card-body"><div>
  The application may be required to base server-side file operations based on client-side actions. This can expose the application to attack through remote or local file-inclusion, or remote code execution attacks if unsafe data is used in file inclusion, class loader, or reflection capabilities. 
</div> 
<div> 
 <ul> 
  <li>Tainted, untrusted, client-side data must not be used directly in server-side file load operations.</li> 
  <li>Where server-side operations are dependent on client-side input, this should be mapped to pre-defined operations on the server-side rather than using tainted client-side input directly.</li> 
 </ul> 
</div> 
<div></div></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading427"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse427" aria-expanded="true" aria-controls="collapse427">Weakness: Uploaded files are stored within the webroot path <span>[WEB-PATH-ROOT]</span></button></h5></div><div id="collapse427" class="collapse" aria-labelledby="heading427" data-parent="#weaknesses"><div class="card-body">If uploaded files are stored within the webroot path, they might be accessible to unauthorized
                        parties.&nbsp;
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading426"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse426" aria-expanded="true" aria-controls="collapse426">Countermeasure: Do not store user files under the web root <span>[ASVS-16.6]</span></button></h5></div><div id="collapse426" class="collapse" aria-labelledby="heading426" data-parent="#controls"><div class="card-body"><div>
  Storage of user-controlled content in folders accessible through the web-server increases the risk of exposure, and also facilitates attacks relying on the upload and execution, or distribution, of malicious content.&nbsp; 
</div> 
<div> 
 <br /> 
</div> 
<div>
  In the case of proprietary user data, it may also expose the restricted data to compromise through direct browsing or direct object reference manipulation if access controls are not securely implemented 
</div> 
<div> 
 <ul> 
  <li>Store uploaded files and other content in segregated folders outside of the web root directory tree to prevent direct access.</li> 
  <li>File content that is intended to be accessed by users from the client-side should be streamed with appropriate MIME types.</li> 
  <li>Ensure appropriate permissions are applied to the files and the folders; they should only be readable by the relevant service accounts, and should not be executable.</li> 
  <li>Ideally, the folder containing the files should not be accessible through the web-application even in the event of a directory traversal or server-side file include vulnerability.</li> 
 </ul> 
</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading451"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse451" aria-expanded="true" aria-controls="collapse451">Risk pattern: HTTP Service: Session ID <span>[HTTP-SERVICE:SESSION]</span></button></h5></div><div id="collapse451" class="collapse" aria-labelledby="heading451" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading450"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse450" aria-expanded="true" aria-controls="collapse450">Use case: Authentication <span>[AUTHENTICATION]</span></button></h5></div><div id="collapse450" class="collapse" aria-labelledby="heading450" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading437"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse437" aria-expanded="true" aria-controls="collapse437">Threat: An attacker induces a client to establish a session with the target software using a session identifier provided by the attacker <span>[CAPEC-61]</span></button></h5></div><div id="collapse437" class="collapse" aria-labelledby="heading437" data-parent="#threats"><div class="card-body">The attacker induces a client to establish a session with the target software using a
                                session identifier provided by the attacker. Once the user successfully authenticates to
                                the target software, the attacker uses the (now privileged) session identifier in their
                                own transactions. This attack leverages the fact that the target software either relies
                                on client-generated session identifiers or maintains the same session identifiers after
                                privilege elevation.
                                <br />
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading436"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse436" aria-expanded="true" aria-controls="collapse436">Weakness: Application allows user to use a session ID not produced by the application <span>[CWE-384]</span></button></h5></div><div id="collapse436" class="collapse" aria-labelledby="heading436" data-parent="#weaknesses"><div class="card-body">Authenticating a user, or otherwise establishing a new user session, without invalidating any
                        existing session identifier gives an attacker the opportunity to steal authenticated sessions.
                        Such a scenario is commonly observed when:
                        <ol>
                        <li>A web application authenticates a user without first invalidating the existing
                        session, thereby continuing to use the session already associated with the user.</li>
                        <li>An attacker is able to force a known session identifier on a user so that, once the
                        user authenticates, the attacker has access to the authenticated session.</li>
                        <li>The application or container uses predictable session identifiers. In the generic
                        exploit of session fixation vulnerabilities, an attacker creates a new session on a web
                        application and records the associated session identifier. The attacker then causes the victim
                        to associate, and possibly authenticate, against the server using that session identifier,
                        giving the attacker access to the user's account through the active session.</li>
                        </ol>
                        <br />
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading431"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse431" aria-expanded="true" aria-controls="collapse431">Countermeasure: Give the user an option to terminate all active sessions when a password change event is triggered <span>[CSD-PWD-CHG]</span></button></h5></div><div id="collapse431" class="collapse" aria-labelledby="heading431" data-parent="#controls"><div class="card-body">A password change could be the event of a possible password compromise. The user must have the option of invalidating all the active sessions when performing the password change.</div></div></div><div class="card border-success"><div class="card-header " id="heading432"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse432" aria-expanded="true" aria-controls="collapse432">Countermeasure: Provide a section with a list of all active sessions and information about them <span>[CSD-SESS-FED]</span></button></h5></div><div id="collapse432" class="collapse" aria-labelledby="heading432" data-parent="#controls"><div class="card-body">The application should provide a section with a list of all the active sessions. That list should contain as much information as possible and should allow the user to invalidate all sessions or any of them selectively.</div></div></div><div class="card border-success"><div class="card-header " id="heading433"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse433" aria-expanded="true" aria-controls="collapse433">Countermeasure: Actively reject Session IDs that have not been generated by the application <span>[CWE-384]</span></button></h5></div><div id="collapse433" class="collapse" aria-labelledby="heading433" data-parent="#controls"><div class="card-body"><div>
  The application should recognize previously issued Session IDs and reject every session ID that has not been generated by the application. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Some types of attacks rely on session fixation. This involves an attacker making up a Session ID not generated by the application and then deceiving the user into clicking a link and authenticating using this Session ID. As the attacker has knowledge of this Session ID he/she will have access if that Session ID is accepted and not invalidated and changed after authentication. 
</div></div></div></div><div class="card border-success"><div class="card-header " id="heading434"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse434" aria-expanded="true" aria-controls="collapse434">Countermeasure: Limit the number of active concurrent sessions <span>[LIMIT-ACTIVE-SESSIONS]</span></button></h5></div><div id="collapse434" class="collapse" aria-labelledby="heading434" data-parent="#controls"><div class="card-body">The number of active sessions shall be limited to avoid several active sessions at the same time. If there are several active sessions, one of them may be used by the real user and another session by attackers who are able to implement changes without the real user being aware.</div></div></div><div class="card border-success"><div class="card-header " id="heading435"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse435" aria-expanded="true" aria-controls="collapse435">Countermeasure: Implement mechanisms to renew the session and session id <span>[RENEW-SESSION]</span></button></h5></div><div id="collapse435" class="collapse" aria-labelledby="heading435" data-parent="#controls"><div class="card-body">Implement a mechanism to generate a new session and new session id, when a successful authentication or re-authentication occurs. After this creation, the old session and session ID shall be removed securely.</div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading440"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse440" aria-expanded="true" aria-controls="collapse440">Threat: An attacker reuses a valid session ID to spoof the target system in order to gain privileges <span>[CAPEC-60]</span></button></h5></div><div id="collapse440" class="collapse" aria-labelledby="heading440" data-parent="#threats"><div class="card-body">This attack targets the reuse of valid session ID to spoof the target system in order
                                to gain privileges. The attacker tries to reuse a stolen session ID used previously
                                during a transaction to perform spoofing and session hijacking. Another name for this
                                type of attack is Session Replay.
                                <br />
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading439"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse439" aria-expanded="true" aria-controls="collapse439">Weakness: Application allows user to use a session ID not produced by the application <span>[CWE-384]</span></button></h5></div><div id="collapse439" class="collapse" aria-labelledby="heading439" data-parent="#weaknesses"><div class="card-body">Authenticating a user, or otherwise establishing a new user session, without invalidating any
                        existing session identifier gives an attacker the opportunity to steal authenticated sessions.
                        Such a scenario is commonly observed when:
                        <ol>
                        <li>A web application authenticates a user without first invalidating the existing
                        session, thereby continuing to use the session already associated with the user.</li>
                        <li>An attacker is able to force a known session identifier on a user so that, once the
                        user authenticates, the attacker has access to the authenticated session.</li>
                        <li>The application or container uses predictable session identifiers. In the generic
                        exploit of session fixation vulnerabilities, an attacker creates a new session on a web
                        application and records the associated session identifier. The attacker then causes the victim
                        to associate, and possibly authenticate, against the server using that session identifier,
                        giving the attacker access to the user's account through the active session.</li>
                        </ol>
                        <br />
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading438"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse438" aria-expanded="true" aria-controls="collapse438">Countermeasure: Implement mechanisms to renew the session and session id <span>[RENEW-SESSION]</span></button></h5></div><div id="collapse438" class="collapse" aria-labelledby="heading438" data-parent="#controls"><div class="card-body">Implement a mechanism to generate a new session and new session id, when a successful authentication or re-authentication occurs. After this creation, the old session and session ID shall be removed securely.</div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading446"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse446" aria-expanded="true" aria-controls="collapse446">Threat: Attackers could compromise users' sessions by comproming the session cookie <span>[ASVS-2014-3.12]</span></button></h5></div><div id="collapse446" class="collapse" aria-labelledby="heading446" data-parent="#threats"><div class="card-body">If the same session cookie is used for multiple applications, and one of those
                                applications has a vulnerability which discloses the session ID. Then by compromising
                                the session cookie in one application, the attacker would have access to the ID for the
                                other.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading442"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse442" aria-expanded="true" aria-controls="collapse442">Weakness: Application allows user to use a session ID not produced by the application <span>[CWE-384]</span></button></h5></div><div id="collapse442" class="collapse" aria-labelledby="heading442" data-parent="#weaknesses"><div class="card-body">Authenticating a user, or otherwise establishing a new user session, without invalidating any
                        existing session identifier gives an attacker the opportunity to steal authenticated sessions.
                        Such a scenario is commonly observed when:
                        <ol>
                        <li>A web application authenticates a user without first invalidating the existing
                        session, thereby continuing to use the session already associated with the user.</li>
                        <li>An attacker is able to force a known session identifier on a user so that, once the
                        user authenticates, the attacker has access to the authenticated session.</li>
                        <li>The application or container uses predictable session identifiers. In the generic
                        exploit of session fixation vulnerabilities, an attacker creates a new session on a web
                        application and records the associated session identifier. The attacker then causes the victim
                        to associate, and possibly authenticate, against the server using that session identifier,
                        giving the attacker access to the user's account through the active session.</li>
                        </ol>
                        <br />
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading441"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse441" aria-expanded="true" aria-controls="collapse441">Countermeasure: Session ID's should be transmitted securely <span>[ASVS-2014-3.6]</span></button></h5></div><div id="collapse441" class="collapse" aria-labelledby="heading441" data-parent="#controls"><div class="card-body"><div>
                        <div>
                        <div>
                        The session token value issued after users have successfully identified and authenticated
                        themselves is of equivalent value to the secrets the user presents to login, and must be
                        protected accordingly. Data passed in the URL (address bar) between client and server is likely
                        to be exposed in logs on the server, or intermediate devices (such as proxies or other network
                        devices), or in local browser logs/history. A common mistake is, for example, to pass a
                        SessionID value as a parameter in the URL of a get request between hosts. To mitigate the risk
                        of exposure of sensitive data, it should only be sent in the body of an HTTP message (for
                        example a POST request), or in the HTTP headers (either standard headers such as the Cookie
                        values, or a custom X- header).
                        </div>
                        </div>
                        <div>
                        <ul>
                        <li>Ensure sensitive, private, or otherwise restricted data is not sent in a URL value
                        'GET' parameter.</li>
                        <li>Specifically, never the session ID token in the URL or over unencrypted transport.</li>
                        <li>Pass data only in appropriately protected fields in the body or headers, for example:</li>
                        <ul>
                        <li>A session Cookie (e.g. JSESSIONID, ASP.NET_SessionID)</li>
                        <li>A POST parameter (e.g. a token in the HTTP request body, or JSON parameter)</li>
                        <li>A standard or bespoke HTTP header (Authorization: X-Session header)</li>
                        </ul>
                        </ul>
                        </div>
                        </div>
                        <ul>
                        </ul>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading445"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse445" aria-expanded="true" aria-controls="collapse445">Weakness: Cookie path and domain attributes set too liberally <span>[COOKIE-WEAKNESS]</span></button></h5></div><div id="collapse445" class="collapse" aria-labelledby="heading445" data-parent="#weaknesses"><div class="card-body">if an application sets a cookie with too open domain and path attributes, an attacker can
                        exploit this situation to gain access to the cookie and hence to the resources that this cookie
                        protect.&nbsp;
                        <div>
                        &nbsp;
                        <br />An example of a wide open and wrongly scoped cookie would be one with the domain
                        attribute set to the whole domain = .example.org
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading443"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse443" aria-expanded="true" aria-controls="collapse443">Countermeasure: Session cookie domain attributes should be restricted to prevent exposure <span>[ASVS-2014-3.12-DOMAIN]</span></button></h5></div><div id="collapse443" class="collapse" aria-labelledby="heading443" data-parent="#controls"><div class="card-body">The session token value issued after users have successfully identified and authenticated
                        themselves is of equivalent value to the secrets the user presents to login, and must be
                        protected accordingly. If the cookie domain attribute is too liberal, the cookie may be
                        accessible to other hosts within the parent domain. This is a particular issue in multi-tenanted
                        hosting, or where applications are delivered as subdomains of a third party parent domain.
                        <div>
                        <ul>
                        <li>The domain attribute for the session cookie should be restricted to the fully
                        qualified hostname on which the application is running.</li>
                        <li>For example, the cookie domain should be set to myapp.example.com rather than
                        .example.com</li>
                        <li>e.g. Set-Cookie: session=token; Path=/app; <b>Domain=myapp.example.com</b>;
                        secure; HTTPOnly</li>
                        </ul>
                        <div>
                        </div>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading444"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse444" aria-expanded="true" aria-controls="collapse444">Countermeasure: Session cookie path attributes should be restricted to prevent exposure <span>[ASVS-2014-3.12-PATH]</span></button></h5></div><div id="collapse444" class="collapse" aria-labelledby="heading444" data-parent="#controls"><div class="card-body"><div>
                        The session token value issued after users have successfully identified and authenticated
                        themselves is of equivalent value to the secrets the user presents to login, and must be
                        protected accordingly. If the cookie path attribute is not appropriately restricted, the session
                        token may be accessible from other applications or content on the server.
                        </div>
                        <div>
                        <ul>
                        <li>The path attribute for the session cookie should be restricted to the application that
                        requires it.</li>
                        <li>For example, if the application is located at: &quot;myapp.example.com/theapp&quot;.&nbsp;Then
                        the path should e set to: &quot;/theapp/&quot;.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading449"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse449" aria-expanded="true" aria-controls="collapse449">Threat: Session ID's and hence user sessions are compromised through network sniffing or man in the middle attacks <span>[CAPEC-158-SESSION]</span></button></h5></div><div id="collapse449" class="collapse" aria-labelledby="heading449" data-parent="#threats"><div class="card-body">An attacker with access to the network path between the victim and the server could
                                employ a sniffer to sniff clear text traffic on the network. If the session ID is
                                transmitted in clear text, then the attacker could compromise it and thereby gain access
                                to the user's session.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading448"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse448" aria-expanded="true" aria-controls="collapse448">Weakness: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute <span>[CWE-614]</span></button></h5></div><div id="collapse448" class="collapse" aria-labelledby="heading448" data-parent="#weaknesses"><div class="card-body">The Secure attribute for sensitive cookies in HTTPS sessions is not set, which could cause the
                        user agent to send those cookies in plaintext over an HTTP session.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading447"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse447" aria-expanded="true" aria-controls="collapse447">Countermeasure: Set the 'secure' flag (or directive) on sensitive cookies <span>[SESS-SNIFF-COOKIE]</span></button></h5></div><div id="collapse447" class="collapse" aria-labelledby="heading447" data-parent="#controls"><div class="card-body"><div>
                        <div>
                        Cookies and their data are passed in the HTTP headers of client-web server communications, and
                        are subject to the same transport security. Sensitive data such as the Session ID sent over
                        unencrypted HTTP transport can be intercepted or monitored in transit, exposing the information
                        or the user's session. The secure directive instructs compliant browsers to only pass the cookie
                        over secure transport, which in most instances implies it will only be sent over an encrypted
                        HTTPS (TLS) connection, thereby protecting users from network sniffing and spoofing attacks.
                        </div>
                        <div>
                        <ul>
                        <li>Set the secure directive on all cookies containing sensitive data (in particular the
                        session ID token).</li>
                        <li>Where an application uses a mix of encrypted and unencrypted content, if session
                        tracking is required a secondary session token which does not permit access to sensitive content
                        could be used, although this deviates from security best-practice.</li>
                        </ul>
                        </div>
                        </div>
                        <div>
                        <div>
                        <div>
                        <ul>
                        </ul>
                        </div>
                        </div>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading452"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse452" aria-expanded="true" aria-controls="collapse452">Risk pattern: IIS Server <span>[SERVER:IIS]</span></button></h5></div><div id="collapse452" class="collapse" aria-labelledby="heading452" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading453"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse453" aria-expanded="true" aria-controls="collapse453">Risk pattern: Java Applet Client <span>[CLIENT:APPLET]</span></button></h5></div><div id="collapse453" class="collapse" aria-labelledby="heading453" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading454"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse454" aria-expanded="true" aria-controls="collapse454">Risk pattern: Java EE App Server <span>[SERVER:JAVA-EE]</span></button></h5></div><div id="collapse454" class="collapse" aria-labelledby="heading454" data-parent="#components"><div class="card-body">A Java Enterprise Edition App Server<div class="accordion" id="usecases"></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading455"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse455" aria-expanded="true" aria-controls="collapse455">Risk pattern: JavaScript Server <span>[SERVER:JAVASCRIPT]</span></button></h5></div><div id="collapse455" class="collapse" aria-labelledby="heading455" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading456"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse456" aria-expanded="true" aria-controls="collapse456">Risk pattern: Java Web Container <span>[SERVER:JAVA-WEB]</span></button></h5></div><div id="collapse456" class="collapse" aria-labelledby="heading456" data-parent="#components"><div class="card-body">A Java Web Container<div class="accordion" id="usecases"></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading457"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse457" aria-expanded="true" aria-controls="collapse457">Risk pattern: Java Web Start Client <span>[CLIENT:WEBSTART]</span></button></h5></div><div id="collapse457" class="collapse" aria-labelledby="heading457" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading462"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse462" aria-expanded="true" aria-controls="collapse462">Risk pattern: LDAP Store <span>[LDAP-STORE]</span></button></h5></div><div id="collapse462" class="collapse" aria-labelledby="heading462" data-parent="#components"><div class="card-body">LDAP store<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading461"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse461" aria-expanded="true" aria-controls="collapse461">Use case: Read or Post data <span>[READ OR POST DATA]</span></button></h5></div><div id="collapse461" class="collapse" aria-labelledby="heading461" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading460"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse460" aria-expanded="true" aria-controls="collapse460">Threat: Attackers could access data for which they're not authorised through LDAP injection attacks <span>[CAPEC-136]</span></button></h5></div><div id="collapse460" class="collapse" aria-labelledby="heading460" data-parent="#threats"><div class="card-body">Attackers could exploit LDAP injection vulnerabilities and gain access to data to
                                which
                                they are not authorized in the LDAP store.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading459"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse459" aria-expanded="true" aria-controls="collapse459">Weakness: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') <span>[CWE-90]</span></button></h5></div><div id="collapse459" class="collapse" aria-labelledby="heading459" data-parent="#weaknesses"><div class="card-body">The software constructs all or part of an LDAP query using externally-influenced input from an
                        upstream component, but it does not neutralize or incorrectly neutralizes special elements that
                        could modify the intended LDAP query when it is sent to a downstream component.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading458"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse458" aria-expanded="true" aria-controls="collapse458">Countermeasure: Escape LDAP meta-characters in user input <span>[CWE-150-LDAP]</span></button></h5></div><div id="collapse458" class="collapse" aria-labelledby="heading458" data-parent="#controls"><div class="card-body"><div>
                        <div>
                        All data received from the client-side should be considered tainted and a potential risk,
                        regardless of the source or transport method.&nbsp;As such, all data from the client side
                        must be subjected to strict validation, sanitization, and encoding against expected syntactic
                        and semantic criteria.
                        </div>
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        When using user supplied input in an LDAP query:
                        </div>
                        <div>
                        <div>
                        <ul>
                        <li>Ensure that LDAP specific meta-characters are escaped before the query is executed.</li>
                        <li>Define a specification of the data that is expected at each input; both the syntax
                        (e.g. alphanumeric only) and semantics (e.g. a word of between 1 and 25 characters, or a
                        specific list). As an example of business rule logic, &quot;boat&quot; may be
                        syntactically valid because it only contains alphanumeric characters, but it is not valid if the
                        input is only expected to contain colors such as &quot;red&quot; or &quot;blue.&quot;</li>
                        <li>Implement a 'known good' or white-list approach, where only inputs that meet the
                        strict criteria for each input are accepted, and reject, transform, or encapsulate any
                        non-compliant data.</li>
                        </ul>
                        </div>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading481"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse481" aria-expanded="true" aria-controls="collapse481">Risk pattern: Logs Policy <span>[LOGS-POLICY]</span></button></h5></div><div id="collapse481" class="collapse" aria-labelledby="heading481" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading480"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse480" aria-expanded="true" aria-controls="collapse480">Use case: Log Management <span>[LOG-MANAGEMENT]</span></button></h5></div><div id="collapse480" class="collapse" aria-labelledby="heading480" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading468"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse468" aria-expanded="true" aria-controls="collapse468">Threat: An attacker injects, manipulates or forges malicious log entries in the log file, allowing him to mislead a log audit, cover traces of attack, or perform other malicious actions <span>[CAPEC-93]</span></button></h5></div><div id="collapse468" class="collapse" aria-labelledby="heading468" data-parent="#threats"><div class="card-body">This attack targets the log files of the target host. The attacker injects,
                                manipulates or forges malicious log entries in the log file, allowing him to mislead a
                                log audit, cover traces of attack, or perform other malicious actions. The target host
                                is not properly controlling log access. As a result tainted data is resulting in the log
                                files leading to a failure in accountability, non-repudiation and incident forensics
                                capability.
                                <br />
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading464"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse464" aria-expanded="true" aria-controls="collapse464">Weakness: Improper Output Neutralization for Logs <span>[CWE-117]</span></button></h5></div><div id="collapse464" class="collapse" aria-labelledby="heading464" data-parent="#weaknesses"><div class="card-body">The software does not neutralize or incorrectly neutralizes
                        output that is written to logs.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading463"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse463" aria-expanded="true" aria-controls="collapse463">Countermeasure: Escape meta-characters from un-trusted data  <span>[ASVS-8.8]</span></button></h5></div><div id="collapse463" class="collapse" aria-labelledby="heading463" data-parent="#controls"><div class="card-body">If untrusted data, including any data received from the client side of a connection is
                        directly written to a log file, then this data could contain newline or other meta-characters
                        that would allow an attacker to forge log entries.
                        <div>
                        Such meta-characters should first be escaped or removed before the data is written to the
                        logging system.
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading467"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse467" aria-expanded="true" aria-controls="collapse467">Weakness: The service contains vulnerabilities that could grant access to data <span>[CWE-284]</span></button></h5></div><div id="collapse467" class="collapse" aria-labelledby="heading467" data-parent="#weaknesses"><div class="card-body">The services may contain security vulnerabilities that can be exploited by attackers to gain unauthorized access to data or additional services.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading465"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse465" aria-expanded="true" aria-controls="collapse465">Countermeasure: Ensure the integrity of the logging system <span>[LOGS-INTEGRITY]</span></button></h5></div><div id="collapse465" class="collapse" aria-labelledby="heading465" data-parent="#controls"><div class="card-body">Ensure Log integrity for the application generated logs, such as storing logs on write-once media, forwarding a copy of the logs to a centralized SIEM or generating message digests for each log file.</div></div></div><div class="card border-success"><div class="card-header " id="heading466"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse466" aria-expanded="true" aria-controls="collapse466">Countermeasure: Limit the number of accounts with privileges allowing modification and/or deletion of audit logs files <span>[RESTRICT-NUMBER-ACCOUNT-TO-LOGS]</span></button></h5></div><div id="collapse466" class="collapse" aria-labelledby="heading466" data-parent="#controls"><div class="card-body"><div>
                        Limit the number of account with privileges to modify and/or delete audit logs files.
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading474"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse474" aria-expanded="true" aria-controls="collapse474">Threat: Attacks against the authentication system may go undetected <span>[CWE-778-AUTH]</span></button></h5></div><div id="collapse474" class="collapse" aria-labelledby="heading474" data-parent="#threats"><div class="card-body">Automated attacks against many user accounts, or successful attacks against an account
                                require a response. &nbsp;If audit logs are not kept of both successful and
                                unsuccessful authentication operations, then post attack forensics will be hampered.&nbsp;&nbsp;
                                <div>
                                &nbsp;
                                <br />Without a dynamic response to mass automated attacks against the
                                authentication system, attackers stand a greater chance of success.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading473"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse473" aria-expanded="true" aria-controls="collapse473">Weakness: Insufficient Logging <span>[CWE-778]</span></button></h5></div><div id="collapse473" class="collapse" aria-labelledby="heading473" data-parent="#weaknesses"><div class="card-body">When a security-critical event occurs, the software either does not record the event or omits important details about the event when logging it.

When security-critical events are not logged properly, such as a failed login attempt, this can make malicious behavior more difficult to detect and may hinder forensic analysis after an attack succeeds.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading469"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse469" aria-expanded="true" aria-controls="collapse469">Countermeasure: Log details of user actions within the system <span>[CDS-USER-TRACK]</span></button></h5></div><div id="collapse469" class="collapse" aria-labelledby="heading469" data-parent="#controls"><div class="card-body"><p>To maintain proper accountability, logs should be maintained with sufficient information to track user actions within the system. These logs should be forensically sound, non-repudiable, and contain comprehensive details about activity. While the exact data for an event may vary, the following should be captured at a minimum:</p> 
<ul> 
 <li>Timestamps against a proven external source (e.g. an NTP server)</li> 
 <li>Origin, with this field we mark if the logs are provided by a trusted or untrusted source.</li> 
 <li>Event, status, and/or&nbsp;error codes (with sensitive data masked as appropriate or not introduced in logs)</li> 
 <li>Service, command, application or function name and details</li> 
 <li>User or system account associated with an event</li> 
 <li>Devices used (e.g. source and destination IPs, terminal session ID, web browser, etc)</li> 
</ul> 
<div>
  Source:&nbsp;&nbsp; 
 <a href="https://security.berkeley.edu/security-audit-logging-guideline">https://security.berkeley.edu/security-audit-logging-guideline</a> 
</div></div></div></div><div class="card border-success"><div class="card-header " id="heading470"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse470" aria-expanded="true" aria-controls="collapse470">Countermeasure: Log and reject all data validation failures <span>[CSD-VAL-LOG]</span></button></h5></div><div id="collapse470" class="collapse" aria-labelledby="heading470" data-parent="#controls"><div class="card-body"><div>
  Data validation failures, together with access control violations, are symptomatic of malicious activity where an attacker is attempting to subvert the protections in place. It is therefore likely that unexpected input detected by the application relates to an attack. Rejecting and logging such activity, and ideally terminating the session, increases the likelihood of detecting and inhibiting structured attacks against the application. 
</div> 
<div> 
 <ul> 
  <li>Log all validation failures when rejecting requests.</li> 
  <li>Ensure logged data is appropriately sanitized and encoded to prevent attacks against the logs and subsequent access to them.</li> 
  <li>Terminate the offending user session to inhibit further attack.</li> 
  <li>Ensure errors returned to the client-side are generic to prevent an attacker enumerating the defenses in place or gaining knowledge about the back-end.</li> 
 </ul> 
</div></div></div></div><div class="card border-success"><div class="card-header " id="heading471"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse471" aria-expanded="true" aria-controls="collapse471">Countermeasure: Use a synchronised time source <span>[CWE-662]</span></button></h5></div><div id="collapse471" class="collapse" aria-labelledby="heading471" data-parent="#controls"><div class="card-body"><div>
                        In order to correlate logs and data from different internal and external systems, and to
                        preserve forensic quality of the logs, it is important a unified and trusted synchronized time
                        source is used throughout the environment.&nbsp;&nbsp;
                        </div>
                        <div>
                        <ul>
                        <li>Servers should be synchronize to an internal or external NTP server</li>
                        <li>The centralized source should in turn use (or be) a trusted central time source.</li>
                        </ul>
                        </div>
                        <div>
                        This control is critical in identifying application events (including attacks) through logging,
                        and in conduction post-event analysis, in particular to track the whole user (or attacker)
                        journey through the system should it be compromised.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        It is good practice to use the concept of Indicators of Compromise (IoC) should be used to
                        detect possible situations in which the system has been compromised and to give an appropriate
                        response.&nbsp; IoCs are often tracked through logs, and accurate time is often essential.
                        </div>
                        <div>
                        <br />
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading472"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse472" aria-expanded="true" aria-controls="collapse472">Countermeasure: Log the backend TLS connection failures <span>[LOG-TLS-FAILURES]</span></button></h5></div><div id="collapse472" class="collapse" aria-labelledby="heading472" data-parent="#controls"><div class="card-body">Implement functionality to record backend TLS connection failures and include these in the
                        logs.
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading479"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse479" aria-expanded="true" aria-controls="collapse479">Threat: Data leakage or disclosure to unauthorized parties <span>[EU-GDPR-DATA_LEAKAGE-UNAUTHZ-PARTIES]</span></button></h5></div><div id="collapse479" class="collapse" aria-labelledby="heading479" data-parent="#threats"><div class="card-body"><span style="">Unauthorized party might access/breach the personal data of the
                                data subject.</span>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading476"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse476" aria-expanded="true" aria-controls="collapse476">Weakness: Information Exposure Through Log Files <span>[CWE-532]</span></button></h5></div><div id="collapse476" class="collapse" aria-labelledby="heading476" data-parent="#weaknesses"><div class="card-body">Information written to log files can be of a sensitive nature
                        and give valuable guidance to an attacker or expose sensitive user
                        information.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading475"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse475" aria-expanded="true" aria-controls="collapse475">Countermeasure: Do not write secrets to the log files <span>[CWE-532]</span></button></h5></div><div id="collapse475" class="collapse" aria-labelledby="heading475" data-parent="#controls"><div class="card-body"><div>
                        The logs may be accessed by attackers and in order to protect sensitive data, no such sensitive
                        data should be included in the logs
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading478"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse478" aria-expanded="true" aria-controls="collapse478">Weakness: Logging of Excessive Data <span>[CWE-779]</span></button></h5></div><div id="collapse478" class="collapse" aria-labelledby="heading478" data-parent="#weaknesses"><div class="card-body">The software logs too much information, making log files hard
                        to process and possibly hindering recovery efforts or forensic analysis after an
                        attack.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading477"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse477" aria-expanded="true" aria-controls="collapse477">Countermeasure: Develop a log retention policy <span>[LOG-RETENTION]</span></button></h5></div><div id="collapse477" class="collapse" aria-labelledby="heading477" data-parent="#controls"><div class="card-body"><div>
                        Develop a log retention policy to identify storage requirements for device logs and implement
                        procedures to ensure that the audit logs are available for a security response in the case of
                        incident or investigation.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        The audit logs must be collected for the last 30 days in easily accessible storage media. Older
                        logs should be archived in a protected storage and should be accessible in the future as
                        required for incidents or investigations.
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading482"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse482" aria-expanded="true" aria-controls="collapse482">Risk pattern: Microsoft .NET Application server <span>[SERVER:DOTNET]</span></button></h5></div><div id="collapse482" class="collapse" aria-labelledby="heading482" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading483"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse483" aria-expanded="true" aria-controls="collapse483">Risk pattern: Microsoft Silverlight Client <span>[CLIENT:SILVERLIGHT]</span></button></h5></div><div id="collapse483" class="collapse" aria-labelledby="heading483" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading488"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse488" aria-expanded="true" aria-controls="collapse488">Risk pattern: Mobile Client: Sensitive Read or Post data <span>[MOBILE-CLIENT:SENS-DATA-STORAGE]</span></button></h5></div><div id="collapse488" class="collapse" aria-labelledby="heading488" data-parent="#components"><div class="card-body">Storage of sensitive data on a mobile device<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading487"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse487" aria-expanded="true" aria-controls="collapse487">Use case: Sensitive Read or Post data <span>[SENSITIVE READ OR POST DATA]</span></button></h5></div><div id="collapse487" class="collapse" aria-labelledby="heading487" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading486"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse486" aria-expanded="true" aria-controls="collapse486">Threat: Sensitive Data stored on the mobile device could be accessed by an attacker <span>[CAPEC-167]</span></button></h5></div><div id="collapse486" class="collapse" aria-labelledby="heading486" data-parent="#threats"><div class="card-body">An attacker could retrieve sensitive data stored on a mobile device.
                                <br />This information may be stored in configuration files, embedded within the
                                application itself, or stored in other ways. Sensitive information may include long-term
                                keys, passwords, credit card or financial information, and other private material that
                                the mobile app uses in its interactions with the server.&nbsp;
                                <br />In some cases, it may not even be necessary to gain access to another user's
                                installation - if all instances of the client software are embedded with the same
                                sensitive information (for example, long term keys for communication with the server)
                                then the attacker must simply find a way to gain their own copy of the client in order
                                to perform this attack.
                                <br />
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading485"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse485" aria-expanded="true" aria-controls="collapse485">Weakness: Cleartext Storage of Sensitive Information <span>[CWE-312]</span></button></h5></div><div id="collapse485" class="collapse" aria-labelledby="heading485" data-parent="#weaknesses"><div class="card-body">The application stores sensitive information in cleartext within a resource that might be
                        accessible to another control sphere.
                        <br />Because the information is stored in cleartext, attackers could potentially read it.
                        Even if the information is encoded in a way that is not human-readable, certain techniques could
                        determine which encoding is being used, then decode the information.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading484"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse484" aria-expanded="true" aria-controls="collapse484">Countermeasure: Store sensitive data in a cryptographically secure store <span>[CWE-312-ENCRYPT]</span></button></h5></div><div id="collapse484" class="collapse" aria-labelledby="heading484" data-parent="#controls"><div class="card-body">Mobile devices offer built in API's to store data in their encrypted stores,
                        such as the keychain on iOS. These stores are ultimately encrypted using a key
                        derived from the device passcode and require the user to set a passcode. &nbsp;However,
                        they do not enforce the quality of the passcode, nor is it possible to determine
                        the quality of the passcode (and therefore, ultimately the key) from within the
                        application.&nbsp;Storing data in the built in encrypted store is therefore
                        recommended for private data, but not for highly sensitive financial data for
                        example. &nbsp;If storing highly sensitive data is a requirement, then it
                        should be encrypted using a key derived from an independent password where the
                        strength of this password can be verified.
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading489"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse489" aria-expanded="true" aria-controls="collapse489">Risk pattern: Nginx Server <span>[SERVER:NGINX]</span></button></h5></div><div id="collapse489" class="collapse" aria-labelledby="heading489" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading494"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse494" aria-expanded="true" aria-controls="collapse494">Risk pattern: Non Standard W3C client technology <span>[non-standard-w3c-client-technology]</span></button></h5></div><div id="collapse494" class="collapse" aria-labelledby="heading494" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading493"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse493" aria-expanded="true" aria-controls="collapse493">Use case: General <span>[general]</span></button></h5></div><div id="collapse493" class="collapse" aria-labelledby="heading493" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading492"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse492" aria-expanded="true" aria-controls="collapse492">Threat: Attackers gain access to users' browsers by exploiting vulnerabilities in third party browser plugins <span>[W3C-PLUGINS]</span></button></h5></div><div id="collapse492" class="collapse" aria-labelledby="heading492" data-parent="#threats"><div class="card-body">Third party browser plugins such as Java, Microsoft Silverlight and Adobe Flash
                                increase the attack surface of any application.&nbsp; Vulnerabilities in these
                                plugins can be used by attackers to gain access to a user's browser and in turn to their
                                data and potentially the system itself.&nbsp;&nbsp;
                                <div>
                                Attackers would typically attack this from malicious websites and would require users to
                                first visit these sites in order for the attack to be launched.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading491"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse491" aria-expanded="true" aria-controls="collapse491">Weakness: Application requires the use of third party browser plugins <span>[IR-W3C-PLUGINS]</span></button></h5></div><div id="collapse491" class="collapse" aria-labelledby="heading491" data-parent="#weaknesses"><div class="card-body">The application requires the use of third party browser plugins in order to function.&nbsp;
                        This increases the attack surface.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading490"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse490" aria-expanded="true" aria-controls="collapse490">Countermeasure: Use W3C browser standards only <span>[ONLY-WITH-W3C]</span></button></h5></div><div id="collapse490" class="collapse" aria-labelledby="heading490" data-parent="#controls"><div class="card-body">Do not use Flash, Active-X, Silverlight, NACL, client-side Java or other client side
                        technologies not supported natively by W3C browser standards.
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading495"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse495" aria-expanded="true" aria-controls="collapse495">Risk pattern: NoSQL Database <span>[DATABASE-NOSQL]</span></button></h5></div><div id="collapse495" class="collapse" aria-labelledby="heading495" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading496"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse496" aria-expanded="true" aria-controls="collapse496">Risk pattern: Other Data store <span>[DATASTORE-OTHER]</span></button></h5></div><div id="collapse496" class="collapse" aria-labelledby="heading496" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading505"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse505" aria-expanded="true" aria-controls="collapse505">Risk pattern: Password reset <span>[PWD-RESET]</span></button></h5></div><div id="collapse505" class="collapse" aria-labelledby="heading505" data-parent="#components"><div class="card-body">Password recovery or reset function on the server side<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading504"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse504" aria-expanded="true" aria-controls="collapse504">Use case: Password reset <span>[PASSWORD RESET]</span></button></h5></div><div id="collapse504" class="collapse" aria-labelledby="heading504" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading500"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse500" aria-expanded="true" aria-controls="collapse500">Threat: Attackers gain access to the system by accessing current user's password <span>[CSD-AUTH-PWD]</span></button></h5></div><div id="collapse500" class="collapse" aria-labelledby="heading500" data-parent="#threats"><div class="card-body">If an attacker has access to the password exchange method when the user resets his
                                password, he would have access to the system as this user.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading499"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse499" aria-expanded="true" aria-controls="collapse499">Weakness: A connection to an external system is performed in plain text <span>[CWE-311]</span></button></h5></div><div id="collapse499" class="collapse" aria-labelledby="heading499" data-parent="#weaknesses"><div class="card-body">Connections made in plain text are not only target for interception but, even when the component is not dealing with sensitive data, a man in the middle attack is possible and the attacker could pretend to be, i.e. an authentication system to gain the user's credentials.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading497"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse497" aria-expanded="true" aria-controls="collapse497">Countermeasure: Do not transmit password in email or other unencrypted channels <span>[ASVS-2.17]</span></button></h5></div><div id="collapse497" class="collapse" aria-labelledby="heading497" data-parent="#controls"><div class="card-body"><div>
                        Data passed between the user and application without appropriate encryption, in particular in
                        emails, may be intercepted or monitored by malicious parties.
                        </div>
                        <div>
                        <ul>
                        <li>Do not send plaintext passwords in emails or other unencrypted transport (e.g. a web
                        page server over HTTP).</li>
                        <li>Password recovery processes should not send either the old or a new password to users
                        (the former is particular bad due to the penchant for people to reuse the same password across
                        multiple systems or applications).</li>
                        <li>If the recovery process is built on sending a temporary random password to users, the
                        risk can be partly mitigated (but not eliminated) by:</li>
                        <ul>
                        <li>Ensuring the random password is single use (one time password), and forcing the user
                        to change the password on first login.</li>
                        <li>Making the password valid only for a short-time (time limited).</li>
                        <li>Requiring a further validation or identification step when the time limited one time
                        password is used.</li>
                        </ul>
                        </ul>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading498"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse498" aria-expanded="true" aria-controls="collapse498">Countermeasure: Implement Password reset email design best practices <span>[CWE-311]</span></button></h5></div><div id="collapse498" class="collapse" aria-labelledby="heading498" data-parent="#controls"><div class="card-body"><div>
                        <div>
                        The password/account recovery process must have equivalent security to the normal authentication
                        process. It should be resistant to brute-force or network monitoring attacks.
                        </div>
                        <div>
                        <ul>
                        <li>Passwords should not be sent in plain text (for example in an email), as they may be
                        intercepted or monitored.</li>
                        <li>Instead, the application should verify the user's identity, and leverage a
                        time-limited one-time password token (TOTP) from the user.</li>
                        <li>Alternatively, the application could require the user enters a soft-token (e.g. Google
                        authenticator), a mobile-push / SMS code, or previously established off-line recovery mechanism
                        (for example a list of pre-defined recovery codes).&nbsp;</li>
                        <li>It should be noted that use of a random value in an e-mail or SMS has known
                        weaknesses, and should be considered a less secure option.</li>
                        <li>When the user provides the token, the application should verify their identity (for
                        example through use of a 'secret question', or verification of recent activity or transaction
                        information).</li>
                        <li>The application should then require they choose a new password or phrase in line with
                        the chosen policy.</li>
                        </ul>
                        </div>
                        </div>
                        <div>
                        <ul>
                        </ul>
                        </div>
                        <div>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading503"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse503" aria-expanded="true" aria-controls="collapse503">Threat: Usernames and/or email addresses are enumerated through error messages <span>[CAPEC-383]</span></button></h5></div><div id="collapse503" class="collapse" aria-labelledby="heading503" data-parent="#threats"><div class="card-body">The function could reveal existing usernames or email addresses through error
                                messages.
                                Attackers could then use automated scripts to enumerate valid usernames or email
                                addresses
                                based on these errors.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading502"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse502" aria-expanded="true" aria-controls="collapse502">Weakness: Response Discrepancy Information Exposure <span>[CWE-204]</span></button></h5></div><div id="collapse502" class="collapse" aria-labelledby="heading502" data-parent="#weaknesses"><div class="card-body">The software provides different responses to incoming requests in a way that allows an actor
                        to determine system state information that is outside of that actor's control sphere.&nbsp;
                        <div>
                        &nbsp;
                        <br />This issue frequently occurs during authentication, where a difference in
                        failed-login messages could allow an attacker to determine if the username is valid or not.
                        These exposures can be inadvertent (bug) or intentional (design).
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading501"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse501" aria-expanded="true" aria-controls="collapse501">Countermeasure: Ensure application errors do not reveal user accounts <span>[AUTH-ENUM-ERR-RECOV]</span></button></h5></div><div id="collapse501" class="collapse" aria-labelledby="heading501" data-parent="#controls"><div class="card-body"><div>
                        Error messages can reveal information of use to an attacker. Explicit errors from the reset or
                        recovery process stating accounts are valid or not, or whether then are locked out are useful to
                        an attacker in enumerating usernames for subsequent attack. Even small variations in errors
                        returned to the user can be used to infer how the application operates, or enforces security
                        controls.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        To prevent a malicious user using error conditions to determine valid accounts:
                        </div>
                        <div>
                        <ul>
                        <li>Trap and log all known error conditions at the server-side</li>
                        <li>Create a generic trap for unexpected errors</li>
                        <li>The response to the password recovery feature should be the same regardless of whether
                        the username, ID or email exists. For example, a message such as 'An email with further details
                        about the recovery process has been sent; if you do not receive an email, please contact
                        support' could be sent to prevent enumeration</li>
                        <li>Ensure the error message returned to the user is generic, or contains only an
                        obfuscated reference that can be correlated with the logged errors at the server-side. &nbsp;In
                        the case of applications delivered over HTTP, the HTTP header should also be generic to prevent
                        enumeration (e.g. all error pages should produce a consistent HTTP 500 error)</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading511"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse511" aria-expanded="true" aria-controls="collapse511">Risk pattern: Password reset by answering a question <span>[PWD-RESET-SECRETQ]</span></button></h5></div><div id="collapse511" class="collapse" aria-labelledby="heading511" data-parent="#components"><div class="card-body">Password recovery or reset function<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading510"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse510" aria-expanded="true" aria-controls="collapse510">Use case: Password reset <span>[PASSWORD RESET]</span></button></h5></div><div id="collapse510" class="collapse" aria-labelledby="heading510" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading509"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse509" aria-expanded="true" aria-controls="collapse509">Threat: Attackers bypass authentication by guessing the answers to secret questions <span>[CAPEC-115-SECRETQ]</span></button></h5></div><div id="collapse509" class="collapse" aria-labelledby="heading509" data-parent="#threats"><div class="card-body">The answers to secret questions that only the user should know can often be found
                                through social networking and other online resources. For example: Date of birth,
                                mother's maiden name, first school attended, etc. They can all readily be found online.
                                <div>
                                <br />In many the attacker may not have to find the exact answer, but can simply
                                infer a reduced list of potential answers which they can use in an automated attack on
                                the system. For example, if they know the town where the user was born then they could
                                use a list of all the schools in that town to brute force the first school attended.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading508"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse508" aria-expanded="true" aria-controls="collapse508">Weakness: Authentication Bypass Issues <span>[CWE-592]</span></button></h5></div><div id="collapse508" class="collapse" aria-labelledby="heading508" data-parent="#weaknesses"><div class="card-body">The software does not properly perform authentication, allowing it to be bypassed through
                        various methods.
                        <br />
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading506"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse506" aria-expanded="true" aria-controls="collapse506">Countermeasure: Use a secure recovery token to reset an account password (such as a TOTP) <span>[CSD-PWD-OFF-CHAN]</span></button></h5></div><div id="collapse506" class="collapse" aria-labelledby="heading506" data-parent="#controls"><div class="card-body"><div>
                        The password/account recovery process must have equivalent security to the normal authentication
                        process. It should be resistant to brute-force or network monitoring attacks.
                        </div>
                        <div>
                        <ul>
                        <li>Having identified the user through secret questions/answers, the application should
                        proceed with a secure reset process.</li>
                        <li>Passwords should not be sent in plain text (for example in an email), as they may be
                        intercepted or monitored.</li>
                        <li>Instead, the application should verify the user's identity, and use a time-limited one
                        time password token (TOTP) from the user.</li>
                        <li>Alternatively, the application could require the user enters a soft-token (e.g. Google
                        authenticator), a mobile-push / SMS code, or previously established off-line recovery mechanism
                        (for example a list of pre-defined recovery codes). It should be noted that use of a random
                        value in an e-mail or SMS has known weaknesses, and should be considered a less secure option.</li>
                        <li>When the user provides the token, the application should verify their identity (for
                        example through use of a 'secret question', or verification of recent activity or transaction
                        information).</li>
                        <li>The application should then require they choose a new password or phrase in line with
                        the chosen policy.</li>
                        </ul>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading507"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse507" aria-expanded="true" aria-controls="collapse507">Countermeasure: Security questions must not violate privacy laws and processes must provide equivalent security to normal authentication <span>[CSD_PWD-REC-Q]</span></button></h5></div><div id="collapse507" class="collapse" aria-labelledby="heading507" data-parent="#controls"><div class="card-body"><div>
                        It is common for application to utilize 'security questions' as additional identity verification
                        steps in the registration, authentication, and recovery processes. While these questions provide
                        additional assurance, they should not be considered a true secret, or of equal security to the
                        user's password. Furthermore, it is important that laws and legislation around private and
                        personally identifiable information (PII) are observed, and the risk of disclosure of the
                        security questions and answers should be considered.
                        </div>
                        <div>
                        <ul>
                        <li>Ensure the security questions do not violate privacy laws (e.g. asking for a SSN or
                        Cardholder Data)</li>
                        <li>Questions and answers must be prevent from malicious recovery (e.g. enumeration or
                        brute-force attacks)</li>
                        <li>The questions, and processes in which they are used, must be strong enough to provide
                        equivalence to the main authentication process.</li>
                        <li>Processes involving the security questions must prevent an attacker with publicly
                        available (or common personal) information about the victim from accessing their account. For
                        example, date of birth, place of birth, birthdate, and mother's maiden name are common pieces of
                        security information that are not truly secret.</li>
                        <li>Consider allowing the user to define their own security questions (challenges) and
                        answers (responses) with guidance.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading518"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse518" aria-expanded="true" aria-controls="collapse518">Risk pattern: Password reset by email <span>[PWD-RESET-EMAIL]</span></button></h5></div><div id="collapse518" class="collapse" aria-labelledby="heading518" data-parent="#components"><div class="card-body">Password recovery or reset function using email<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading517"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse517" aria-expanded="true" aria-controls="collapse517">Use case: Password reset <span>[PASSWORD RESET]</span></button></h5></div><div id="collapse517" class="collapse" aria-labelledby="heading517" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading516"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse516" aria-expanded="true" aria-controls="collapse516">Threat: Password sent in email or SMS is compromised <span>[CAPEC-158-PWD-IN-EMAIL]</span></button></h5></div><div id="collapse516" class="collapse" aria-labelledby="heading516" data-parent="#threats"><div class="card-body">If the user's password is sent to them in email then attackers could perform
                                network
                                sniffing attacks if they are on the same network as the victim, for example on the
                                same WiFi
                                network. Attackers would then be able to access the users' account without the
                                user's
                                knowledge.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading513"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse513" aria-expanded="true" aria-controls="collapse513">Weakness: Authentication credentials transmitted in clear text <span>[CWE-319-PWD]</span></button></h5></div><div id="collapse513" class="collapse" aria-labelledby="heading513" data-parent="#weaknesses"><div class="card-body">The software transmits sensitive or security-critical data in cleartext in a communication
                        channel that can be sniffed by unauthorized actors.&nbsp;
                        <div>
                        &nbsp;
                        <br />Many communication channels can be &quot;sniffed&quot; by attackers during
                        data transmission. For example, network traffic can often be sniffed by any attacker who has
                        access to a network interface. This significantly lowers the difficulty of exploitation by
                        attackers
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading512"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse512" aria-expanded="true" aria-controls="collapse512">Countermeasure: Send time expired one time password/token (TOTP) in email <span>[PWD-RECOVER-OTP]</span></button></h5></div><div id="collapse512" class="collapse" aria-labelledby="heading512" data-parent="#controls"><div class="card-body"><div>
                        The password/account recovery process must have equivalent security to the normal authentication
                        process. It should be resistant to brute-force or network monitoring attacks. Reset over email
                        presents a risk of monitoring and interception, these threats can in part by mitigated through
                        the following process:
                        </div>
                        <div>
                        <ul>
                        <li>Create a unique token or password that compromises at least 128 bits of provably
                        random data.</li>
                        <li>This token should be emailed to the registered email address of the user; for example
                        in&nbsp;form of a one time password, or a unique identifier in a URL.</li>
                        <li>The token should expire after a short period of time (long enough for the user to
                        receive and process the email - 15 minutes at most and preferably less).</li>
                        <li>When the user provides the token, the application should verify their identity (for
                        example through use of a 'secret question', or verification of recent activity or transaction
                        information).</li>
                        <li>The password or token must be single use; the user must be required to choose a new
                        password and the token should be immediately invalidated.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading515"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse515" aria-expanded="true" aria-controls="collapse515">Weakness: The application uses a weak credential recovery method for email access <span>[CS-EMAIL-COMP]</span></button></h5></div><div id="collapse515" class="collapse" aria-labelledby="heading515" data-parent="#weaknesses"><div class="card-body">Using weak credential recovery methods (like sending an SMS or transmitting the new password
                        over insecure channels, more generally), this fact can be used to compromise the access to an
                        email account.&nbsp;
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading514"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse514" aria-expanded="true" aria-controls="collapse514">Countermeasure: Use a secure recovery token to reset an account password (such as a TOTP) <span>[CSD-PWD-OFF-CHAN]</span></button></h5></div><div id="collapse514" class="collapse" aria-labelledby="heading514" data-parent="#controls"><div class="card-body"><div>
                        The password/account recovery process must have equivalent security to the normal authentication
                        process. It should be resistant to brute-force or network monitoring attacks.
                        </div>
                        <div>
                        <ul>
                        <li>Having identified the user through secret questions/answers, the application should
                        proceed with a secure reset process.</li>
                        <li>Passwords should not be sent in plain text (for example in an email), as they may be
                        intercepted or monitored.</li>
                        <li>Instead, the application should verify the user's identity, and use a time-limited one
                        time password token (TOTP) from the user.</li>
                        <li>Alternatively, the application could require the user enters a soft-token (e.g. Google
                        authenticator), a mobile-push / SMS code, or previously established off-line recovery mechanism
                        (for example a list of pre-defined recovery codes). It should be noted that use of a random
                        value in an e-mail or SMS has known weaknesses, and should be considered a less secure option.</li>
                        <li>When the user provides the token, the application should verify their identity (for
                        example through use of a 'secret question', or verification of recent activity or transaction
                        information).</li>
                        <li>The application should then require they choose a new password or phrase in line with
                        the chosen policy.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading523"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse523" aria-expanded="true" aria-controls="collapse523">Risk pattern: Password reset by sending the user a OTP <span>[PWD-RESET-TOKEN]</span></button></h5></div><div id="collapse523" class="collapse" aria-labelledby="heading523" data-parent="#components"><div class="card-body">Password recovery or reset function using a token<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading522"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse522" aria-expanded="true" aria-controls="collapse522">Use case: Password reset <span>[PASSWORD RESET]</span></button></h5></div><div id="collapse522" class="collapse" aria-labelledby="heading522" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading521"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse521" aria-expanded="true" aria-controls="collapse521">Threat: One-Time Password (OTP) sent in email or SMS is compromised <span>[CAPEC-158-PWD-IN-EMAIL]</span></button></h5></div><div id="collapse521" class="collapse" aria-labelledby="heading521" data-parent="#threats"><div class="card-body">If the user's password is sent to them in email then attackers could perform
                                network
                                sniffing attacks if they are on the same network as the victim, for example on the
                                same WiFi
                                network. Attackers would then be able to access the users' account without the
                                user's
                                knowledge.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading520"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse520" aria-expanded="true" aria-controls="collapse520">Weakness: The application uses a weak credential recovery method for email access <span>[CS-EMAIL-COMP]</span></button></h5></div><div id="collapse520" class="collapse" aria-labelledby="heading520" data-parent="#weaknesses"><div class="card-body">Using weak credential recovery methods (like sending an SMS or transmitting the new password
                        over insecure channels, more generally), this fact can be used to compromise the access to an
                        email account.&nbsp;
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading519"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse519" aria-expanded="true" aria-controls="collapse519">Countermeasure: Use a secure recovery token to reset an account password (such as a TOTP) <span>[CSD-PWD-OFF-CHAN]</span></button></h5></div><div id="collapse519" class="collapse" aria-labelledby="heading519" data-parent="#controls"><div class="card-body"><div>
                        The password/account recovery process must have equivalent security to the normal authentication
                        process. It should be resistant to brute-force or network monitoring attacks.
                        </div>
                        <div>
                        <ul>
                        <li>Having identified the user through secret questions/answers, the application should
                        proceed with a secure reset process.</li>
                        <li>Passwords should not be sent in plain text (for example in an email), as they may be
                        intercepted or monitored.</li>
                        <li>Instead, the application should verify the user's identity, and use a time-limited one
                        time password token (TOTP) from the user.</li>
                        <li>Alternatively, the application could require the user enters a soft-token (e.g. Google
                        authenticator), a mobile-push / SMS code, or previously established off-line recovery mechanism
                        (for example a list of pre-defined recovery codes). It should be noted that use of a random
                        value in an e-mail or SMS has known weaknesses, and should be considered a less secure option.</li>
                        <li>When the user provides the token, the application should verify their identity (for
                        example through use of a 'secret question', or verification of recent activity or transaction
                        information).</li>
                        <li>The application should then require they choose a new password or phrase in line with
                        the chosen policy.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading524"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse524" aria-expanded="true" aria-controls="collapse524">Risk pattern: PHP Server <span>[SERVER:PHP]</span></button></h5></div><div id="collapse524" class="collapse" aria-labelledby="heading524" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading525"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse525" aria-expanded="true" aria-controls="collapse525">Risk pattern: Python Server <span>[SERVER:PYTHON]</span></button></h5></div><div id="collapse525" class="collapse" aria-labelledby="heading525" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading526"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse526" aria-expanded="true" aria-controls="collapse526">Risk pattern: Ruby Server <span>[SERVER:RUBY]</span></button></h5></div><div id="collapse526" class="collapse" aria-labelledby="heading526" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading538"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse538" aria-expanded="true" aria-controls="collapse538">Risk pattern: Secrets Management <span>[SECRETS-MANAGEMENT]</span></button></h5></div><div id="collapse538" class="collapse" aria-labelledby="heading538" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading537"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse537" aria-expanded="true" aria-controls="collapse537">Use case: Store sensitive data <span>[STORE-SENSITIVE-DATA]</span></button></h5></div><div id="collapse537" class="collapse" aria-labelledby="heading537" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading529"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse529" aria-expanded="true" aria-controls="collapse529">Threat: An attacker obtains an authoritative or reputable signer's private signature key by theft  <span>[CAPEC-474]</span></button></h5></div><div id="collapse529" class="collapse" aria-labelledby="heading529" data-parent="#threats"><div class="card-body">An attacker obtains an authoritative or reputable signer's private signature key by
                                theft and then uses this key to forge signatures from the original signer to mislead a
                                victim into performing actions that benefit the attacker.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading528"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse528" aria-expanded="true" aria-controls="collapse528">Weakness: Key Management Errors <span>[CWE-320]</span></button></h5></div><div id="collapse528" class="collapse" aria-labelledby="heading528" data-parent="#weaknesses"><div class="card-body">Weaknesses in this category are related to errors in the
                        management of cryptographic keys.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading527"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse527" aria-expanded="true" aria-controls="collapse527">Countermeasure: Isolate cryptographic processes - including master secrets - and consider the use of a virtualized or physical hardware key vaults (HSM). <span>[CSD-KEY-MGMT]</span></button></h5></div><div id="collapse527" class="collapse" aria-labelledby="heading527" data-parent="#controls"><div class="card-body"><div>
                        Cryptographic processes require the use of a private key or a secret. If this information lives
                        with the component, a compromise of the system could lead to this private key or secret being
                        stolen. This would give the attacker access to all information.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        The way to prevent this is to keep the cryptographic functionalities on a separate service that
                        perform the encryption/decryption on demand. It is better if this service uses virtualized or
                        physical hardware key vaults like a Hardware Security Module because those devices store the
                        private key and secrets securely.&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        They often allow a key or secret generation process and implement security measures to prevent
                        this information being extracted from them.&nbsp;
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading536"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse536" aria-expanded="true" aria-controls="collapse536">Threat: An attacker obtains an authoritative signer's private signature key by exploiting a cryptographic weaknesses <span>[CAPEC-485]</span></button></h5></div><div id="collapse536" class="collapse" aria-labelledby="heading536" data-parent="#threats"><div class="card-body">An attacker obtains an authoritative or reputable signer's private signature key by
                                exploiting a cryptographic weakness in the signature algorithm or pseudorandom number
                                generation and then uses this key to forge signatures from the original signer to
                                mislead a victim into performing actions which benefit the attacker.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading531"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse531" aria-expanded="true" aria-controls="collapse531">Weakness: Protection Mechanism Failure <span>[CWE-693]</span></button></h5></div><div id="collapse531" class="collapse" aria-labelledby="heading531" data-parent="#weaknesses"><div class="card-body">The product does not use or incorrectly uses a protection
                        mechanism that provides sufficient defense against directed attacks against the
                        product.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading530"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse530" aria-expanded="true" aria-controls="collapse530">Countermeasure: Verify that all cryptographic modules fail securely, and errors are handled in a way that does not enable oracle padding. <span>[ASVS-7.2]</span></button></h5></div><div id="collapse530" class="collapse" aria-labelledby="heading530" data-parent="#controls"><div class="card-body"><div>
                        Encryption should fail closed so that data does not get stored in an unprotected state.
                        <br />
                        </div>
                        <div>
                        To protect against padding oracles, you want to make sure that your application does not return
                        a different error when the padding is wrong. The best way to do this is an Encrypt-then-MAC
                        construction, where a Message Authentication Code (MAC) is applied to the ciphertext. If the MAC
                        fails, you don't even need to look at the padding. If the MAC is correct, it is
                        cryptographically unlikely that the padding has been tampered with.
                        <br />
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading533"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse533" aria-expanded="true" aria-controls="collapse533">Weakness: Use of Insufficiently Random Values <span>[CWE-330]</span></button></h5></div><div id="collapse533" class="collapse" aria-labelledby="heading533" data-parent="#weaknesses"><div class="card-body">The software may use insufficiently random numbers or values in
                        a security context that depends on unpredictable numbers.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading532"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse532" aria-expanded="true" aria-controls="collapse532">Countermeasure: Use a cryptographically secure pseudo-random number generator <span>[CWE-330]</span></button></h5></div><div id="collapse532" class="collapse" aria-labelledby="heading532" data-parent="#controls"><div class="card-body"><div>
  Use a well-vetted algorithm that is currently considered to be strong and secure by experts in the field and ensure well-tested implementation with adequate length seeds. In general, if a pseudo-random number generator is not advertised as being cryptographically secure, then it is probably a statistical PRNG and should not be used in a security-sensitive context.&nbsp; 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Pseudo-random number generators can produce predictable numbers if the generator is known and the seed can be guessed. A 256-bit seed is a good starting point for producing a &quot;random enough&quot; number. 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div>
  Ensure that all random numbers, especially those used for cryptographic parameters (keys, IV’s, MAC tags), random file names, random GUIDs, and random strings are generated in a cryptographically strong fashion. 
 <br /> 
 <br />Ensure that random algorithms are seeded with sufficient entropy. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Use a secure pseudo-random number generator ensuring it leverages an appropriate length seed. The recommendation by FIPS 140-2 is 256-bit seed. 
</div> 
<div> 
 <br />Tools like NIST RNG Test tool (as used in PCI PTS Derived Test Requirements) can be used to comprehensively assess the quality of a Random Number Generator by reading e.g. 128MB of data from the RNG source and then assessing its randomness properties with the tool. 
 <br /> 
 <br />The following libraries are considered weak random numbers generators and should not be used. 
 <br /> 
</div> 
<div> 
 <br /> 
</div> 
<ul> 
 <li>C library: random(), rand() instead use getrandom(2) instead</li> 
 <li>Java library: java.util.Random() instead use java.security.SecureRandom instead</li> 
</ul> 
<br />For secure random number generation, refer to NIST SP 800-90A. CTR-DRBG, HASH-DRBG, HMAC-DRBG are recommended. Refer to NIST SP800-22 A Statistical Test Suite for Random and Pseudorandom Number Generators for Cryptographic Applications, and the testing toolkit.</div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading535"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse535" aria-expanded="true" aria-controls="collapse535">Weakness: Use of a Broken or Risky Cryptographic Algorithm <span>[CWE-327]</span></button></h5></div><div id="collapse535" class="collapse" aria-labelledby="heading535" data-parent="#weaknesses"><div class="card-body">The use of a broken or risky cryptographic algorithm is an
                        unnecessary risk that may result in the exposure of sensitive
                        information.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading534"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse534" aria-expanded="true" aria-controls="collapse534">Countermeasure: Ensure that only strong algorithms, cyphers and protocols are used <span>[STRONG-ALGORITHMS-PROTOCOLS]</span></button></h5></div><div id="collapse534" class="collapse" aria-labelledby="heading534" data-parent="#controls"><div class="card-body"><div>
  Ensure that the application is using strong algorithms, cyphers and protocols. The general practice and required minimum key lengths depend on the scenarios listed below. 
</div> 
<div> 
 <ul> 
  <li>Key exchange: Diffie-Hellman key exchange with minimum 2048 bits</li> 
  <li>Message Integrity: HMAC-SHA2</li> 
  <li>Message Hash: SHA2 256 bits</li> 
  <li>Asymmetric encryption: RSA 2048 bits</li> 
  <li>Symmetric-key algorithm: AES 128 bits</li> 
  <li>Password Hashing: Argon2, PBKDF2, Scrypt, Bcrypt.</li> 
 </ul> 
</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading545"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse545" aria-expanded="true" aria-controls="collapse545">Risk pattern: Self registration of users <span>[USER-REG:SELF]</span></button></h5></div><div id="collapse545" class="collapse" aria-labelledby="heading545" data-parent="#components"><div class="card-body">Server side registration functions<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading544"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse544" aria-expanded="true" aria-controls="collapse544">Use case: User registration <span>[USER REGISTRATION]</span></button></h5></div><div id="collapse544" class="collapse" aria-labelledby="heading544" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading543"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse543" aria-expanded="true" aria-controls="collapse543">Threat: Usernames and/or email addresses are enumerated through error messages <span>[CAPEC-383-USERNAME-REG]</span></button></h5></div><div id="collapse543" class="collapse" aria-labelledby="heading543" data-parent="#threats"><div class="card-body">The registration function could reveal existing usernames or email addresses
                                through error
                                messages if users sign up and choose a username of an existing user. Attackers could
                                use
                                automated scripts to enumerate valid usernames or email addresses based on these
                                error
                                messages.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading540"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse540" aria-expanded="true" aria-controls="collapse540">Weakness: Improper Control of Interaction Frequency <span>[CWE-799]</span></button></h5></div><div id="collapse540" class="collapse" aria-labelledby="heading540" data-parent="#weaknesses"><div class="card-body">The software does not properly limit the number or frequency of interactions that it has with
                        an actor, such as the number of incoming requests.&nbsp;
                        <div>
                        &nbsp;
                        <br />This can allow the actor to perform actions more frequently than expected. The actor
                        could be a human or an automated process such as a virus or bot. This could be used to cause a
                        denial of service, compromise program logic (such as limiting humans to a single vote), or other
                        consequences. For example, an authentication routine might not limit the number of times an
                        attacker can guess a password. Or, a web site might conduct a poll but only expect humans to
                        vote a maximum of once a day.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading539"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse539" aria-expanded="true" aria-controls="collapse539">Countermeasure: Implement application and network rate limiting <span>[CWE-799]</span></button></h5></div><div id="collapse539" class="collapse" aria-labelledby="heading539" data-parent="#controls"><div class="card-body"><p>A number of attacks rely on brute-force techniques to send large volumes of requests to enumerate or attempt to exploit flaws in an application, for example, sending common passwords to multiple target accounts within an application. By profiling normal traffic volumes, and applying rate limiting, the application can be built to actively mitigate such attacks.</p> 
<p></p> 
<ul> 
 <li>Connection rate-limiting based on the source IP address can be used to restrict attacks against the authentication or registration systems. Multiple failures (or attempts) from a single IP should result in temporarily blocking or dropping traffic from the source. Note however that some corporate and <span class="caps">ISP</span> environment may place multiple valid and discrete clients behind the same IP address, resulting in false-positives.&nbsp;</li> 
 <li>Attackers may use botnets and other IP masking techniques to deliver attacks from multiple sources to avoid IP based rate-limiting. To mitigate this class of attack, Indicators of Compromise should be monitored (for example a higher rate of login failures than usual), and appropriate actions taken. For example, when the application detects active brute-force attacks, a Web Application Firewall (<span class="caps">WAF</span>) or other intermediate devices could be used to block attacks sharing a signature from pattern matching or deep packet inspection (e.g. <span class="caps">HTTP</span> headers or common passwords across multiple accounts). Similarly, the application could respond by requiring a <span class="caps">CAPTCHA</span>, cookie, or Javascript challenge when an attack is detected.</li> 
</ul> 
<p></p> 
<b><font size="4"> Remediation:</font></b> 
<div> 
 <b><font size="4"></font></b>Implement the mechanisms to lockout accounts:&nbsp; 
</div> 
<div> 
 <ul> 
  <li>When the application detects a set number of failure login attempts, the account shall be locked for a certain time period.&nbsp;</li> 
  <li>When the application detects that an account is locked more times than usual, this account shall be disabled. A disabled account shall only be restored by an administrator.&nbsp;</li> 
  <li>When the application detects active brute-force attacks, the application shall require a <span class="caps">CAPTCHA</span>, cookie, or JavaScript challenge.</li> 
 </ul> 
</div></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading542"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse542" aria-expanded="true" aria-controls="collapse542">Weakness: Information Exposure Through an Error Message <span>[CWE-209]</span></button></h5></div><div id="collapse542" class="collapse" aria-labelledby="heading542" data-parent="#weaknesses"><div class="card-body">The software generates an error message that includes sensitive information about its
                        environment, users, or associated data.&nbsp;
                        <div>
                        &nbsp;
                        <br />The sensitive information may be valuable information on its own (such as a
                        password), or it may be useful for launching other, more deadly attacks. If an attack fails, an
                        attacker may use error information provided by the server to launch another more focused attack.
                        For example, an attempt to exploit a path traversal weakness (CWE-22) might yield the full
                        pathname of the installed application. In turn, this could be used to select the proper number
                        of &quot;..&quot; sequences to navigate to the targeted file. An attack using SQL
                        injection (CWE-89) might not initially succeed, but an error message could reveal the malformed
                        query, which would expose query logic and possibly even passwords or other sensitive information
                        used within the query.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading541"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse541" aria-expanded="true" aria-controls="collapse541">Countermeasure: Prevent username and email enumeration in the registration process <span>[CWE-209-USERNAME-REG]</span></button></h5></div><div id="collapse541" class="collapse" aria-labelledby="heading541" data-parent="#controls"><div class="card-body"><div>
                        Enumeration of usernames and/or email addresses within an application is a common attack, aiding
                        in conducting brute-force attacks against users, and with potential privacy issues where the
                        username is considered to be personally identifiable information (PII).
                        </div>
                        <div>
                        <ul>
                        <li>Messages returned to the user during the registration process should not reveal any
                        information about existing users of the system. For example, if a user attempts to register with
                        an email address that is already associated with a user, the application should not reveal this
                        to them.</li>
                        <li>To protect privacy and prevent user enumeration, the application should always respond
                        with the same message indicating an email has been sent to the user's address regardless of the
                        status of that email address or username, and direct them to follow the instructions therein to
                        complete the process.</li>
                        <li>Where the username or email address is already in use, the email can advise the user
                        of the recovery process.</li>
                        <li>Where the username and email are unique and new, the email can contain a link to
                        complete the process.</li>
                        </ul>
                        <div>
                        The prevents an attacker without access to the victim's email address from enumerating whether
                        they are registered in the application.
                        </div>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading553"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse553" aria-expanded="true" aria-controls="collapse553">Risk pattern: Sensitive Data: Storage by a service <span>[SERVICE:SENS-DATA:STORAGE]</span></button></h5></div><div id="collapse553" class="collapse" aria-labelledby="heading553" data-parent="#components"><div class="card-body">Storage of sensitive data on a service<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading552"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse552" aria-expanded="true" aria-controls="collapse552">Use case: Store sensitive data <span>[STORE SENSITIVE DATA]</span></button></h5></div><div id="collapse552" class="collapse" aria-labelledby="heading552" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading548"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse548" aria-expanded="true" aria-controls="collapse548">Threat: Sensitive data is compromised if a backup of the data is compromised <span>[BACKUP-COMPROMISE]</span></button></h5></div><div id="collapse548" class="collapse" aria-labelledby="heading548" data-parent="#threats"><div class="card-body">Sensitive data could be compromised if an attacker gained access to a backup copy of
                                that data.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading547"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse547" aria-expanded="true" aria-controls="collapse547">Weakness: A connection to an external system is performed in plain text <span>[CWE-311]</span></button></h5></div><div id="collapse547" class="collapse" aria-labelledby="heading547" data-parent="#weaknesses"><div class="card-body">Connections made in plain text are not only target for interception but, even when the component is not dealing with sensitive data, a man in the middle attack is possible and the attacker could pretend to be, i.e. an authentication system to gain the user's credentials.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading546"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse546" aria-expanded="true" aria-controls="collapse546">Countermeasure: Encrypt data stored on the host (data at rest) <span>[CWE-311-AT-REST]</span></button></h5></div><div id="collapse546" class="collapse" aria-labelledby="heading546" data-parent="#controls"><div class="card-body"><div> 
 <div>
   Data stored on the server or the client must be protected by encryption (data 
  <i>at rest</i>). 
 </div> 
 <div> 
  <ul> 
   <li>Cryptographically strong symmetric or asymmetric (public-key) encryption&nbsp;should be used to protect the data.</li> 
   <li>Encryption should be performed before the data is written to disk or other persistent storage.</li> 
   <li>The key for encrypting and decrypting the data should <i>not</i> be accessible from the same host.&nbsp;</li> 
   <li>The encryption and decryption operation should be performed on a different host.</li> 
   <li>A recognized, proven, and tested implementation/library should be used (in preference to a bespoke implementation).</li> 
  </ul> 
 </div> 
</div> 
<div> 
</div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading551"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse551" aria-expanded="true" aria-controls="collapse551">Threat: Sensitive data is compromised if the host itself is compromised <span>[HOST-COMPROMISE]</span></button></h5></div><div id="collapse551" class="collapse" aria-labelledby="heading551" data-parent="#threats"><div class="card-body">If sensitive data is stored or processed on the host, then should the host itself be
                                compromised by an attacker, the confidentiality and/or the integrity of the data would
                                also be at risk.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading550"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse550" aria-expanded="true" aria-controls="collapse550">Weakness: A connection to an external system is performed in plain text <span>[CWE-311]</span></button></h5></div><div id="collapse550" class="collapse" aria-labelledby="heading550" data-parent="#weaknesses"><div class="card-body">Connections made in plain text are not only target for interception but, even when the component is not dealing with sensitive data, a man in the middle attack is possible and the attacker could pretend to be, i.e. an authentication system to gain the user's credentials.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading549"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse549" aria-expanded="true" aria-controls="collapse549">Countermeasure: Encrypt data stored on the host (data at rest) <span>[CWE-311-AT-REST]</span></button></h5></div><div id="collapse549" class="collapse" aria-labelledby="heading549" data-parent="#controls"><div class="card-body"><div> 
 <div>
   Data stored on the server or the client must be protected by encryption (data 
  <i>at rest</i>). 
 </div> 
 <div> 
  <ul> 
   <li>Cryptographically strong symmetric or asymmetric (public-key) encryption&nbsp;should be used to protect the data.</li> 
   <li>Encryption should be performed before the data is written to disk or other persistent storage.</li> 
   <li>The key for encrypting and decrypting the data should <i>not</i> be accessible from the same host.&nbsp;</li> 
   <li>The encryption and decryption operation should be performed on a different host.</li> 
   <li>A recognized, proven, and tested implementation/library should be used (in preference to a bespoke implementation).</li> 
  </ul> 
 </div> 
</div> 
<div> 
</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading563"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse563" aria-expanded="true" aria-controls="collapse563">Risk pattern: Sensitive Data: Transport <span>[SENS-DATA:TRANSPORT]</span></button></h5></div><div id="collapse563" class="collapse" aria-labelledby="heading563" data-parent="#components"><div class="card-body">Transport sensitive data between client and server<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading562"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse562" aria-expanded="true" aria-controls="collapse562">Use case: Access sensitive data <span>[ACCESS SENSITIVE DATA]</span></button></h5></div><div id="collapse562" class="collapse" aria-labelledby="heading562" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading558"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse558" aria-expanded="true" aria-controls="collapse558">Threat: Sensitive data is compromised through network sniffing attacks <span>[CAPEC-158]</span></button></h5></div><div id="collapse558" class="collapse" aria-labelledby="heading558" data-parent="#threats"><div class="card-body">An attacker monitoring network traffic between nodes of a public or multicast network.&nbsp;
                                <div>
                                <ul>
                                <li>The attacker need not be able to prevent reception or change content but must
                                simply be able to observe and read the traffic.&nbsp;</li>
                                <li>The attacker might precipitate or indirectly influence the content of the
                                observed transaction, but the attacker is never the intended recipient of the
                                information.&nbsp;</li>
                                </ul>
                                </div>
                                <div>
                                This differs from other sniffing attacks in that it is over a public network rather via
                                some other communications channel, such as radio.
                                <br />
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading555"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse555" aria-expanded="true" aria-controls="collapse555">Weakness: Cleartext Transmission of Sensitive Information <span>[CWE-319]</span></button></h5></div><div id="collapse555" class="collapse" aria-labelledby="heading555" data-parent="#weaknesses"><div class="card-body">The software transmits sensitive or security-critical data in cleartext in a communication channel that can be sniffed by unauthorized actors.

Many communication channels can be "sniffed" by attackers during data transmission. For example, network traffic can often be sniffed by any attacker who has access to a network interface. This significantly lowers the difficulty of exploitation by attackers.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading554"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse554" aria-expanded="true" aria-controls="collapse554">Countermeasure: Encrypt data between the client and server/service <span>[CWE-319-TRANSPORT]</span></button></h5></div><div id="collapse554" class="collapse" aria-labelledby="heading554" data-parent="#controls"><div class="card-body"><div>
  Data passed between the client and server should be protected by encryption in transit. 
</div> 
<div> 
 <ul> 
  <li>Implement cryptographically strong TLS end-to-end encryption between the client and server, terminating within a secure environment on the server-side.</li> 
  <li>Consider use of client certificates to prevent interception of (or man-in-the-middle attacks on) the encrypted connection.</li> 
  <li>Alternatively, asymmetric (public-key) encryption could be utilized, although a recognized, proven, and tested implementation/library should be used</li> 
 </ul> 
</div></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading557"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse557" aria-expanded="true" aria-controls="collapse557">Weakness: Use of a Broken or Risky Cryptographic Algorithm <span>[CWE-327]</span></button></h5></div><div id="collapse557" class="collapse" aria-labelledby="heading557" data-parent="#weaknesses"><div class="card-body">The use of a broken or risky cryptographic algorithm is an
                        unnecessary risk that may result in the exposure of sensitive
                        information.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading556"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse556" aria-expanded="true" aria-controls="collapse556">Countermeasure: Ensure that only strong algorithms, cyphers and protocols are used <span>[STRONG-ALGORITHMS-PROTOCOLS]</span></button></h5></div><div id="collapse556" class="collapse" aria-labelledby="heading556" data-parent="#controls"><div class="card-body"><div>
  Ensure that the application is using strong algorithms, cyphers and protocols. The general practice and required minimum key lengths depend on the scenarios listed below. 
</div> 
<div> 
 <ul> 
  <li>Key exchange: Diffie-Hellman key exchange with minimum 2048 bits</li> 
  <li>Message Integrity: HMAC-SHA2</li> 
  <li>Message Hash: SHA2 256 bits</li> 
  <li>Asymmetric encryption: RSA 2048 bits</li> 
  <li>Symmetric-key algorithm: AES 128 bits</li> 
  <li>Password Hashing: Argon2, PBKDF2, Scrypt, Bcrypt.</li> 
 </ul> 
</div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading561"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse561" aria-expanded="true" aria-controls="collapse561">Threat: Sensitive data is exposed to unauthorised personnel in a pre-production environment <span>[PRE-PROD]</span></button></h5></div><div id="collapse561" class="collapse" aria-labelledby="heading561" data-parent="#threats"><div class="card-body">Pre-production environments are usually available to a wide group of developers and
                                testers who may not be authorized to view sensitive production data.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading560"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse560" aria-expanded="true" aria-controls="collapse560">Weakness: Production data used in pre-production system <span>[CWE-485-PREPROD]</span></button></h5></div><div id="collapse560" class="collapse" aria-labelledby="heading560" data-parent="#weaknesses"><div class="card-body">Production data used in pre-production system might not be properly protected as applications
                        in pre-production are not usually well tested. pre-production environments usually lack from the
                        strong Countermeasures that are set for production environments. &nbsp;
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading559"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse559" aria-expanded="true" aria-controls="collapse559">Countermeasure: Ensure personal and other sensitive data is not exposed in pre-production environments <span>[CWE-485-PREPROD]</span></button></h5></div><div id="collapse559" class="collapse" aria-labelledby="heading559" data-parent="#controls"><div class="card-body"><div>
                        Pre-production environments should not expose personally identifiable information (PII) or other
                        sensitive information. Often, such environments are populated with production data for testing
                        or other purposes. &nbsp;Security weaknesses, either in the software or controls around
                        access to pre-prod systems, can unnecessarily expose sensitive data. This is often a breach of
                        legal and commercial requirements, including various governmental data protection and privacy
                        acts, and industry regulations such as those required by the Payments Card Industry (PCI).
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        Where test data is derived from production data, the following must be observed:
                        </div>
                        <div>
                        <ol>
                        <li>Data masking or obfuscation techniques must be used to anonymize the data used in
                        pre-production. &nbsp;For example, all but the start and end of a credit card number must be
                        removed/replaced</li>
                        <li>No real personally identifiable information (PII) or other sensitive data should be
                        present in Pre-prod. &nbsp;For example, names, dates of birth, and other personal
                        information must be removed, randomized, or replaced.</li>
                        <li>Only data that has been processed and anonymized should be transferred into pre-prod;
                        ideally representative test data should be generated rather than relying even on obfuscated
                        production data.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading571"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse571" aria-expanded="true" aria-controls="collapse571">Risk pattern: Sensitive Data: Transport HTTPS <span>[sensitive-data-transport-https]</span></button></h5></div><div id="collapse571" class="collapse" aria-labelledby="heading571" data-parent="#components"><div class="card-body">HTTPS services accessed with a browser.<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading570"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse570" aria-expanded="true" aria-controls="collapse570">Use case: Access sensitive data <span>[access-sensitive-data]</span></button></h5></div><div id="collapse570" class="collapse" aria-labelledby="heading570" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading569"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse569" aria-expanded="true" aria-controls="collapse569">Threat: User data or credentials are compromised through network sniffing or man in the middle attacks <span>[CAPEC-158-SESSION]</span></button></h5></div><div id="collapse569" class="collapse" aria-labelledby="heading569" data-parent="#threats"><div class="card-body">An attacker with access to the network path between the victim and the server could
                                employ a sniffer to sniff clear text traffic on the network. If the session ID is
                                transmitted in clear text, then the attacker could compromise it and thereby gain access
                                to the user's session.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading568"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse568" aria-expanded="true" aria-controls="collapse568">Weakness: Cleartext Transmission of Sensitive Information <span>[CWE-319]</span></button></h5></div><div id="collapse568" class="collapse" aria-labelledby="heading568" data-parent="#weaknesses"><div class="card-body">The software transmits sensitive or security-critical data in cleartext in a communication channel that can be sniffed by unauthorized actors.

Many communication channels can be "sniffed" by attackers during data transmission. For example, network traffic can often be sniffed by any attacker who has access to a network interface. This significantly lowers the difficulty of exploitation by attackers.  <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading564"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse564" aria-expanded="true" aria-controls="collapse564">Countermeasure: Consider HTTP Public Key Pinning (HPKP) <span>[CWE-295]</span></button></h5></div><div id="collapse564" class="collapse" aria-labelledby="heading564" data-parent="#controls"><div class="card-body"><div>
                        HPKP is a Trust on First Use (TOFU) technique. The first time a web server tells a client via a
                        special HTTP header which public keys belong to it, the client stores this information for a
                        given period of time. When the client visits the server again, it expects at least one
                        certificate in the certificate chain to contain a public key whose fingerprint is already known
                        via HPKP. If the server delivers an unknown public key, the client should present a warning to
                        the user.&nbsp;
                        </div>
                        <div>
                        <ul>
                        <li>Verify that TLS certificate public key pinning (HPKP) is implemented with production
                        and backup public keys. For more information, please see the references below.&nbsp;</li>
                        <li>To ensure the authenticity of a server's public key used in TLS sessions, this public
                        key is wrapped into a X.509 certificate which is usually signed by a certificate authority (CA).
                        Web clients such as browsers trust a lot of these CAs, which can all create certificates for
                        arbitrary domain names. If an attacker is able to compromise a single CA, they can perform MITM
                        attacks on various TLS connections. HPKP can circumvent this threat for the HTTPS protocol by
                        telling the client which public key belongs to a certain web server.&nbsp;</li>
                        </ul>
                        <div>
                        There are risks associated with HPKP, in particular HPKP Suicide and Ransom.
                        </div>
                        </div>
                        <div>
                        <ul>
                        <li>Ensure certificate recovery processes are in place.</li>
                        <li>Review expiration and revocation criteria for the certificates.</li>
                        <li>Consider the risks associated with domain hijack and HPKP ransom.</li>
                        </ul>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading565"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse565" aria-expanded="true" aria-controls="collapse565">Countermeasure: Encrypt data between the client and server/service <span>[CWE-319-TRANSPORT]</span></button></h5></div><div id="collapse565" class="collapse" aria-labelledby="heading565" data-parent="#controls"><div class="card-body"><div>
  Data passed between the client and server should be protected by encryption in transit. 
</div> 
<div> 
 <ul> 
  <li>Implement cryptographically strong TLS end-to-end encryption between the client and server, terminating within a secure environment on the server-side.</li> 
  <li>Consider use of client certificates to prevent interception of (or man-in-the-middle attacks on) the encrypted connection.</li> 
  <li>Alternatively, asymmetric (public-key) encryption could be utilized, although a recognized, proven, and tested implementation/library should be used</li> 
 </ul> 
</div></div></div></div><div class="card border-success"><div class="card-header " id="heading566"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse566" aria-expanded="true" aria-controls="collapse566">Countermeasure: Set the HTTP security header 'Strict-Transport-Security' (HSTS) <span>[CWE-693-STRICT-TRANSPORT-SECURITY]</span></button></h5></div><div id="collapse566" class="collapse" aria-labelledby="heading566" data-parent="#controls"><div class="card-body"><div>
                        Modern browsers support the Strict-Transport-Security HTTP header. This header instructs the
                        browser to only communication over HTTPS for all subsequent requests to the domain, mitigating a
                        number of attacks designed to force users to switch to unencrypted transport to expose data.
                        </div>
                        <div>
                        <ul>
                        <li>Set the Strict-Transport-Security HTTP header in all server-responses.</li>
                        </ul>
                        </div>
                        <ul>
                        </ul>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading567"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse567" aria-expanded="true" aria-controls="collapse567">Countermeasure: Preload application URLs to vendor Strict Transport Security domain lists <span>[HSTS-PRELOAD]</span></button></h5></div><div id="collapse567" class="collapse" aria-labelledby="heading567" data-parent="#controls"><div class="card-body"><div>
                        Browser vendors supporting the&nbsp;Strict-Transport-Security HTTP header maintain&nbsp;Strict
                        Transport Security domain lists. HSTS users a the 'Trust On First Use' model, meaning an
                        attacker has a window of opportunity to subvert users of a protected site before they receive
                        the initial HSTS response. This list is preloaded into browsers, mitigating the window of
                        opportunity.
                        </div>
                        <div>
                        <ul>
                        <li>Add HTTP Strict Transport Security (HSTS) for all the requests and all the subdomains</li>
                        <li>Preload the URLs of the applications to the Strict Transport Security domain lists
                        maintained by participating vendors</li>
                        <li>Encourage users to access the site with patched versions of the participating vendors.</li>
                        <li>Consider creating and pre-loading subdomains for critical applications prior to
                        release to gain maximum advantage from HSTS pre-loading.</li>
                        </ul>
                        </div>
                        <div>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading583"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse583" aria-expanded="true" aria-controls="collapse583">Risk pattern: Sensitive Data: Transport using SSL/TLS <span>[SENS-DATA:TRANSPORT:TLS]</span></button></h5></div><div id="collapse583" class="collapse" aria-labelledby="heading583" data-parent="#components"><div class="card-body">Transport sensitive data between client and server using SSL/TLS<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading582"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse582" aria-expanded="true" aria-controls="collapse582">Use case: Access sensitive data <span>[ACCESS SENSITIVE DATA]</span></button></h5></div><div id="collapse582" class="collapse" aria-labelledby="heading582" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading578"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse578" aria-expanded="true" aria-controls="collapse578">Threat: Sensitive data is compromised though attacks against SSL/TLS <span>[CAPEC-217]</span></button></h5></div><div id="collapse578" class="collapse" aria-labelledby="heading578" data-parent="#threats"><div class="card-body">Attackers could gain access to sensitive data in transit over an SSL connection by
                                exploiting weaknesses in the SSL configuration. The use of cryptographically weak
                                protocols and/or ciphers could be used to decrypt or otherwise gain access to the
                                encrypted data.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading573"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse573" aria-expanded="true" aria-controls="collapse573">Weakness: Padding Oracle On Downgraded Legacy Encryption (POODLE) <span>[CWE-327-POODLE]</span></button></h5></div><div id="collapse573" class="collapse" aria-labelledby="heading573" data-parent="#weaknesses"><div class="card-body">SSL 3.0 [RFC6101] is an obsolete and insecure protocol. While for most practical purposes it
                        has been replaced by its successors TLS 1.0 [RFC2246], TLS 1.1 [RFC4346],and TLS 1.2 [RFC5246],
                        many TLS implementations remain backwards&shy; compatible withSSL 3.0 to interoperate with
                        legacy systems in the interest of a smooth user experience. The protocol handshake provides for
                        authenticated version negotiation, so normally the latest protocol version common to the client
                        and the server will be used.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        However, even if a client and server both support a version of TLS, the security level offered by
                        SSL 3.0 is still relevant since many clients implement a protocol downgrade to work around
                        server&shy;side interoperability bugs.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading572"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse572" aria-expanded="true" aria-controls="collapse572">Countermeasure: Require cryptographically secure protocols (e.g. TLSv1.2 and above) <span>[TLS-STRONG-PROTOCOLS]</span></button></h5></div><div id="collapse572" class="collapse" aria-labelledby="heading572" data-parent="#controls"><div class="card-body"><div>
                        Only cryptographically strong ciphers should be required. Best-practice dictates a subset of
                        'known good' ciphers and protocols be defined and enforced at the server. &nbsp;This may,
                        however, have compatibility issues with older browsers, requiring a balance be sought between
                        accessibility and security.&nbsp;
                        </div>
                        <ul>
                        <li>Define and enforce a list of acceptable ciphers and protocols. Disable SSLv3 and
                        earlier protocols on the service.&nbsp;</li>
                        <li>Ideally only TLSv1.2 and newer should be supported</li>
                        <li>If TLSv1.1 or 1.0 are required, known secure configurations and ciphers should be
                        selected.</li>
                        <li>SSLv3.0 and earlier should not be used</li>
                        </ul>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading575"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse575" aria-expanded="true" aria-controls="collapse575">Weakness: Use of weak TLS cipher suites <span>[SSL-WEAK-CIPHERS]</span></button></h5></div><div id="collapse575" class="collapse" aria-labelledby="heading575" data-parent="#weaknesses"><div class="card-body">A weak TLS cipher suite could allow an attacker to sniff the transmission by exploiting this
                        weakness.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading574"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse574" aria-expanded="true" aria-controls="collapse574">Countermeasure: Require cryptographically strong TLS cipher suites <span>[TLS-STRONG-CIPHERS]</span></button></h5></div><div id="collapse574" class="collapse" aria-labelledby="heading574" data-parent="#controls"><div class="card-body">Only cryptographically strong ciphers should be required. Best-practice dictates a subset of '
                        <i>known good</i>' ciphers and protocols be defined and enforced at the server.
                        &nbsp;This may, however, have compatibility issues with older browsers, requiring a balance
                        be sought between accessibility and security.&nbsp;
                        <div>
                        <ul>
                        <li>Define and enforce a list of acceptable ciphers and protocols</li>
                        <li>Explicitly disable known-bad ciphers and protocols, such as:</li>
                        <ul>
                        <li>Null and export ciphers</li>
                        <li>DH, MD5 and other weak cryptography</li>
                        <li>Ciphers with keys less than 128 bits</li>
                        <li>CBC ciphers with TLSv1.0 or earlier</li>
                        </ul>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading577"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse577" aria-expanded="true" aria-controls="collapse577">Weakness: Use of weak TLS protocols <span>[SSL-WEAK-PROTOCOL]</span></button></h5></div><div id="collapse577" class="collapse" aria-labelledby="heading577" data-parent="#weaknesses"><div class="card-body">A cryptographically weak SSL/TLS protocol could allow an attacker to sniff the traffic or
                        impersonate the server.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading576"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse576" aria-expanded="true" aria-controls="collapse576">Countermeasure: Require cryptographically secure protocols (e.g. TLSv1.2 and above) <span>[TLS-STRONG-PROTOCOLS]</span></button></h5></div><div id="collapse576" class="collapse" aria-labelledby="heading576" data-parent="#controls"><div class="card-body"><div>
                        Only cryptographically strong ciphers should be required. Best-practice dictates a subset of
                        'known good' ciphers and protocols be defined and enforced at the server. &nbsp;This may,
                        however, have compatibility issues with older browsers, requiring a balance be sought between
                        accessibility and security.&nbsp;
                        </div>
                        <ul>
                        <li>Define and enforce a list of acceptable ciphers and protocols. Disable SSLv3 and
                        earlier protocols on the service.&nbsp;</li>
                        <li>Ideally only TLSv1.2 and newer should be supported</li>
                        <li>If TLSv1.1 or 1.0 are required, known secure configurations and ciphers should be
                        selected.</li>
                        <li>SSLv3.0 and earlier should not be used</li>
                        </ul>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading581"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse581" aria-expanded="true" aria-controls="collapse581">Threat: Users lose trust in the system due to a perceived lack of security <span>[IRIUS-TRUST-SERVICE]</span></button></h5></div><div id="collapse581" class="collapse" aria-labelledby="heading581" data-parent="#threats"><div class="card-body">Users lose trust in the system because a key security mechanism, such as certificate
                                validation is not present and visible.&nbsp; For example, should a TLS certificate
                                expire or become invalid then this is clearly displayed in the browser as a security
                                warning.&nbsp; This could cause users to abandon the system.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading580"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse580" aria-expanded="true" aria-controls="collapse580">Weakness: Missing Check for Certificate Revocation after Initial Check <span>[CWE-370]</span></button></h5></div><div id="collapse580" class="collapse" aria-labelledby="heading580" data-parent="#weaknesses"><div class="card-body">The software does not check the revocation status of a
                        certificate after its initial revocation check, which can cause the software to
                        perform privileged actions even after the certificate is revoked at a later
                        time.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading579"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse579" aria-expanded="true" aria-controls="collapse579">Countermeasure: Configure and enable appropriate certification revocation <span>[PROPER-REVOCATION-CERTIFICATE]</span></button></h5></div><div id="collapse579" class="collapse" aria-labelledby="heading579" data-parent="#controls"><div class="card-body"><div>
                        Configure and enable appropriate certification revocation for each certificate created, such as
                        Online Certificate Status Protocol (OCSP) Stapling.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        OCSP is a protocol to check if an SSL certificate has been revoked. Instead of the client
                        downloading a large list of revoked certificates, they can simply submit a request to a CA
                        server, which returns a signed response with the certificate current status.
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading590"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse590" aria-expanded="true" aria-controls="collapse590">Risk pattern: Server <span>[INF-SERVER]</span></button></h5></div><div id="collapse590" class="collapse" aria-labelledby="heading590" data-parent="#components"><div class="card-body">Network connected server<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading589"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse589" aria-expanded="true" aria-controls="collapse589">Use case: Access services <span>[ACCESS SERVICES]</span></button></h5></div><div id="collapse589" class="collapse" aria-labelledby="heading589" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading588"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse588" aria-expanded="true" aria-controls="collapse588">Threat: Data compromised if the server itself is compromised <span>[SERVER-ATTACK]</span></button></h5></div><div id="collapse588" class="collapse" aria-labelledby="heading588" data-parent="#threats"><div class="card-body">If attackers compromise the server that hosts the service or data, then the data and
                                the service itself could be at risk of compromise. The server could be compromised
                                through any of the services that it exposes.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading585"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse585" aria-expanded="true" aria-controls="collapse585">Weakness: Recommended security patches are not applied <span>[UNPATCHED-SERVER]</span></button></h5></div><div id="collapse585" class="collapse" aria-labelledby="heading585" data-parent="#weaknesses"><div class="card-body">When patches are not applied in a timely manner then the server or system could be vulnerable
                        to known security issues. These issues could be used by an attacker to gain access to the
                        system.&nbsp;
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading584"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse584" aria-expanded="true" aria-controls="collapse584">Countermeasure: Apply required security patches <span>[PATCH-SERVER]</span></button></h5></div><div id="collapse584" class="collapse" aria-labelledby="heading584" data-parent="#controls"><div class="card-body"><div>
                        Vendors and other maintainers of software release patches in response to security flaws and
                        other bugs in their products.
                        </div>
                        <div>
                        <ul>
                        <li>Apply patches and other software updates in a timely manner to prevent unexpected
                        failures or exploitation.</li>
                        <li>Clearly define an approach for testing and applying patches, in particular security
                        patches, with expected timescales. &nbsp;There is often a small window between release of a
                        patch, and potentially malicious actors reverse-engineering the patch to identify and exploit
                        the flaw.</li>
                        <li>Use a threat intelligence, vulnerability scanning, or other alerting service to ensure
                        the project team is aware of issues within the project or its components promptly.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading587"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse587" aria-expanded="true" aria-controls="collapse587">Weakness: Unnecessary services are exposed <span>[UNNECESSARY-SERVICES]</span></button></h5></div><div id="collapse587" class="collapse" aria-labelledby="heading587" data-parent="#weaknesses"><div class="card-body">The application exposes unnecessary services which increase the attack surface.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading586"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse586" aria-expanded="true" aria-controls="collapse586">Countermeasure: Restrict access to required services only <span>[INF-UNNECESSARY-SERVICES]</span></button></h5></div><div id="collapse586" class="collapse" aria-labelledby="heading586" data-parent="#controls"><div class="card-body"><p>The attack surface, and therefore susceptibility to attack, should be minimized. In particular, services that are not explicitly required for the proper operation of the server or service should be disable, or access to them be restricted.&nbsp;</p> 
<p></p> 
<ul> 
 <li>Any service, feature, or functionality that is not required should be disabled or removed. This applies equally to the operating system, middleware, web-server, or other software in use.</li> 
 <li>Access to the server and remaining services (in particular those that cannot be disabled or removed) should be controlled use host-based and/or network security controls; for example host firewalls, network firewalls, routers, or switches.</li> 
</ul> 
<p></p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading591"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse591" aria-expanded="true" aria-controls="collapse591">Risk pattern: Server: Database <span>[DB-SERVER]</span></button></h5></div><div id="collapse591" class="collapse" aria-labelledby="heading591" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading596"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse596" aria-expanded="true" aria-controls="collapse596">Risk pattern: SQL Database <span>[DATABASE-SQL]</span></button></h5></div><div id="collapse596" class="collapse" aria-labelledby="heading596" data-parent="#components"><div class="card-body">SQL Database system<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading595"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse595" aria-expanded="true" aria-controls="collapse595">Use case: Read or Post data <span>[READ OR POST DATA]</span></button></h5></div><div id="collapse595" class="collapse" aria-labelledby="heading595" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading594"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse594" aria-expanded="true" aria-controls="collapse594">Threat: Attackers gain unauthorised access to data and/or systems through SQL Injection attacks <span>[CAPEC-66]</span></button></h5></div><div id="collapse594" class="collapse" aria-labelledby="heading594" data-parent="#threats"><div class="card-body">Successful SQL Injection attacks could lead to full compromise of the database or to a
                                partial compromise of only the data visible to the application.
                                <div>
                                <br />&nbsp;
                                <div>
                                Typically, these types of attacks result in unauthorized disclosure of sensitive data,
                                but can also be used to inject spurious data into the database or to drop tables and
                                deny service to legitimate users.
                                </div>
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading593"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse593" aria-expanded="true" aria-controls="collapse593">Weakness: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') <span>[CWE-89]</span></button></h5></div><div id="collapse593" class="collapse" aria-labelledby="heading593" data-parent="#weaknesses"><div class="card-body">The software constructs all or part of an SQL command using externally-influenced input from
                        an upstream component, but it does not neutralize or incorrectly neutralizes special elements
                        that could modify the intended SQL command when it is sent to a downstream component.&nbsp;
                        <div>
                        &nbsp;
                        <br />Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the
                        generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user
                        data. This can be used to alter query logic to bypass security checks, or to insert additional
                        statements that modify the back-end database, possibly including execution of system commands.
                        SQL injection has become a common issue with database-driven web sites. The flaw is easily
                        detected, and easily exploited, and as such, any site or software package with even a minimal
                        user base is likely to be subject to an attempted attack of this kind. This flaw depends on the
                        fact that SQL makes no real distinction between the control and data planes.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading592"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse592" aria-expanded="true" aria-controls="collapse592">Countermeasure: Use prepared statements for all database queries <span>[CWE-89-PREPARED]</span></button></h5></div><div id="collapse592" class="collapse" aria-labelledby="heading592" data-parent="#controls"><div class="card-body"><div>
                        Database injection attacks, such as SQLi (SQL Injection) rely on sending tainted client-side
                        data which is used in dynamic SQL queries at the server-side in an unsafe manner. For example,
                        creating queries by concatenating strings using untrusted data may result in&nbsp;vulnerable
                        code
                        <b>,</b>&nbsp;for example an attacker may append an 'OR' statement through the
                        provided customerName parameter passed to the following code to bypass the checks and return
                        additional data from the database:
                        </div>
                        <div>
                        <pre>

                        <ul>

                        <li>String query = &quot;SELECT user FROM users WHERE name = '&quot; </li>


                        </ul> + request.getParameter(&quot;customerName&quot;)+&quot;'&quot;;</pre>
                        </div>
                        <div>
                        Using prepared statements with carefully controlled and validated input conditions mitigates
                        against SQLi and related attacks.
                        </div>
                        <div>
                        <ul>
                        <li>Database queries should always be made using prepared statements or parameterized
                        queries.</li>
                        <li>Queries through an Object-Relational mapper should also be treated as tainted input,
                        and made using prepared statements to mitigate the threat.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading601"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse601" aria-expanded="true" aria-controls="collapse601">Risk pattern: Storage of auth credentials in clear text <span>[CREDENTIALS-STORAGE:CLEAR]</span></button></h5></div><div id="collapse601" class="collapse" aria-labelledby="heading601" data-parent="#components"><div class="card-body">Storing sensitive data in clear text<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading600"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse600" aria-expanded="true" aria-controls="collapse600">Use case: Sensitive Read or Post data <span>[SENSITIVE READ OR POST DATA]</span></button></h5></div><div id="collapse600" class="collapse" aria-labelledby="heading600" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading599"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse599" aria-expanded="true" aria-controls="collapse599">Threat: Users' passwords are compromised if the storage medium is compromised <span>[CWE-256]</span></button></h5></div><div id="collapse599" class="collapse" aria-labelledby="heading599" data-parent="#threats"><div class="card-body">A compromise of the storage system medium itself (device, server or database) could
                                allow attackers full access to the data
                                stored, including authentication credentials such as passwords.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading598"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse598" aria-expanded="true" aria-controls="collapse598">Weakness: Plaintext Storage of a Password <span>[CWE-257]</span></button></h5></div><div id="collapse598" class="collapse" aria-labelledby="heading598" data-parent="#weaknesses"><div class="card-body">The storage of passwords in a recoverable format makes them subject to password reuse attacks
                        by malicious users. In fact, it should be noted that recoverable encrypted passwords provide no
                        significant benefit over&nbsp;plaintext&nbsp;passwords since they are subject not only
                        to reuse by malicious&nbsp;attackers&nbsp;but also by malicious insiders. If a system
                        administrator can recover a password directly, or use a brute force search on the available
                        information, the administrator can use the password on other accounts.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading597"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse597" aria-expanded="true" aria-controls="collapse597">Countermeasure: Store passwords in unrecoverable form to prevent disclosure <span>[CWE-256]</span></button></h5></div><div id="collapse597" class="collapse" aria-labelledby="heading597" data-parent="#controls"><div class="card-body"><p>To protect users passwords from accidental or deliberate exposure, the application should store cryptographic hashes of passwords instead of the passwords themselves.&nbsp;</p> 
<p></p> 
<ul> 
 <li>Do not store passwords themselves in the data store for verification at login.&nbsp;</li> 
 <li>Instead, create a cryptographic hash of the password using a strong hash function that includes a work factor and a built in ‘salt’ value, like bcrypt or scrypt. This reduces the risk of brute-force attacks and rainbow tables, and allows flexibility to adapt the hashing function to balance security and performance.&nbsp;</li> 
 <li>Alternatively, use a strong hash function like <span class="caps">SHA</span>-384 together with a unique ‘salt’ value for every account. Apply multiple iterations of the hash to create the additional computational work required to mitigate brute-force attacks.</li> 
</ul> 
<p></p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading606"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse606" aria-expanded="true" aria-controls="collapse606">Risk pattern: Thick client: Authentication <span>[FATCLIENT:AUTHN]</span></button></h5></div><div id="collapse606" class="collapse" aria-labelledby="heading606" data-parent="#components"><div class="card-body">A thick client that authenticates to a service<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading605"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse605" aria-expanded="true" aria-controls="collapse605">Use case: Authentication <span>[AUTHENTICATION]</span></button></h5></div><div id="collapse605" class="collapse" aria-labelledby="heading605" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading604"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse604" aria-expanded="true" aria-controls="collapse604">Threat: Authentication credentials could be compromised <span>[CAPEC-205]</span></button></h5></div><div id="collapse604" class="collapse" aria-labelledby="heading604" data-parent="#threats"><div class="card-body">If authentication credentials not adequately protected in the client, then they could
                                be compromised through a number of attack vectors. If the credentials are hard coded
                                into the source, then everyone with access to the source, will also have access to the
                                credentials. This could include internal and third party developers.&nbsp;
                                <div>
                                &nbsp;
                                <br />If the credentials are stored on the file system without adequate operation
                                system controls, then system administrators with access to the server would also have
                                access to the credentials.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading603"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse603" aria-expanded="true" aria-controls="collapse603">Weakness: Insufficiently Protected Credentials <span>[CWE-522]</span></button></h5></div><div id="collapse603" class="collapse" aria-labelledby="heading603" data-parent="#weaknesses"><div class="card-body">This weakness occurs when the application transmits or stores authentication credentials and
                        uses an insecure method that is susceptible to unauthorized interception and/or retrieval.
                        <br />
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading602"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse602" aria-expanded="true" aria-controls="collapse602">Countermeasure: Authentication credentials should be saved in a cryptographically secure store <span>[CWE-798-CLIENT]</span></button></h5></div><div id="collapse602" class="collapse" aria-labelledby="heading602" data-parent="#controls"><div class="card-body"><div>
                        Single or automated sign-on from thick client applications can be facilitated in a number of
                        ways; local/client-side storage of credentials is considered an insecure option due to the risk
                        of exposure of the credentials at the client-side.
                        </div>
                        <div>
                        <ul>
                        <li>If possible, avoid storing authentication credentials on the client at all. Instead,
                        consider use of keys, certificates, or other cryptographically secure token unique to the
                        client-side instance and controlled by the client-side. &nbsp;For example, a unique key
                        could be issued to each client where the 'stay logged in' or similar function has been selected.
                        These individual keys can then be expired or revoked from the server-side automatically or by
                        the user as required.</li>
                        <li>If credentials must be stored, then they should be stored in a cryptographically
                        secure encrypted store.</li>
                        <li>Where possible, system provided stores should be used; for example, iOS and Android
                        provide password stores, as does MacOS/OS X's Keychain.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading611"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse611" aria-expanded="true" aria-controls="collapse611">Risk pattern: Thick Client: Stores sensitive data <span>[FATCLIENT:SENS-DATA-STORAGE]</span></button></h5></div><div id="collapse611" class="collapse" aria-labelledby="heading611" data-parent="#components"><div class="card-body">Storage of senstiive data on a thick client<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading610"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse610" aria-expanded="true" aria-controls="collapse610">Use case: Sensitive Read or Post data <span>[SENSITIVE READ OR POST DATA]</span></button></h5></div><div id="collapse610" class="collapse" aria-labelledby="heading610" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading609"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse609" aria-expanded="true" aria-controls="collapse609">Threat: Sensitive Data stored on the client could be accessed by an attacker <span>[CAPEC-167]</span></button></h5></div><div id="collapse609" class="collapse" aria-labelledby="heading609" data-parent="#threats"><div class="card-body">An attacker examines an available client application for the presence of sensitive
                                information.&nbsp;
                                <div>
                                <br />
                                </div>
                                <div>
                                This information may be stored in configuration files, embedded within the application
                                itself, or stored in other ways. Sensitive information may include long-term keys,
                                passwords, credit card or financial information, and other private material that the
                                client uses in its interactions with the server.&nbsp;
                                </div>
                                <div>
                                <br />
                                </div>
                                <div>
                                While servers are (hopefully) protected with professional security administrators, most
                                users may be less skilled at protecting their clients. As a result, the user client may
                                represent a weak link that an attacker can exploit. If an attacker can gain access to a
                                client installation, they may be able to detect and lift sensitive information that
                                could be used directly (such as financial information), or allow the attacker to subvert
                                future communication between the client and the server.&nbsp;
                                </div>
                                <div>
                                <br />
                                </div>
                                <div>
                                In some cases, it may not even be necessary to gain access to another user's
                                installation - if all instances of the client software are embedded with the same
                                sensitive information (for example, long term keys for communication with the server),
                                then the attacker must simply find a way to gain their own copy of the client in order
                                to perform this attack.
                                <br />
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading608"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse608" aria-expanded="true" aria-controls="collapse608">Weakness: Secrets, API keys and or passwords are included in the source code or online repositories <span>[CWE-312]</span></button></h5></div><div id="collapse608" class="collapse" aria-labelledby="heading608" data-parent="#weaknesses"><div class="card-body">API keys, passwords or secrets included in the source code or in the configuration files can be leaked to users with access to the code. This access can be incidentally granted by publishing the source code on a package-form or an online, public repository.

          The unauthorized access to any of those secrets could lead to a compromise of sensitive data or a system.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading607"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse607" aria-expanded="true" aria-controls="collapse607">Countermeasure: Store sensitive data in a cryptographically secure store <span>[CWE-312-ENCRYPT]</span></button></h5></div><div id="collapse607" class="collapse" aria-labelledby="heading607" data-parent="#controls"><div class="card-body"><div>
                        Local/client-side storage of sensitive data is considered an insecure option due to the risk of
                        exposure of the data on the client-side.
                        </div>
                        <div>
                        <ul>
                        <li>If possible, avoid storing sensitive data on the client at all. Instead, store the
                        data on the server side and only access it once the user has authenticated.</li>
                        <li>If sensitive data must be stored, then it should be stored in a cryptographically
                        secure encrypted store.</li>
                        <li>Where possible, system provided stores should be used; for example, iOS and Android
                        provide password stores, as does MacOS/OS X's Keychain.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading617"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse617" aria-expanded="true" aria-controls="collapse617">Risk pattern: Untrusted Data: Received <span>[untrusted-data-received]</span></button></h5></div><div id="collapse617" class="collapse" aria-labelledby="heading617" data-parent="#components"><div class="card-body">Untrusted or tainted data is received.<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading616"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse616" aria-expanded="true" aria-controls="collapse616">Use case: Post data <span>[post-data]</span></button></h5></div><div id="collapse616" class="collapse" aria-labelledby="heading616" data-parent="#usecases"><div class="card-body">Data is received (posted) here<div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading615"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse615" aria-expanded="true" aria-controls="collapse615">Threat: Attackers gain access to the system through Server Side Code Injection <span>[CWE-94]</span></button></h5></div><div id="collapse615" class="collapse" aria-labelledby="heading615" data-parent="#threats"><div class="card-body">Server Side Code Injection happens when an attacker is able to direct input under his
                                control and mix it with executed code on server side by modifying the logic executed on
                                it.&nbsp;
                                <div>
                                <br />&nbsp;
                                <div>
                                Depending on the code isolation, this event could grant the user with access to system
                                resources and data.&nbsp;
                                </div>
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading614"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse614" aria-expanded="true" aria-controls="collapse614">Weakness: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') <span>[CWE-78]</span></button></h5></div><div id="collapse614" class="collapse" aria-labelledby="heading614" data-parent="#weaknesses"><div class="card-body">The software constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component. This could allow attackers to execute unexpected, dangerous commands directly on the operating system. This weakness can lead to a vulnerability in environments in which the attacker does not have direct access to the operating system, such as in web applications.&nbsp; 
<div> 
 <br /> 
</div> 
<div>
  Alternately, if the weakness occurs in a privileged program, it could allow the attacker to specify commands that normally would not be accessible, or to call alternate commands with privileges that the attacker does not have. The problem is exacerbated if the compromised process does not follow the principle of least privilege, because the attacker-controlled commands may run with special system privileges that increases the amount of damage. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  There are at least two subtypes of OS command injection:&nbsp; 
</div> 
<div> 
 <ul> 
  <li>The application intends to execute a single, fixed program that is under its own control. It intends to use externally-supplied inputs as arguments to that program. For example, the program might use system(&quot;nslookup [HOSTNAME]&quot;) to run nslookup and allow the user to supply a HOSTNAME, which is used as an argument. Attackers cannot prevent nslookup from executing. However, if the program does not remove command separators from the HOSTNAME argument, attackers could place the separators into the arguments, which allows them to execute their own program after nslookup has finished executing.The application accepts an input that it uses to fully select which program to run, as well as which commands to use.&nbsp;</li> 
  <li>The application simply redirects this entire command to the operating system. For example, the program might use &quot;exec([COMMAND])&quot; to execute the [COMMAND] that was supplied by the user. If the COMMAND is under attacker control, then the attacker can execute arbitrary commands or programs. If the command is being executed using functions like exec() and CreateProcess(), the attacker might not be able to combine multiple commands together in the same line. From a weakness standpoint, these variants represent distinct programmer errors.&nbsp;</li> 
 </ul>In the first variant, the programmer clearly intends input from untrusted parties will be part of the arguments in the command to be executed. In the second variant, the programmer does not intend for the command to be accessible to any untrusted party, but the programmer probably has not accounted for alternate ways in which malicious attackers can provide input. 
</div><div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading612"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse612" aria-expanded="true" aria-controls="collapse612">Countermeasure: Validate all data received from the client side <span>[DATA-VAL]</span></button></h5></div><div id="collapse612" class="collapse" aria-labelledby="heading612" data-parent="#controls"><div class="card-body"><div>
                        All data received from the client-side should be considered tainted and a potential risk,
                        regardless of the source or transport method. &nbsp;For example, while hidden form fields,
                        cookies, or other headers may be obfuscated from a user, along with parameters passed in
                        ViewStates or other encapsulated forms, these can be modified by the user at the client-side in
                        memory, or in transit on the network. Similarly, data passed from binary or compiled components
                        can be modified in situ or in transit.&nbsp;
                        </div>
                        <div>
                        <i><br /></i>
                        </div>
                        <div>
                        <i>Furthermore, encryption only secures the data in transit between the two ends of the
                        encrypted tunnel (one end of which is typically controlled by the client); data passing through
                        the link may still be malicious. </i>
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        As such, all data from the client side must be subjected to strict validation, sanitization, and
                        encoding against expected syntactic and semantic criteria.
                        </div>
                        <div>
                        <ul>
                        <li>Define a specification of the data that is expected at each input; both the syntax
                        (e.g. alphanumeric only) and semantics (e.g. a word of between 1 and 25 characters, or a
                        specific list). As an example of business rule logic, &quot;boat&quot; may be
                        syntactically valid because it only contains alphanumeric characters, but it is not valid if the
                        input is only expected to contain colors such as &quot;red&quot; or &quot;blue.&quot;</li>
                        <li>Implement a 'known good' or white-list approach, where only inputs that meet the
                        strict criteria for each input are accepted, and reject, transform, or encapsulate any
                        non-compliant data.</li>
                        <li>While useful for identifying malicious content, do not rely on looking for specific
                        malformed or attack payloads (blacklists). It is almost impossible to maintain a comprehensive
                        and accurate blacklist due to the complexity and evolving nature of attacks, opportunities to
                        obfuscate payloads, and changes to the code's execution environment. As noted, blacklists can be
                        useful for detecting and logging potential attacks, or determining which inputs are so malformed
                        that they should be rejected outright.&nbsp;</li>
                        <li>Validate all data received from the client, including values such as HTTP headers and
                        cookie values if these are used as input on the server side, X- headers, and other platform
                        specific data objects passed between the client and server.</li>
                        </ul>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading613"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse613" aria-expanded="true" aria-controls="collapse613">Countermeasure: Ensure that the client-side and the server-side are using the same encoding style <span>[SAME-ENCODING-STYLE]</span></button></h5></div><div id="collapse613" class="collapse" aria-labelledby="heading613" data-parent="#controls"><div class="card-body">Ensure that the client-side and the server-side are using the same encoding style.</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading622"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse622" aria-expanded="true" aria-controls="collapse622">Risk pattern: Web Application <span>[WEB-APP]</span></button></h5></div><div id="collapse622" class="collapse" aria-labelledby="heading622" data-parent="#components"><div class="card-body">The server side web application<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading621"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse621" aria-expanded="true" aria-controls="collapse621">Use case: General <span>[GENERAL]</span></button></h5></div><div id="collapse621" class="collapse" aria-labelledby="heading621" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading620"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse620" aria-expanded="true" aria-controls="collapse620">Threat: An attacker may successfully launch a phishing scam and steal user credentials by modifying the URL value to a malicious site <span>[open-redirect-threat]</span></button></h5></div><div id="collapse620" class="collapse" aria-labelledby="heading620" data-parent="#threats"><div class="card-body">An http parameter may contain a URL value and could cause the web application to
                                redirect the request to the specified URL. By modifying the URL value to a malicious
                                site, an attacker may successfully launch a phishing scam and steal user credentials.
                                Because the server name in the modified link is identical to the original site, phishing
                                attempts have a more trustworthy appearance.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading619"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse619" aria-expanded="true" aria-controls="collapse619">Weakness: URL Redirection to Untrusted Site ('Open Redirect') <span>[CWE-601]</span></button></h5></div><div id="collapse619" class="collapse" aria-labelledby="heading619" data-parent="#weaknesses"><div class="card-body">A web application accepts a user-controlled input that
                        specifies a link to an external site, and uses that link in a Redirect. This
                        simplifies phishing attacks.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading618"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse618" aria-expanded="true" aria-controls="collapse618">Countermeasure: Whitelist to which URLs the application can redirect to <span>[CWE-601]</span></button></h5></div><div id="collapse618" class="collapse" aria-labelledby="heading618" data-parent="#controls"><div class="card-body">The application should maintain a list of the URLs to which it can redirect. This whitelisting
                        can also be done by applying a regular expression. The application should only allow redirects
                        to trusted URLS.
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading623"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse623" aria-expanded="true" aria-controls="collapse623">Risk pattern: Web Application: Sensitive data transport <span>[WEB-APP:SENS-DATA:TRANSPORT]</span></button></h5></div><div id="collapse623" class="collapse" aria-labelledby="heading623" data-parent="#components"><div class="card-body">The server side functions of a web application<div class="accordion" id="usecases"></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading628"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse628" aria-expanded="true" aria-controls="collapse628">Risk pattern: Web Application: WYSIWYG <span>[BROWSER:WYSIWYG]</span></button></h5></div><div id="collapse628" class="collapse" aria-labelledby="heading628" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading627"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse627" aria-expanded="true" aria-controls="collapse627">Use case: General <span>[GENERAL]</span></button></h5></div><div id="collapse627" class="collapse" aria-labelledby="heading627" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading626"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse626" aria-expanded="true" aria-controls="collapse626">Threat: Attackers gain access to users data by manipulating server side code <span>[CAPEC-341]</span></button></h5></div><div id="collapse626" class="collapse" aria-labelledby="heading626" data-parent="#threats"><div class="card-body">Server Side Code Injection happens when an attacker is able to direct input under his
                                control and mix it with executed code on server side by modifying the logic executed on
                                it.&nbsp;
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading625"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse625" aria-expanded="true" aria-controls="collapse625">Weakness: Users can submit HTML markup <span>[CWE-79-HTML]</span></button></h5></div><div id="collapse625" class="collapse" aria-labelledby="heading625" data-parent="#weaknesses"><div class="card-body"><br />The software does not neutralize or incorrectly neutralizes user-controllable
                        input before it is placed in output that is used as a web page that is served to other users.
                        client-side injection (XSS, HTML, CSS...) vulnerabilities occur when:
                        <ol>
                        <li>Untrusted data enters a web application, typically from a web request.</li>
                        <li>The web application dynamically generates a web page that contains this untrusted
                        data.</li>
                        <li>During page generation, the application does not prevent the data from containing
                        content that is executable by a web browser, such as JavaScript, HTML tags, HTML attributes,
                        mouse events, Flash, ActiveX, etc.</li>
                        <li>A victim visits the generated web page through a web browser, which contains malicious
                        script that was injected using the untrusted data.</li>
                        <li>Since the script comes from a web page that was sent by the web server, the victim's
                        web browser executes the malicious script in the context of the web server's domain.</li>
                        <li>This effectively violates the intention of the web browser's same-origin policy, which
                        states that scripts in one domain should not be able to access resources or run code in a
                        different domain.</li>
                        </ol>
                        <br />
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading624"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse624" aria-expanded="true" aria-controls="collapse624">Countermeasure: Sanitise data received from a WYSIWYG editor <span>[CWE-79-HTML]</span></button></h5></div><div id="collapse624" class="collapse" aria-labelledby="heading624" data-parent="#controls"><div class="card-body"><div>
                        WYSIWYG editors allow users to input formatted HTML text to the application. Allowing
                        uncontrolled HTML input could lead to Cross Site Scripting and other content-based attacks. In a
                        number of instances it may be necessary to allow users to use extended or active content in data
                        provided to the application (for example CMS or blogs), but the active content permitted should
                        be carefully vetted and controlled.
                        </div>
                        <div>
                        <ul>
                        <li>Sanitize data received through WYSIWYG (or other HTML/raw) editing interfaces.</li>
                        <li>Where HTML or other meta-data is permitted, this should be checked against a carefully
                        selected and controlled whitelist of tags and attributes.</li>
                        <li>All other meta-characters or unexpected content should either be rejected, removed,
                        masked, or encoded.</li>
                        </ul>
                        </div>
                        <div>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading653"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse653" aria-expanded="true" aria-controls="collapse653">Risk pattern: Web Browser <span>[BROWSER]</span></button></h5></div><div id="collapse653" class="collapse" aria-labelledby="heading653" data-parent="#components"><div class="card-body">Web Browser<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading643"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse643" aria-expanded="true" aria-controls="collapse643">Use case: Read or Post data <span>[READ OR POST DATA]</span></button></h5></div><div id="collapse643" class="collapse" aria-labelledby="heading643" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading631"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse631" aria-expanded="true" aria-controls="collapse631">Threat: An attacker crafts malicious web links and distributes them, typically in a targeted manner, hoping to induce users to click on the link and execute the malicious action against some third-party application. <span>[CAPEC-62]</span></button></h5></div><div id="collapse631" class="collapse" aria-labelledby="heading631" data-parent="#threats"><div class="card-body">An attacker crafts malicious web links and distributes them (via web pages, email,
                                etc.), typically in a targeted manner, hoping to induce users to click on the link and
                                execute the malicious action against some third-party application. If successful, the
                                action embedded in the malicious link will be processed and accepted by the targeted
                                application with the users' privilege level.
                                <br />This type of attack leverages the persistence and implicit trust placed in
                                user session cookies by many web applications today. In such an architecture, once the
                                user authenticates to an application and a session cookie is created on the user's
                                system, all following transactions for that session are authenticated using that cookie
                                including potential actions initiated by an attacker and simply &quot;riding&quot;
                                the existing session cookie.
                                <br />
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading630"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse630" aria-expanded="true" aria-controls="collapse630">Weakness: Cross Site Request Forgery <span>[CWE-352]</span></button></h5></div><div id="collapse630" class="collapse" aria-labelledby="heading630" data-parent="#weaknesses"><div class="card-body">The web application does not, or can not, sufficiently verify whether a well-formed, valid,
                        consistent request was intentionally provided by the user who submitted the request.&nbsp;
                        <div>
                        &nbsp;
                        <br />When a web server is designed to receive a request from a client without any
                        mechanism for verifying that it was intentionally sent, then it might be possible for an
                        attacker to trick a client into making an unintentional request to the web server which will be
                        treated as an authentic request. This can be done via a URL, image load, XMLHttpRequest, etc.
                        and can result in exposure of data or unintended code execution.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading629"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse629" aria-expanded="true" aria-controls="collapse629">Countermeasure: Reject requests containing unexpected or missing content type headers <span>[ASVS-18.8]</span></button></h5></div><div id="collapse629" class="collapse" aria-labelledby="heading629" data-parent="#controls"><div class="card-body"><div>
                        Reject requests containing unexpected or missing content type headers with HTTP response status
                        &quot;406 Unacceptable&quot; or &quot;415 Unsupported Media Type&quot;.
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading642"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse642" aria-expanded="true" aria-controls="collapse642">Threat: Attackers could gain access to a users' browser through Cross Site Scripting attacks <span>[CAPEC-341]</span></button></h5></div><div id="collapse642" class="collapse" aria-labelledby="heading642" data-parent="#threats"><div class="card-body">Cross Site Scripting vulnerabilities could allow attackers to gain control of
                                users'
                                browsers, which in turn would allow them to:<div><ol><li>Re-write
                                browser
                                content</li><li>Read the users' session cookie and thereby hijack their
                                session</li><li>Read
                                form data from the users' browser</li><li>Trick users into installing
                                malware&nbsp;</li></ol></div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading633"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse633" aria-expanded="true" aria-controls="collapse633">Weakness: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') <span>[CWE-79]</span></button></h5></div><div id="collapse633" class="collapse" aria-labelledby="heading633" data-parent="#weaknesses"><div class="card-body">The software does not neutralize or incorrectly neutralizes user-controllable input before it
                        is placed in output that is used as a web page that is served to other users. Cross-site
                        scripting (XSS) vulnerabilities occur when:
                        <ol>
                        <li>Untrusted data enters a web application, typically from a web request.</li>
                        <li>The web application dynamically generates a web page that contains this untrusted
                        data.</li>
                        <li>During page generation, the application does not prevent the data from containing
                        content that is executable by a web browser, such as JavaScript, HTML tags, HTML attributes,
                        mouse events, Flash, ActiveX, etc.</li>
                        <li>A victim visits the generated web page through a web browser, which contains malicious
                        script that was injected using the untrusted data.</li>
                        <li>Since the script comes from a web page that was sent by the web server, the victim's
                        web browser executes the malicious script in the context of the web server's domain.</li>
                        <li>This effectively violates the intention of the web browser's same-origin policy, which
                        states that scripts in one domain should not be able to access resources or run code in a
                        different domain.</li>
                        </ol>There are three main kinds of XSS:
                        <ul>
                        <li><b>Type 1: Reflected XSS (or Non-Persistent)</b></li>
                        </ul>
                        <blockquote>
                        The server reads data directly from the HTTP request and reflects it back in the HTTP response.
                        Reflected XSS exploits occur when an attacker causes a victim to supply dangerous content to a
                        vulnerable web application, which is then reflected back to the victim and executed by the web
                        browser. The most common mechanism for delivering malicious content is to include it as a
                        parameter in a URL that is posted publicly or e-mailed directly to the victim. URLs constructed
                        in this manner constitute the core of many phishing schemes, whereby an attacker convinces a
                        victim to visit a URL that refers to a vulnerable site. After the site reflects the attacker's
                        content back to the victim, the content is executed by the victim's browser.
                        </blockquote>
                        <ul>
                        <li><b>Type 2: Stored XSS (or Persistent)</b></li>
                        </ul>
                        <blockquote>
                        The application stores dangerous data in a database, message forum, visitor log, or other
                        trusted data store. At a later time, the dangerous data is subsequently read back into the
                        application and included in dynamic content. From an attacker's perspective, the optimal place
                        to inject malicious content is in an area that is displayed to either many users or particularly
                        interesting users. Interesting users typically have elevated privileges in the application or
                        interact with sensitive data that is valuable to the attacker. If one of these users executes
                        malicious content, the attacker may be able to perform privileged operations on behalf of the
                        user or gain access to sensitive data belonging to the user. For example, the attacker might
                        inject XSS into a log message, which might not be handled properly when an administrator views
                        the logs.
                        </blockquote>
                        <ul>
                        <li><b>Type 0: DOM-Based XSS</b></li>
                        </ul>
                        <blockquote>
                        In DOM-based XSS, the client performs the injection of XSS into the page; in the other types,
                        the server performs the injection. DOM-based XSS generally involves server-controlled, trusted
                        script that is sent to the client, such as Javascript that performs sanity checks on a form
                        before the user submits it. If the server-supplied script processes user-supplied data and then
                        injects it back into the web page (such as with dynamic HTML), then DOM-based XSS is
                        possible.Once the malicious script is injected, the attacker can perform a variety of malicious
                        activities. The attacker could transfer private information, such as cookies that may include
                        session information, from the victim's machine to the attacker. The attacker could send
                        malicious requests to a web site on behalf of the victim, which could be especially dangerous to
                        the site if the victim has administrator privileges to manage that site. Phishing attacks could
                        be used to emulate trusted web sites and trick the victim into entering a password, allowing the
                        attacker to compromise the victim's account on that web site. Finally, the script could exploit
                        a vulnerability in the web browser itself possibly taking over the victim's machine, sometimes
                        referred to as &quot;drive-by hacking&quot;.
                        </blockquote>
                        <blockquote>
                        <br />
                        </blockquote>In many cases, the attack can be launched without the victim even being aware
                        of it. Even with careful users, attackers frequently use a variety of methods to encode the
                        malicious portion of the attack, such as URL encoding or Unicode, so the request looks less
                        suspicious.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading632"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse632" aria-expanded="true" aria-controls="collapse632">Countermeasure: Perform contextual HTML encoding of all user submitted data <span>[CWE-79-ENCODE]</span></button></h5></div><div id="collapse632" class="collapse" aria-labelledby="heading632" data-parent="#controls"><div class="card-body"><div>
                        All data received from the client-side should be considered tainted and a potential risk. If
                        handled properly at the point of input, this untrusted tainted data should have been sanitized
                        and encoded safely. The context when returning the data to the user is important, however, as
                        this will affect what metacharacters have significance, and how they will be interpreted at the
                        client-side.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        For example, if data is inserted into the HTML body then HTML Entity encoding should be
                        performed, but if the data is inserted into a JavaScript block, then JavaScript escaping should
                        be performed. Similarly, while JavaScript code should not be executed in the browser when
                        returned in an application/json response, it may then be rendered in an unsafe manner.
                        </div>
                        <div>
                        <ul>
                        <li>Apply contextual encoding to all tainted data when returned to the users (including
                        secondary users if the application has multiple interfaces - e.g. an internal user viewing data
                        entered by an external customer).</li>
                        <li>This should be in addition to, and in conjunction with, sanitization and encoding
                        applied at the time of data acquisition.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading635"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse635" aria-expanded="true" aria-controls="collapse635">Weakness: Internet Explorer could allow Cross Site Scripting attacks through content sniffing <span>[CWE-693-NOSNIFF]</span></button></h5></div><div id="collapse635" class="collapse" aria-labelledby="heading635" data-parent="#weaknesses"><div class="card-body">The product does not use or incorrectly uses a protection mechanism that provides sufficient
                        defense against directed attacks against the product. This weakness covers three distinct
                        situations:
                        <div>
                        <ul>
                        <li>A &quot;missing&quot; protection mechanism occurs when the application does
                        not define any mechanism against a certain class of attack.&nbsp;</li>
                        <li>An &quot;insufficient&quot; protection mechanism might provide some defenses -
                        for example, against the most common attacks - but it does not protect against everything that
                        is intended.&nbsp;</li>
                        <li>Finally, an &quot;ignored&quot; mechanism occurs when a mechanism is available
                        and in active use within the product, but the developer has not applied it in some code path.</li>
                        </ul>
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading634"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse634" aria-expanded="true" aria-controls="collapse634">Countermeasure: Set the HTTP security header 'X-Content-Type-Options' from the server <span>[CWE-693-NOSNIFF]</span></button></h5></div><div id="collapse634" class="collapse" aria-labelledby="heading634" data-parent="#controls"><div class="card-body"><div>
                        A number of browser-based attacks rely on incorrectly stating MIME types on content in an
                        attempt to bypass server and browser controls to render malicious content for the user.
                        </div>
                        <div>
                        <ul>
                        <li>Set the <i>X-Content-Type-Options: nosniff</i>&nbsp;header on any page
                        that displays previously uploaded content to prevent some XSS and related attacks.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading637"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse637" aria-expanded="true" aria-controls="collapse637">Weakness: Lack of 'HttpOnly' flag on session cookie <span>[CWE-84-HTTP-ONLY]</span></button></h5></div><div id="collapse637" class="collapse" aria-labelledby="heading637" data-parent="#weaknesses"><div class="card-body">The web application improperly neutralizes user-controlled input for executable script
                        disguised with URI encodings.
                        <br />
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading636"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse636" aria-expanded="true" aria-controls="collapse636">Countermeasure: Set the 'httpOnly' flag (or directive) on session cookies <span>[CWE-84-HTTP-ONLY]</span></button></h5></div><div id="collapse636" class="collapse" aria-labelledby="heading636" data-parent="#controls"><div class="card-body"><div>
                        Cookies and their data can been accessed in the browser through a number of means, including
                        JavaScript. This can facilitate attacks against users, for example cross-site scripting attacks
                        to POST the session ID to a third party site in order to hijack the session. The httpOnly
                        directive instructs compliant browsers to only allow the cookies to be accessed at the HTTP (or
                        server) layer, preventing client-side code or other browser functionality from accessing their
                        contents, mitigating such attacks.
                        </div>
                        <div>
                        <ul>
                        <li>Set the httpOnly directive on all cookies containing sensitive data (in particular the
                        session ID token) unless there is a specific requirement for that data to be accessed within the
                        browser.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading639"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse639" aria-expanded="true" aria-controls="collapse639">Weakness: Lack of Content Security Policy version 2 (CSPv2) <span>[WEB-CSP]</span></button></h5></div><div id="collapse639" class="collapse" aria-labelledby="heading639" data-parent="#weaknesses"><div class="card-body">Content Security Policy (CSP) is a computer security standard introduced to prevent cross-site
                        scripting (XSS), clickjacking and other code injection attacks resulting from execution of
                        malicious content in the trusted web page context.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading638"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse638" aria-expanded="true" aria-controls="collapse638">Countermeasure: Define a restrictive 'least privilege' Content Security Policy <span>[WEB-CSP]</span></button></h5></div><div id="collapse638" class="collapse" aria-labelledby="heading638" data-parent="#controls"><div class="card-body"><div>
                        The Content-Security-Policy instructs compliant browsers on how they may interact with external
                        sites while in the current context. This enables the server to control interactive with code and
                        content from third parties, mitigating some client-side code injection attacks. The policy
                        allows the server to specify what connections are permitted for each type of resource.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        For example, the following policy tells the browser to allow connections to the same domain to
                        which the page was served. and websocket connections to the domain *.iriusrisk.com.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        Content-Security-Policy: default-src 'self'; script-src 'self'; style-src 'self'
                        'unsafe-inline'; connect-src 'self' wss://*.iriusrisk.com; img-src 'self' data:
                        </div>
                        <div>
                        <ul>
                        <li>Define and set a Content-Security-Policy with least-privilege to allow only those
                        interactions that are explicitly required.&nbsp;</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading641"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse641" aria-expanded="true" aria-controls="collapse641">Weakness: Lack of supporting built in browser XSS protection <span>[CWE-693-X-XSS-PROTECTION]</span></button></h5></div><div id="collapse641" class="collapse" aria-labelledby="heading641" data-parent="#weaknesses"><div class="card-body">The product does not use or incorrectly uses a protection mechanism that provides sufficient
                        defense against directed attacks against the product. This weakness covers three distinct
                        situations:
                        <div>
                        <ul>
                        <li>A &quot;missing&quot; protection mechanism occurs when the application does
                        not define any mechanism against a certain class of attack.&nbsp;</li>
                        <li>An &quot;insufficient&quot; protection mechanism might provide some defenses -
                        for example, against the most common attacks - but it does not protect against everything that
                        is intended.&nbsp;</li>
                        <li>Finally, an &quot;ignored&quot; mechanism occurs when a mechanism is available
                        and in active use within the product, but the developer has not applied it in some code path.</li>
                        </ul>
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading640"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse640" aria-expanded="true" aria-controls="collapse640">Countermeasure: Set the HTTP security header 'X-XSS-Protection' from the server <span>[CWE-693-X-XSS-PROTECTION]</span></button></h5></div><div id="collapse640" class="collapse" aria-labelledby="heading640" data-parent="#controls"><div class="card-body"><div>
                        <div>
                        Modern browsers including IE8 and recent WebKit based implementation such as Safari and Chrome
                        have optional additional XSS prevention controls built-in. These controls are activated using
                        the X-XSS-Protection header.
                        </div>
                        </div>
                        <div>
                        <ul>
                        <li>Set the <i>X-XSS-Protection: 1; mode=block</i> header at the server-side
                        on all content.</li>
                        </ul>
                        </div>
                        <blockquote>
                        </blockquote>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading652"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse652" aria-expanded="true" aria-controls="collapse652">Use case: Transaction Authentication <span>[TRANSACTION AUTHENTICATION]</span></button></h5></div><div id="collapse652" class="collapse" aria-labelledby="heading652" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading646"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse646" aria-expanded="true" aria-controls="collapse646">Threat: Attackers cause users to peform arbitrary clicks on the site through ClickJacking attacks <span>[CAPEC-103]</span></button></h5></div><div id="collapse646" class="collapse" aria-labelledby="heading646" data-parent="#threats"><div class="card-body">In a clickjacking attack the victim is tricked into unknowingly initiating some action
                                in one system while interacting with the UI from seemingly completely different system.&nbsp;
                                <div>
                                <br />
                                </div>
                                <div>
                                While being logged in to some target system, the victim visits the attackers' malicious
                                site which displays a UI that the victim wishes to interact with. In reality, the
                                clickjacked page has a transparent layer above the visible UI with action controls that
                                the attacker wishes the victim to execute. The victim clicks on buttons or other UI
                                elements they see on the page which actually triggers the action controls in the
                                transparent overlaying layer.
                                </div>
                                <div>
                                <br />
                                </div>
                                <div>
                                Depending on what that action control is, the attacker may have just tricked the victim
                                into executing some potentially privileged (and most certainly undesired) functionality
                                in the target system to which the victim is authenticated.&nbsp;
                                </div>
                                <div>
                                <br />
                                </div>
                                <div>
                                The basic problem here is that there is a dichotomy between what the victim thinks he's
                                clicking on versus what he or she is actually clicking on.
                                <br />
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading645"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse645" aria-expanded="true" aria-controls="collapse645">Weakness: The page can be included in an iframe <span>[CWE-693-CLICKJACK]</span></button></h5></div><div id="collapse645" class="collapse" aria-labelledby="heading645" data-parent="#weaknesses"><div class="card-body">The product does not use or incorrectly uses a protection mechanism that provides sufficient
                        defense against directed attacks against the product. This weakness covers three distinct
                        situations:
                        <div>
                        <ul>
                        <li>A &quot;missing&quot; protection mechanism occurs when the application does
                        not define any mechanism against a certain class of attack.&nbsp;</li>
                        <li>An &quot;insufficient&quot; protection mechanism might provide some defenses -
                        for example, against the most common attacks - but it does not protect against everything that
                        is intended.&nbsp;</li>
                        <li>Finally, an &quot;ignored&quot; mechanism occurs when a mechanism is available
                        and in active use within the product, but the developer has not applied it in some code path.</li>
                        </ul>
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading644"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse644" aria-expanded="true" aria-controls="collapse644">Countermeasure: Set the HTTP security header 'X-Frame-Options header' from the server <span>[@cwe-693-clickjack]</span></button></h5></div><div id="collapse644" class="collapse" aria-labelledby="heading644" data-parent="#controls"><div class="card-body"><div>
                        Prevent the page from being framed by setting the X-Frame-Options header
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        Set the X-Frame-Options header to the value: SAMEORIGIN or DENY. &nbsp;This header is
                        honored by the following browser versions:&nbsp;
                        </div>
                        <ul>
                        <li>Chrome 4.1.249.1042</li>
                        <li>Firefox (Gecko) 3.6.9</li>
                        <li>Internet Explorer 8.0 9.0</li>
                        <li>Opera 10.50Safari 4.0</li>
                        </ul>Newer versions may also support the additional value: ALLOW-FROM which allows
                        specifying URLS that are permitted to frame the page.
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading651"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse651" aria-expanded="true" aria-controls="collapse651">Threat: Attackers could cause users to perform specific actions on their behalf through Cross Site Request Forgery attacks <span>[CAPEC-62]</span></button></h5></div><div id="collapse651" class="collapse" aria-labelledby="heading651" data-parent="#threats"><div class="card-body">Attackers could cause users to perform actions by exploiting Cross Site Request
                                Forgery vulnerabilities. This involves the attackers creating a malicious website that
                                hosts a form or JavaScript designed to perform a POST or GET request against the target
                                application. If the victim is logged into the target application, and then navigates to
                                the attacker's malicious website, the form will be submitted and the operation performed
                                by &quot;riding&quot; on the users existing session.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading648"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse648" aria-expanded="true" aria-controls="collapse648">Weakness: Cross Site Request Forgery <span>[CWE-352]</span></button></h5></div><div id="collapse648" class="collapse" aria-labelledby="heading648" data-parent="#weaknesses"><div class="card-body">The web application does not, or can not, sufficiently verify whether a well-formed, valid,
                        consistent request was intentionally provided by the user who submitted the request.&nbsp;
                        <div>
                        &nbsp;
                        <br />When a web server is designed to receive a request from a client without any
                        mechanism for verifying that it was intentionally sent, then it might be possible for an
                        attacker to trick a client into making an unintentional request to the web server which will be
                        treated as an authentic request. This can be done via a URL, image load, XMLHttpRequest, etc.
                        and can result in exposure of data or unintended code execution.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading647"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse647" aria-expanded="true" aria-controls="collapse647">Countermeasure: Set and verify one time 'Anti CSRF' tokens for sensitive operations <span>[CWE-352-TOKENS]</span></button></h5></div><div id="collapse647" class="collapse" aria-labelledby="heading647" data-parent="#controls"><div class="card-body"><div>
                        Cross Site Request Forgery (CSRF) attacks exploit users by causing them to unknowingly submit
                        requests to the application while logged in, for example by tricking them in to clicking links
                        or through cross-site scripting (XSS) attacks. These attacks can be deployed where sensitive
                        operations can be accessed through a simple GET request, or a POST form submission and no
                        additional controls are in place. These attacks can be mitigated by requiring a random server
                        generated token be submitted and verified in each request. Requiring re-authentication of
                        sensitive functions is also effective, but intrusive in the user experience.
                        </div>
                        <div>
                        <ul>
                        <li>HTML pages that offer sensitive operations should also include a random one time token
                        as a hidden field with every form. When the form is submitted, the server side should verify
                        that the token received is the same as the token issued.</li>
                        <li>Re-authentication should be required on sensitive functionality such as
                        password-change or user-creation.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading650"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse650" aria-expanded="true" aria-controls="collapse650">Weakness: Missing Authentication for Critical Function <span>[CWE-306]</span></button></h5></div><div id="collapse650" class="collapse" aria-labelledby="heading650" data-parent="#weaknesses"><div class="card-body">The software does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading649"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse649" aria-expanded="true" aria-controls="collapse649">Countermeasure: Require re-authentication for critical operations <span>[RE-AUTH]</span></button></h5></div><div id="collapse649" class="collapse" aria-labelledby="heading649" data-parent="#controls"><div class="card-body"><div>
                        Unattended, hijacked, or otherwise compromised user sessions can be leveraged through certain
                        functionality by an attacker to gain more persistent access. For example, they could change the
                        user's password, create a new account within the application, or abuse the privilege of the
                        compromised user to cause damage (an administrative used could potentially modify or destroy
                        data). To mitigate the threat, in addition to controls such as anti-CSRF tokens,
                        re-authentication of key functionality should be implemented.
                        </div>
                        <div>
                        <ul>
                        <li>Requires users verify their identity when performing critical operations. This could
                        be achieved by requiring they re-enter their password, or a secondary secret value. &nbsp;</li>
                        <li>In sensitive systems, consider use of multi-factor authentication such as a time based
                        on time password (TOTP), or a signing tokens (c.f. Internet banking solutions using an element
                        of the transaction to be approved as the seed for the OTP).</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading660"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse660" aria-expanded="true" aria-controls="collapse660">Risk pattern: Web Browser: Authentication <span>[BROWSER:AUTHN-SF]</span></button></h5></div><div id="collapse660" class="collapse" aria-labelledby="heading660" data-parent="#components"><div class="card-body">Browser used for authentication<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading659"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse659" aria-expanded="true" aria-controls="collapse659">Use case: Authentication <span>[AUTHENTICATION]</span></button></h5></div><div id="collapse659" class="collapse" aria-labelledby="heading659" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading658"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse658" aria-expanded="true" aria-controls="collapse658">Threat: Authentication process is spoofed by replaying login credentials <span>[CWE-60-AUTH]</span></button></h5></div><div id="collapse658" class="collapse" aria-labelledby="heading658" data-parent="#threats"><div class="card-body">If the server does not respond with an HTTP 3xx redirect when the user submits their
                                credentials, then an attacker who has access to the victim's browser could use the
                                'Back' and 'Reload' buttons to replay the login request.
                                <div>
                                &nbsp; &nbsp;
                                <div>
                                If the attacker can install browser plugins then they could compromise those
                                credentials, but if not, then they could simply login as the legitimate user.
                                </div>
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading655"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse655" aria-expanded="true" aria-controls="collapse655">Weakness: Authentication services responds with HTTP 2xx status code <span>[CWE-525-REPOST]</span></button></h5></div><div id="collapse655" class="collapse" aria-labelledby="heading655" data-parent="#weaknesses"><div class="card-body">If the server responds with an HTTP 200 status code, then by refreshing the page, the browser
                        will resubmit the entered details. This could allow an attacker with access to the victim's
                        browser to resubmit and capture sensitive data that was previously submitted.&nbsp;
                        <br />
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading654"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse654" aria-expanded="true" aria-controls="collapse654">Countermeasure: Respond to login requests with HTTP 302 redirect <span>[CWE-525-REPOST]</span></button></h5></div><div id="collapse654" class="collapse" aria-labelledby="heading654" data-parent="#controls"><div class="card-body"><div>
                        Browsers may cache form data submitted through the HTTP POST method for persistence and replay
                        when the user browsers back and forward. This means that even after a user has logged out, a
                        subsequent party may use the navigation options to browse back to the page returned after login.
                        When browsing to this page, or reloading it, the browser may offer to resubmit the previous
                        data, including the username and password. This both exposes the user's account to immediate
                        attack, and gives the malicious party to intercept the POST request and retrieve the username,
                        password, and other submitted data.
                        </div>
                        <div>
                        <ul>
                        <li>Ensure the browser returns an HTTP 30x series response to any sensitive data submitted
                        in an HTTP POST request, in particular authentication requests and others containing the
                        password or other secret data.</li>
                        <li>This should be extended to failed requests; even compromise of a misspelt username or
                        password may enable an attacker to determine the correct credentials.</li>
                        </ul>
                        </div>
                        <div>
                        <br />
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading657"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse657" aria-expanded="true" aria-controls="collapse657">Weakness: Information Exposure Through Browser Caching of form fields <span>[CWE-525-AUTOCOMPLETE-FORM]</span></button></h5></div><div id="collapse657" class="collapse" aria-labelledby="heading657" data-parent="#weaknesses"><div class="card-body">For each web page, the application should have an appropriate caching policy specifying the
                        extent to which the page and its form fields should be cached.
                        <br />
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading656"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse656" aria-expanded="true" aria-controls="collapse656">Countermeasure: Disable authentication form autocomplete <span>[CWE-525-AUTOCOMPLETE-FORM]</span></button></h5></div><div id="collapse656" class="collapse" aria-labelledby="heading656" data-parent="#controls"><div class="card-body"><div>
                        Auto-completion or pre-filling of authentication details by the browser implies that credentials
                        are stored in plaintext or a reversible format. This may be in violation of security
                        best-practice, or application security expectations. The application should attempt to mitigate
                        this risk by requesting the browser does not cache or store credentials.
                        </div>
                        <div>
                        <ul>
                        <li>All forms handling sensitive data should be protected using the autocomplete=off HTML
                        directive at the form or field level.</li>
                        <li>Issue browser specific directives to request auto-fill or completion is disabled; The
                        AUTOCOMPLETE attribute should be set to &quot;OFF&quot;.</li>
                        </ul>
                        <div>
                        It should be noted that compliance with these requests at the client-side is optional, and many
                        browsers and clients override these directives to use operating system, browser, or third party
                        password managers or key-safes to store secrets.
                        </div>
                        </div>
                        <div>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading676"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse676" aria-expanded="true" aria-controls="collapse676">Risk pattern: Web Browser: Handles sensitive data <span>[BROWSER:SENS-DATA]</span></button></h5></div><div id="collapse676" class="collapse" aria-labelledby="heading676" data-parent="#components"><div class="card-body">Browser that presents or posts sensitive data<div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading671"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse671" aria-expanded="true" aria-controls="collapse671">Use case: Access sensitive data <span>[ACCESS SENSITIVE DATA]</span></button></h5></div><div id="collapse671" class="collapse" aria-labelledby="heading671" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading667"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse667" aria-expanded="true" aria-controls="collapse667">Threat: Attackers with access to a victim's browser could read locally stored data <span>[CAPEC-204-AUTOCOMPLETE]</span></button></h5></div><div id="collapse667" class="collapse" aria-labelledby="heading667" data-parent="#threats"><div class="card-body">If the application accepts sensitive data through forms, then browsers could cache
                                that data and redisplay it if an attacker views the same form in the same browser.
                                <div>
                                <br />
                                </div>
                                <div>
                                This requires the attacker to have access to the victim's browser.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading663"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse663" aria-expanded="true" aria-controls="collapse663">Weakness: Information Exposure Through Browser Caching <span>[CWE-525]</span></button></h5></div><div id="collapse663" class="collapse" aria-labelledby="heading663" data-parent="#weaknesses"><div class="card-body">For each web page, the application should have an appropriate caching policy specifying the
                        extent to which the page and its form fields should be cached.
                        <br />
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading661"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse661" aria-expanded="true" aria-controls="collapse661">Countermeasure: Set Cache-Control headers on sensitive and authenticated content <span>[CWE-525-CACHING]</span></button></h5></div><div id="collapse661" class="collapse" aria-labelledby="heading661" data-parent="#controls"><div class="card-body"><div>
                        Browsers, servers, and upstream/intermediate devices may cache (temporarily store) data sent in
                        HTTP sessions for performance reasons. The protocol allows for a number of HTTP headers and
                        directives to control what data may be cached, where, and for how long. It is important that
                        cache-controls are specified to prevent exposure of sensitive data through inappropriate caching
                        of authenticated and otherwise restricted access data, either in the users browser or other
                        devices.
                        </div>
                        <div>
                        <ul>
                        <li>Configure the server or application to set cache-control headers on sensitive content.&nbsp;</li>
                        <li>The following headers are recommended:</li>
                        <ul>
                        <li>Expires: Tue, 03 Jul 2001 06:00:00 GMT 9.4</li>
                        <li>Last-Modified: {now} GMT</li>
                        <li>Cache-Control: no-store, no-cache, must-revalidate, max-age=0</li>
                        <li>Cache-Control: post-check=0, pre-check=0</li>
                        <li>Pragma: no-cache&nbsp;</li>
                        </ul>
                        </ul>
                        <div>
                        <br />
                        </div>
                        </div>
                        <div>
                        <br />
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading662"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse662" aria-expanded="true" aria-controls="collapse662">Countermeasure: Disable autocompletion of sensitive data <span>[CWE-525-WEB]</span></button></h5></div><div id="collapse662" class="collapse" aria-labelledby="heading662" data-parent="#controls"><div class="card-body"><div>
                        Auto-completion or pre-filling of sensitive details by the browser implies that those details
                        are stored in plaintext or a reversible format. This may be in violation of security
                        best-practice, or application security expectations. The application should attempt to mitigate
                        this risk by requesting the browser does not cache or store sensitive data such as credit card
                        PANs and CV2s, personally identifiable information (PII) or other secret data.
                        </div>
                        <div>
                        <ul>
                        <li>All forms handling sensitive data should be protected using the autocomplete=off HTML
                        directive at the form or field level.</li>
                        <li>Issue browser specific directives to request auto-fill or completion is disabled; The
                        AUTOCOMPLETE attribute should be set to &quot;OFF&quot;.</li>
                        </ul>
                        <div>
                        It should be noted that compliance with these requests at the client-side is optional, and many
                        browsers and clients override these directives to use operating system, browser, or third party
                        password managers or key-safes to store secrets.
                        </div>
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <br />
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading666"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse666" aria-expanded="true" aria-controls="collapse666">Weakness: Information Exposure Through Local Storage <span>[CWE-922]</span></button></h5></div><div id="collapse666" class="collapse" aria-labelledby="heading666" data-parent="#weaknesses"><div class="card-body">The software stores sensitive information without properly limiting read or write access by
                        unauthorized actors.&nbsp;
                        <div>
                        &nbsp;
                        <br />If read access is not properly restricted, then attackers can steal the sensitive
                        information. If write access is not properly restricted, then attackers can modify and possibly
                        delete the data, causing incorrect results and possibly a denial of service.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading664"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse664" aria-expanded="true" aria-controls="collapse664">Countermeasure: Do not store sensitive data on client side <span>[CWE-922]</span></button></h5></div><div id="collapse664" class="collapse" aria-labelledby="heading664" data-parent="#controls"><div class="card-body"><div>
                        Browsers and extensions provide a number of local storage options to persist data during HTTP
                        interactions, including (but not limited to) Cookies, HTML5 local storage, session storage,
                        IndexedDB, Flash! cookies, and Silverlight isolated storage. These storage options may all be
                        accessed by subsequent users of the browser or computer, and some have experienced security
                        vulnerabilities providing unauthorized and/or remote access to their contents. It is important
                        that sensitive, private, and otherwise restricted data is handled with care at the client-side,
                        and is not stored in insecure locations which may expose it to attack.
                        </div>
                        <div>
                        <ul>
                        <li>Do not store sensitive data in any kind of persistent, client-side storage.</li>
                        <li>Review any application or browser layer caching or temporary storage to ensure it
                        doesn't expose data.</li>
                        </ul>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading665"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse665" aria-expanded="true" aria-controls="collapse665">Countermeasure: Clear sensitive and authenticated data from client-side storage <span>[CWE-922-AUTH]</span></button></h5></div><div id="collapse665" class="collapse" aria-labelledby="heading665" data-parent="#controls"><div class="card-body"><div>
                        Sensitive data should not be persistently stored at the client-side due to the risk of exposure.
                        However, during normal application operation, authenticated and other sensitive data is passed,
                        stored in transient form, and displayed to users. It is important that any such temporary
                        storage is purged in a timely manner and actively at the end of a user session.
                        </div>
                        <div>
                        <ul>
                        <li>Sensitive data (including any authenticated content)&nbsp;stored on client side
                        objects such as the browser DOM should be cleared.</li>
                        <li>This data should be removed actively at the end of user session (e.g. using the logout
                        function), and where possible cleared through hard termination of the browser (e.g. closing the
                        window or tab without using the proper application function).</li>
                        <li>Ensure any storage used during application interaction is temporary, and automatically
                        cleared by the browser.</li>
                        <li>Where possible, set expiration times on client-side data to prevent accidental or
                        malicious storage or disclosure.</li>
                        </ul>
                        </div>
                        <div>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading670"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse670" aria-expanded="true" aria-controls="collapse670">Threat: Sensitive data is compromised through query parameters in the URL <span>[WEB-QUERY-PARAM]</span></button></h5></div><div id="collapse670" class="collapse" aria-labelledby="heading670" data-parent="#threats"><div class="card-body">Sensitive data directly put as a parameters on the URL could be easily leaked on logs,
                                browser history, etc.&nbsp;
                                <div>
                                <br />
                                </div>
                                <div>
                                And this information could be used by an attacker to gain access to the system or user
                                data.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading669"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse669" aria-expanded="true" aria-controls="collapse669">Weakness: The application sends sensitive information using the URL query string <span>[CWE-598]</span></button></h5></div><div id="collapse669" class="collapse" aria-labelledby="heading669" data-parent="#weaknesses"><div class="card-body">The web application uses the GET method to process requests that contain sensitive
                        information, which can expose that information through the browser's history, Referers, web
                        logs, and other sources.
                        <br />
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading668"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse668" aria-expanded="true" aria-controls="collapse668">Countermeasure: Ensure no sensitive data is sent in the URL <span>[CWE-598]</span></button></h5></div><div id="collapse668" class="collapse" aria-labelledby="heading668" data-parent="#controls"><div class="card-body"><div>
                        Data passed in the URL (address bar) between client and server is likely to be exposed in logs
                        on the server, or intermediate devices (such as proxies or other network devices), or in local
                        browser logs/history. A common mistake is, for example, to pass a SessionID value as a parameter
                        in the URL of a get request between hosts. To mitigate the risk of exposure of sensitive data,
                        it should only be sent in the body of an HTTP message (for example a POST request), or in the
                        HTTP headers (either standard headers such as the Cookie values, or a custom X- header).
                        </div>
                        <div>
                        <ul>
                        <li>Ensure sensitive, private, or otherwise restricted data is not sent in a URL value.</li>
                        <li>Pass data only in appropriately protected fields in the body or headers.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading675"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse675" aria-expanded="true" aria-controls="collapse675">Use case: Read or Post data <span>[READ OR POST DATA]</span></button></h5></div><div id="collapse675" class="collapse" aria-labelledby="heading675" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading674"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse674" aria-expanded="true" aria-controls="collapse674">Threat: Attackers could gain access to sensitive data through a too permissive CORS policy <span>[CWE-942-CORS_PERMISSIVE]</span></button></h5></div><div id="collapse674" class="collapse" aria-labelledby="heading674" data-parent="#threats"><div class="card-body"><p>An overly permissive policy file allows many of the same attacks seen in
                                Cross-Site Scripting.&nbsp;</p>
                                <p>Once the user has visited a malicious site, they are vulnerable to a variety of
                                attacks. The attacker could transfer private information, such as cookies that may
                                include session information, from the victim's machine to the attacker. The attacker
                                could send malicious requests to a web site on behalf of the victim, which could be
                                especially dangerous to the site if the victim has administrator privileges to manage
                                that site.</p>
                                <p>In many cases, the attack can be launched without the victim even being aware
                                of it.</p>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading673"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse673" aria-expanded="true" aria-controls="collapse673">Weakness: CORS Access-Control-Allow-Origin policy is set to * <span>[CWE-942-CORS_PERMISSIVE]</span></button></h5></div><div id="collapse673" class="collapse" aria-labelledby="heading673" data-parent="#weaknesses"><div class="card-body">The software uses a cross-domain policy file that includes domains that should not be trusted.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        A cross-domain policy file (&quot;crossdomain.xml&quot; in Flash and &quot;clientaccesspolicy.xml&quot;
                        in Silverlight) defines a whitelist of domains from which a server is allowed to make
                        cross-domain requests. When making a cross-domain request, the Flash or Silverlight client will
                        first look for the policy file on the target server. If it is found, and the domain hosting the
                        application is explicitly allowed to make requests, the request is made.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        Therefore, if a cross-domain policy file includes domains that should not be trusted, such as
                        when using wildcards, then the application could be attacked by these untrusted domains. An
                        overly permissive policy file allows many of the same attacks seen in Cross-Site Scripting
                        (CWE-79). Once the user has executed a malicious Flash or Silverlight application, they are
                        vulnerable to a variety of attacks. The attacker could transfer private information, such as
                        cookies that may include session information, from the victim's machine to the attacker. The
                        attacker could send malicious requests to a web site on behalf of the victim, which could be
                        especially dangerous to the site if the victim has administrator privileges to manage that
                        site.In many cases, the attack can be launched without the victim even being aware of it.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading672"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse672" aria-expanded="true" aria-controls="collapse672">Countermeasure: Restrict Cross Domain Origin policy through HTTP headers <span>[CWE-942-CORS]</span></button></h5></div><div id="collapse672" class="collapse" aria-labelledby="heading672" data-parent="#controls"><div class="card-body"><div>
                        If an overly permissive policy is specified then an attacker may be able to execute malicious
                        code hosted on a third party site in the victim's browser under the security trust of the
                        legitimate application. To prevent this:
                        </div>
                        <div>
                        <ul>
                        <li>Set the Access-Control-Allow-Origin header to only permit explicitly required trusted
                        domains.</li>
                        <li>This set should be as small as possible, and follow the 'least privilege' paradigm.</li>
                        <li>Do not use untrusted or tainted user-data from untrusted domains in CORS responses
                        without proper validation and sanitization.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading681"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse681" aria-expanded="true" aria-controls="collapse681">Risk pattern: Web Browser: JSON processing <span>[BROWSER:JSON]</span></button></h5></div><div id="collapse681" class="collapse" aria-labelledby="heading681" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading680"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse680" aria-expanded="true" aria-controls="collapse680">Use case: Read or Post data <span>[READ OR POST DATA]</span></button></h5></div><div id="collapse680" class="collapse" aria-labelledby="heading680" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading679"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse679" aria-expanded="true" aria-controls="collapse679">Threat: Attackers gain access to the system through Client Side Code Injection <span>[WEB-CLIENT-INJ]</span></button></h5></div><div id="collapse679" class="collapse" aria-labelledby="heading679" data-parent="#threats"><div class="card-body">If an attacker is able to mix controlled input with Client Side code he could direct
                                attacks to steal sensitive data from users.&nbsp;
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading678"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse678" aria-expanded="true" aria-controls="collapse678">Weakness: The application uses eval to parse JSON objects <span>[CWE-94]</span></button></h5></div><div id="collapse678" class="collapse" aria-labelledby="heading678" data-parent="#weaknesses"><div class="card-body">The software constructs all or part of a code segment using externally-influenced input from
                        an upstream component, but it does not neutralize or incorrectly neutralizes special elements
                        that could modify the syntax or behavior of the intended code segment.&nbsp;&nbsp;
                        <div>
                        &nbsp;
                        <br />When software allows a user's input to contain code syntax, it might be possible for
                        an attacker to craft the code in such a way that it will alter the intended control flow of the
                        software. Such an alteration could lead to arbitrary code execution.Injection problems encompass
                        a wide variety of issues -- all mitigated in very different ways.&nbsp;
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading677"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse677" aria-expanded="true" aria-controls="collapse677">Countermeasure: Use JSON.parse to safely parse JSON objects <span>[CWE-94]</span></button></h5></div><div id="collapse677" class="collapse" aria-labelledby="heading677" data-parent="#controls"><div class="card-body"><div>
                        AJAX requests used to pass data between the client- and server- can contain any data, including
                        malicious executable content. This data must be parsed in a safe manner to prevent malicious
                        code being executed to compromise the application or it's users. Utilizing eval based solutions
                        to process input data places the application at risk, as the malicious user has control over the
                        data passed to the eval function, and could execute arbitrary code as a result. JSON.parse
                        provides a means to convert the JSON payloads into an object without risk of execution.
                        </div>
                        <div>
                        <ul>
                        <li>Ensure all tainted and potentially malicious data is processed using JSON.parse.</li>
                        <li>Data should be validated and sanitized using appropriate syntactic and semantic
                        checks, ideally against a white-list of known-good input.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading690"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse690" aria-expanded="true" aria-controls="collapse690">Risk pattern: Web Browser: Session <span>[web-browser-session]</span></button></h5></div><div id="collapse690" class="collapse" aria-labelledby="heading690" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading689"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse689" aria-expanded="true" aria-controls="collapse689">Use case: Read or Post data <span>[READ OR POST DATA]</span></button></h5></div><div id="collapse689" class="collapse" aria-labelledby="heading689" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading688"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse688" aria-expanded="true" aria-controls="collapse688">Threat: Attackers could gain access to an open session, if they have access to a user's browser <span>[ASVS-2014-3.3]</span></button></h5></div><div id="collapse688" class="collapse" aria-labelledby="heading688" data-parent="#threats"><div class="card-body">If a user steps away from their browser for a few minutes and there is an
                                opportunity for
                                an attacker to access the browser, then they could gain access to the user's logged
                                in
                                session and perform operations on their behalf.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading685"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse685" aria-expanded="true" aria-controls="collapse685">Weakness: Insufficient Session Expiration <span>[CWE-613]</span></button></h5></div><div id="collapse685" class="collapse" aria-labelledby="heading685" data-parent="#weaknesses"><div class="card-body">Insufficient Session Expiration is when a web site permits an attacker to reuse old session credentials or session IDs for authorization.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading682"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse682" aria-expanded="true" aria-controls="collapse682">Countermeasure: Revoke user sessions after a period of inactivity <span>[ASVS-2014-3.3]</span></button></h5></div><div id="collapse682" class="collapse" aria-labelledby="heading682" data-parent="#controls"><div class="card-body"><div>
  Unattended authenticated sessions may be hijacked by a malicious user; for example on a shared terminal or an unlocked computer. 
</div> 
<div> 
 <ul> 
  <li>User sessions should be invalidated and terminated after a period of inactivity.</li> 
  <li>This period should be defined by the project; time limit of between 5 and 30 mins is common in most online applications. &nbsp;Shorter periods for high-security applications, or longer periods dictated by the work-flow may be appropriate.</li> 
  <li>The timeout should be triggered when the user is no longer interacting with the (web) application; e.g. the are no longer manually browsing or using the application functionality. Ensure that any background automated processes (e.g. heartbeats, pricing or data updates) are not considered activities that reset the timeout.</li> 
  <li>Session revocation must occur at the server-side; for example, the session associated with the session ID is terminated on the server, rather than simply resetting a client-side cookie containing the session ID.</li> 
 </ul> 
</div></div></div></div><div class="card border-success"><div class="card-header " id="heading683"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse683" aria-expanded="true" aria-controls="collapse683">Countermeasure: Revoke user sessions after a fixed time period <span>[ASVS-2014-3.4]</span></button></h5></div><div id="collapse683" class="collapse" aria-labelledby="heading683" data-parent="#controls"><div class="card-body"><div>
                        User sessions that remain active for extended periods can expose them to attacks, or provide
                        greater opportunities for a malicious actor to exploit a compromised session. &nbsp;For
                        example, cryptographic or brute-force attacks against a session ID may become practical in a
                        longer time-window. &nbsp;Similarly, if a user session has been compromised, an attacker may
                        forcibly keep that session alive to maintain a foothold in the application or environment. These
                        types of attack can be mitigated by setting a hard limit on user sessions, even where the user
                        is (or appears to be) actively using the application.
                        </div>
                        <div>
                        <ul>
                        <li>Invalidate all user sessions with the application after an extended period, even when
                        they appear active (e.g. after 24 hours the user should be warned to complete their tasks or
                        forced to re-authenticate)</li>
                        <li>Ensure session revocation is enforced at the server-side rather than the client-side;
                        for example, the session ID should be invalidated at the server rather than the client-side
                        cookie being deleted or changed.</li>
                        </ul>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading684"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse684" aria-expanded="true" aria-controls="collapse684">Countermeasure: Provide logout links on all pages that require authentication <span>[ASVS-2014-3.5]</span></button></h5></div><div id="collapse684" class="collapse" aria-labelledby="heading684" data-parent="#controls"><div class="card-body"><div>
                        Applications requiring users authenticate to access privileged, secret, or potentially sensitive
                        information or functionality must also allow users a clear way to terminate their access;
                        typically through a logout or log off option.
                        </div>
                        <ul>
                        <li>Provide clearly visible logout links/options on all pages after a user has logged in.&nbsp;</li>
                        <li>Ensure the user's session is terminated at the server-side, and not at the
                        client-side.</li>
                        </ul>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading687"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse687" aria-expanded="true" aria-controls="collapse687">Weakness: Insufficient Session Logout <span>[cwe-613-logout]</span></button></h5></div><div id="collapse687" class="collapse" aria-labelledby="heading687" data-parent="#weaknesses"><div class="card-body">Insufficient Session Expiration is when a web site permits an attacker to reuse old session
                        credentials or session IDs for authorization. &nbsp;
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading686"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse686" aria-expanded="true" aria-controls="collapse686">Countermeasure: Terminate user sessions on the server-side <span>[ASVS-3.2]</span></button></h5></div><div id="collapse686" class="collapse" aria-labelledby="heading686" data-parent="#controls"><div class="card-body"><div>
                        User sessions may end for a number of reasons; they may choose to log out, the session may be
                        subject to an active or inactive timeout, they may be logged out due to concurrency
                        restrictions, or the session may be revoked due to automated or manual intervention in response
                        to a security or other event (e.g. suspicious behavior or system maintenance).
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        In all cases, the user session must be terminated at the server-side, not solely at the
                        client-side (for example by deleting or reissuing a session ID token/cookie).
                        </div>
                        <div>
                        <ul>
                        <li>Revoke user sessions at the server-side.</li>
                        <li>Redirect users to the login page, or provide a login prompt to them in context.</li>
                        <li>Where possible, ensure the session is not reused by the application server.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading691"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse691" aria-expanded="true" aria-controls="collapse691">Risk pattern: Web Client <span>[WEB-CLIENT]</span></button></h5></div><div id="collapse691" class="collapse" aria-labelledby="heading691" data-parent="#components"><div class="card-body">A generic web client which is not a full browser<div class="accordion" id="usecases"></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading692"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse692" aria-expanded="true" aria-controls="collapse692">Risk pattern: Web Service <span>[WEB-SERVICE]</span></button></h5></div><div id="collapse692" class="collapse" aria-labelledby="heading692" data-parent="#components"><div class="card-body">Web Service<div class="accordion" id="usecases"></div></div></div></div></div></body></html>