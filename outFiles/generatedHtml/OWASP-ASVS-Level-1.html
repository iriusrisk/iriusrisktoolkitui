<html>
<head>
<title>Standard OWASP-ASVS-Level-1 from the library CS-Default, iot-security-compliance-framework</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
</head>
<body>
<h1 style="justify-content: center;text-align: center;font-weight: bold;">Standard 'OWASP-ASVS-Level-1' from the library 'CS-Default, iot-security-compliance-framework'</h1>
<div id="accordion">
<div class="card border">
<div id="heading1" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse1" aria-expanded="false" aria-controls="collapse1" class="btn btn-light btn-group-toggle">Requirement: Verify all pages and resources by default require authentication except those specifically intended to be public (Principle of complete mediation). [2.1]</button></h5></div>
<div id="collapse1" class="collapse" aria-labelledby="heading1" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent1">
<div class="card border-success">
<div id="heading2" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse2" aria-expanded="false" aria-controls="collapse2" class="btn btn-light btn-group-toggle">Countermeasure: Require authentication before presenting restricted data [CWE-306-SERVICE]</button></h5></div>
<div id="collapse2" class="collapse" aria-labelledby="heading2" data-parent="#parent1"><div class="card-body"><html><body>
<div>
                        The application should ensure users have undergone an Identification and Verification (ID&amp;V)
                        process before allowing access to secret, sensitive or otherwise restricted data. For less
                        sensitive but still restricted data, simple verification of the location of the user may suffice
                        (e.g. IP restrictions).
                        </div>
                        <div>
                        <ul>
                        <li>For non-sensitive but non-public data, access could be restricted by IP address, for
                        example limiting access to internal networks, workstations, or gateways</li>
                        <li>For more sensitive data, TLS client-side certificates may be appropriate</li>
                        <li>Where secret or other sensitive data is handled, a full authentication process to
                        identify and validate users with single or multi-factor authentication may be required</li>
                        </ul>
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        <div>
                        <ul>
                        </ul>
                        </div>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading3" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse3" aria-expanded="false" aria-controls="collapse3" class="btn btn-light btn-group-toggle">Countermeasure: Authenticate users (single factor authentication) [CWE-306-SF]</button></h5></div>
<div id="collapse3" class="collapse" aria-labelledby="heading3" data-parent="#parent1"><div class="card-body"><html><body>
<div>
                        The application should ensure users have undergone an Identification and Verification (ID&amp;V)
                        process before allowing access to secret, sensitive or otherwise restricted data. A common and
                        simple form is Single Factor Authentication, requiring the user asserts who they are, and
                        provides evidence (for example in the form of a previously established password or PIN).
                        </div>
                        <div>
                        <ul>
                        <li>Require users provide authentication credentials before accessing restricted
                        application data or functionality</li>
                        </ul>
                        </div>
                        <div>
                        <br>
                        </div>
                    </body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading4" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse4" aria-expanded="false" aria-controls="collapse4" class="btn btn-light btn-group-toggle">Requirement: Verify that forms containing credentials are not filled in by the application. Pre-filling by the application implies that credentials are stored in plaintext or a reversible format, which is explicitly prohibited.  [2.2]</button></h5></div>
<div id="collapse4" class="collapse" aria-labelledby="heading4" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent4"><div class="card border-success">
<div id="heading5" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse5" aria-expanded="false" aria-controls="collapse5" class="btn btn-light btn-group-toggle">Countermeasure: Disable authentication form autocomplete / pre-fill [CWE-312]</button></h5></div>
<div id="collapse5" class="collapse" aria-labelledby="heading5" data-parent="#parent4"><div class="card-body"><html><body>
<div>
                        Auto-completion or pre-filling of authentication details by the browser implies that credentials
                        are stored in plaintext or a reversible format. This may be in violation of security
                        best-practice, or application security expectations. The application should attempt to mitigate
                        this risk by requesting the browser does not cache or store credentials.
                        </div>
                        <div>
                        <ul>
                        <li>All forms handling sensitive data should be protected using the autocomplete=off HTML
                        directive at the form or field level.</li>
                        <li>Issue browser specific directives to request auto-fill or completion is disabled; The
                        AUTOCOMPLETE attribute should be set to "OFF".</li>
                        </ul>
                        <div>
                        It should be noted that compliance with these requests at the client-side is optional, and many
                        browsers and clients override these directives to use operating system, browser, or third party
                        password managers or key-safes to store secrets.
                        </div>
                        </div>
                        <div></div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading6" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse6" aria-expanded="false" aria-controls="collapse6" class="btn btn-light btn-group-toggle">Requirement: Verify all authentication controls are enforced on the server side. [2.4]</button></h5></div>
<div id="collapse6" class="collapse" aria-labelledby="heading6" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent6"><div class="card border-success">
<div id="heading7" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse7" aria-expanded="false" aria-controls="collapse7" class="btn btn-light btn-group-toggle">Countermeasure: Enforce authentication on the server-side [CWE-603]</button></h5></div>
<div id="collapse7" class="collapse" aria-labelledby="heading7" data-parent="#parent6"><div class="card-body"><html><body>
<div>
                        All data at the client-side must be considered tainted.  As such, decisions on
                        authentication (or Identification and Verification - ID&amp;V) must be made or validated at
                        the server-side to prevent their subversion.
                        </div>
                        <div>
                        <ul>
                        <li>Ensure credentials are passed securely from the client-to server.</li>
                        <li>The server should compare the credentials with those stored at the server-side (e.g.
                        the hashed password compared against those stored for the claimed identity).</li>
                        <li>Implement controls to mitigate brute-force attacks; for example through rate-limiting,
                        account lockouts, or escalating timeouts.</li>
                        <li>Once authenticated, a non-predictable and cryptographically secure token should be
                        passed securely to the client-side to validate further interaction with the server.</li>
                        <li>Messages returned to the user during authentication, in particular when the process
                        fails, should not reveal to the user whether the username was valid.  Returning generic
                        errors prevents an attacker enumerating valid account IDs for subsequent attacks.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading8" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse8" aria-expanded="false" aria-controls="collapse8" class="btn btn-light btn-group-toggle">Requirement: Verify all authentication controls fail securely to ensure attackers cannot log in. [2.6]</button></h5></div>
<div id="collapse8" class="collapse" aria-labelledby="heading8" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent8"><div class="card border-success">
<div id="heading9" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse9" aria-expanded="false" aria-controls="collapse9" class="btn btn-light btn-group-toggle">Countermeasure: Ensure authentication fails securely on the server-side [CWE-636]</button></h5></div>
<div id="collapse9" class="collapse" aria-labelledby="heading9" data-parent="#parent8"><div class="card-body"><html><body>
<div>
                        The authenticated state at the server-side should default to failed (fail closed). This prevents
                        attacks that subvert the authentication system by causing errors in the process at a point the
                        application considers the user to be authenticated without having logged in successfully (fail
                        open).
                        </div>
                        <div>
                        <ul>
                        <li>Unless the authentication process has completed successfully (i.e. the user has been
                        identified and the correct authentication credentials or tokens have been provided to verify
                        that identity), the status of any subsequent error path should be an authentication failure.</li>
                        </ul>
                        </div>
                        <div>
                        <br>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading10" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse10" aria-expanded="false" aria-controls="collapse10" class="btn btn-light btn-group-toggle">Requirement: Verify password entry fields allow, or encourage, the use of passphrases, and do not prevent password managers, long passphrases or highly complex passwords being entered. [2.7]</button></h5></div>
<div id="collapse10" class="collapse" aria-labelledby="heading10" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent10">
<div class="card border-success">
<div id="heading11" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse11" aria-expanded="false" aria-controls="collapse11" class="btn btn-light btn-group-toggle">Countermeasure: Require the use of strong passwords [CWE-521]</button></h5></div>
<div id="collapse11" class="collapse" aria-labelledby="heading11" data-parent="#parent10"><div class="card-body"><html><body>
<div>
                        Passwords used either as a sole verification credentials, or as part of a multi-factor
                        authentication, are a key aspect of application security, and strong password selection should
                        be encouraged and enforced. The application should allow flexibility in user password selection,
                        and enforce minimum criteria for password quality. This should include:
                        </div>
                        <div>
                        <ul>
                        <li>Minimum password length requirements, to mitigate brute-force and dictionary attacks.</li>
                        <li>Encourage use of pass-phrases using multiple words, achieving longer passwords more
                        resistant to attack.</li>
                        <li>Enforce use of mixed case, numeric and/or special characters to increase complexity.</li>
                        <li>Prevent or discourage use of dictionary words and common passwords through
                        black-lists. For example, a set of commonly used passwords can be found on SecLists at <a href="https://github.com/danielmiessler/SecLists/tree/master/Passwords">https://github.com/danielmiessler/SecLists/tree/master/Passwords</a> </li>
                        <div></div>
                        </ul>
                        </div>
                        <div>
                        <p><b>Password length</b></p>
                        <p>Password length considers the minimum and maximum length of characters comprising the
                        password of your users. For ease of changing this length, its implementation can be configurable
                        possibly using a properties file or xml configuration file.</p>
                        <ul>
                        <li>Minimum length. Passwords should be at least ten (10) characters long. Combining this
                        length with complexity makes a password difficult to guess and/or brute force.</li>
                        <li>Maximum length. People tend to forget their passwords easily. The longer the password,
                        the more likely people are to enter them incorrectly for the system. However, long pass-phrases
                        can be easily remembered, and should not be prevented through unnecessarily strict upper
                        restrictions on length.</li>
                        </ul>
                        <p><b>Password Complexity</b></p>
                        <ul>
                        <li>Password characters should be a combination of alphanumeric characters. Alphanumeric
                        characters consist of letters, numbers, punctuation marks, mathematical and other conventional
                        symbols.</li>
                        <li>For change and reset password functionality it is recommended a history of old
                        password (salted) hashes used. This can be used to prevent password reuse, or an attacker
                        alternating between a selection of passwords (Monday1, Tuesday2 etc.)</li>
                        <li>Actual passwords must not be stored, to protect them against brute forcing if the
                        database is compromised</li>
                        </ul>
                        </div>
                        <div>
                        <div>
                        <ul>
                        </ul>
                        <ul>
                        </ul>
                        </div>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading12" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse12" aria-expanded="false" aria-controls="collapse12" class="btn btn-light btn-group-toggle">Countermeasure: Require the use of strong passwords [CWE-521]</button></h5></div>
<div id="collapse12" class="collapse" aria-labelledby="heading12" data-parent="#parent10"><div class="card-body"><html><body>
<p>Passwords used either as a sole verification credentials, or as part of a multi-factor authentication, are a key aspect of application security, and strong password selection should be encouraged and enforced. The application should allow flexibility in user password selection, and enforce minimum criteria for password quality. This should include: </p> 
<p></p> 
<ul> 
 <li>Minimum password length requirements, to mitigate brute-force and dictionary attacks. </li> 
 <li>Encourage use of pass-phrases using multiple words, achieving longer passwords more resistant to attack. </li> 
 <li>Enforce use of mixed case, numeric and/or special characters to increase complexity. </li> 
 <li>Prevent or discourage use of dictionary words and common passwords through black-lists. For example, a set of commonly used passwords can be found on SecLists at <a href="https://github.com/danielmiessler/SecLists/tree/master/Passwords">https://github.com/danielmiessler/SecLists/tree/master/Passwords</a>
</li> 
</ul> 
<p></p> Password length Password length considers the minimum and maximum length of characters comprising the password of your users. For ease of changing this length, its implementation can be configurable possibly using a properties file or xml configuration file.  
<div> 
 <ul> 
  <li>Minimum length. Passwords should be at least ten (10) characters long. Combining this length with complexity makes a password difficult to guess and/or brute force. </li> 
  <li>Maximum length. People tend to forget their passwords easily. The longer the password, the more likely people are to enter them incorrectly for the system. However, long pass-phrases can be easily remembered, and should not be prevented through unnecessarily strict upper restrictions on length. Password Complexity </li> 
  <li>Password characters should be a combination of alphanumeric characters. Alphanumeric characters consist of letters, numbers, punctuation marks, mathematical and other conventional symbols. </li> 
  <li>For change and reset password functionality it is recommended a history of old password (salted) hashes used. This can be used to prevent password reuse, or an attacker alternating between a selection of passwords (Monday1, Tuesday2 etc.).</li> 
  <li>Actual passwords must not be stored, to protect them against brute forcing if the database is compromised.</li> 
 </ul> 
</div>
</body></html></div></div>
</div>
<div class="card border-success">
<div id="heading13" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse13" aria-expanded="false" aria-controls="collapse13" class="btn btn-light btn-group-toggle">Countermeasure: Require the use of strong passwords [CWE-521]</button></h5></div>
<div id="collapse13" class="collapse" aria-labelledby="heading13" data-parent="#parent10"><div class="card-body"><html><body>
<p>Passwords used either as a sole verification credentials, or as part of a multi-factor authentication, are a key aspect of application security, and strong password selection should be encouraged and enforced. The application should allow flexibility in user password selection, and enforce minimum criteria for password quality. This should include: </p> 
<p></p> 
<ul> 
 <li>Minimum password length requirements, to mitigate brute-force and dictionary attacks. </li> 
 <li>Encourage use of pass-phrases using multiple words, achieving longer passwords more resistant to attack. </li> 
 <li>Enforce use of mixed case, numeric and/or special characters to increase complexity. </li> 
 <li>Prevent or discourage use of dictionary words and common passwords through black-lists. For example, a set of commonly used passwords can be found on SecLists at <a href="https://github.com/danielmiessler/SecLists/tree/master/Passwords">https://github.com/danielmiessler/SecLists/tree/master/Passwords</a>
</li> 
</ul> 
<p></p> Password length Password length considers the minimum and maximum length of characters comprising the password of your users. For ease of changing this length, its implementation can be configurable possibly using a properties file or xml configuration file.  
<div> 
 <ul> 
  <li>
<b>Minimum length. </b>Passwords should be at least ten (10) characters long. Combining this length with complexity makes a password difficult to guess and/or brute force. </li> 
  <li>
<b>Maximum length.</b> People tend to forget their passwords easily. The longer the password, the more likely people are to enter them incorrectly for the system. However, long pass-phrases can be easily remembered, and should not be prevented through unnecessarily strict upper restrictions on length. </li> 
  <li>
<b>Password Complexity. </b>Password characters should be a combination of alphanumeric characters. Alphanumeric characters consist of letters, numbers, punctuation marks, mathematical and other conventional symbols. </li> 
  <li>For change and reset password functionality it is recommended a history of old password (salted) hashes used. This can be used to prevent password reuse, or an attacker alternating between a selection of passwords (Monday1, Tuesday2 etc.) </li> 
  <li>Actual passwords must not be stored, to protect them against brute forcing if the database is compromised.</li> 
 </ul> 
</div>
</body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading14" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse14" aria-expanded="false" aria-controls="collapse14" class="btn btn-light btn-group-toggle">Requirement: Verify that the changing password functionality includes the old password, the new password, and a password confirmation. [2.9]</button></h5></div>
<div id="collapse14" class="collapse" aria-labelledby="heading14" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent14"><div class="card border-success">
<div id="heading15" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse15" aria-expanded="false" aria-controls="collapse15" class="btn btn-light btn-group-toggle">Countermeasure: Offer a password change facility [CWE-255-PWD-CHANGE]</button></h5></div>
<div id="collapse15" class="collapse" aria-labelledby="heading15" data-parent="#parent14"><div class="card-body"><html><body>
<div>
                        Users must retain control of their credentials in a single factor system, and to facilitate this
                        they must have the ability to change their password. This is particularly important should the
                        user determine their password has been compromised, potentially allowing a third party to access
                        the system impersonating them. Furthermore, accountability is adversely affected where users
                        cannot change their passwords, as they can plausibly claim that even though they knew their
                        account credentials were compromised, there was no way for them to prevent unauthorized use of
                        the account.
                        </div>
                        <div>
                        <ul>
                        <li>Users should be allowed to change their passwords, ideally within the application</li>
                        <li>Password change should require re-authentication to prevent abuse of a compromised or
                        unattended session. I.e. the user should be required to enter their existing password in order
                        to change it.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading16" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse16" aria-expanded="false" aria-controls="collapse16" class="btn btn-light btn-group-toggle">Requirement: Verify that credentials are transported using a suitable encrypted link and that all pages/functions that require a user to enter credentials are done so using an encrypted link. [2.16]</button></h5></div>
<div id="collapse16" class="collapse" aria-labelledby="heading16" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent16"><div class="card border-success">
<div id="heading17" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse17" aria-expanded="false" aria-controls="collapse17" class="btn btn-light btn-group-toggle">Countermeasure: Encrypt data between the client and server/service [CWE-319-TRANSPORT]</button></h5></div>
<div id="collapse17" class="collapse" aria-labelledby="heading17" data-parent="#parent16"><div class="card-body"><html><body>
<div>
                        Data passed between the client and server should be protected by encryption in transit.
                        </div>
                        <div>
                        <ul>
                        <li>Implement cryptographically strong TLS end-to-end encryption between the client and
                        server, terminating within a secure environment on the server-side.</li>
                        <li>Consider use of client certificates to prevent interception of (or man-in-the-middle
                        attacks on) the encrypted connection.</li>
                        <li>Alternatively, asymmetric (public-key) encryption could be utilized, although a
                        recognized, proven, and tested implementation/library should be used</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading18" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse18" aria-expanded="false" aria-controls="collapse18" class="btn btn-light btn-group-toggle">Requirement: Verify that the forgotten password function and other recovery paths do not reveal the current password and that the new password is not sent in clear text to the user. [2.17]</button></h5></div>
<div id="collapse18" class="collapse" aria-labelledby="heading18" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent18"><div class="card border-success">
<div id="heading19" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse19" aria-expanded="false" aria-controls="collapse19" class="btn btn-light btn-group-toggle">Countermeasure: Implement Password reset email design best practices [CWE-311]</button></h5></div>
<div id="collapse19" class="collapse" aria-labelledby="heading19" data-parent="#parent18"><div class="card-body"><html><body>
<div>
                        <div>
                        The password/account recovery process must have equivalent security to the normal authentication
                        process. It should be resistant to brute-force or network monitoring attacks.
                        </div>
                        <div>
                        <ul>
                        <li>Passwords should not be sent in plain text (for example in an email), as they may be
                        intercepted or monitored.</li>
                        <li>Instead, the application should verify the user's identity, and leverage a
                        time-limited one-time password token (TOTP) from the user.</li>
                        <li>Alternatively, the application could require the user enters a soft-token (e.g. Google
                        authenticator), a mobile-push / SMS code, or previously established off-line recovery mechanism
                        (for example a list of pre-defined recovery codes). </li>
                        <li>It should be noted that use of a random value in an e-mail or SMS has known
                        weaknesses, and should be considered a less secure option.</li>
                        <li>When the user provides the token, the application should verify their identity (for
                        example through use of a 'secret question', or verification of recent activity or transaction
                        information).</li>
                        <li>The application should then require they choose a new password or phrase in line with
                        the chosen policy.</li>
                        </ul>
                        </div>
                        </div>
                        <div>
                        <ul>
                        </ul>
                        </div>
                        <div>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading20" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse20" aria-expanded="false" aria-controls="collapse20" class="btn btn-light btn-group-toggle">Requirement: Verify that information enumeration is not possible via login, password reset, or forgot account functionality. [2.18]</button></h5></div>
<div id="collapse20" class="collapse" aria-labelledby="heading20" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent20">
<div class="card border-success">
<div id="heading21" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse21" aria-expanded="false" aria-controls="collapse21" class="btn btn-light btn-group-toggle">Countermeasure: Ensure application errors do not reveal account status [CWE-204-USERNAME-LOGIN]</button></h5></div>
<div id="collapse21" class="collapse" aria-labelledby="heading21" data-parent="#parent20"><div class="card-body"><html><body>
<div>
                        Error messages can reveal information of use to an attacker, particularly in the case of
                        relating to login, registration and recovery processes.  Explicit errors stating
                        accounts are valid or not, or whether then are locked out are useful to an attacker in
                        enumerating usernames for subsequent attack. Even small variations in errors returned to the
                        user can be used to infer how the application operates, or enforces security controls.
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        To prevent a malicious user using error conditions to determine how the application functions in
                        order to subvert it:
                        </div>
                        <div>
                        <ul>
                        <li>Trap and log all known error conditions at the server-side</li>
                        <li>Create a generic trap for unexpected errors</li>
                        <li>E.g. Error messages during the login process should not disclose which authentication
                        token was incorrect, instead a generic message simply stating that authentication failed should
                        be displayed.</li>
                        <li>Ensure the error message returned to the user is generic, or contains only an
                        obfuscated reference that can be correlated with the logged errors at the server-side.  In
                        the case of applications delivered over HTTP, the HTTP header should also be generic to prevent
                        enumeration (e.g. all error pages should produce a consistent HTTP 500 error)</li>
                        </ul>
                        </div>
                        <div>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading22" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse22" aria-expanded="false" aria-controls="collapse22" class="btn btn-light btn-group-toggle">Countermeasure: Ensure application errors do not reveal user accounts [AUTH-ENUM-ERR-RECOV]</button></h5></div>
<div id="collapse22" class="collapse" aria-labelledby="heading22" data-parent="#parent20"><div class="card-body"><html><body>
<div>
                        Error messages can reveal information of use to an attacker. Explicit errors from the reset or
                        recovery process stating accounts are valid or not, or whether then are locked out are useful to
                        an attacker in enumerating usernames for subsequent attack. Even small variations in errors
                        returned to the user can be used to infer how the application operates, or enforces security
                        controls.
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        To prevent a malicious user using error conditions to determine valid accounts:
                        </div>
                        <div>
                        <ul>
                        <li>Trap and log all known error conditions at the server-side</li>
                        <li>Create a generic trap for unexpected errors</li>
                        <li>The response to the password recovery feature should be the same regardless of whether
                        the username, ID or email exists. For example, a message such as 'An email with further details
                        about the recovery process has been sent; if you do not receive an email, please contact
                        support' could be sent to prevent enumeration</li>
                        <li>Ensure the error message returned to the user is generic, or contains only an
                        obfuscated reference that can be correlated with the logged errors at the server-side.  In
                        the case of applications delivered over HTTP, the HTTP header should also be generic to prevent
                        enumeration (e.g. all error pages should produce a consistent HTTP 500 error)</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading23" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse23" aria-expanded="false" aria-controls="collapse23" class="btn btn-light btn-group-toggle">Countermeasure: Prevent username and email enumeration in the registration process [CWE-209-USERNAME-REG]</button></h5></div>
<div id="collapse23" class="collapse" aria-labelledby="heading23" data-parent="#parent20"><div class="card-body"><html><body>
<div>
                        Enumeration of usernames and/or email addresses within an application is a common attack, aiding
                        in conducting brute-force attacks against users, and with potential privacy issues where the
                        username is considered to be personally identifiable information (PII).
                        </div>
                        <div>
                        <ul>
                        <li>Messages returned to the user during the registration process should not reveal any
                        information about existing users of the system. For example, if a user attempts to register with
                        an email address that is already associated with a user, the application should not reveal this
                        to them.</li>
                        <li>To protect privacy and prevent user enumeration, the application should always respond
                        with the same message indicating an email has been sent to the user's address regardless of the
                        status of that email address or username, and direct them to follow the instructions therein to
                        complete the process.</li>
                        <li>Where the username or email address is already in use, the email can advise the user
                        of the recovery process.</li>
                        <li>Where the username and email are unique and new, the email can contain a link to
                        complete the process.</li>
                        </ul>
                        <div>
                        The prevents an attacker without access to the victim's email address from enumerating whether
                        they are registered in the application.
                        </div>
                        </div>
                    </body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading24" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse24" aria-expanded="false" aria-controls="collapse24" class="btn btn-light btn-group-toggle">Requirement: Verify there are no default passwords in use for the application framework or any components used by the application (such as 'admin/password'. [2.19]</button></h5></div>
<div id="collapse24" class="collapse" aria-labelledby="heading24" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent24"><div class="card border-success">
<div id="heading25" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse25" aria-expanded="false" aria-controls="collapse25" class="btn btn-light btn-group-toggle">Countermeasure: Remove default credentials and role-based accounts from the application [CWE-255]</button></h5></div>
<div id="collapse25" class="collapse" aria-labelledby="heading25" data-parent="#parent24"><div class="card-body"><html><body>
<div>
                        Security is often compromised through default or predictable account credentials, such as
                        'admin/admin'. Best-practice dictates that accounts are only enabled when required, do not have
                        common account names, and force users to choose unique strong passwords rather than using vendor
                        defaults.
                        </div>
                        <div>
                        <ul>
                        <li>Ensure all default application and software accounts are disabled or removed if not
                        required</li>
                        <li>Strong passwords should be set on accounts that are required, default credentials must
                        be changed.</li>
                        <li>Build application accounts from a least-privilege perspective. </li>
                        <ul>
                        <li>Accounts should only be enabled if required. </li>
                        <li>Users should have individual accounts rather than role-based ones (e.g. dave-admin,
                        sue-admin rather than a shared 'admin' user)</li>
                        </ul>
                        </ul>
                        </div>
                        <div>
                        <br>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading26" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse26" aria-expanded="false" aria-controls="collapse26" class="btn btn-light btn-group-toggle">Requirement: Verify that anti-automation is in place to prevent breached credential testing, brute forcing, and account lockout attacks. [2.20]</button></h5></div>
<div id="collapse26" class="collapse" aria-labelledby="heading26" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent26">
<div class="card border-success">
<div id="heading27" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse27" aria-expanded="false" aria-controls="collapse27" class="btn btn-light btn-group-toggle">Countermeasure: Implement application and network rate limiting [CWE-799]</button></h5></div>
<div id="collapse27" class="collapse" aria-labelledby="heading27" data-parent="#parent26"><div class="card-body"><html><body>
<div>
                        <div>
                        <div>
                        A number of attacks rely on brute-force techniques to send large volumes of requests to
                        enumerate or attempt to exploit flaws in an application, for example, sending common passwords
                        to multiple target accounts within an application. By profiling normal traffic volumes, and
                        applying rate limiting, the application can be built to actively mitigate such attacks.
                        </div>
                        <div>
                        <ul>
                        <li>Connection rate-limiting based on the source IP address can be used to restrict
                        attacks against the authentication or registration systems. Multiple failures (or attempts) from
                        a single IP should result in temporarily blocking or dropping traffic from the source. Note
                        however that some corporate and ISP environment may place multiple valid and discrete clients
                        behind the same IP address, resulting in false-positives.</li>
                        <li>Attackers may use botnets and other IP masking techniques to deliver attacks from
                        multiple sources to avoid IP based rate-limiting. To mitigate this class of attack, Indicators
                        of Compromise should be monitored (for example a higher rate of login failures than usual), and
                        appropriate actions taken. For example, when the application detects active brute-force attacks,
                        a Web Application Firewall (WAF) or other intermediate devices could be used to block attacks
                        sharing a signature from pattern matching or deep packet inspection (e.g. HTTP headers or common
                        passwords across multiple accounts). Similarly, the application could respond by requiring a
                        CAPTCHA, cookie, or Javascript challenge when an attack is detected.</li>
                        </ul>
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        Implement the mechanisms to lockout accounts:
                        </div>
                        <div>
                        <ul>
                        <li>When the application detects a set number of failure login attempts, the account shall
                        be locked for a certain time period.</li>
                        <li>When the application detects that an account is locked more times than usual, this
                        account shall be disabled. A disabled account shall only be restored by an administrator.</li>
                        <li>When the application detects active brute-force attacks, the application shall require
                        a CAPTCHA, cookie, or JavaScript challenge.</li>
                        </ul>
                        </div>
                        </div>
                        <div>
                        <ul>
                        </ul>
                        </div>
                        </div>
                        <div>
                        <ul>
                        </ul>
                        </div>
                        <div>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading28" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse28" aria-expanded="false" aria-controls="collapse28" class="btn btn-light btn-group-toggle">Countermeasure: Implement application and network rate limiting on the login function [CWE-799-LOGIN]</button></h5></div>
<div id="collapse28" class="collapse" aria-labelledby="heading28" data-parent="#parent26"><div class="card-body"><html><body>
<div>
                        <div>
                        <div>
                        A number of attacks rely on brute-force techniques to send large volumes of requests to
                        enumerate or attempt to exploit flaws in an application, for example, sending common passwords
                        to multiple target accounts within an application. By profiling normal traffic volumes, and
                        applying rate limiting, the application can be built to actively mitigate such attacks.
                        </div>
                        <div>
                        <ul>
                        <li>Connection rate-limiting based on the source IP address can be used to restrict
                        attacks against the authentication or registration systems. Multiple failures (or attempts) from
                        a single IP should result in temporarily blocking or dropping traffic from the source. Note
                        however that some corporate and ISP environment may place multiple valid and discrete clients
                        behind the same IP address, resulting in false-positives.</li>
                        <li>Attackers may use botnets and other IP masking techniques to deliver attacks from
                        multiple sources to avoid IP based rate-limiting. To mitigate this class of attack, Indicators
                        of Compromise should be monitored (for example a higher rate of login failures than usual), and
                        appropriate actions taken. For example, when the application detects active brute-force attacks,
                        a Web Application Firewall (WAF) or other intermediate devices could be used to block attacks
                        sharing a signature from pattern matching or deep packet inspection (e.g. HTTP headers or common
                        passwords across multiple accounts). Similarly, the application could respond by requiring a
                        CAPTCHA, cookie, or Javascript challenge when an attack is detected.</li>
                        </ul>
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        Implement the mechanisms to lockout accounts:
                        </div>
                        <div>
                        <ul>
                        <li>When the application detects a set number of failure login attempts, the account shall
                        be locked for a certain time period.</li>
                        <li>When the application detects that an account is locked more times than usual, this
                        account shall be disabled. A disabled account shall only be restored by an administrator.</li>
                        <li>When the application detects active brute-force attacks, the application shall require
                        a CAPTCHA, cookie, or JavaScript challenge.</li>
                        </ul>
                        </div>
                        </div>
                        </div>
                        <div>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading29" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse29" aria-expanded="false" aria-controls="collapse29" class="btn btn-light btn-group-toggle">Countermeasure: Implement application and network rate limiting [CWE-799]</button></h5></div>
<div id="collapse29" class="collapse" aria-labelledby="heading29" data-parent="#parent26"><div class="card-body"><html><body>
<p>A number of attacks rely on brute-force techniques to send large volumes of requests to enumerate or attempt to exploit flaws in an application, for example, sending common passwords to multiple target accounts within an application. By profiling normal traffic volumes, and applying rate limiting, the application can be built to actively mitigate such attacks.</p> 
<p></p> 
<ul> 
 <li>Connection rate-limiting based on the source IP address can be used to restrict attacks against the authentication or registration systems. Multiple failures (or attempts) from a single IP should result in temporarily blocking or dropping traffic from the source. Note however that some corporate and <span class="caps">ISP</span> environment may place multiple valid and discrete clients behind the same IP address, resulting in false-positives. </li> 
 <li>Attackers may use botnets and other IP masking techniques to deliver attacks from multiple sources to avoid IP based rate-limiting. To mitigate this class of attack, Indicators of Compromise should be monitored (for example a higher rate of login failures than usual), and appropriate actions taken. For example, when the application detects active brute-force attacks, a Web Application Firewall (<span class="caps">WAF</span>) or other intermediate devices could be used to block attacks sharing a signature from pattern matching or deep packet inspection (e.g. <span class="caps">HTTP</span> headers or common passwords across multiple accounts). Similarly, the application could respond by requiring a <span class="caps">CAPTCHA</span>, cookie, or Javascript challenge when an attack is detected.</li> 
</ul> 
<p></p> 
<b><font size="4"> Remediation:</font></b> 
<div> 
 <b><font size="4"></font></b>Implement the mechanisms to lockout accounts:  
</div> 
<div> 
 <ul> 
  <li>When the application detects a set number of failure login attempts, the account shall be locked for a certain time period. </li> 
  <li>When the application detects that an account is locked more times than usual, this account shall be disabled. A disabled account shall only be restored by an administrator. </li> 
  <li>When the application detects active brute-force attacks, the application shall require a <span class="caps">CAPTCHA</span>, cookie, or JavaScript challenge.</li> 
 </ul> 
</div>
</body></html></div></div>
</div>
<div class="card border-success">
<div id="heading30" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse30" aria-expanded="false" aria-controls="collapse30" class="btn btn-light btn-group-toggle">Countermeasure: Implement application and network rate limiting on the login function [CWE-799-LOGIN]</button></h5></div>
<div id="collapse30" class="collapse" aria-labelledby="heading30" data-parent="#parent26"><div class="card-body"><html><body>
<p>A number of attacks rely on brute-force techniques to send large volumes of requests to enumerate or attempt to exploit flaws in an application, for example, sending common passwords to multiple target accounts within an application. By profiling normal traffic volumes, and applying rate limiting, the application can be built to actively mitigate such attacks. </p> 
<p></p> 
<ul> 
 <li>Connection rate-limiting based on the source IP address can be used to restrict attacks against the authentication or registration systems. Multiple failures (or attempts) from a single IP should result in temporarily blocking or dropping traffic from the source. Note however that some corporate and <span class="caps">ISP</span> environment may place multiple valid and discrete clients behind the same IP address, resulting in false-positives. </li> 
 <li>Attackers may use botnets and other IP masking techniques to deliver attacks from multiple sources to avoid IP based rate-limiting. To mitigate this class of attack, Indicators of Compromise should be monitored (for example a higher rate of login failures than usual), and appropriate actions taken. For example, when the application detects active brute-force attacks, a Web Application Firewall (<span class="caps">WAF</span>) or other intermediate devices could be used to block attacks sharing a signature from pattern matching or deep packet inspection (e.g. <span class="caps">HTTP</span> headers or common passwords across multiple accounts). Similarly, the application could respond by requiring a <span class="caps">CAPTCHA</span>, cookie, or Javascript challenge when an attack is detected.</li> 
</ul> 
<p></p> 
<font size="4"><b> Remediation: </b></font> 
<div>
  Implement the mechanisms to lockout accounts:  
</div> 
<div> 
 <ul> 
  <li>When the application detects a set number of failure login attempts, the account shall be locked for a certain time period. </li> 
  <li>When the application detects that an account is locked more times than usual, this account shall be disabled. A disabled account shall only be restored by an administrator. </li> 
  <li>When the application detects active brute-force attacks, the application shall require a <span class="caps">CAPTCHA</span>, cookie, or JavaScript challenge.</li> 
 </ul> 
</div>
</body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading31" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse31" aria-expanded="false" aria-controls="collapse31" class="btn btn-light btn-group-toggle">Requirement: Verify that forgotten password and other recovery paths use a TOTP or other soft token, mobile push, or other offline recovery mechanism. Use of a random value in an e-mail or SMS should be a last resort and is known weak. [2.22]</button></h5></div>
<div id="collapse31" class="collapse" aria-labelledby="heading31" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent31"><div class="card border-success">
<div id="heading32" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse32" aria-expanded="false" aria-controls="collapse32" class="btn btn-light btn-group-toggle">Countermeasure: Use a secure recovery token to reset an account password (such as a TOTP) [CSD-PWD-OFF-CHAN]</button></h5></div>
<div id="collapse32" class="collapse" aria-labelledby="heading32" data-parent="#parent31"><div class="card-body"><html><body>
<div>
                        The password/account recovery process must have equivalent security to the normal authentication
                        process. It should be resistant to brute-force or network monitoring attacks.
                        </div>
                        <div>
                        <ul>
                        <li>Having identified the user through secret questions/answers, the application should
                        proceed with a secure reset process.</li>
                        <li>Passwords should not be sent in plain text (for example in an email), as they may be
                        intercepted or monitored.</li>
                        <li>Instead, the application should verify the user's identity, and use a time-limited one
                        time password token (TOTP) from the user.</li>
                        <li>Alternatively, the application could require the user enters a soft-token (e.g. Google
                        authenticator), a mobile-push / SMS code, or previously established off-line recovery mechanism
                        (for example a list of pre-defined recovery codes). It should be noted that use of a random
                        value in an e-mail or SMS has known weaknesses, and should be considered a less secure option.</li>
                        <li>When the user provides the token, the application should verify their identity (for
                        example through use of a 'secret question', or verification of recent activity or transaction
                        information).</li>
                        <li>The application should then require they choose a new password or phrase in line with
                        the chosen policy.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading33" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse33" aria-expanded="false" aria-controls="collapse33" class="btn btn-light btn-group-toggle">Requirement: Verify that if shared knowledge based questions (also known as "secret questions") are required, the questions do not violate privacy laws and are sufficiently strong to protect accounts from malicious recovery.  [2.24]</button></h5></div>
<div id="collapse33" class="collapse" aria-labelledby="heading33" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent33"><div class="card border-success">
<div id="heading34" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse34" aria-expanded="false" aria-controls="collapse34" class="btn btn-light btn-group-toggle">Countermeasure: Security questions must not violate privacy laws and processes must provide equivalent security to normal authentication [CSD_PWD-REC-Q]</button></h5></div>
<div id="collapse34" class="collapse" aria-labelledby="heading34" data-parent="#parent33"><div class="card-body"><html><body>
<div>
                        It is common for application to utilize 'security questions' as additional identity verification
                        steps in the registration, authentication, and recovery processes. While these questions provide
                        additional assurance, they should not be considered a true secret, or of equal security to the
                        user's password. Furthermore, it is important that laws and legislation around private and
                        personally identifiable information (PII) are observed, and the risk of disclosure of the
                        security questions and answers should be considered.
                        </div>
                        <div>
                        <ul>
                        <li>Ensure the security questions do not violate privacy laws (e.g. asking for a SSN or
                        Cardholder Data)</li>
                        <li>Questions and answers must be prevent from malicious recovery (e.g. enumeration or
                        brute-force attacks)</li>
                        <li>The questions, and processes in which they are used, must be strong enough to provide
                        equivalence to the main authentication process.</li>
                        <li>Processes involving the security questions must prevent an attacker with publicly
                        available (or common personal) information about the victim from accessing their account. For
                        example, date of birth, place of birth, birthdate, and mother's maiden name are common pieces of
                        security information that are not truly secret.</li>
                        <li>Consider allowing the user to define their own security questions (challenges) and
                        answers (responses) with guidance.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading35" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse35" aria-expanded="false" aria-controls="collapse35" class="btn btn-light btn-group-toggle">Requirement: Verify that risk based re-authentication, two factor or transaction signing is in place for high value transactions.  [2.26]</button></h5></div>
<div id="collapse35" class="collapse" aria-labelledby="heading35" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent35"><div class="card border-success">
<div id="heading36" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse36" aria-expanded="false" aria-controls="collapse36" class="btn btn-light btn-group-toggle">Countermeasure: Require additional authentication for sensitive operations / high value transactions [CSD-SESS-REAUTH]</button></h5></div>
<div id="collapse36" class="collapse" aria-labelledby="heading36" data-parent="#parent35"><div class="card-body"><html><body>
<div>
                        Having gained access to an account, for example through session hijack or cross-site scripting,
                        an attack can compromise data and functionality accessible to the victim. This may include
                        elevated privilege or sensitive data and functionality, such as changing passwords, creating
                        accounts, or transferring funds.
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        These functions and data should be further protected from attack using a risk-based
                        authentication model requiring re-authentication, multi-factor authentication, or use of a token
                        to sign transactions or operations.
                        </div>
                        <div>
                        <ul>
                        <li>Implement re-authentication on key functions (such as requiring the old password
                        before setting a new one).</li>
                        <li>Use secondary authentication such as a transaction PIN to allow financial transfers.</li>
                        <li>Critical administrative functionality should require multi-factor authentication (such
                        as a hard or soft token).</li>
                        <li>Consider use of signing technologies or tokens that enable the server-side to verify
                        the authenticity of a request and mitigate Man in the Middle (MiTM) or Man in the Browser (MiTB)
                        attacks.</li>
                        </ul>
                        </div>
                        <div>
                        <br>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading37" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse37" aria-expanded="false" aria-controls="collapse37" class="btn btn-light btn-group-toggle">Requirement: Verify that measures are in place to block the use of commonly chosen passwords and weak passphrases. [2.27]</button></h5></div>
<div id="collapse37" class="collapse" aria-labelledby="heading37" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent37">
<div class="card border-success">
<div id="heading38" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse38" aria-expanded="false" aria-controls="collapse38" class="btn btn-light btn-group-toggle">Countermeasure: Require the use of strong passwords [CWE-521]</button></h5></div>
<div id="collapse38" class="collapse" aria-labelledby="heading38" data-parent="#parent37"><div class="card-body"><html><body>
<div>
                        Passwords used either as a sole verification credentials, or as part of a multi-factor
                        authentication, are a key aspect of application security, and strong password selection should
                        be encouraged and enforced. The application should allow flexibility in user password selection,
                        and enforce minimum criteria for password quality. This should include:
                        </div>
                        <div>
                        <ul>
                        <li>Minimum password length requirements, to mitigate brute-force and dictionary attacks.</li>
                        <li>Encourage use of pass-phrases using multiple words, achieving longer passwords more
                        resistant to attack.</li>
                        <li>Enforce use of mixed case, numeric and/or special characters to increase complexity.</li>
                        <li>Prevent or discourage use of dictionary words and common passwords through
                        black-lists. For example, a set of commonly used passwords can be found on SecLists at <a href="https://github.com/danielmiessler/SecLists/tree/master/Passwords">https://github.com/danielmiessler/SecLists/tree/master/Passwords</a> </li>
                        <div></div>
                        </ul>
                        </div>
                        <div>
                        <p><b>Password length</b></p>
                        <p>Password length considers the minimum and maximum length of characters comprising the
                        password of your users. For ease of changing this length, its implementation can be configurable
                        possibly using a properties file or xml configuration file.</p>
                        <ul>
                        <li>Minimum length. Passwords should be at least ten (10) characters long. Combining this
                        length with complexity makes a password difficult to guess and/or brute force.</li>
                        <li>Maximum length. People tend to forget their passwords easily. The longer the password,
                        the more likely people are to enter them incorrectly for the system. However, long pass-phrases
                        can be easily remembered, and should not be prevented through unnecessarily strict upper
                        restrictions on length.</li>
                        </ul>
                        <p><b>Password Complexity</b></p>
                        <ul>
                        <li>Password characters should be a combination of alphanumeric characters. Alphanumeric
                        characters consist of letters, numbers, punctuation marks, mathematical and other conventional
                        symbols.</li>
                        <li>For change and reset password functionality it is recommended a history of old
                        password (salted) hashes used. This can be used to prevent password reuse, or an attacker
                        alternating between a selection of passwords (Monday1, Tuesday2 etc.)</li>
                        <li>Actual passwords must not be stored, to protect them against brute forcing if the
                        database is compromised</li>
                        </ul>
                        </div>
                        <div>
                        <div>
                        <ul>
                        </ul>
                        <ul>
                        </ul>
                        </div>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading39" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse39" aria-expanded="false" aria-controls="collapse39" class="btn btn-light btn-group-toggle">Countermeasure: Require the use of strong passwords [CWE-521]</button></h5></div>
<div id="collapse39" class="collapse" aria-labelledby="heading39" data-parent="#parent37"><div class="card-body"><html><body>
<p>Passwords used either as a sole verification credentials, or as part of a multi-factor authentication, are a key aspect of application security, and strong password selection should be encouraged and enforced. The application should allow flexibility in user password selection, and enforce minimum criteria for password quality. This should include: </p> 
<p></p> 
<ul> 
 <li>Minimum password length requirements, to mitigate brute-force and dictionary attacks. </li> 
 <li>Encourage use of pass-phrases using multiple words, achieving longer passwords more resistant to attack. </li> 
 <li>Enforce use of mixed case, numeric and/or special characters to increase complexity. </li> 
 <li>Prevent or discourage use of dictionary words and common passwords through black-lists. For example, a set of commonly used passwords can be found on SecLists at <a href="https://github.com/danielmiessler/SecLists/tree/master/Passwords">https://github.com/danielmiessler/SecLists/tree/master/Passwords</a>
</li> 
</ul> 
<p></p> Password length Password length considers the minimum and maximum length of characters comprising the password of your users. For ease of changing this length, its implementation can be configurable possibly using a properties file or xml configuration file.  
<div> 
 <ul> 
  <li>Minimum length. Passwords should be at least ten (10) characters long. Combining this length with complexity makes a password difficult to guess and/or brute force. </li> 
  <li>Maximum length. People tend to forget their passwords easily. The longer the password, the more likely people are to enter them incorrectly for the system. However, long pass-phrases can be easily remembered, and should not be prevented through unnecessarily strict upper restrictions on length. Password Complexity </li> 
  <li>Password characters should be a combination of alphanumeric characters. Alphanumeric characters consist of letters, numbers, punctuation marks, mathematical and other conventional symbols. </li> 
  <li>For change and reset password functionality it is recommended a history of old password (salted) hashes used. This can be used to prevent password reuse, or an attacker alternating between a selection of passwords (Monday1, Tuesday2 etc.).</li> 
  <li>Actual passwords must not be stored, to protect them against brute forcing if the database is compromised.</li> 
 </ul> 
</div>
</body></html></div></div>
</div>
<div class="card border-success">
<div id="heading40" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse40" aria-expanded="false" aria-controls="collapse40" class="btn btn-light btn-group-toggle">Countermeasure: Require the use of strong passwords [CWE-521]</button></h5></div>
<div id="collapse40" class="collapse" aria-labelledby="heading40" data-parent="#parent37"><div class="card-body"><html><body>
<p>Passwords used either as a sole verification credentials, or as part of a multi-factor authentication, are a key aspect of application security, and strong password selection should be encouraged and enforced. The application should allow flexibility in user password selection, and enforce minimum criteria for password quality. This should include: </p> 
<p></p> 
<ul> 
 <li>Minimum password length requirements, to mitigate brute-force and dictionary attacks. </li> 
 <li>Encourage use of pass-phrases using multiple words, achieving longer passwords more resistant to attack. </li> 
 <li>Enforce use of mixed case, numeric and/or special characters to increase complexity. </li> 
 <li>Prevent or discourage use of dictionary words and common passwords through black-lists. For example, a set of commonly used passwords can be found on SecLists at <a href="https://github.com/danielmiessler/SecLists/tree/master/Passwords">https://github.com/danielmiessler/SecLists/tree/master/Passwords</a>
</li> 
</ul> 
<p></p> Password length Password length considers the minimum and maximum length of characters comprising the password of your users. For ease of changing this length, its implementation can be configurable possibly using a properties file or xml configuration file.  
<div> 
 <ul> 
  <li>
<b>Minimum length. </b>Passwords should be at least ten (10) characters long. Combining this length with complexity makes a password difficult to guess and/or brute force. </li> 
  <li>
<b>Maximum length.</b> People tend to forget their passwords easily. The longer the password, the more likely people are to enter them incorrectly for the system. However, long pass-phrases can be easily remembered, and should not be prevented through unnecessarily strict upper restrictions on length. </li> 
  <li>
<b>Password Complexity. </b>Password characters should be a combination of alphanumeric characters. Alphanumeric characters consist of letters, numbers, punctuation marks, mathematical and other conventional symbols. </li> 
  <li>For change and reset password functionality it is recommended a history of old password (salted) hashes used. This can be used to prevent password reuse, or an attacker alternating between a selection of passwords (Monday1, Tuesday2 etc.) </li> 
  <li>Actual passwords must not be stored, to protect them against brute forcing if the database is compromised.</li> 
 </ul> 
</div>
</body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading41" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse41" aria-expanded="false" aria-controls="collapse41" class="btn btn-light btn-group-toggle">Requirement: Verify that administrative interfaces are not accessible to untrusted parties. [2.32]</button></h5></div>
<div id="collapse41" class="collapse" aria-labelledby="heading41" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent41">
<div class="card border-success">
<div id="heading42" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse42" aria-expanded="false" aria-controls="collapse42" class="btn btn-light btn-group-toggle">Countermeasure: Restrict access to administrative interfaces [CSD-ADM-TRUST]</button></h5></div>
<div id="collapse42" class="collapse" aria-labelledby="heading42" data-parent="#parent41"><div class="card-body"><html><body>
<div>
                        <div>
                        Restrict access to administrative interfaces to trusted actors from trusted locations to reduce
                        the application attack surface and likelihood of compromise.
                        </div>
                        </div>
                        <div>
                        <ul>
                        <li>Restrict administrative access to specific networks or hosts.</li>
                        <li>Use strong authentication for privileged access, for example a 2FA.</li>
                        </ul>
                        </div>
                        <div></div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading43" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse43" aria-expanded="false" aria-controls="collapse43" class="btn btn-light btn-group-toggle">Countermeasure: Restrict access to administrative interfaces [CSD-ADM-TRUST]</button></h5></div>
<div id="collapse43" class="collapse" aria-labelledby="heading43" data-parent="#parent41"><div class="card-body"><html><body>
<p></p> 
<ul> 
 <li>Restrict access to administrative interfaces to trusted actors from trusted locations to reduce the application attack surface and likelihood of compromise. </li> 
 <li>Restrict administrative access to specific networks or hosts. </li> 
 <li>Use strong authentication for privileged access, for example a 2FA.</li> 
</ul> 
<p></p>
</body></html></div></div>
</div>
<div class="card border-success">
<div id="heading44" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse44" aria-expanded="false" aria-controls="collapse44" class="btn btn-light btn-group-toggle">Countermeasure: Restrict access to administrative interfaces [CSD-ADM-TRUST]</button></h5></div>
<div id="collapse44" class="collapse" aria-labelledby="heading44" data-parent="#parent41"><div class="card-body"><html><body>
<p>Restrict access to administrative interfaces to trusted actors from trusted locations to reduce the application attack surface and likelihood of compromise.</p> 
<p>Restrict administrative access to specific networks or hosts. </p> 
<div>
  Use strong authentication for privileged access, for example a 2FA. 
</div>
</body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading45" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse45" aria-expanded="false" aria-controls="collapse45" class="btn btn-light btn-group-toggle">Requirement: Browser autocomplete, and integration with password managers are permitted unless prohibited by risk based policy. [2.33]</button></h5></div>
<div id="collapse45" class="collapse" aria-labelledby="heading45" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent45"><div class="card border-success">
<div id="heading46" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse46" aria-expanded="false" aria-controls="collapse46" class="btn btn-light btn-group-toggle">Countermeasure: Disable authentication form autocomplete [CWE-525-AUTOCOMPLETE-FORM]</button></h5></div>
<div id="collapse46" class="collapse" aria-labelledby="heading46" data-parent="#parent45"><div class="card-body"><html><body>
<div>
                        Auto-completion or pre-filling of authentication details by the browser implies that credentials
                        are stored in plaintext or a reversible format. This may be in violation of security
                        best-practice, or application security expectations. The application should attempt to mitigate
                        this risk by requesting the browser does not cache or store credentials.
                        </div>
                        <div>
                        <ul>
                        <li>All forms handling sensitive data should be protected using the autocomplete=off HTML
                        directive at the form or field level.</li>
                        <li>Issue browser specific directives to request auto-fill or completion is disabled; The
                        AUTOCOMPLETE attribute should be set to "OFF".</li>
                        </ul>
                        <div>
                        It should be noted that compliance with these requests at the client-side is optional, and many
                        browsers and clients override these directives to use operating system, browser, or third party
                        password managers or key-safes to store secrets.
                        </div>
                        </div>
                        <div>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading47" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse47" aria-expanded="false" aria-controls="collapse47" class="btn btn-light btn-group-toggle">Requirement: Verify that there is no custom session manager, or that the custom session manager is resistant against all common session management attacks. [3.1]</button></h5></div>
<div id="collapse47" class="collapse" aria-labelledby="heading47" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent47"><div class="card border-success">
<div id="heading48" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse48" aria-expanded="false" aria-controls="collapse48" class="btn btn-light btn-group-toggle">Countermeasure: Use the session management functionality provided by the web framework [ASVS-3.1]</button></h5></div>
<div id="collapse48" class="collapse" aria-labelledby="heading48" data-parent="#parent47"><div class="card-body"><html><body>
<div>
                        Server side frameworks often provide session management facilities that will automatically
                        generate and manage a cryptographically strong session ID value.
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        Verify that the framework in use offers this facility and that the session ID generated is
                        cryptographically strong.
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading49" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse49" aria-expanded="false" aria-controls="collapse49" class="btn btn-light btn-group-toggle">Requirement: Verify that sessions are invalidated when the user logs out. [3.2]</button></h5></div>
<div id="collapse49" class="collapse" aria-labelledby="heading49" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent49">
<div class="card border-success">
<div id="heading50" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse50" aria-expanded="false" aria-controls="collapse50" class="btn btn-light btn-group-toggle">Countermeasure: Terminate user sessions on the server-side after a logout operation [CWE-613-LOGOUT]</button></h5></div>
<div id="collapse50" class="collapse" aria-labelledby="heading50" data-parent="#parent49"><div class="card-body"><html><body>
<div>
                        When a user chooses to log out (or otherwise has their session terminated), the user session
                        must be terminated at the server-side, not solely at the client-side (for example by deleting or
                        reissuing a session ID token/cookie).
                        </div>
                        <div>
                        <ul>
                        <li>Revoke user sessions at the server-side.</li>
                        <li>Redirect users to the login page, or provide a login prompt to them in context.</li>
                        <li>Where possible, ensure the session is not reused by the application server.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading51" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse51" aria-expanded="false" aria-controls="collapse51" class="btn btn-light btn-group-toggle">Countermeasure: Terminate user sessions on the server-side [ASVS-3.2]</button></h5></div>
<div id="collapse51" class="collapse" aria-labelledby="heading51" data-parent="#parent49"><div class="card-body"><html><body>
<div>
                        User sessions may end for a number of reasons; they may choose to log out, the session may be
                        subject to an active or inactive timeout, they may be logged out due to concurrency
                        restrictions, or the session may be revoked due to automated or manual intervention in response
                        to a security or other event (e.g. suspicious behavior or system maintenance).
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        In all cases, the user session must be terminated at the server-side, not solely at the
                        client-side (for example by deleting or reissuing a session ID token/cookie).
                        </div>
                        <div>
                        <ul>
                        <li>Revoke user sessions at the server-side.</li>
                        <li>Redirect users to the login page, or provide a login prompt to them in context.</li>
                        <li>Where possible, ensure the session is not reused by the application server.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading52" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse52" aria-expanded="false" aria-controls="collapse52" class="btn btn-light btn-group-toggle">Requirement: Verify that sessions timeout after a specified period of inactivity. [3.3]</button></h5></div>
<div id="collapse52" class="collapse" aria-labelledby="heading52" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent52">
<div class="card border-success">
<div id="heading53" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse53" aria-expanded="false" aria-controls="collapse53" class="btn btn-light btn-group-toggle">Countermeasure: Revoke user sessions after a period of inactivity [ASVS-2014-3.3]</button></h5></div>
<div id="collapse53" class="collapse" aria-labelledby="heading53" data-parent="#parent52"><div class="card-body"><html><body>
<div>
                        Unattended authenticated sessions may be hijacked by a malicious user; for example on a shared
                        terminal or an unlocked computer.
                        </div>
                        <div>
                        <ul>
                        <li>User sessions should be invalidated and terminated after a period of inactivity.</li>
                        <li>This period should be defined by the project; time limit of between 5 and 30 mins is
                        common in most online applications.  Shorter periods for high-security applications, or
                        longer periods dictated by the work-flow may be appropriate.</li>
                        <li>The timeout should be triggered when the user is no longer interacting with the (web)
                        application; e.g. the are no longer manually browsing or using the application functionality.
                        Ensure that any background automated processes (e.g. heartbeats, pricing or data updates) are
                        not considered activities that reset the timeout.</li>
                        <li>Session revocation must occur at the server-side; for example, the session associated
                        with the session ID is terminated on the server, rather than simply resetting a client-side
                        cookie containing the session ID.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading54" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse54" aria-expanded="false" aria-controls="collapse54" class="btn btn-light btn-group-toggle">Countermeasure: Revoke user sessions after a period of inactivity [ASVS-2014-3.3]</button></h5></div>
<div id="collapse54" class="collapse" aria-labelledby="heading54" data-parent="#parent52"><div class="card-body"><html><body>
<p>Unattended authenticated sessions may be hijacked by a malicious user; for example on a shared terminal or an unlocked computer.</p> 
<p></p> 
<ul> 
 <li> User sessions should be invalidated and terminated after a period of inactivity. </li> 
 <li>This period should be defined by the project; time limit of between 5 and 30 mins is common in most online applications. Shorter periods for high-security applications, or longer periods dictated by the workflow may be appropriate. </li> 
 <li>The timeout should be triggered when the user is no longer interacting with the (web) application; e.g. the are no longer manually browsing or using the application functionality. Ensure that any background automated processes (e.g. heartbeats, pricing or data updates) are not considered activities that reset the timeout. </li> 
 <li>Session revocation must occur at the server-side; for example, the session associated with the session ID is terminated on the server, rather than simply resetting a client-side cookie containing the session ID.</li> 
</ul> 
<div> 
 <ul> 
 </ul> 
 <p></p> 
</div>
</body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading55" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse55" aria-expanded="false" aria-controls="collapse55" class="btn btn-light btn-group-toggle">Requirement: Verify that all pages that require authentication have easy and visible access to logout functionality. [3.5]</button></h5></div>
<div id="collapse55" class="collapse" aria-labelledby="heading55" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent55"><div class="card border-success">
<div id="heading56" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse56" aria-expanded="false" aria-controls="collapse56" class="btn btn-light btn-group-toggle">Countermeasure: Provide logout links on all pages that require authentication [ASVS-2014-3.5]</button></h5></div>
<div id="collapse56" class="collapse" aria-labelledby="heading56" data-parent="#parent55"><div class="card-body"><html><body>
<div>
                        Applications requiring users authenticate to access privileged, secret, or potentially sensitive
                        information or functionality must also allow users a clear way to terminate their access;
                        typically through a logout or log off option.
                        </div>
                        <ul>
                        <li>Provide clearly visible logout links/options on all pages after a user has logged in. </li>
                        <li>Ensure the user's session is terminated at the server-side, and not at the
                        client-side.</li>
                        </ul>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading57" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse57" aria-expanded="false" aria-controls="collapse57" class="btn btn-light btn-group-toggle">Requirement: Verify that the session id is never disclosed in URLs, error messages, or logs. This includes verifying that the application does not support URL rewriting of session cookies. [3.6]</button></h5></div>
<div id="collapse57" class="collapse" aria-labelledby="heading57" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent57"><div class="card border-success">
<div id="heading58" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse58" aria-expanded="false" aria-controls="collapse58" class="btn btn-light btn-group-toggle">Countermeasure: Session ID's should be transmitted securely [ASVS-2014-3.6]</button></h5></div>
<div id="collapse58" class="collapse" aria-labelledby="heading58" data-parent="#parent57"><div class="card-body"><html><body>
<div>
                        <div>
                        <div>
                        The session token value issued after users have successfully identified and authenticated
                        themselves is of equivalent value to the secrets the user presents to login, and must be
                        protected accordingly. Data passed in the URL (address bar) between client and server is likely
                        to be exposed in logs on the server, or intermediate devices (such as proxies or other network
                        devices), or in local browser logs/history. A common mistake is, for example, to pass a
                        SessionID value as a parameter in the URL of a get request between hosts. To mitigate the risk
                        of exposure of sensitive data, it should only be sent in the body of an HTTP message (for
                        example a POST request), or in the HTTP headers (either standard headers such as the Cookie
                        values, or a custom X- header).
                        </div>
                        </div>
                        <div>
                        <ul>
                        <li>Ensure sensitive, private, or otherwise restricted data is not sent in a URL value
                        'GET' parameter.</li>
                        <li>Specifically, never the session ID token in the URL or over unencrypted transport.</li>
                        <li>Pass data only in appropriately protected fields in the body or headers, for example:</li>
                        <ul>
                        <li>A session Cookie (e.g. JSESSIONID, ASP.NET_SessionID)</li>
                        <li>A POST parameter (e.g. a token in the HTTP request body, or JSON parameter)</li>
                        <li>A standard or bespoke HTTP header (Authorization: X-Session header)</li>
                        </ul>
                        </ul>
                        </div>
                        </div>
                        <ul>
                        </ul>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading59" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse59" aria-expanded="false" aria-controls="collapse59" class="btn btn-light btn-group-toggle">Requirement: Verify that all successful authentication and re-authentication generates a new session and session id. [3.7]</button></h5></div>
<div id="collapse59" class="collapse" aria-labelledby="heading59" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent59">
<div class="card border-success">
<div id="heading60" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse60" aria-expanded="false" aria-controls="collapse60" class="btn btn-light btn-group-toggle">Countermeasure: Implement mechanisms to renew the session and session id [RENEW-SESSION]</button></h5></div>
<div id="collapse60" class="collapse" aria-labelledby="heading60" data-parent="#parent59"><div class="card-body"><html><body><p>Implement a mechanism to generate a new session and new session id, when a successful
                        authentication or re-authentication occurs. After this creation, the old session and session ID
                        shall be removed securely.
                    </p></body></html></div></div>
</div>
<div class="card border-success">
<div id="heading61" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse61" aria-expanded="false" aria-controls="collapse61" class="btn btn-light btn-group-toggle">Countermeasure: Implement mechanisms to renew the session and session id [RENEW-SESSION]</button></h5></div>
<div id="collapse61" class="collapse" aria-labelledby="heading61" data-parent="#parent59"><div class="card-body"><html><body><p>Implement a mechanism to generate a new session and new session id, when a successful authentication or re-authentication occurs. After this creation, the old session and session ID shall be removed securely.</p></body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading62" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse62" aria-expanded="false" aria-controls="collapse62" class="btn btn-light btn-group-toggle">Requirement: Verify that session ids stored in cookies have their path set to an appropriately restrictive value for the application, and authentication session tokens additionally set the ??ttpOnly??and ??ecure??attributes [3.12]</button></h5></div>
<div id="collapse62" class="collapse" aria-labelledby="heading62" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent62">
<div class="card border-success">
<div id="heading63" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse63" aria-expanded="false" aria-controls="collapse63" class="btn btn-light btn-group-toggle">Countermeasure: Set the 'secure' flag (or directive) on sensitive cookies [SESS-SNIFF-COOKIE]</button></h5></div>
<div id="collapse63" class="collapse" aria-labelledby="heading63" data-parent="#parent62"><div class="card-body"><html><body>
<div>
                        <div>
                        Cookies and their data are passed in the HTTP headers of client-web server communications, and
                        are subject to the same transport security. Sensitive data such as the Session ID sent over
                        unencrypted HTTP transport can be intercepted or monitored in transit, exposing the information
                        or the user's session. The secure directive instructs compliant browsers to only pass the cookie
                        over secure transport, which in most instances implies it will only be sent over an encrypted
                        HTTPS (TLS) connection, thereby protecting users from network sniffing and spoofing attacks.
                        </div>
                        <div>
                        <ul>
                        <li>Set the secure directive on all cookies containing sensitive data (in particular the
                        session ID token).</li>
                        <li>Where an application uses a mix of encrypted and unencrypted content, if session
                        tracking is required a secondary session token which does not permit access to sensitive content
                        could be used, although this deviates from security best-practice.</li>
                        </ul>
                        </div>
                        </div>
                        <div>
                        <div>
                        <div>
                        <ul>
                        </ul>
                        </div>
                        </div>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading64" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse64" aria-expanded="false" aria-controls="collapse64" class="btn btn-light btn-group-toggle">Countermeasure: Set the 'httpOnly' flag (or directive) on session cookies [CWE-84-HTTP-ONLY]</button></h5></div>
<div id="collapse64" class="collapse" aria-labelledby="heading64" data-parent="#parent62"><div class="card-body"><html><body>
<div>
                        Cookies and their data can been accessed in the browser through a number of means, including
                        JavaScript. This can facilitate attacks against users, for example cross-site scripting attacks
                        to POST the session ID to a third party site in order to hijack the session. The httpOnly
                        directive instructs compliant browsers to only allow the cookies to be accessed at the HTTP (or
                        server) layer, preventing client-side code or other browser functionality from accessing their
                        contents, mitigating such attacks.
                        </div>
                        <div>
                        <ul>
                        <li>Set the httpOnly directive on all cookies containing sensitive data (in particular the
                        session ID token) unless there is a specific requirement for that data to be accessed within the
                        browser.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading65" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse65" aria-expanded="false" aria-controls="collapse65" class="btn btn-light btn-group-toggle">Requirement: Verify that the application limits the number of active concurrent sessions. [3.16]</button></h5></div>
<div id="collapse65" class="collapse" aria-labelledby="heading65" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent65">
<div class="card border-success">
<div id="heading66" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse66" aria-expanded="false" aria-controls="collapse66" class="btn btn-light btn-group-toggle">Countermeasure: Limit the number of active concurrent sessions [LIMIT-ACTIVE-SESSIONS]</button></h5></div>
<div id="collapse66" class="collapse" aria-labelledby="heading66" data-parent="#parent65"><div class="card-body"><html><body><p>The number of active sessions shall be limited to avoid several active sessions at the same
                        time. If there are several active sessions, one of them may be used by the real user and another
                        session by attackers who are able to implement changes without the real user being aware.
                    </p></body></html></div></div>
</div>
<div class="card border-success">
<div id="heading67" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse67" aria-expanded="false" aria-controls="collapse67" class="btn btn-light btn-group-toggle">Countermeasure: Limit the number of active concurrent sessions [LIMIT-ACTIVE-SESSIONS]</button></h5></div>
<div id="collapse67" class="collapse" aria-labelledby="heading67" data-parent="#parent65"><div class="card-body"><html><body><p>The number of active sessions shall be limited to avoid several active sessions at the same time. If there are several active sessions, one of them may be used by the real user and another session by attackers who are able to implement changes without the real user being aware.</p></body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading68" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse68" aria-expanded="false" aria-controls="collapse68" class="btn btn-light btn-group-toggle">Requirement: Verify that an active session list is displayed in the account profile or similar of each user. The user should be able to terminate any active session. [3.17]</button></h5></div>
<div id="collapse68" class="collapse" aria-labelledby="heading68" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent68"><div class="card border-success">
<div id="heading69" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse69" aria-expanded="false" aria-controls="collapse69" class="btn btn-light btn-group-toggle">Countermeasure: Provide a section with a list of all active sessions and information about them [CSD-SESS-FED]</button></h5></div>
<div id="collapse69" class="collapse" aria-labelledby="heading69" data-parent="#parent68"><div class="card-body"><html><body><p>The application should provide a section with a list of all the active sessions. That list should contain as much information as possible and should allow the user to invalidate all sessions or any of them selectively.</p></body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading70" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse70" aria-expanded="false" aria-controls="collapse70" class="btn btn-light btn-group-toggle">Requirement: Verify the user is prompted with the option to terminate all other active sessions after a successful change password process. [3.18]</button></h5></div>
<div id="collapse70" class="collapse" aria-labelledby="heading70" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent70">
<div class="card border-success">
<div id="heading71" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse71" aria-expanded="false" aria-controls="collapse71" class="btn btn-light btn-group-toggle">Countermeasure: Give the user an option to terminate all active sessions when a password change event is triggered [CSD-PWD-CHG]</button></h5></div>
<div id="collapse71" class="collapse" aria-labelledby="heading71" data-parent="#parent70"><div class="card-body"><html><body><p>A password change could be the event of a possible password compromise. The user must have the
                        option of invalidating all the active sessions when performing the password change.
                    </p></body></html></div></div>
</div>
<div class="card border-success">
<div id="heading72" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse72" aria-expanded="false" aria-controls="collapse72" class="btn btn-light btn-group-toggle">Countermeasure: Give the user an option to terminate all active sessions when a password change event is triggered [CSD-PWD-CHG]</button></h5></div>
<div id="collapse72" class="collapse" aria-labelledby="heading72" data-parent="#parent70"><div class="card-body"><html><body><p>A password change could be the event of a possible password compromise. The user must have the option of invalidating all the active sessions when performing the password change.</p></body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading73" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse73" aria-expanded="false" aria-controls="collapse73" class="btn btn-light btn-group-toggle">Requirement: Verify that the principle of least privilege exists - users should only be able to access functions, data files, URLs, controllers, services, and other resources, for which they possess specific authorization. This implies protection against spoofing and elevation of privilege. [4.1]</button></h5></div>
<div id="collapse73" class="collapse" aria-labelledby="heading73" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent73">
<div class="card border-success">
<div id="heading74" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse74" aria-expanded="false" aria-controls="collapse74" class="btn btn-light btn-group-toggle">Countermeasure: Apply authorization checks to segregate and control access to user data [CWE-285]</button></h5></div>
<div id="collapse74" class="collapse" aria-labelledby="heading74" data-parent="#parent73"><div class="card-body"><html><body>
<div>
                        <div>
                        Applications protecting sensitive or otherwise restricted resources must ensure only appropriate
                        and authorized users may access the application data. It is important that an application
                        prevents unauthorized users gaining inappropriate access to each other's data; although user A
                        and user B may both be trusted to access data within the application, they may be authorized to
                        only access different subsets of the protected resources.  E.g. user A should not be
                        able to access user B's personal data by manipulating a request (typical examples are
                        manipulation of an ID value or other object reference sent in the URL or body of an HTTP
                        request).
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        It is not sufficient to rely on obscurity, for example obfuscated or secret URLs or filenames.
                        The application must validate each request for protected data against the proven identity of the
                        user. Before providing access to restricted resources the application must:
                        </div>
                        <div>
                        <ul>
                        <li>Ensure the user has undergone appropriate authentication (identification and
                        verification, or ID&amp;V). E.g. they must have provided their identity and confirmed this
                        with a password, token, or other verification. Typically this will be through checking the
                        validity of the session token issued after login.</li>
                        <li>Confirm the user is entitled to access the data or resource they are requesting. E.g.
                        their confirmed identify checked against a server-side access control matrix to determine
                        whether they may access the requested resource.</li>
                        <li>Access controls should be granular, and allow for access to individual resources to be
                        issued to individual users or roles.</li>
                        </ul>
                        <div>
                        URL and asset based access control is provided by most web-frameworks, and it is preferable to
                        use an established and proven framework.
                        </div>
                        </div>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading75" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse75" aria-expanded="false" aria-controls="collapse75" class="btn btn-light btn-group-toggle">Countermeasure: Apply authorization checks to segregate and control access to user data [CWE-285]</button></h5></div>
<div id="collapse75" class="collapse" aria-labelledby="heading75" data-parent="#parent73"><div class="card-body"><html><body>
<p>Applications protecting sensitive or otherwise restricted resources must ensure only appropriate and authorized users may access the application data. It is important that an application prevents unauthorised users gaining inappropriate access to each other’s data; although user A and user B may both be trusted to access data within the application, they may be authorized to only access different subsets of the protected resources. E.g. user A should not be able to access user B’s personal data by manipulating a request (typical examples are manipulation of an ID value or other object reference sent in the <span class="caps">URL</span> or body of an <span class="caps">HTTP</span> request). </p> It is not sufficient to rely on obscurity, for example obfuscated or secret 
<span class="caps">URL</span>s or filenames. The application must validate each request for protected data against the proven identity of the user. Before providing access to restricted resources the application must:  
<div> 
 <ul> 
  <li>Ensure the user has undergone appropriate authentication (identification and verification, or ID&amp;V). E.g. they must have provided their identity and confirmed this with a password, token, or other verification. Typically this will be through checking the validity of the session token issued after login. </li> 
  <li>Confirm the user is entitled to access the data or resource they are requesting. E.g. their confirmed identify checked against a server-side access control matrix to determine whether they may access the requested resource. </li> 
  <li>Access controls should be granular, and allow for access to individual resources to be issued to individual users or roles. <span class="caps">URL</span> and asset based access control is provided by most web-frameworks, and it is preferable to use an established and proven framework.</li> 
 </ul> 
</div>
</body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading76" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse76" aria-expanded="false" aria-controls="collapse76" class="btn btn-light btn-group-toggle">Requirement: Verify that access to sensitive records is protected, such that only authorized objects or data is accessible to each user (for example, protect against users tampering with a parameter to see or alter another user's account). [4.4]</button></h5></div>
<div id="collapse76" class="collapse" aria-labelledby="heading76" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent76">
<div class="card border-success">
<div id="heading77" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse77" aria-expanded="false" aria-controls="collapse77" class="btn btn-light btn-group-toggle">Countermeasure: Apply authorization checks to segregate and control access to user data [CWE-285]</button></h5></div>
<div id="collapse77" class="collapse" aria-labelledby="heading77" data-parent="#parent76"><div class="card-body"><html><body>
<div>
                        <div>
                        Applications protecting sensitive or otherwise restricted resources must ensure only appropriate
                        and authorized users may access the application data. It is important that an application
                        prevents unauthorized users gaining inappropriate access to each other's data; although user A
                        and user B may both be trusted to access data within the application, they may be authorized to
                        only access different subsets of the protected resources.  E.g. user A should not be
                        able to access user B's personal data by manipulating a request (typical examples are
                        manipulation of an ID value or other object reference sent in the URL or body of an HTTP
                        request).
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        It is not sufficient to rely on obscurity, for example obfuscated or secret URLs or filenames.
                        The application must validate each request for protected data against the proven identity of the
                        user. Before providing access to restricted resources the application must:
                        </div>
                        <div>
                        <ul>
                        <li>Ensure the user has undergone appropriate authentication (identification and
                        verification, or ID&amp;V). E.g. they must have provided their identity and confirmed this
                        with a password, token, or other verification. Typically this will be through checking the
                        validity of the session token issued after login.</li>
                        <li>Confirm the user is entitled to access the data or resource they are requesting. E.g.
                        their confirmed identify checked against a server-side access control matrix to determine
                        whether they may access the requested resource.</li>
                        <li>Access controls should be granular, and allow for access to individual resources to be
                        issued to individual users or roles.</li>
                        </ul>
                        <div>
                        URL and asset based access control is provided by most web-frameworks, and it is preferable to
                        use an established and proven framework.
                        </div>
                        </div>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading78" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse78" aria-expanded="false" aria-controls="collapse78" class="btn btn-light btn-group-toggle">Countermeasure: Avoid using direct references to files [CWE-639]</button></h5></div>
<div id="collapse78" class="collapse" aria-labelledby="heading78" data-parent="#parent76"><div class="card-body"><html><body>
<div>
                        All data received from the client-side should be considered tainted and a potential risk,
                        regardless of the source or transport method. Many flaws in applications result from unsafe
                        handling of filenames or path data, for example directory traversal and arbitrary file
                        disclosure. Use of filenames or other direct references to objects such as files at the
                        server-side increases the risk of compromise of the system or unauthorized access to other
                        files, content, or functionality.
                        </div>
                        <div>
                        <ul>
                        <li>Avoid using direct references to files or validate file name.</li>
                        <li>For example instead of using: <a>www.example.com/open.jsp?file=details.txt </a>use: <a>www.example.com/open.jsp?file=[GUID]</a> and
                        then use a lookup table on the server to associate the [GUID] value with file details.txt.</li>
                        <li>Files should be stored outside the web-root to prevent an attacker browsing directly
                        to them.</li>
                        <li>Do not use obscurity to prevent access; for example do not rely on renaming a file to
                        include a random string to prevent direct download or disclosure.</li>
                        </ul>If direct references are used to access files from within the web-root deviating from
                        recommended security practice, the following must be implemented:
                        </div>
                        <div>
                        <ul>
                        <li>String input validation must be applied.  Identify and filter for directory
                        traversal meta-characters such as "../" or "..\" or "/",
                        together with encoded variations and derivations.</li>
                        <li>Use of a strict white-list of files that may be downloaded.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading79" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse79" aria-expanded="false" aria-controls="collapse79" class="btn btn-light btn-group-toggle">Requirement: Verify that directory browsing is disabled unless deliberately desired. Additionally, applications should not allow discovery or disclosure of file or directory metadata, such as Thumbs.db, .DS_Store, .git or .svn folders. [4.5]</button></h5></div>
<div id="collapse79" class="collapse" aria-labelledby="heading79" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent79"><div class="card border-success">
<div id="heading80" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse80" aria-expanded="false" aria-controls="collapse80" class="btn btn-light btn-group-toggle">Countermeasure: Disable web server directory listing and ensure file metadata (e.g. .git) and backup files are not present within web roots [DIRECTORY_LISTING]</button></h5></div>
<div id="collapse80" class="collapse" aria-labelledby="heading80" data-parent="#parent79"><div class="card-body"><html><body>
<div>
                        Indexable directories allow an attacker to easily discover the existence of content on your web
                        server that should remain private.
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Disable directory listings in the web - or application-server configuration by
                        default.</li>
                        <li>Restrict access to unnecessary directories and files.</li>
                        <li>Create an index (default) file for each directory.</li>
                        </ol>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading81" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse81" aria-expanded="false" aria-controls="collapse81" class="btn btn-light btn-group-toggle">Requirement: Verify that access controls fail securely. [4.8]</button></h5></div>
<div id="collapse81" class="collapse" aria-labelledby="heading81" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent81"><div class="card border-success">
<div id="heading82" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse82" aria-expanded="false" aria-controls="collapse82" class="btn btn-light btn-group-toggle">Countermeasure: Apply authorization checks to segregate and control access to user data [CWE-285]</button></h5></div>
<div id="collapse82" class="collapse" aria-labelledby="heading82" data-parent="#parent81"><div class="card-body"><html><body>
<div>
                        <div>
                        Applications protecting sensitive or otherwise restricted resources must ensure only appropriate
                        and authorized users may access the application data. It is important that an application
                        prevents unauthorized users gaining inappropriate access to each other's data; although user A
                        and user B may both be trusted to access data within the application, they may be authorized to
                        only access different subsets of the protected resources.  E.g. user A should not be
                        able to access user B's personal data by manipulating a request (typical examples are
                        manipulation of an ID value or other object reference sent in the URL or body of an HTTP
                        request).
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        It is not sufficient to rely on obscurity, for example obfuscated or secret URLs or filenames.
                        The application must validate each request for protected data against the proven identity of the
                        user. Before providing access to restricted resources the application must:
                        </div>
                        <div>
                        <ul>
                        <li>Ensure the user has undergone appropriate authentication (identification and
                        verification, or ID&amp;V). E.g. they must have provided their identity and confirmed this
                        with a password, token, or other verification. Typically this will be through checking the
                        validity of the session token issued after login.</li>
                        <li>Confirm the user is entitled to access the data or resource they are requesting. E.g.
                        their confirmed identify checked against a server-side access control matrix to determine
                        whether they may access the requested resource.</li>
                        <li>Access controls should be granular, and allow for access to individual resources to be
                        issued to individual users or roles.</li>
                        </ul>
                        <div>
                        URL and asset based access control is provided by most web-frameworks, and it is preferable to
                        use an established and proven framework.
                        </div>
                        </div>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading83" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse83" aria-expanded="false" aria-controls="collapse83" class="btn btn-light btn-group-toggle">Requirement: Verify that the same access control rules implied by the presentation layer are enforced on the server side. [4.9]</button></h5></div>
<div id="collapse83" class="collapse" aria-labelledby="heading83" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent83">
<div class="card border-success">
<div id="heading84" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse84" aria-expanded="false" aria-controls="collapse84" class="btn btn-light btn-group-toggle">Countermeasure: Implement sensitive logic and data validation on the server-side [CS-CLIENT-SECRET]</button></h5></div>
<div id="collapse84" class="collapse" aria-labelledby="heading84" data-parent="#parent83"><div class="card-body"><html><body>
<div>
                        All data and functionality at the client-side must be considered tainted and subject to
                        manipulation by a malicious actor, regardless of the controls in place (e.g. encryption or
                        obfuscation of client-side code or content).  
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        This includes application logic decisions, such as access controls, and data considered
                        sensitive or secret, such as encryption keys.
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        While controls may be duplicated at the client-side to improve the user experience, it is
                        important these are enforced at the server-side.
                        </div>
                        <div>
                        <ul>
                        <li>Business logic, in particular access controls, must be implemented at the server-side.
                         </li>
                        <li>Secret data should be stored at the server-side, and only that which is explicitly
                        required be duplicated at the client-side.</li>
                        <li>All data provided from the client-side (even from binary clients) should be considered
                        tainted, and security decisions should not be made solely on this data.</li>
                        </ul>
                        </div>
                        <div>
                        For example, an insecure implementation could include a compiled application (e.g. Flash!)
                        performing authentication at the client-side against a stored password.  Decompilation
                        of the binary (in this case flv file) or interception and modification of controls between the
                        client and server could expose the password or allow unauthorized access to the authenticated
                        application content.
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading85" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse85" aria-expanded="false" aria-controls="collapse85" class="btn btn-light btn-group-toggle">Countermeasure: Implement sensitive logic and data validation on the server-side [CS-CLIENT-SECRET]</button></h5></div>
<div id="collapse85" class="collapse" aria-labelledby="heading85" data-parent="#parent83"><div class="card-body"><html><body>
<p>All data and functionality at the client-side must be considered tainted and subject to manipulation by a malicious actor, regardless of the controls in place (e.g. encryption or obfuscation of client-side code or content). </p> This includes application logic decisions, such as access controls, and data considered sensitive or secret, such as encryption keys. While controls may be duplicated at the client-side to improve the user experience, it is important these are enforced at the server-side.  
<div> 
 <ul> 
  <li>Business logic, in particular access controls, must be implemented at the server-side.</li> 
  <li>Secret data should be stored at the server-side, and only that which is explicitly required be duplicated at the client-side. </li> 
 </ul>All data provided from the client-side (even from binary clients) should be considered tainted, and security decisions should not be made solely on this data. For example, an insecure implementation could include a compiled application (e.g. Flash!) performing authentication at the client-side against a stored password. Decompilation of the binary (in this case flv file) or interception and modification of controls between the client and server could expose the password or allow unauthorised access to the authenticated application content. 
</div>
</body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading86" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse86" aria-expanded="false" aria-controls="collapse86" class="btn btn-light btn-group-toggle">Requirement: Verify that the application or framework uses strong random anti-CSRF tokens or has another transaction protection mechanism. [4.13]</button></h5></div>
<div id="collapse86" class="collapse" aria-labelledby="heading86" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent86">
<div class="card border-success">
<div id="heading87" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse87" aria-expanded="false" aria-controls="collapse87" class="btn btn-light btn-group-toggle">Countermeasure: Require re-authentication for critical operations [RE-AUTH]</button></h5></div>
<div id="collapse87" class="collapse" aria-labelledby="heading87" data-parent="#parent86"><div class="card-body"><html><body>
<div>
                        Unattended, hijacked, or otherwise compromised user sessions can be leveraged through certain
                        functionality by an attacker to gain more persistent access. For example, they could change the
                        user's password, create a new account within the application, or abuse the privilege of the
                        compromised user to cause damage (an administrative used could potentially modify or destroy
                        data). To mitigate the threat, in addition to controls such as anti-CSRF tokens,
                        re-authentication of key functionality should be implemented.
                        </div>
                        <div>
                        <ul>
                        <li>Requires users verify their identity when performing critical operations. This could
                        be achieved by requiring they re-enter their password, or a secondary secret value.  </li>
                        <li>In sensitive systems, consider use of multi-factor authentication such as a time based
                        on time password (TOTP), or a signing tokens (c.f. Internet banking solutions using an element
                        of the transaction to be approved as the seed for the OTP).</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading88" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse88" aria-expanded="false" aria-controls="collapse88" class="btn btn-light btn-group-toggle">Countermeasure: Set and verify one time 'Anti CSRF' tokens for sensitive operations [CWE-352-TOKENS]</button></h5></div>
<div id="collapse88" class="collapse" aria-labelledby="heading88" data-parent="#parent86"><div class="card-body"><html><body>
<div>
                        Cross Site Request Forgery (CSRF) attacks exploit users by causing them to unknowingly submit
                        requests to the application while logged in, for example by tricking them in to clicking links
                        or through cross-site scripting (XSS) attacks. These attacks can be deployed where sensitive
                        operations can be accessed through a simple GET request, or a POST form submission and no
                        additional controls are in place. These attacks can be mitigated by requiring a random server
                        generated token be submitted and verified in each request. Requiring re-authentication of
                        sensitive functions is also effective, but intrusive in the user experience.
                        </div>
                        <div>
                        <ul>
                        <li>HTML pages that offer sensitive operations should also include a random one time token
                        as a hidden field with every form. When the form is submitted, the server side should verify
                        that the token received is the same as the token issued.</li>
                        <li>Re-authentication should be required on sensitive functionality such as
                        password-change or user-creation.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading89" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse89" aria-expanded="false" aria-controls="collapse89" class="btn btn-light btn-group-toggle">Requirement: Verify that the application correctly enforces context-sensitive authorisation so as to not allow unauthorised manipulation by means of parameter tampering. [4.16]</button></h5></div>
<div id="collapse89" class="collapse" aria-labelledby="heading89" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent89"><div class="card border-success">
<div id="heading90" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse90" aria-expanded="false" aria-controls="collapse90" class="btn btn-light btn-group-toggle">Countermeasure: Enforce authentication on the server-side [CWE-603]</button></h5></div>
<div id="collapse90" class="collapse" aria-labelledby="heading90" data-parent="#parent89"><div class="card-body"><html><body>
<div>
                        All data at the client-side must be considered tainted.  As such, decisions on
                        authentication (or Identification and Verification - ID&amp;V) must be made or validated at
                        the server-side to prevent their subversion.
                        </div>
                        <div>
                        <ul>
                        <li>Ensure credentials are passed securely from the client-to server.</li>
                        <li>The server should compare the credentials with those stored at the server-side (e.g.
                        the hashed password compared against those stored for the claimed identity).</li>
                        <li>Implement controls to mitigate brute-force attacks; for example through rate-limiting,
                        account lockouts, or escalating timeouts.</li>
                        <li>Once authenticated, a non-predictable and cryptographically secure token should be
                        passed securely to the client-side to validate further interaction with the server.</li>
                        <li>Messages returned to the user during authentication, in particular when the process
                        fails, should not reveal to the user whether the username was valid.  Returning generic
                        errors prevents an attacker enumerating valid account IDs for subsequent attacks.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading91" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse91" aria-expanded="false" aria-controls="collapse91" class="btn btn-light btn-group-toggle">Requirement: Verify that the runtime environment is not susceptible to buffer overflows, or that security controls prevent buffer overflows. [5.1]</button></h5></div>
<div id="collapse91" class="collapse" aria-labelledby="heading91" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent91">
<div class="card border-success">
<div id="heading92" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse92" aria-expanded="false" aria-controls="collapse92" class="btn btn-light btn-group-toggle">Countermeasure: Develop using a language with integrated memory protection [CWE-120-MANAGED]</button></h5></div>
<div id="collapse92" class="collapse" aria-labelledby="heading92" data-parent="#parent91"><div class="card-body"><html><body>
<div>
                        Use of a language that manages memory and disallows direct access greatly reduces the likelihood
                        of presence and exploitation of overflow vulnerabilities.
                        </div>
                        <div>
                        <ul>
                        <li>Use a memory managed platform such as the JVM or .NET.</li>
                        <li>Alternatively, use of an interpreted language such Python, Perl or Ruby can also
                        mitigate the risk.</li>
                        <li>Ensure that the runtime environment is patched to the latest recommended levels so
                        flaws within it do not undermine these protections.</li>
                        </ul>
                        </div>
                        <div>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading93" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse93" aria-expanded="false" aria-controls="collapse93" class="btn btn-light btn-group-toggle">Countermeasure: Enable and enforce Address Space Layout Randomisation (ASLR) [CWE-120-RANDOM]</button></h5></div>
<div id="collapse93" class="collapse" aria-labelledby="heading93" data-parent="#parent91"><div class="card-body"><html><body>
<div>
                        Modern operating systems offer randomization of process address space to reduce the
                        predictability of the location of code elements in memory, and inhibit exploitation of overflow
                        vulnerabilities. 
                        </div>
                        <div>
                        However, it is often possible to disable or otherwise at least partially opt out of these
                        protections at a system or process level.
                        </div>
                        <div>
                        <ul>
                        <li>Ensure ASLR is enabled and enforced at the operating system level where possible.</li>
                        <li>Enable ASLR controls in the project.</li>
                        <li>Review dependencies to ensure they utilize ASLR, and if not, consider alternatives
                        that do.</li>
                        </ul>
                        </div>
                        <div></div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading94" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse94" aria-expanded="false" aria-controls="collapse94" class="btn btn-light btn-group-toggle">Countermeasure: Enforce stack and heap protection measures, including disabling stack execution [CWE-120-STACK]</button></h5></div>
<div id="collapse94" class="collapse" aria-labelledby="heading94" data-parent="#parent91"><div class="card-body"><html><body>
<p>Many modern operating systems offer protections to disallow code from executing from the
                        stack, inhibiting overflow attacks which rely on executing user code on the stack.
                        </p>
<div>
                        <ul>
                        <li>Enable stack protection at the operating system level, and verify opt out is not
                        permitted.</li>
                        <li>Ensure project components are developed with DEP / NX or equivalent stack protections.</li>
                        <li>Review all libraries and dependencies to ensure they also enforce stack protection,
                        and if not, consider alternatives that do.</li>
                        </ul>
                        </div>
                        <div></div>
                    </body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading95" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse95" aria-expanded="false" aria-controls="collapse95" class="btn btn-light btn-group-toggle">Requirement: Verify that server side input validation failures result in request rejection and are logged. [5.3]</button></h5></div>
<div id="collapse95" class="collapse" aria-labelledby="heading95" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent95"><div class="card border-success">
<div id="heading96" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse96" aria-expanded="false" aria-controls="collapse96" class="btn btn-light btn-group-toggle">Countermeasure: Log and reject all data validation failures [CSD-VAL-LOG]</button></h5></div>
<div id="collapse96" class="collapse" aria-labelledby="heading96" data-parent="#parent95"><div class="card-body"><html><body>
<div>
                        Data validation failures, together with access control violations, are symptomatic of malicious
                        activity where an attacker is attempting to subvert the protections in place. It is therefore
                        likely that unexpected input detected by the application relates to an attack. Rejecting and
                        logging such activity, and ideally terminating the session, increases the likelihood of
                        detecting and inhibiting structured attacks against the application.
                        </div>
                        <div>
                        <ul>
                        <li>Log all validation failures when rejecting requests.</li>
                        <li>Ensure logged data is appropriately sanitized and encoded to prevent attacks against
                        the logs and subsequent access to them.</li>
                        <li>Terminate the offending user session to inhibit further attack.</li>
                        <li>Ensure errors returned to the client-side are generic to prevent an attacker
                        enumerating the defenses in place or gaining knowledge about the back-end.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading97" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse97" aria-expanded="false" aria-controls="collapse97" class="btn btn-light btn-group-toggle">Requirement: Verify that input validation routines are enforced on the server side. [5.5]</button></h5></div>
<div id="collapse97" class="collapse" aria-labelledby="heading97" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent97">
<div class="card border-success">
<div id="heading98" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse98" aria-expanded="false" aria-controls="collapse98" class="btn btn-light btn-group-toggle">Countermeasure: Implement sensitive logic and data validation on the server-side [CS-CLIENT-SECRET]</button></h5></div>
<div id="collapse98" class="collapse" aria-labelledby="heading98" data-parent="#parent97"><div class="card-body"><html><body>
<div>
                        All data and functionality at the client-side must be considered tainted and subject to
                        manipulation by a malicious actor, regardless of the controls in place (e.g. encryption or
                        obfuscation of client-side code or content).  
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        This includes application logic decisions, such as access controls, and data considered
                        sensitive or secret, such as encryption keys.
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        While controls may be duplicated at the client-side to improve the user experience, it is
                        important these are enforced at the server-side.
                        </div>
                        <div>
                        <ul>
                        <li>Business logic, in particular access controls, must be implemented at the server-side.
                         </li>
                        <li>Secret data should be stored at the server-side, and only that which is explicitly
                        required be duplicated at the client-side.</li>
                        <li>All data provided from the client-side (even from binary clients) should be considered
                        tainted, and security decisions should not be made solely on this data.</li>
                        </ul>
                        </div>
                        <div>
                        For example, an insecure implementation could include a compiled application (e.g. Flash!)
                        performing authentication at the client-side against a stored password.  Decompilation
                        of the binary (in this case flv file) or interception and modification of controls between the
                        client and server could expose the password or allow unauthorized access to the authenticated
                        application content.
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading99" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse99" aria-expanded="false" aria-controls="collapse99" class="btn btn-light btn-group-toggle">Countermeasure: Implement sensitive logic and data validation on the server-side [CS-CLIENT-SECRET]</button></h5></div>
<div id="collapse99" class="collapse" aria-labelledby="heading99" data-parent="#parent97"><div class="card-body"><html><body>
<p>All data and functionality at the client-side must be considered tainted and subject to manipulation by a malicious actor, regardless of the controls in place (e.g. encryption or obfuscation of client-side code or content). </p> This includes application logic decisions, such as access controls, and data considered sensitive or secret, such as encryption keys. While controls may be duplicated at the client-side to improve the user experience, it is important these are enforced at the server-side.  
<div> 
 <ul> 
  <li>Business logic, in particular access controls, must be implemented at the server-side.</li> 
  <li>Secret data should be stored at the server-side, and only that which is explicitly required be duplicated at the client-side. </li> 
 </ul>All data provided from the client-side (even from binary clients) should be considered tainted, and security decisions should not be made solely on this data. For example, an insecure implementation could include a compiled application (e.g. Flash!) performing authentication at the client-side against a stored password. Decompilation of the binary (in this case flv file) or interception and modification of controls between the client and server could expose the password or allow unauthorised access to the authenticated application content. 
</div>
</body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading100" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse100" aria-expanded="false" aria-controls="collapse100" class="btn btn-light btn-group-toggle">Requirement: Verify that all SQL queries, HQL, OSQL, NOSQL and stored procedures, calling of stored procedures are protected by the use of prepared statements or query parameterization, and thus not susceptible to SQL injection [5.10]</button></h5></div>
<div id="collapse100" class="collapse" aria-labelledby="heading100" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent100"><div class="card border-success">
<div id="heading101" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse101" aria-expanded="false" aria-controls="collapse101" class="btn btn-light btn-group-toggle">Countermeasure: Use prepared statements for all database queries [CWE-89-PREPARED]</button></h5></div>
<div id="collapse101" class="collapse" aria-labelledby="heading101" data-parent="#parent100"><div class="card-body"><html><body>
<div>
                        Database injection attacks, such as SQLi (SQL Injection) rely on sending tainted client-side
                        data which is used in dynamic SQL queries at the server-side in an unsafe manner. For example,
                        creating queries by concatenating strings using untrusted data may result in vulnerable
                        code
                        <b>,</b> for example an attacker may append an 'OR' statement through the
                        provided customerName parameter passed to the following code to bypass the checks and return
                        additional data from the database:
                        </div>
                        <div>
                        <pre>

                        </pre>
<ul>

                        <li>String query = "SELECT user FROM users WHERE name = '" </li>


                        </ul> + request.getParameter("customerName")+"'";
                        </div>
                        <div>
                        Using prepared statements with carefully controlled and validated input conditions mitigates
                        against SQLi and related attacks.
                        </div>
                        <div>
                        <ul>
                        <li>Database queries should always be made using prepared statements or parameterized
                        queries.</li>
                        <li>Queries through an Object-Relational mapper should also be treated as tainted input,
                        and made using prepared statements to mitigate the threat.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading102" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse102" aria-expanded="false" aria-controls="collapse102" class="btn btn-light btn-group-toggle">Requirement: Verify that the application is not susceptible to LDAP Injection, or that security controls prevent LDAP Injection. [5.11]</button></h5></div>
<div id="collapse102" class="collapse" aria-labelledby="heading102" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent102"><div class="card border-success">
<div id="heading103" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse103" aria-expanded="false" aria-controls="collapse103" class="btn btn-light btn-group-toggle">Countermeasure: Escape LDAP meta-characters in user input [CWE-150-LDAP]</button></h5></div>
<div id="collapse103" class="collapse" aria-labelledby="heading103" data-parent="#parent102"><div class="card-body"><html><body>
<div>
                        <div>
                        All data received from the client-side should be considered tainted and a potential risk,
                        regardless of the source or transport method. As such, all data from the client side
                        must be subjected to strict validation, sanitization, and encoding against expected syntactic
                        and semantic criteria.
                        </div>
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        When using user supplied input in an LDAP query:
                        </div>
                        <div>
                        <div>
                        <ul>
                        <li>Ensure that LDAP specific meta-characters are escaped before the query is executed.</li>
                        <li>Define a specification of the data that is expected at each input; both the syntax
                        (e.g. alphanumeric only) and semantics (e.g. a word of between 1 and 25 characters, or a
                        specific list). As an example of business rule logic, "boat" may be
                        syntactically valid because it only contains alphanumeric characters, but it is not valid if the
                        input is only expected to contain colors such as "red" or "blue."</li>
                        <li>Implement a 'known good' or white-list approach, where only inputs that meet the
                        strict criteria for each input are accepted, and reject, transform, or encapsulate any
                        non-compliant data.</li>
                        </ul>
                        </div>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading104" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse104" aria-expanded="false" aria-controls="collapse104" class="btn btn-light btn-group-toggle">Requirement: Verify that the application is not susceptible to OS Command Injection, or that security controls prevent OS Command Injection. [5.12]</button></h5></div>
<div id="collapse104" class="collapse" aria-labelledby="heading104" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent104">
<div class="card border-success">
<div id="heading105" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse105" aria-expanded="false" aria-controls="collapse105" class="btn btn-light btn-group-toggle">Countermeasure: Validate all data received from the client side [DATA-VAL]</button></h5></div>
<div id="collapse105" class="collapse" aria-labelledby="heading105" data-parent="#parent104"><div class="card-body"><html><body>
<div>
                        All data received from the client-side should be considered tainted and a potential risk,
                        regardless of the source or transport method.  For example, while hidden form fields,
                        cookies, or other headers may be obfuscated from a user, along with parameters passed in
                        ViewStates or other encapsulated forms, these can be modified by the user at the client-side in
                        memory, or in transit on the network. Similarly, data passed from binary or compiled components
                        can be modified in situ or in transit. 
                        </div>
                        <div>
                        <i><br></i>
                        </div>
                        <div>
                        <i>Furthermore, encryption only secures the data in transit between the two ends of the
                        encrypted tunnel (one end of which is typically controlled by the client); data passing through
                        the link may still be malicious. </i>
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        As such, all data from the client side must be subjected to strict validation, sanitization, and
                        encoding against expected syntactic and semantic criteria.
                        </div>
                        <div>
                        <ul>
                        <li>Define a specification of the data that is expected at each input; both the syntax
                        (e.g. alphanumeric only) and semantics (e.g. a word of between 1 and 25 characters, or a
                        specific list). As an example of business rule logic, "boat" may be
                        syntactically valid because it only contains alphanumeric characters, but it is not valid if the
                        input is only expected to contain colors such as "red" or "blue."</li>
                        <li>Implement a 'known good' or white-list approach, where only inputs that meet the
                        strict criteria for each input are accepted, and reject, transform, or encapsulate any
                        non-compliant data.</li>
                        <li>While useful for identifying malicious content, do not rely on looking for specific
                        malformed or attack payloads (blacklists). It is almost impossible to maintain a comprehensive
                        and accurate blacklist due to the complexity and evolving nature of attacks, opportunities to
                        obfuscate payloads, and changes to the code's execution environment. As noted, blacklists can be
                        useful for detecting and logging potential attacks, or determining which inputs are so malformed
                        that they should be rejected outright. </li>
                        <li>Validate all data received from the client, including values such as HTTP headers and
                        cookie values if these are used as input on the server side, X- headers, and other platform
                        specific data objects passed between the client and server.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading106" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse106" aria-expanded="false" aria-controls="collapse106" class="btn btn-light btn-group-toggle">Countermeasure: Validate all data received [DATA-VAL]</button></h5></div>
<div id="collapse106" class="collapse" aria-labelledby="heading106" data-parent="#parent104"><div class="card-body"><html><body>
<p>All data received should be considered tainted and a potential risk, regardless of the source or transport method. For example, while hidden form fields, cookies, or other headers may be obfuscated from a user, along with parameters passed in ViewStates or other encapsulated forms, these can be modified by the user at the client-side in memory, or in transit on the network. Similarly, data passed from binary or compiled components can be modified in situ or in transit. 
 <i></i> 
 <i>Furthermore, encryption only secures the data in transit between the two ends of the encrypted tunnel (one end of which is typically controlled by the client); data passing through the link may still be malicious.</i> </p>

 As such, all data from the client side must be subjected to strict validation, sanitization, and encoding against expected syntactic and semantic criteria. 
 – Define a specification of the data that is expected at each input; both the syntax (e.g. alphanumeric only) and semantics (e.g. a word of between 1 and 25 characters, or a specific list). As an example of business rule logic, "boat" may be syntactically valid because it only contains alphanumeric characters, but it is not valid if the input is only expected to contain colors such as "red" or "blue."
 – Implement a ‘known good’ or white-list approach, where only inputs that meet the strict criteria for each input are accepted, and reject, transform, or encapsulate any non-compliant data.
 – While useful for identifying malicious content, do not rely on looking for specific malformed or attack payloads (blacklists). It is almost impossible to maintain a comprehensive and accurate blacklist due to the complexity and evolving nature of attacks, opportunities to obfuscate payloads, and changes to the code’s execution environment. As noted, blacklists can be useful for detecting and logging potential attacks, or determining which inputs are so malformed that they should be rejected outright.
 – Validate all data received from the client, including values such as <span class="caps">HTTP</span> headers and cookie values if these are used as input on the server side, X- headers, and other platform specific data objects passed between the client and server.</body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading107" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse107" aria-expanded="false" aria-controls="collapse107" class="btn btn-light btn-group-toggle">Requirement: Verify that the application is not susceptible to Remote File Inclusion (RFI) or Local File Inclusion (LFI) when content is used that is a path to a file. [5.13]</button></h5></div>
<div id="collapse107" class="collapse" aria-labelledby="heading107" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent107">
<div class="card border-success">
<div id="heading108" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse108" aria-expanded="false" aria-controls="collapse108" class="btn btn-light btn-group-toggle">Countermeasure: Avoid using direct references to files [CWE-639]</button></h5></div>
<div id="collapse108" class="collapse" aria-labelledby="heading108" data-parent="#parent107"><div class="card-body"><html><body>
<div>
                        All data received from the client-side should be considered tainted and a potential risk,
                        regardless of the source or transport method. Many flaws in applications result from unsafe
                        handling of filenames or path data, for example directory traversal and arbitrary file
                        disclosure. Use of filenames or other direct references to objects such as files at the
                        server-side increases the risk of compromise of the system or unauthorized access to other
                        files, content, or functionality.
                        </div>
                        <div>
                        <ul>
                        <li>Avoid using direct references to files or validate file name.</li>
                        <li>For example instead of using: <a>www.example.com/open.jsp?file=details.txt </a>use: <a>www.example.com/open.jsp?file=[GUID]</a> and
                        then use a lookup table on the server to associate the [GUID] value with file details.txt.</li>
                        <li>Files should be stored outside the web-root to prevent an attacker browsing directly
                        to them.</li>
                        <li>Do not use obscurity to prevent access; for example do not rely on renaming a file to
                        include a random string to prevent direct download or disclosure.</li>
                        </ul>If direct references are used to access files from within the web-root deviating from
                        recommended security practice, the following must be implemented:
                        </div>
                        <div>
                        <ul>
                        <li>String input validation must be applied.  Identify and filter for directory
                        traversal meta-characters such as "../" or "..\" or "/",
                        together with encoded variations and derivations.</li>
                        <li>Use of a strict white-list of files that may be downloaded.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading109" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse109" aria-expanded="false" aria-controls="collapse109" class="btn btn-light btn-group-toggle">Countermeasure: Use a library that is not vulnerable to Remote File Inclusion [CWE-98-LIB]</button></h5></div>
<div id="collapse109" class="collapse" aria-labelledby="heading109" data-parent="#parent107"><div class="card-body"><html><body>
<div>
                        The Remote File Inclusion (RFI) attack vector is prevalent, and has affected a number of
                        libraries. It can lead to remote code execution, data exposure, and other compromise of the
                        application and underlying server.
                        </div>
                        <div>
                        <ul>
                        <li>Use a library that is not known to be susceptible to Remote File Inclusion (RFI)
                        vulnerabilities.</li>
                        <li>Use an independently vetted library or framework that does not allow this weakness to
                        occur or provides constructs that make this weakness easier to avoid. </li>
                        <li>Follow rigorous data validation and sanitization processes.</li>
                        <li>Perform regular checks for published vulnerabilities the libraries in use.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading110" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse110" aria-expanded="false" aria-controls="collapse110" class="btn btn-light btn-group-toggle">Requirement: Verify that the application is not susceptible to common XML attacks, such as XPath query tampering, XML External Entity attacks, and XML injection attacks. [5.14]</button></h5></div>
<div id="collapse110" class="collapse" aria-labelledby="heading110" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent110">
<div class="card border-success">
<div id="heading111" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse111" aria-expanded="false" aria-controls="collapse111" class="btn btn-light btn-group-toggle">Countermeasure: Disable external XML entity references in the processor [cwe-611-validate]</button></h5></div>
<div id="collapse111" class="collapse" aria-labelledby="heading111" data-parent="#parent110"><div class="card-body"><html><body>
<div>
                        The XML standards provide for formal validation criteria to be specified in a schema (XSD or
                        DTD). The XML data itself may include DTD specifications, which a skilled attacked could use to
                        attempt to subvert data validation controls.
                        </div>
                        <div>
                        <ul>
                        <li>Configure the XML processor to use a local static DTD.</li>
                        <li>Disallow any declared DTD included in the XML document. </li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading112" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse112" aria-expanded="false" aria-controls="collapse112" class="btn btn-light btn-group-toggle">Countermeasure: Validate all data received from the client side [DATA-VAL]</button></h5></div>
<div id="collapse112" class="collapse" aria-labelledby="heading112" data-parent="#parent110"><div class="card-body"><html><body>
<div>
                        All data received from the client-side should be considered tainted and a potential risk,
                        regardless of the source or transport method.  For example, while hidden form fields,
                        cookies, or other headers may be obfuscated from a user, along with parameters passed in
                        ViewStates or other encapsulated forms, these can be modified by the user at the client-side in
                        memory, or in transit on the network. Similarly, data passed from binary or compiled components
                        can be modified in situ or in transit. 
                        </div>
                        <div>
                        <i><br></i>
                        </div>
                        <div>
                        <i>Furthermore, encryption only secures the data in transit between the two ends of the
                        encrypted tunnel (one end of which is typically controlled by the client); data passing through
                        the link may still be malicious.</i>
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        As such, all data from the client side must be subjected to strict validation, sanitization, and
                        encoding against expected syntactic and semantic criteria.
                        </div>
                        <div>
                        <ul>
                        <li>Define a specification of the data that is expected at each input; both the syntax
                        (e.g. alphanumeric only) and semantics (e.g. a word of between 1 and 25 characters, or a
                        specific list). As an example of business rule logic, "boat" may be
                        syntactically valid because it only contains alphanumeric characters, but it is not valid if the
                        input is only expected to contain colors such as "red" or "blue."</li>
                        <li>Implement a 'known good' or white-list approach, where only inputs that meet the
                        strict criteria for each input are accepted, and reject, transform, or encapsulate any
                        non-compliant data.</li>
                        <li>While useful for identifying malicious content, do not rely on looking for specific
                        malformed or attack payloads (blacklists). It is almost impossible to maintain a comprehensive
                        and accurate blacklist due to the complexity and evolving nature of attacks, opportunities to
                        obfuscate payloads, and changes to the code's execution environment. As noted, blacklists can be
                        useful for detecting and logging potential attacks, or determining which inputs are so malformed
                        that they should be rejected outright. </li>
                        <li>Validate all data received from the client, including values such as HTTP headers and
                        cookie values if these are used as input on the server side, X- headers, and other platform
                        specific data objects passed between the client and server.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading113" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse113" aria-expanded="false" aria-controls="collapse113" class="btn btn-light btn-group-toggle">Countermeasure: Validate all data received from the client side [DATA-VAL]</button></h5></div>
<div id="collapse113" class="collapse" aria-labelledby="heading113" data-parent="#parent110"><div class="card-body"><html><body>
<div>
                        All data received from the client-side should be considered tainted and a potential risk,
                        regardless of the source or transport method.  For example, while hidden form fields,
                        cookies, or other headers may be obfuscated from a user, along with parameters passed in
                        ViewStates or other encapsulated forms, these can be modified by the user at the client-side in
                        memory, or in transit on the network. Similarly, data passed from binary or compiled components
                        can be modified in situ or in transit. 
                        </div>
                        <div>
                        <i><br></i>
                        </div>
                        <div>
                        <i>Furthermore, encryption only secures the data in transit between the two ends of the
                        encrypted tunnel (one end of which is typically controlled by the client); data passing through
                        the link may still be malicious. </i>
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        As such, all data from the client side must be subjected to strict validation, sanitization, and
                        encoding against expected syntactic and semantic criteria.
                        </div>
                        <div>
                        <ul>
                        <li>Define a specification of the data that is expected at each input; both the syntax
                        (e.g. alphanumeric only) and semantics (e.g. a word of between 1 and 25 characters, or a
                        specific list). As an example of business rule logic, "boat" may be
                        syntactically valid because it only contains alphanumeric characters, but it is not valid if the
                        input is only expected to contain colors such as "red" or "blue."</li>
                        <li>Implement a 'known good' or white-list approach, where only inputs that meet the
                        strict criteria for each input are accepted, and reject, transform, or encapsulate any
                        non-compliant data.</li>
                        <li>While useful for identifying malicious content, do not rely on looking for specific
                        malformed or attack payloads (blacklists). It is almost impossible to maintain a comprehensive
                        and accurate blacklist due to the complexity and evolving nature of attacks, opportunities to
                        obfuscate payloads, and changes to the code's execution environment. As noted, blacklists can be
                        useful for detecting and logging potential attacks, or determining which inputs are so malformed
                        that they should be rejected outright. </li>
                        <li>Validate all data received from the client, including values such as HTTP headers and
                        cookie values if these are used as input on the server side, X- headers, and other platform
                        specific data objects passed between the client and server.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading114" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse114" aria-expanded="false" aria-controls="collapse114" class="btn btn-light btn-group-toggle">Countermeasure: Validate all data received [DATA-VAL]</button></h5></div>
<div id="collapse114" class="collapse" aria-labelledby="heading114" data-parent="#parent110"><div class="card-body"><html><body>
<p>All data received should be considered tainted and a potential risk, regardless of the source or transport method. For example, while hidden form fields, cookies, or other headers may be obfuscated from a user, along with parameters passed in ViewStates or other encapsulated forms, these can be modified by the user at the client-side in memory, or in transit on the network. Similarly, data passed from binary or compiled components can be modified in situ or in transit. 
 <i></i> 
 <i>Furthermore, encryption only secures the data in transit between the two ends of the encrypted tunnel (one end of which is typically controlled by the client); data passing through the link may still be malicious.</i> </p>

 As such, all data from the client side must be subjected to strict validation, sanitization, and encoding against expected syntactic and semantic criteria. 
 – Define a specification of the data that is expected at each input; both the syntax (e.g. alphanumeric only) and semantics (e.g. a word of between 1 and 25 characters, or a specific list). As an example of business rule logic, "boat" may be syntactically valid because it only contains alphanumeric characters, but it is not valid if the input is only expected to contain colors such as "red" or "blue."
 – Implement a ‘known good’ or white-list approach, where only inputs that meet the strict criteria for each input are accepted, and reject, transform, or encapsulate any non-compliant data.
 – While useful for identifying malicious content, do not rely on looking for specific malformed or attack payloads (blacklists). It is almost impossible to maintain a comprehensive and accurate blacklist due to the complexity and evolving nature of attacks, opportunities to obfuscate payloads, and changes to the code’s execution environment. As noted, blacklists can be useful for detecting and logging potential attacks, or determining which inputs are so malformed that they should be rejected outright.
 – Validate all data received from the client, including values such as <span class="caps">HTTP</span> headers and cookie values if these are used as input on the server side, X- headers, and other platform specific data objects passed between the client and server.</body></html></div></div>
</div>
<div class="card border-success">
<div id="heading115" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse115" aria-expanded="false" aria-controls="collapse115" class="btn btn-light btn-group-toggle">Countermeasure: Validate all data received [DATA-VAL]</button></h5></div>
<div id="collapse115" class="collapse" aria-labelledby="heading115" data-parent="#parent110"><div class="card-body"><html><body>
<p>All data received should be considered tainted and a potential risk, regardless of the source or transport method. For example, while hidden form fields, cookies, or other headers may be obfuscated from a user, along with parameters passed in ViewStates or other encapsulated forms, these can be modified by the user at the client-side in memory, or in transit on the network. Similarly, data passed from binary or compiled components can be modified in situ or in transit. <i></i> <i>Furthermore, encryption only secures the data in transit between the two ends of the encrypted tunnel (one end of which is typically controlled by the client); data passing through the link may still be malicious.</i> </p> As such, all data from the client side must be subjected to strict validation, sanitization, and encoding against expected syntactic and semantic criteria. 
<div> 
 <ul> 
  <li>Define a specification of the data that is expected at each input; both the syntax (e.g. alphanumeric only) and semantics (e.g. a word of between 1 and 25 characters, or a specific list). As an example of business rule logic, "boat" may be syntactically valid because it only contains alphanumeric characters, but it is not valid if the input is only expected to contain colors such as "red" or "blue." </li> 
  <li>Implement a ‘known good’ or white-list approach, where only inputs that meet the strict criteria for each input are accepted, and reject, transform, or encapsulate any non-compliant data. </li> 
  <li>While useful for identifying malicious content, do not rely on looking for specific malformed or attack payloads (blacklists). It is almost impossible to maintain a comprehensive and accurate blacklist due to the complexity and evolving nature of attacks, opportunities to obfuscate payloads, and changes to the code’s execution environment. As noted, blacklists can be useful for detecting and logging potential attacks, or determining which inputs are so malformed that they should be rejected outright. </li> 
  <li>Validate all data received from the client, including values such as <span class="caps">HTTP</span> headers and cookie values if these are used as input on the server side, X- headers, and other platform specific data objects passed between the client and server.</li> 
 </ul> 
</div>
</body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading116" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse116" aria-expanded="false" aria-controls="collapse116" class="btn btn-light btn-group-toggle">Requirement: Ensure that all string variables placed into HTML or other web client code is either properly contextually encoded manually, or utilize templates that automatically encode contextually to ensure the application is not susceptible to reflected, stored and DOM Cross-Site Scripting (XSS) attacks. [5.15]</button></h5></div>
<div id="collapse116" class="collapse" aria-labelledby="heading116" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent116">
<div class="card border-success">
<div id="heading117" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse117" aria-expanded="false" aria-controls="collapse117" class="btn btn-light btn-group-toggle">Countermeasure: Perform contextual HTML encoding of all user submitted data [CWE-79-ENCODE]</button></h5></div>
<div id="collapse117" class="collapse" aria-labelledby="heading117" data-parent="#parent116"><div class="card-body"><html><body>
<div>
                        All data received from the client-side should be considered tainted and a potential risk. If
                        handled properly at the point of input, this untrusted tainted data should have been sanitized
                        and encoded safely. The context when returning the data to the user is important, however, as
                        this will affect what metacharacters have significance, and how they will be interpreted at the
                        client-side.
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        For example, if data is inserted into the HTML body then HTML Entity encoding should be
                        performed, but if the data is inserted into a JavaScript block, then JavaScript escaping should
                        be performed. Similarly, while JavaScript code should not be executed in the browser when
                        returned in an application/json response, it may then be rendered in an unsafe manner.
                        </div>
                        <div>
                        <ul>
                        <li>Apply contextual encoding to all tainted data when returned to the users (including
                        secondary users if the application has multiple interfaces - e.g. an internal user viewing data
                        entered by an external customer).</li>
                        <li>This should be in addition to, and in conjunction with, sanitization and encoding
                        applied at the time of data acquisition.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading118" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse118" aria-expanded="false" aria-controls="collapse118" class="btn btn-light btn-group-toggle">Countermeasure: Perform contextual HTML encoding of all user submitted data [CWE-79-ENCODE]</button></h5></div>
<div id="collapse118" class="collapse" aria-labelledby="heading118" data-parent="#parent116"><div class="card-body"><html><body>
<p>All data received from the client-side should be considered tainted and a potential risk. If handled properly at the point of input, this untrusted tainted data should have been sanitized and encoded safely. The context when returning the data to the user is important, however, as this will affect what metacharacters have significance, and how they will be interpreted at the client-side. </p>

 For example, if data is inserted into the <span class="caps">HTML</span> body then <span class="caps">HTML</span> Entity encoding should be performed, but if the data is inserted into a JavaScript block, then JavaScript escaping should be performed. Similarly, while JavaScript code should not be executed in the browser when returned in an application/json response, it may then be rendered in an unsafe manner. 
 – Apply contextual encoding to all tainted data when returned to the users (including secondary users if the application has multiple interfaces – e.g. an internal user viewing data entered by an external customer).
 – This should be in addition to, and in conjunction with, sanitization and encoding applied at the time of data acquisition.</body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading119" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse119" aria-expanded="false" aria-controls="collapse119" class="btn btn-light btn-group-toggle">Requirement: Make sure untrusted HTML from WYSIWYG editors or similar are properly sanitized with an HTML sanitizer and handle it appropriately according to the input validation task and encoding task. [5.22]</button></h5></div>
<div id="collapse119" class="collapse" aria-labelledby="heading119" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent119"><div class="card border-success">
<div id="heading120" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse120" aria-expanded="false" aria-controls="collapse120" class="btn btn-light btn-group-toggle">Countermeasure: Sanitise data received from a WYSIWYG editor [CWE-79-HTML]</button></h5></div>
<div id="collapse120" class="collapse" aria-labelledby="heading120" data-parent="#parent119"><div class="card-body"><html><body>
<div>
                        WYSIWYG editors allow users to input formatted HTML text to the application. Allowing
                        uncontrolled HTML input could lead to Cross Site Scripting and other content-based attacks. In a
                        number of instances it may be necessary to allow users to use extended or active content in data
                        provided to the application (for example CMS or blogs), but the active content permitted should
                        be carefully vetted and controlled.
                        </div>
                        <div>
                        <ul>
                        <li>Sanitize data received through WYSIWYG (or other HTML/raw) editing interfaces.</li>
                        <li>Where HTML or other meta-data is permitted, this should be checked against a carefully
                        selected and controlled whitelist of tags and attributes.</li>
                        <li>All other meta-characters or unexpected content should either be rejected, removed,
                        masked, or encoded.</li>
                        </ul>
                        </div>
                        <div>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading121" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse121" aria-expanded="false" aria-controls="collapse121" class="btn btn-light btn-group-toggle">Requirement: Verify that all cryptographic modules fail securely, and errors are handled in a way that does not enable oracle padding. [7.2]</button></h5></div>
<div id="collapse121" class="collapse" aria-labelledby="heading121" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent121">
<div class="card border-success">
<div id="heading122" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse122" aria-expanded="false" aria-controls="collapse122" class="btn btn-light btn-group-toggle">Countermeasure: Ensure sensitive data is not revealed through error output messages. [ASVS-8.1]</button></h5></div>
<div id="collapse122" class="collapse" aria-labelledby="heading122" data-parent="#parent121"><div class="card-body"><html><body><p>Ensure the application does not output error messages or stack traces containing sensitive
                        data that could assist an attacker, including session id, software/framework versions and
                        personal information.
                    </p></body></html></div></div>
</div>
<div class="card border-success">
<div id="heading123" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse123" aria-expanded="false" aria-controls="collapse123" class="btn btn-light btn-group-toggle">Countermeasure: Validate all data received from the client side [DATA-VAL]</button></h5></div>
<div id="collapse123" class="collapse" aria-labelledby="heading123" data-parent="#parent121"><div class="card-body"><html><body>
<div>
                        All data received from the client-side should be considered tainted and a potential risk,
                        regardless of the source or transport method.  For example, while hidden form fields,
                        cookies, or other headers may be obfuscated from a user, along with parameters passed in
                        ViewStates or other encapsulated forms, these can be modified by the user at the client-side in
                        memory, or in transit on the network. Similarly, data passed from binary or compiled components
                        can be modified in situ or in transit. 
                        </div>
                        <div>
                        <i><br></i>
                        </div>
                        <div>
                        <i>Furthermore, encryption only secures the data in transit between the two ends of the
                        encrypted tunnel (one end of which is typically controlled by the client); data passing through
                        the link may still be malicious.</i>
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        As such, all data from the client side must be subjected to strict validation, sanitization, and
                        encoding against expected syntactic and semantic criteria.
                        </div>
                        <div>
                        <ul>
                        <li>Define a specification of the data that is expected at each input; both the syntax
                        (e.g. alphanumeric only) and semantics (e.g. a word of between 1 and 25 characters, or a
                        specific list). As an example of business rule logic, "boat" may be
                        syntactically valid because it only contains alphanumeric characters, but it is not valid if the
                        input is only expected to contain colors such as "red" or "blue."</li>
                        <li>Implement a 'known good' or white-list approach, where only inputs that meet the
                        strict criteria for each input are accepted, and reject, transform, or encapsulate any
                        non-compliant data.</li>
                        <li>While useful for identifying malicious content, do not rely on looking for specific
                        malformed or attack payloads (blacklists). It is almost impossible to maintain a comprehensive
                        and accurate blacklist due to the complexity and evolving nature of attacks, opportunities to
                        obfuscate payloads, and changes to the code's execution environment. As noted, blacklists can be
                        useful for detecting and logging potential attacks, or determining which inputs are so malformed
                        that they should be rejected outright. </li>
                        <li>Validate all data received from the client, including values such as HTTP headers and
                        cookie values if these are used as input on the server side, X- headers, and other platform
                        specific data objects passed between the client and server.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading124" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse124" aria-expanded="false" aria-controls="collapse124" class="btn btn-light btn-group-toggle">Countermeasure: Verify that all cryptographic modules fail securely, and errors are handled in a way that does not enable oracle padding. [ASVS-7.2]</button></h5></div>
<div id="collapse124" class="collapse" aria-labelledby="heading124" data-parent="#parent121"><div class="card-body"><html><body>
<div>
                        Encryption should fail closed so that data does not get stored in an unprotected state.
                        <br>
                        </div>
                        <div>
                        To protect against padding oracles, you want to make sure that your application does not return
                        a different error when the padding is wrong. The best way to do this is an Encrypt-then-MAC
                        construction, where a Message Authentication Code (MAC) is applied to the ciphertext. If the MAC
                        fails, you don't even need to look at the padding. If the MAC is correct, it is
                        cryptographically unlikely that the padding has been tampered with.
                        <br>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading125" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse125" aria-expanded="false" aria-controls="collapse125" class="btn btn-light btn-group-toggle">Countermeasure: Validate all data received from the client side [DATA-VAL]</button></h5></div>
<div id="collapse125" class="collapse" aria-labelledby="heading125" data-parent="#parent121"><div class="card-body"><html><body>
<div>
                        All data received from the client-side should be considered tainted and a potential risk,
                        regardless of the source or transport method.  For example, while hidden form fields,
                        cookies, or other headers may be obfuscated from a user, along with parameters passed in
                        ViewStates or other encapsulated forms, these can be modified by the user at the client-side in
                        memory, or in transit on the network. Similarly, data passed from binary or compiled components
                        can be modified in situ or in transit. 
                        </div>
                        <div>
                        <i><br></i>
                        </div>
                        <div>
                        <i>Furthermore, encryption only secures the data in transit between the two ends of the
                        encrypted tunnel (one end of which is typically controlled by the client); data passing through
                        the link may still be malicious. </i>
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        As such, all data from the client side must be subjected to strict validation, sanitization, and
                        encoding against expected syntactic and semantic criteria.
                        </div>
                        <div>
                        <ul>
                        <li>Define a specification of the data that is expected at each input; both the syntax
                        (e.g. alphanumeric only) and semantics (e.g. a word of between 1 and 25 characters, or a
                        specific list). As an example of business rule logic, "boat" may be
                        syntactically valid because it only contains alphanumeric characters, but it is not valid if the
                        input is only expected to contain colors such as "red" or "blue."</li>
                        <li>Implement a 'known good' or white-list approach, where only inputs that meet the
                        strict criteria for each input are accepted, and reject, transform, or encapsulate any
                        non-compliant data.</li>
                        <li>While useful for identifying malicious content, do not rely on looking for specific
                        malformed or attack payloads (blacklists). It is almost impossible to maintain a comprehensive
                        and accurate blacklist due to the complexity and evolving nature of attacks, opportunities to
                        obfuscate payloads, and changes to the code's execution environment. As noted, blacklists can be
                        useful for detecting and logging potential attacks, or determining which inputs are so malformed
                        that they should be rejected outright. </li>
                        <li>Validate all data received from the client, including values such as HTTP headers and
                        cookie values if these are used as input on the server side, X- headers, and other platform
                        specific data objects passed between the client and server.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading126" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse126" aria-expanded="false" aria-controls="collapse126" class="btn btn-light btn-group-toggle">Countermeasure: Validate all data received [DATA-VAL]</button></h5></div>
<div id="collapse126" class="collapse" aria-labelledby="heading126" data-parent="#parent121"><div class="card-body"><html><body>
<p>All data received should be considered tainted and a potential risk, regardless of the source or transport method. For example, while hidden form fields, cookies, or other headers may be obfuscated from a user, along with parameters passed in ViewStates or other encapsulated forms, these can be modified by the user at the client-side in memory, or in transit on the network. Similarly, data passed from binary or compiled components can be modified in situ or in transit. 
 <i></i> 
 <i>Furthermore, encryption only secures the data in transit between the two ends of the encrypted tunnel (one end of which is typically controlled by the client); data passing through the link may still be malicious.</i> </p>

 As such, all data from the client side must be subjected to strict validation, sanitization, and encoding against expected syntactic and semantic criteria. 
 – Define a specification of the data that is expected at each input; both the syntax (e.g. alphanumeric only) and semantics (e.g. a word of between 1 and 25 characters, or a specific list). As an example of business rule logic, "boat" may be syntactically valid because it only contains alphanumeric characters, but it is not valid if the input is only expected to contain colors such as "red" or "blue."
 – Implement a ‘known good’ or white-list approach, where only inputs that meet the strict criteria for each input are accepted, and reject, transform, or encapsulate any non-compliant data.
 – While useful for identifying malicious content, do not rely on looking for specific malformed or attack payloads (blacklists). It is almost impossible to maintain a comprehensive and accurate blacklist due to the complexity and evolving nature of attacks, opportunities to obfuscate payloads, and changes to the code’s execution environment. As noted, blacklists can be useful for detecting and logging potential attacks, or determining which inputs are so malformed that they should be rejected outright.
 – Validate all data received from the client, including values such as <span class="caps">HTTP</span> headers and cookie values if these are used as input on the server side, X- headers, and other platform specific data objects passed between the client and server.</body></html></div></div>
</div>
<div class="card border-success">
<div id="heading127" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse127" aria-expanded="false" aria-controls="collapse127" class="btn btn-light btn-group-toggle">Countermeasure: Validate all data received [DATA-VAL]</button></h5></div>
<div id="collapse127" class="collapse" aria-labelledby="heading127" data-parent="#parent121"><div class="card-body"><html><body>
<p>All data received should be considered tainted and a potential risk, regardless of the source or transport method. For example, while hidden form fields, cookies, or other headers may be obfuscated from a user, along with parameters passed in ViewStates or other encapsulated forms, these can be modified by the user at the client-side in memory, or in transit on the network. Similarly, data passed from binary or compiled components can be modified in situ or in transit. <i></i> <i>Furthermore, encryption only secures the data in transit between the two ends of the encrypted tunnel (one end of which is typically controlled by the client); data passing through the link may still be malicious.</i> </p> As such, all data from the client side must be subjected to strict validation, sanitization, and encoding against expected syntactic and semantic criteria. 
<div> 
 <ul> 
  <li>Define a specification of the data that is expected at each input; both the syntax (e.g. alphanumeric only) and semantics (e.g. a word of between 1 and 25 characters, or a specific list). As an example of business rule logic, "boat" may be syntactically valid because it only contains alphanumeric characters, but it is not valid if the input is only expected to contain colors such as "red" or "blue." </li> 
  <li>Implement a ‘known good’ or white-list approach, where only inputs that meet the strict criteria for each input are accepted, and reject, transform, or encapsulate any non-compliant data. </li> 
  <li>While useful for identifying malicious content, do not rely on looking for specific malformed or attack payloads (blacklists). It is almost impossible to maintain a comprehensive and accurate blacklist due to the complexity and evolving nature of attacks, opportunities to obfuscate payloads, and changes to the code’s execution environment. As noted, blacklists can be useful for detecting and logging potential attacks, or determining which inputs are so malformed that they should be rejected outright. </li> 
  <li>Validate all data received from the client, including values such as <span class="caps">HTTP</span> headers and cookie values if these are used as input on the server side, X- headers, and other platform specific data objects passed between the client and server.</li> 
 </ul> 
</div>
</body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading128" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse128" aria-expanded="false" aria-controls="collapse128" class="btn btn-light btn-group-toggle">Requirement: Verify that cryptographic algorithms used by the application have been validated against FIPS 140-2 or an equivalent standard. [7.7]</button></h5></div>
<div id="collapse128" class="collapse" aria-labelledby="heading128" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent128">
<div class="card border-success">
<div id="heading129" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse129" aria-expanded="false" aria-controls="collapse129" class="btn btn-light btn-group-toggle">Countermeasure: Ensure that only strong algorithms, cyphers and protocols are used [STRONG-ALGORITHMS-PROTOCOLS]</button></h5></div>
<div id="collapse129" class="collapse" aria-labelledby="heading129" data-parent="#parent128"><div class="card-body"><html><body>
<div>
                        Ensure that the application is using strong algorithms, cyphers and protocols. The general
                        practice and required minimum key lengths depend on the scenarios listed below.
                        </div>
                        <div>
                        <ul>
                        <li>Key exchange: Diffie-Hellman key exchange with minimum 2048 bits</li>
                        <li>Message Integrity: HMAC-SHA2</li>
                        <li>Message Hash: SHA2 256 bits</li>
                        <li>Asymmetric encryption: RSA 2048 bits</li>
                        <li>Symmetric-key algorithm: AES 128 bits</li>
                        <li>Password Hashing: Argon2, PBKDF2, Scrypt, Bcrypt.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading130" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse130" aria-expanded="false" aria-controls="collapse130" class="btn btn-light btn-group-toggle">Countermeasure: Require cryptographically secure protocols (e.g. TLSv1.2 and above) [TLS-STRONG-PROTOCOLS]</button></h5></div>
<div id="collapse130" class="collapse" aria-labelledby="heading130" data-parent="#parent128"><div class="card-body"><html><body>
<div>
                        Only cryptographically strong ciphers should be required. Best-practice dictates a subset of
                        'known good' ciphers and protocols be defined and enforced at the server.  This may,
                        however, have compatibility issues with older browsers, requiring a balance be sought between
                        accessibility and security. 
                        </div>
                        <ul>
                        <li>Define and enforce a list of acceptable ciphers and protocols. Disable SSLv3 and
                        earlier protocols on the service. </li>
                        <li>Ideally only TLSv1.2 and newer should be supported</li>
                        <li>If TLSv1.1 or 1.0 are required, known secure configurations and ciphers should be
                        selected.</li>
                        <li>SSLv3.0 and earlier should not be used</li>
                        </ul>
                    </body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading131" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse131" aria-expanded="false" aria-controls="collapse131" class="btn btn-light btn-group-toggle">Requirement: Verify that the application does not output error messages or stack traces containing sensitive data that could assist an attacker, including session id, software/framework versions and personal information [8.1]</button></h5></div>
<div id="collapse131" class="collapse" aria-labelledby="heading131" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent131"><div class="card border-success">
<div id="heading132" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse132" aria-expanded="false" aria-controls="collapse132" class="btn btn-light btn-group-toggle">Countermeasure: Ensure sensitive data is not revealed through error output messages. [ASVS-8.1]</button></h5></div>
<div id="collapse132" class="collapse" aria-labelledby="heading132" data-parent="#parent131"><div class="card-body"><html><body><p>Ensure the application does not output error messages or stack traces containing sensitive
                        data that could assist an attacker, including session id, software/framework versions and
                        personal information.
                    </p></body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading133" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse133" aria-expanded="false" aria-controls="collapse133" class="btn btn-light btn-group-toggle">Requirement: Time sources should be synchronized to ensure logs have the correct time [8.13]</button></h5></div>
<div id="collapse133" class="collapse" aria-labelledby="heading133" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent133">
<div class="card border-success">
<div id="heading134" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse134" aria-expanded="false" aria-controls="collapse134" class="btn btn-light btn-group-toggle">Countermeasure: Use a synchronised time source [CWE-662]</button></h5></div>
<div id="collapse134" class="collapse" aria-labelledby="heading134" data-parent="#parent133"><div class="card-body"><html><body>
<div>
                        In order to correlate logs and data from different internal and external systems, and to
                        preserve forensic quality of the logs, it is important a unified and trusted synchronized time
                        source is used throughout the environment.  
                        </div>
                        <div>
                        <ul>
                        <li>Servers should be synchronize to an internal or external NTP server</li>
                        <li>The centralized source should in turn use (or be) a trusted central time source.</li>
                        </ul>
                        </div>
                        <div>
                        This control is critical in identifying application events (including attacks) through logging,
                        and in conduction post-event analysis, in particular to track the whole user (or attacker)
                        journey through the system should it be compromised.
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        It is good practice to use the concept of Indicators of Compromise (IoC) should be used to
                        detect possible situations in which the system has been compromised and to give an appropriate
                        response.  IoCs are often tracked through logs, and accurate time is often essential.
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading135" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse135" aria-expanded="false" aria-controls="collapse135" class="btn btn-light btn-group-toggle">Countermeasure: Use a synchronised time source [CWE-662]</button></h5></div>
<div id="collapse135" class="collapse" aria-labelledby="heading135" data-parent="#parent133"><div class="card-body"><html><body>
<div>
                        In order to correlate logs and data from different internal and external systems, and to
                        preserve forensic quality of the logs, it is important a unified and trusted synchronized time
                        source is used throughout the environment.  
                        </div>
                        <div>
                        <ul>
                        <li>Servers should be synchronize to an internal or external NTP server</li>
                        <li>The centralized source should in turn use (or be) a trusted central time source.</li>
                        </ul>
                        </div>
                        <div>
                        This control is critical in identifying application events (including attacks) through logging,
                        and in conduction post-event analysis, in particular to track the whole user (or attacker)
                        journey through the system should it be compromised.
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        It is good practice to use the concept of Indicators of Compromise (IoC) should be used to
                        detect possible situations in which the system has been compromised and to give an appropriate
                        response.  IoCs are often tracked through logs, and accurate time is often essential.
                        </div>
                        <div>
                        <br>
                        </div>
                    </body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading136" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse136" aria-expanded="false" aria-controls="collapse136" class="btn btn-light btn-group-toggle">Requirement: Verify that all forms containing sensitive information have disabled client side caching, including autocomplete features. [9.1]</button></h5></div>
<div id="collapse136" class="collapse" aria-labelledby="heading136" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent136">
<div class="card border-success">
<div id="heading137" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse137" aria-expanded="false" aria-controls="collapse137" class="btn btn-light btn-group-toggle">Countermeasure: Disable authentication form autocomplete [CWE-525-AUTOCOMPLETE-FORM]</button></h5></div>
<div id="collapse137" class="collapse" aria-labelledby="heading137" data-parent="#parent136"><div class="card-body"><html><body>
<div>
                        Auto-completion or pre-filling of authentication details by the browser implies that credentials
                        are stored in plaintext or a reversible format. This may be in violation of security
                        best-practice, or application security expectations. The application should attempt to mitigate
                        this risk by requesting the browser does not cache or store credentials.
                        </div>
                        <div>
                        <ul>
                        <li>All forms handling sensitive data should be protected using the autocomplete=off HTML
                        directive at the form or field level.</li>
                        <li>Issue browser specific directives to request auto-fill or completion is disabled; The
                        AUTOCOMPLETE attribute should be set to "OFF".</li>
                        </ul>
                        <div>
                        It should be noted that compliance with these requests at the client-side is optional, and many
                        browsers and clients override these directives to use operating system, browser, or third party
                        password managers or key-safes to store secrets.
                        </div>
                        </div>
                        <div>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading138" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse138" aria-expanded="false" aria-controls="collapse138" class="btn btn-light btn-group-toggle">Countermeasure: Respond to login requests with HTTP 302 redirect [CWE-525-REPOST]</button></h5></div>
<div id="collapse138" class="collapse" aria-labelledby="heading138" data-parent="#parent136"><div class="card-body"><html><body>
<div>
                        Browsers may cache form data submitted through the HTTP POST method for persistence and replay
                        when the user browsers back and forward. This means that even after a user has logged out, a
                        subsequent party may use the navigation options to browse back to the page returned after login.
                        When browsing to this page, or reloading it, the browser may offer to resubmit the previous
                        data, including the username and password. This both exposes the user's account to immediate
                        attack, and gives the malicious party to intercept the POST request and retrieve the username,
                        password, and other submitted data.
                        </div>
                        <div>
                        <ul>
                        <li>Ensure the browser returns an HTTP 30x series response to any sensitive data submitted
                        in an HTTP POST request, in particular authentication requests and others containing the
                        password or other secret data.</li>
                        <li>This should be extended to failed requests; even compromise of a misspelt username or
                        password may enable an attacker to determine the correct credentials.</li>
                        </ul>
                        </div>
                        <div>
                        <br>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading139" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse139" aria-expanded="false" aria-controls="collapse139" class="btn btn-light btn-group-toggle">Countermeasure: Disable autocompletion of sensitive data [CWE-525-WEB]</button></h5></div>
<div id="collapse139" class="collapse" aria-labelledby="heading139" data-parent="#parent136"><div class="card-body"><html><body>
<div>
                        Auto-completion or pre-filling of sensitive details by the browser implies that those details
                        are stored in plaintext or a reversible format. This may be in violation of security
                        best-practice, or application security expectations. The application should attempt to mitigate
                        this risk by requesting the browser does not cache or store sensitive data such as credit card
                        PANs and CV2s, personally identifiable information (PII) or other secret data.
                        </div>
                        <div>
                        <ul>
                        <li>All forms handling sensitive data should be protected using the autocomplete=off HTML
                        directive at the form or field level.</li>
                        <li>Issue browser specific directives to request auto-fill or completion is disabled; The
                        AUTOCOMPLETE attribute should be set to "OFF".</li>
                        </ul>
                        <div>
                        It should be noted that compliance with these requests at the client-side is optional, and many
                        browsers and clients override these directives to use operating system, browser, or third party
                        password managers or key-safes to store secrets.
                        </div>
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        <br>
                        </div>
                    </body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading140" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse140" aria-expanded="false" aria-controls="collapse140" class="btn btn-light btn-group-toggle">Requirement: Verify that all sensitive data is sent to the server in the HTTP message body or headers (i.e., URL parameters are never used to send sensitive data). [9.3]</button></h5></div>
<div id="collapse140" class="collapse" aria-labelledby="heading140" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent140"><div class="card border-success">
<div id="heading141" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse141" aria-expanded="false" aria-controls="collapse141" class="btn btn-light btn-group-toggle">Countermeasure: Ensure no sensitive data is sent in the URL [CWE-598]</button></h5></div>
<div id="collapse141" class="collapse" aria-labelledby="heading141" data-parent="#parent140"><div class="card-body"><html><body>
<div>
                        Data passed in the URL (address bar) between client and server is likely to be exposed in logs
                        on the server, or intermediate devices (such as proxies or other network devices), or in local
                        browser logs/history. A common mistake is, for example, to pass a SessionID value as a parameter
                        in the URL of a get request between hosts. To mitigate the risk of exposure of sensitive data,
                        it should only be sent in the body of an HTTP message (for example a POST request), or in the
                        HTTP headers (either standard headers such as the Cookie values, or a custom X- header).
                        </div>
                        <div>
                        <ul>
                        <li>Ensure sensitive, private, or otherwise restricted data is not sent in a URL value.</li>
                        <li>Pass data only in appropriately protected fields in the body or headers.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading142" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse142" aria-expanded="false" aria-controls="collapse142" class="btn btn-light btn-group-toggle">Requirement: Verify that the application sets appropriate anti-caching headers as per the risk of the application [9.4]</button></h5></div>
<div id="collapse142" class="collapse" aria-labelledby="heading142" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent142"><div class="card border-success">
<div id="heading143" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse143" aria-expanded="false" aria-controls="collapse143" class="btn btn-light btn-group-toggle">Countermeasure: Set Cache-Control headers on sensitive and authenticated content [CWE-525-CACHING]</button></h5></div>
<div id="collapse143" class="collapse" aria-labelledby="heading143" data-parent="#parent142"><div class="card-body"><html><body>
<div>
                        Browsers, servers, and upstream/intermediate devices may cache (temporarily store) data sent in
                        HTTP sessions for performance reasons. The protocol allows for a number of HTTP headers and
                        directives to control what data may be cached, where, and for how long. It is important that
                        cache-controls are specified to prevent exposure of sensitive data through inappropriate caching
                        of authenticated and otherwise restricted access data, either in the users browser or other
                        devices.
                        </div>
                        <div>
                        <ul>
                        <li>Configure the server or application to set cache-control headers on sensitive content. </li>
                        <li>The following headers are recommended:</li>
                        <ul>
                        <li>Expires: Tue, 03 Jul 2001 06:00:00 GMT 9.4</li>
                        <li>Last-Modified: {now} GMT</li>
                        <li>Cache-Control: no-store, no-cache, must-revalidate, max-age=0</li>
                        <li>Cache-Control: post-check=0, pre-check=0</li>
                        <li>Pragma: no-cache </li>
                        </ul>
                        </ul>
                        <div>
                        <br>
                        </div>
                        </div>
                        <div>
                        <br>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading144" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse144" aria-expanded="false" aria-controls="collapse144" class="btn btn-light btn-group-toggle">Requirement: Verify that data stored in client side storage (such as HTML5 local storage, session storage, IndexedDB, regular cookies or Flash cookies) does not contain sensitive data or PII. [9.9]</button></h5></div>
<div id="collapse144" class="collapse" aria-labelledby="heading144" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent144"><div class="card border-success">
<div id="heading145" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse145" aria-expanded="false" aria-controls="collapse145" class="btn btn-light btn-group-toggle">Countermeasure: Do not store sensitive data on client side [CWE-922]</button></h5></div>
<div id="collapse145" class="collapse" aria-labelledby="heading145" data-parent="#parent144"><div class="card-body"><html><body>
<div>
                        Browsers and extensions provide a number of local storage options to persist data during HTTP
                        interactions, including (but not limited to) Cookies, HTML5 local storage, session storage,
                        IndexedDB, Flash! cookies, and Silverlight isolated storage. These storage options may all be
                        accessed by subsequent users of the browser or computer, and some have experienced security
                        vulnerabilities providing unauthorized and/or remote access to their contents. It is important
                        that sensitive, private, and otherwise restricted data is handled with care at the client-side,
                        and is not stored in insecure locations which may expose it to attack.
                        </div>
                        <div>
                        <ul>
                        <li>Do not store sensitive data in any kind of persistent, client-side storage.</li>
                        <li>Review any application or browser layer caching or temporary storage to ensure it
                        doesn't expose data.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading146" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse146" aria-expanded="false" aria-controls="collapse146" class="btn btn-light btn-group-toggle">Requirement: Verify that a path can be built from a trusted CA to each Transport Layer Security (TLS) server certificate, and that each server certificate is valid. [10.1]</button></h5></div>
<div id="collapse146" class="collapse" aria-labelledby="heading146" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent146"><div class="card border-success">
<div id="heading147" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse147" aria-expanded="false" aria-controls="collapse147" class="btn btn-light btn-group-toggle">Countermeasure: Validate the certificate presented by the server [CWE-295-CLIENT]</button></h5></div>
<div id="collapse147" class="collapse" aria-labelledby="heading147" data-parent="#parent146"><div class="card-body"><html><body>
<div>
                        Certificates presented by the server must be valid, provable, and cryptographically secure in
                        order to derive the benefits of TLS encrypted communications.  Invalid certificates
                        expose the application and its users to spoofing attacks such as Man In The Middle (MITM) where
                        data may be intercepted or redirected to a malicious site, and undermine confidence in the site.
                        </div>
                        <div>
                        <ul>
                        <li>
                        <div>
                        Validate that the certificate presented by the server is signed by a trusted Certificate
                        Authority.
                        </div>
</li>
                        <li>
                        <div>
                        Ensure the certificate chain of trust is legitimate and secure.
                        </div>
</li>
                        <li>
                        <div>
                        Verify cryptographically secure ciphers are in use throughout the chain, in particular strong
                        hashing algorithms are in use for certificate signatures. 
                        </div>
</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading148" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse148" aria-expanded="false" aria-controls="collapse148" class="btn btn-light btn-group-toggle">Requirement: Verify that TLS is used for all connections (including both external and backend connections) that are authenticated or that involve sensitive data or functions, and does not fall back to insecure or unencrypted protocols. Ensure the strongest alternative is the preferred algorithm. [10.3]</button></h5></div>
<div id="collapse148" class="collapse" aria-labelledby="heading148" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent148"><div class="card border-success">
<div id="heading149" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse149" aria-expanded="false" aria-controls="collapse149" class="btn btn-light btn-group-toggle">Countermeasure: Encrypt data between the client and server/service [CWE-319-TRANSPORT]</button></h5></div>
<div id="collapse149" class="collapse" aria-labelledby="heading149" data-parent="#parent148"><div class="card-body"><html><body>
<div>
                        Data passed between the client and server should be protected by encryption in transit.
                        </div>
                        <div>
                        <ul>
                        <li>Implement cryptographically strong TLS end-to-end encryption between the client and
                        server, terminating within a secure environment on the server-side.</li>
                        <li>Consider use of client certificates to prevent interception of (or man-in-the-middle
                        attacks on) the encrypted connection.</li>
                        <li>Alternatively, asymmetric (public-key) encryption could be utilized, although a
                        recognized, proven, and tested implementation/library should be used</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading150" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse150" aria-expanded="false" aria-controls="collapse150" class="btn btn-light btn-group-toggle">Requirement: Verify that HTTP Strict Transport Security headers are included on all requests and for all subdomains, such as Strict-Transport-Security: max-age=15724800; includeSubdomains [10.11]</button></h5></div>
<div id="collapse150" class="collapse" aria-labelledby="heading150" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent150"><div class="card border-success">
<div id="heading151" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse151" aria-expanded="false" aria-controls="collapse151" class="btn btn-light btn-group-toggle">Countermeasure: Set the HTTP security header 'Strict-Transport-Security' (HSTS) [CWE-693-STRICT-TRANSPORT-SECURITY]</button></h5></div>
<div id="collapse151" class="collapse" aria-labelledby="heading151" data-parent="#parent150"><div class="card-body"><html><body>
<div>
                        Modern browsers support the Strict-Transport-Security HTTP header. This header instructs the
                        browser to only communication over HTTPS for all subsequent requests to the domain, mitigating a
                        number of attacks designed to force users to switch to unencrypted transport to expose data.
                        </div>
                        <div>
                        <ul>
                        <li>Set the Strict-Transport-Security HTTP header in all server-responses.</li>
                        </ul>
                        </div>
                        <ul>
                        </ul>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading152" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse152" aria-expanded="false" aria-controls="collapse152" class="btn btn-light btn-group-toggle">Requirement: Ensure forward secrecy ciphers are in use to mitigate passive attackers recording traffic. [10.13]</button></h5></div>
<div id="collapse152" class="collapse" aria-labelledby="heading152" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent152"><div class="card border-success">
<div id="heading153" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse153" aria-expanded="false" aria-controls="collapse153" class="btn btn-light btn-group-toggle">Countermeasure: Require cryptographically strong TLS cipher suites [TLS-STRONG-CIPHERS]</button></h5></div>
<div id="collapse153" class="collapse" aria-labelledby="heading153" data-parent="#parent152"><div class="card-body"><html><body>
<p>Only cryptographically strong ciphers should be required. Best-practice dictates a subset of '
                        <i>known good</i>' ciphers and protocols be defined and enforced at the server.
                         This may, however, have compatibility issues with older browsers, requiring a balance
                        be sought between accessibility and security. 
                        </p>
<div>
                        <ul>
                        <li>Define and enforce a list of acceptable ciphers and protocols</li>
                        <li>Explicitly disable known-bad ciphers and protocols, such as:</li>
                        <ul>
                        <li>Null and export ciphers</li>
                        <li>DH, MD5 and other weak cryptography</li>
                        <li>Ciphers with keys less than 128 bits</li>
                        <li>CBC ciphers with TLSv1.0 or earlier</li>
                        </ul>
                        </ul>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading154" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse154" aria-expanded="false" aria-controls="collapse154" class="btn btn-light btn-group-toggle">Requirement: Verify that proper certification revocation, such as Online Certificate Status Protocol (OSCP) Stapling, is enabled and configured. [10.14]</button></h5></div>
<div id="collapse154" class="collapse" aria-labelledby="heading154" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent154"><div class="card border-success">
<div id="heading155" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse155" aria-expanded="false" aria-controls="collapse155" class="btn btn-light btn-group-toggle">Countermeasure: Configure and enable appropriate certification revocation [PROPER-REVOCATION-CERTIFICATE]</button></h5></div>
<div id="collapse155" class="collapse" aria-labelledby="heading155" data-parent="#parent154"><div class="card-body"><html><body>
<div>
                        Configure and enable appropriate certification revocation for each certificate created, such as
                        Online Certificate Status Protocol (OCSP) Stapling.
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        OCSP is a protocol to check if an SSL certificate has been revoked. Instead of the client
                        downloading a large list of revoked certificates, they can simply submit a request to a CA
                        server, which returns a signed response with the certificate current status.
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading156" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse156" aria-expanded="false" aria-controls="collapse156" class="btn btn-light btn-group-toggle">Requirement: Verify that only strong algorithms, ciphers, and protocols are used, through all the certificate hierarchy, including root and intermediary certificates of your selected certifying authority. [10.15]</button></h5></div>
<div id="collapse156" class="collapse" aria-labelledby="heading156" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent156"><div class="card border-success">
<div id="heading157" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse157" aria-expanded="false" aria-controls="collapse157" class="btn btn-light btn-group-toggle">Countermeasure: Ensure that only strong algorithms, cyphers and protocols are used [STRONG-ALGORITHMS-PROTOCOLS]</button></h5></div>
<div id="collapse157" class="collapse" aria-labelledby="heading157" data-parent="#parent156"><div class="card-body"><html><body>
<div>
                        Ensure that the application is using strong algorithms, cyphers and protocols. The general
                        practice and required minimum key lengths depend on the scenarios listed below.
                        </div>
                        <div>
                        <ul>
                        <li>Key exchange: Diffie-Hellman key exchange with minimum 2048 bits</li>
                        <li>Message Integrity: HMAC-SHA2</li>
                        <li>Message Hash: SHA2 256 bits</li>
                        <li>Asymmetric encryption: RSA 2048 bits</li>
                        <li>Symmetric-key algorithm: AES 128 bits</li>
                        <li>Password Hashing: Argon2, PBKDF2, Scrypt, Bcrypt.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading158" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse158" aria-expanded="false" aria-controls="collapse158" class="btn btn-light btn-group-toggle">Requirement: Verify that the TLS settings are in line with current leading practice, particularly as common configurations, ciphers, and algorithms become insecure. [10.16]</button></h5></div>
<div id="collapse158" class="collapse" aria-labelledby="heading158" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent158">
<div class="card border-success">
<div id="heading159" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse159" aria-expanded="false" aria-controls="collapse159" class="btn btn-light btn-group-toggle">Countermeasure: Require cryptographically secure protocols (e.g. TLSv1.2 and above) [TLS-STRONG-PROTOCOLS]</button></h5></div>
<div id="collapse159" class="collapse" aria-labelledby="heading159" data-parent="#parent158"><div class="card-body"><html><body>
<div>
                        Only cryptographically strong ciphers should be required. Best-practice dictates a subset of
                        'known good' ciphers and protocols be defined and enforced at the server.  This may,
                        however, have compatibility issues with older browsers, requiring a balance be sought between
                        accessibility and security. 
                        </div>
                        <ul>
                        <li>Define and enforce a list of acceptable ciphers and protocols. Disable SSLv3 and
                        earlier protocols on the service. </li>
                        <li>Ideally only TLSv1.2 and newer should be supported</li>
                        <li>If TLSv1.1 or 1.0 are required, known secure configurations and ciphers should be
                        selected.</li>
                        <li>SSLv3.0 and earlier should not be used</li>
                        </ul>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading160" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse160" aria-expanded="false" aria-controls="collapse160" class="btn btn-light btn-group-toggle">Countermeasure: Require cryptographically strong TLS cipher suites [TLS-STRONG-CIPHERS]</button></h5></div>
<div id="collapse160" class="collapse" aria-labelledby="heading160" data-parent="#parent158"><div class="card-body"><html><body>
<p>Only cryptographically strong ciphers should be required. Best-practice dictates a subset of '
                        <i>known good</i>' ciphers and protocols be defined and enforced at the server.
                         This may, however, have compatibility issues with older browsers, requiring a balance
                        be sought between accessibility and security. 
                        </p>
<div>
                        <ul>
                        <li>Define and enforce a list of acceptable ciphers and protocols</li>
                        <li>Explicitly disable known-bad ciphers and protocols, such as:</li>
                        <ul>
                        <li>Null and export ciphers</li>
                        <li>DH, MD5 and other weak cryptography</li>
                        <li>Ciphers with keys less than 128 bits</li>
                        <li>CBC ciphers with TLSv1.0 or earlier</li>
                        </ul>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading161" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse161" aria-expanded="false" aria-controls="collapse161" class="btn btn-light btn-group-toggle">Requirement: Verify that the application accepts only a defined set of required HTTP request methods, such as GET and POST are accepted, and unused methods (e.g. TRACE, PUT, and DELETE) are explicitly blocked. [11.1]</button></h5></div>
<div id="collapse161" class="collapse" aria-labelledby="heading161" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent161"><div class="card border-success">
<div id="heading162" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse162" aria-expanded="false" aria-controls="collapse162" class="btn btn-light btn-group-toggle">Countermeasure: Ensure that the application accepts only a defined set of required HTTP request methods [RESTRICT-HTTP-METHODS]</button></h5></div>
<div id="collapse162" class="collapse" aria-labelledby="heading162" data-parent="#parent161"><div class="card-body"><html><body>
<div>
                        HTTP offers a number of methods that can be used to perform actions on the web server. Many of
                        theses methods are designed to aid developers in deploying and testing HTTP applications. These
                        HTTP methods can be used for nefarious purposes if the web server is misconfigured.
                        Additionally, Cross Site Tracing (XST), a form of cross site scripting using the server's HTTP
                        TRACE method, is examined.
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        While GET and POST are by far the most common methods that are used to access information
                        provided by a web server, the Hypertext Transfer Protocol (HTTP) allows several other (and
                        somewhat less known) methods. RFC 2616 (which describes HTTP version 1.1 which is the standard
                        today) defines the following eight methods:
                        </div>
                        <div>
                        <ul>
                        <li>HEAD</li>
                        <li>GET</li>
                        <li>POST</li>
                        <li>PUT</li>
                        <li>DELETE</li>
                        <li>TRACE</li>
                        <li>OPTIONS</li>
                        <li>CONNECT</li>
                        </ul>
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        Some of these methods can potentially pose a security risk for a web application, as they allow
                        an attacker to modify the files stored on the web server and, in some scenarios, steal the
                        credentials of legitimate users. More specifically, the methods that should be disabled are the
                        following:
                        </div>
                        <div>
                        <ul>
                        <li>
<b>PUT: </b>This method allows a client to upload new files on the web
                        server. An attacker can exploit it by uploading malicious files (e.g.: an asp file that executes
                        commands by invoking cmd.exe), or by simply using the victim's server as a file repository.</li>
                        <li>
<b>DELETE:</b> This method allows a client to delete a file on the web
                        server. An attacker can exploit it as a very simple and direct way to deface a web site or to
                        mount a DoS attack.</li>
                        <li>
<b>CONNECT: </b>This method could allow a client to use the web server as
                        a proxy.</li>
                        <li>
<b>TRACE: </b>This method simply echoes back to the client whatever string
                        has been sent to the server, and is used mainly for debugging purposes. This method, originally
                        assumed harmless, can be used to mount an attack known as Cross Site Tracing, which has been
                        discovered by Jeremiah Grossman (see links at the bottom of the page).</li>
                        </ul>
                        </div>
                        <div>
                        If an application needs one or more of these methods, such as REST Web Services (which may
                        require PUT or DELETE), it is important to check that their usage is properly limited to trusted
                        users and safe conditions.
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        Ensure that the application accepts only the HTTP requests GET and POST. The HTTP requests
                        TRACE, PUT and DELETE are blocked.
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading163" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse163" aria-expanded="false" aria-controls="collapse163" class="btn btn-light btn-group-toggle">Requirement: Verify that every HTTP response contains a content type header specifying a safe character set (e.g., UTF-8, ISO 8859-1). [11.2]</button></h5></div>
<div id="collapse163" class="collapse" aria-labelledby="heading163" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent163">
<div class="card border-success">
<div id="heading164" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse164" aria-expanded="false" aria-controls="collapse164" class="btn btn-light btn-group-toggle">Countermeasure: Perform contextual HTML encoding of all user submitted data [CWE-79-ENCODE]</button></h5></div>
<div id="collapse164" class="collapse" aria-labelledby="heading164" data-parent="#parent163"><div class="card-body"><html><body>
<div>
                        All data received from the client-side should be considered tainted and a potential risk. If
                        handled properly at the point of input, this untrusted tainted data should have been sanitized
                        and encoded safely. The context when returning the data to the user is important, however, as
                        this will affect what metacharacters have significance, and how they will be interpreted at the
                        client-side.
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        For example, if data is inserted into the HTML body then HTML Entity encoding should be
                        performed, but if the data is inserted into a JavaScript block, then JavaScript escaping should
                        be performed. Similarly, while JavaScript code should not be executed in the browser when
                        returned in an application/json response, it may then be rendered in an unsafe manner.
                        </div>
                        <div>
                        <ul>
                        <li>Apply contextual encoding to all tainted data when returned to the users (including
                        secondary users if the application has multiple interfaces - e.g. an internal user viewing data
                        entered by an external customer).</li>
                        <li>This should be in addition to, and in conjunction with, sanitization and encoding
                        applied at the time of data acquisition.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading165" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse165" aria-expanded="false" aria-controls="collapse165" class="btn btn-light btn-group-toggle">Countermeasure: Perform contextual HTML encoding of all user submitted data [CWE-79-ENCODE]</button></h5></div>
<div id="collapse165" class="collapse" aria-labelledby="heading165" data-parent="#parent163"><div class="card-body"><html><body>
<p>All data received from the client-side should be considered tainted and a potential risk. If handled properly at the point of input, this untrusted tainted data should have been sanitized and encoded safely. The context when returning the data to the user is important, however, as this will affect what metacharacters have significance, and how they will be interpreted at the client-side. </p>

 For example, if data is inserted into the <span class="caps">HTML</span> body then <span class="caps">HTML</span> Entity encoding should be performed, but if the data is inserted into a JavaScript block, then JavaScript escaping should be performed. Similarly, while JavaScript code should not be executed in the browser when returned in an application/json response, it may then be rendered in an unsafe manner. 
 – Apply contextual encoding to all tainted data when returned to the users (including secondary users if the application has multiple interfaces – e.g. an internal user viewing data entered by an external customer).
 – This should be in addition to, and in conjunction with, sanitization and encoding applied at the time of data acquisition.</body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading166" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse166" aria-expanded="false" aria-controls="collapse166" class="btn btn-light btn-group-toggle">Requirement: Verify that the HTTP headers or any part of the HTTP response do not expose detailed version information of system components. [11.5]</button></h5></div>
<div id="collapse166" class="collapse" aria-labelledby="heading166" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent166"><div class="card border-success">
<div id="heading167" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse167" aria-expanded="false" aria-controls="collapse167" class="btn btn-light btn-group-toggle">Countermeasure: Do not share system information in HTTP headers and responses [ASVS-11.5]</button></h5></div>
<div id="collapse167" class="collapse" aria-labelledby="heading167" data-parent="#parent166"><div class="card-body"><html><body><p>The application shall not share detailed version information of system components or other
                        information that would assist attackers in the HTTP header or HTTP responses.
                    </p></body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading168" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse168" aria-expanded="false" aria-controls="collapse168" class="btn btn-light btn-group-toggle">Requirement: Verify that all API responses contain X-Content-Type-Options: nosniff and Content-Disposition: attachment; filename="api.json" (or other appropriate filename for the content type). [11.6]</button></h5></div>
<div id="collapse168" class="collapse" aria-labelledby="heading168" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent168"><div class="card border-success">
<div id="heading169" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse169" aria-expanded="false" aria-controls="collapse169" class="btn btn-light btn-group-toggle">Countermeasure: Set the HTTP security header 'X-Content-Type-Options' from the server [CWE-693-NOSNIFF]</button></h5></div>
<div id="collapse169" class="collapse" aria-labelledby="heading169" data-parent="#parent168"><div class="card-body"><html><body>
<div>
                        A number of browser-based attacks rely on incorrectly stating MIME types on content in an
                        attempt to bypass server and browser controls to render malicious content for the user.
                        </div>
                        <div>
                        <ul>
                        <li>Set the <i>X-Content-Type-Options: nosniff</i> header on any page
                        that displays previously uploaded content to prevent some XSS and related attacks.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading170" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse170" aria-expanded="false" aria-controls="collapse170" class="btn btn-light btn-group-toggle">Requirement: Verify that a content security policy (CSPv2) is in place that helps mitigate common DOM, XSS, JSON, and JavaScript injection vulnerabilities.  [11.7]</button></h5></div>
<div id="collapse170" class="collapse" aria-labelledby="heading170" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent170"><div class="card border-success">
<div id="heading171" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse171" aria-expanded="false" aria-controls="collapse171" class="btn btn-light btn-group-toggle">Countermeasure: Define a restrictive 'least privilege' Content Security Policy [WEB-CSP]</button></h5></div>
<div id="collapse171" class="collapse" aria-labelledby="heading171" data-parent="#parent170"><div class="card-body"><html><body>
<div>
                        The Content-Security-Policy instructs compliant browsers on how they may interact with external
                        sites while in the current context. This enables the server to control interactive with code and
                        content from third parties, mitigating some client-side code injection attacks. The policy
                        allows the server to specify what connections are permitted for each type of resource.
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        For example, the following policy tells the browser to allow connections to the same domain to
                        which the page was served. and websocket connections to the domain *.iriusrisk.com.
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        Content-Security-Policy: default-src 'self'; script-src 'self'; style-src 'self'
                        'unsafe-inline'; connect-src 'self' wss://*.iriusrisk.com; img-src 'self' data:
                        </div>
                        <div>
                        <ul>
                        <li>Define and set a Content-Security-Policy with least-privilege to allow only those
                        interactions that are explicitly required. </li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading172" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse172" aria-expanded="false" aria-controls="collapse172" class="btn btn-light btn-group-toggle">Requirement: Verify that the X-XSS-Protection: 1; mode=block header is in place. [11.8]</button></h5></div>
<div id="collapse172" class="collapse" aria-labelledby="heading172" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent172"><div class="card border-success">
<div id="heading173" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse173" aria-expanded="false" aria-controls="collapse173" class="btn btn-light btn-group-toggle">Countermeasure: Set the HTTP security header 'X-XSS-Protection' from the server [CWE-693-X-XSS-PROTECTION]</button></h5></div>
<div id="collapse173" class="collapse" aria-labelledby="heading173" data-parent="#parent172"><div class="card-body"><html><body>
<div>
                        <div>
                        Modern browsers including IE8 and recent WebKit based implementation such as Safari and Chrome
                        have optional additional XSS prevention controls built-in. These controls are activated using
                        the X-XSS-Protection header.
                        </div>
                        </div>
                        <div>
                        <ul>
                        <li>Set the <i>X-XSS-Protection: 1; mode=block</i> header at the server-side
                        on all content.</li>
                        </ul>
                        </div>
                        <blockquote>
                        </blockquote>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading174" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse174" aria-expanded="false" aria-controls="collapse174" class="btn btn-light btn-group-toggle">Requirement: Verify that URL redirects and forwards only allow whitelisted destinations, or show a warning when redirecting to potentially untrusted content. [16.1]</button></h5></div>
<div id="collapse174" class="collapse" aria-labelledby="heading174" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent174"><div class="card border-success">
<div id="heading175" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse175" aria-expanded="false" aria-controls="collapse175" class="btn btn-light btn-group-toggle">Countermeasure: Whitelist to which URLs the application can redirect to [CWE-601]</button></h5></div>
<div id="collapse175" class="collapse" aria-labelledby="heading175" data-parent="#parent174"><div class="card-body"><html><body><p>The application should maintain a list of the URLs to which it can redirect. This whitelisting
                        can also be done by applying a regular expression. The application should only allow redirects
                        to trusted URLS.
                    </p></body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading176" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse176" aria-expanded="false" aria-controls="collapse176" class="btn btn-light btn-group-toggle">Requirement: Verify that untrusted file data submitted to the application is not used directly with file I/O commands, particularly to protect against path traversal, local file include, file mime type, and OS command injection vulnerabilities. [16.2]</button></h5></div>
<div id="collapse176" class="collapse" aria-labelledby="heading176" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent176">
<div class="card border-success">
<div id="heading177" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse177" aria-expanded="false" aria-controls="collapse177" class="btn btn-light btn-group-toggle">Countermeasure: Validate the file format before processing [FILE-DATA-CHECK]</button></h5></div>
<div id="collapse177" class="collapse" aria-labelledby="heading177" data-parent="#parent176"><div class="card-body"><html><body>
<div>
                        Attackers may attempt to bypass controls on uploaded content by renaming, embedding, or
                        otherwise manipulating benign files with malicious content. As with client-side data, the
                        application should screen uploaded content before processing it.
                        </div>
                        <div>
                        <ul>
                        <li>File contents and and file-system path data must to be checked for sanity.</li>
                        <li>Consider directory traversal, local file inclusion, and OS injection attacks when
                        validating filenames.</li>
                        <li>Verify MIME type is correct and appropriate, and matches content.</li>
                        <li>Files with an structured format should be checked against the expected
                        format/definition (e.g. XML against a XSD or DTD).</li>
                        </ul>
                        </div>
                        <div>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading178" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse178" aria-expanded="false" aria-controls="collapse178" class="btn btn-light btn-group-toggle">Countermeasure: Validate the file format before processing [FILE-DATA-CHECK]</button></h5></div>
<div id="collapse178" class="collapse" aria-labelledby="heading178" data-parent="#parent176"><div class="card-body"><html><body>
<div>
  Attackers may attempt to bypass controls on uploaded content by renaming, embedding, or otherwise manipulating benign files with malicious content. As with client-side data, the application should screen uploaded content before processing it. 
</div> 
<div> 
 <ul> 
  <li>File contents and and file-system path data must to be checked for sanity.</li> 
  <li>Consider directory traversal, local file inclusion, and OS injection attacks when validating filenames.</li> 
  <li>Verify MIME type is correct and appropriate, and matches content.</li> 
  <li>Files with an structured format should be checked against the expected format/definition (e.g. XML against a XSD or DTD).</li> 
 </ul> 
</div> 
<div> 
</div>
</body></html></div></div>
</div>
<div class="card border-success">
<div id="heading179" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse179" aria-expanded="false" aria-controls="collapse179" class="btn btn-light btn-group-toggle">Countermeasure: Validate all data received from the client side [DATA-VAL]</button></h5></div>
<div id="collapse179" class="collapse" aria-labelledby="heading179" data-parent="#parent176"><div class="card-body"><html><body>
<div>
                        All data received from the client-side should be considered tainted and a potential risk,
                        regardless of the source or transport method.  For example, while hidden form fields,
                        cookies, or other headers may be obfuscated from a user, along with parameters passed in
                        ViewStates or other encapsulated forms, these can be modified by the user at the client-side in
                        memory, or in transit on the network. Similarly, data passed from binary or compiled components
                        can be modified in situ or in transit. 
                        </div>
                        <div>
                        <i><br></i>
                        </div>
                        <div>
                        <i>Furthermore, encryption only secures the data in transit between the two ends of the
                        encrypted tunnel (one end of which is typically controlled by the client); data passing through
                        the link may still be malicious. </i>
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        As such, all data from the client side must be subjected to strict validation, sanitization, and
                        encoding against expected syntactic and semantic criteria.
                        </div>
                        <div>
                        <ul>
                        <li>Define a specification of the data that is expected at each input; both the syntax
                        (e.g. alphanumeric only) and semantics (e.g. a word of between 1 and 25 characters, or a
                        specific list). As an example of business rule logic, "boat" may be
                        syntactically valid because it only contains alphanumeric characters, but it is not valid if the
                        input is only expected to contain colors such as "red" or "blue."</li>
                        <li>Implement a 'known good' or white-list approach, where only inputs that meet the
                        strict criteria for each input are accepted, and reject, transform, or encapsulate any
                        non-compliant data.</li>
                        <li>While useful for identifying malicious content, do not rely on looking for specific
                        malformed or attack payloads (blacklists). It is almost impossible to maintain a comprehensive
                        and accurate blacklist due to the complexity and evolving nature of attacks, opportunities to
                        obfuscate payloads, and changes to the code's execution environment. As noted, blacklists can be
                        useful for detecting and logging potential attacks, or determining which inputs are so malformed
                        that they should be rejected outright. </li>
                        <li>Validate all data received from the client, including values such as HTTP headers and
                        cookie values if these are used as input on the server side, X- headers, and other platform
                        specific data objects passed between the client and server.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading180" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse180" aria-expanded="false" aria-controls="collapse180" class="btn btn-light btn-group-toggle">Countermeasure: Use JSON.parse to safely parse JSON objects [CWE-94]</button></h5></div>
<div id="collapse180" class="collapse" aria-labelledby="heading180" data-parent="#parent176"><div class="card-body"><html><body>
<div>
                        AJAX requests used to pass data between the client- and server- can contain any data, including
                        malicious executable content. This data must be parsed in a safe manner to prevent malicious
                        code being executed to compromise the application or it's users. Utilizing eval based solutions
                        to process input data places the application at risk, as the malicious user has control over the
                        data passed to the eval function, and could execute arbitrary code as a result. JSON.parse
                        provides a means to convert the JSON payloads into an object without risk of execution.
                        </div>
                        <div>
                        <ul>
                        <li>Ensure all tainted and potentially malicious data is processed using JSON.parse.</li>
                        <li>Data should be validated and sanitized using appropriate syntactic and semantic
                        checks, ideally against a white-list of known-good input.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading181" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse181" aria-expanded="false" aria-controls="collapse181" class="btn btn-light btn-group-toggle">Countermeasure: Validate all data received [DATA-VAL]</button></h5></div>
<div id="collapse181" class="collapse" aria-labelledby="heading181" data-parent="#parent176"><div class="card-body"><html><body>
<p>All data received should be considered tainted and a potential risk, regardless of the source or transport method. For example, while hidden form fields, cookies, or other headers may be obfuscated from a user, along with parameters passed in ViewStates or other encapsulated forms, these can be modified by the user at the client-side in memory, or in transit on the network. Similarly, data passed from binary or compiled components can be modified in situ or in transit. 
 <i></i> 
 <i>Furthermore, encryption only secures the data in transit between the two ends of the encrypted tunnel (one end of which is typically controlled by the client); data passing through the link may still be malicious.</i> </p>

 As such, all data from the client side must be subjected to strict validation, sanitization, and encoding against expected syntactic and semantic criteria. 
 – Define a specification of the data that is expected at each input; both the syntax (e.g. alphanumeric only) and semantics (e.g. a word of between 1 and 25 characters, or a specific list). As an example of business rule logic, "boat" may be syntactically valid because it only contains alphanumeric characters, but it is not valid if the input is only expected to contain colors such as "red" or "blue."
 – Implement a ‘known good’ or white-list approach, where only inputs that meet the strict criteria for each input are accepted, and reject, transform, or encapsulate any non-compliant data.
 – While useful for identifying malicious content, do not rely on looking for specific malformed or attack payloads (blacklists). It is almost impossible to maintain a comprehensive and accurate blacklist due to the complexity and evolving nature of attacks, opportunities to obfuscate payloads, and changes to the code’s execution environment. As noted, blacklists can be useful for detecting and logging potential attacks, or determining which inputs are so malformed that they should be rejected outright.
 – Validate all data received from the client, including values such as <span class="caps">HTTP</span> headers and cookie values if these are used as input on the server side, X- headers, and other platform specific data objects passed between the client and server.</body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading182" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse182" aria-expanded="false" aria-controls="collapse182" class="btn btn-light btn-group-toggle">Requirement: Verify that files obtained from untrusted sources are validated to be of expected type and scanned by antivirus scanners to prevent upload of known malicious content. [16.3]</button></h5></div>
<div id="collapse182" class="collapse" aria-labelledby="heading182" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent182">
<div class="card border-success">
<div id="heading183" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse183" aria-expanded="false" aria-controls="collapse183" class="btn btn-light btn-group-toggle">Countermeasure: Perform content scanning on untrusted files when uploaded [FILE-SCAN]</button></h5></div>
<div id="collapse183" class="collapse" aria-labelledby="heading183" data-parent="#parent182"><div class="card-body"><html><body>
<div>
                        The application should perform validation and sanitization on all tainted content from the
                        client-side, including uploaded files. 
                        </div>
                        <div>
                        <ul>
                        <li>Content/malware scanning performed against the file (e.g. next generation anti-virus)
                        to detect suspicious, dangerous, or unexpected content.</li>
                        <li>Content analysis should also be used to reject unexpected or dangerous file formats
                        that may harbor malicious code, for example encrypted word, pdf or other office documents or
                        archives, or other files with hidden or executable payloads.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading184" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse184" aria-expanded="false" aria-controls="collapse184" class="btn btn-light btn-group-toggle">Countermeasure: Perform content scanning on untrusted files when uploaded [FILE-SCAN]</button></h5></div>
<div id="collapse184" class="collapse" aria-labelledby="heading184" data-parent="#parent182"><div class="card-body"><html><body>
<div>
  The application should perform validation and sanitization on all tainted content from the client-side, including uploaded files.  
</div> 
<div> 
 <ul> 
  <li>Content/malware scanning performed against the file (e.g. next generation anti-virus) to detect suspicious, dangerous, or unexpected content.</li> 
  <li>Content analysis should also be used to reject unexpected or dangerous file formats that may harbor malicious code, for example encrypted word, pdf or other office documents or archives, or other files with hidden or executable payloads.</li> 
 </ul> 
</div>
</body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading185" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse185" aria-expanded="false" aria-controls="collapse185" class="btn btn-light btn-group-toggle">Requirement: Verify that untrusted data is not used within inclusion, class loader, or reflection capabilities to prevent remote/local file inclusion vulnerabilities. [16.4]</button></h5></div>
<div id="collapse185" class="collapse" aria-labelledby="heading185" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent185">
<div class="card border-success">
<div id="heading186" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse186" aria-expanded="false" aria-controls="collapse186" class="btn btn-light btn-group-toggle">Countermeasure: Do not use untrusted client-side data in server-side file operations [WEB-FILE-DATA]</button></h5></div>
<div id="collapse186" class="collapse" aria-labelledby="heading186" data-parent="#parent185"><div class="card-body"><html><body>
<div>
                        The application may be required to base server-side file operations based on client-side
                        actions. This can expose the application to attack through remote or local file-inclusion, or
                        remote code execution attacks if unsafe data is used in file inclusion, class loader, or
                        reflection capabilities.
                        </div>
                        <div>
                        <ul>
                        <li>Tainted, untrusted, client-side data must not be used directly in server-side file
                        load operations.</li>
                        <li>Where server-side operations are dependent on client-side input, this should be mapped
                        to pre-defined operations on the server-side rather than using tainted client-side input
                        directly.</li>
                        </ul>
                        </div>
                        <div></div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading187" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse187" aria-expanded="false" aria-controls="collapse187" class="btn btn-light btn-group-toggle">Countermeasure: Do not use untrusted client-side data in server-side file operations [WEB-FILE-DATA]</button></h5></div>
<div id="collapse187" class="collapse" aria-labelledby="heading187" data-parent="#parent185"><div class="card-body"><html><body>
<div>
  The application may be required to base server-side file operations based on client-side actions. This can expose the application to attack through remote or local file-inclusion, or remote code execution attacks if unsafe data is used in file inclusion, class loader, or reflection capabilities. 
</div> 
<div> 
 <ul> 
  <li>Tainted, untrusted, client-side data must not be used directly in server-side file load operations.</li> 
  <li>Where server-side operations are dependent on client-side input, this should be mapped to pre-defined operations on the server-side rather than using tainted client-side input directly.</li> 
 </ul> 
</div> 
<div></div>
</body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading188" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse188" aria-expanded="false" aria-controls="collapse188" class="btn btn-light btn-group-toggle">Requirement: Verify that untrusted data is not used within cross-domain resource sharing (CORS) to protect against arbitrary remote content. [16.5]</button></h5></div>
<div id="collapse188" class="collapse" aria-labelledby="heading188" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent188"><div class="card border-success">
<div id="heading189" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse189" aria-expanded="false" aria-controls="collapse189" class="btn btn-light btn-group-toggle">Countermeasure: Restrict Cross Domain Origin policy through HTTP headers [CWE-942-CORS]</button></h5></div>
<div id="collapse189" class="collapse" aria-labelledby="heading189" data-parent="#parent188"><div class="card-body"><html><body>
<div>
                        If an overly permissive policy is specified then an attacker may be able to execute malicious
                        code hosted on a third party site in the victim's browser under the security trust of the
                        legitimate application. To prevent this:
                        </div>
                        <div>
                        <ul>
                        <li>Set the Access-Control-Allow-Origin header to only permit explicitly required trusted
                        domains.</li>
                        <li>This set should be as small as possible, and follow the 'least privilege' paradigm.</li>
                        <li>Do not use untrusted or tainted user-data from untrusted domains in CORS responses
                        without proper validation and sanitization.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading190" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse190" aria-expanded="false" aria-controls="collapse190" class="btn btn-light btn-group-toggle">Requirement: Verify the application code does not execute uploaded data obtained from untrusted sources. [16.8]</button></h5></div>
<div id="collapse190" class="collapse" aria-labelledby="heading190" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent190">
<div class="card border-success">
<div id="heading191" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse191" aria-expanded="false" aria-controls="collapse191" class="btn btn-light btn-group-toggle">Countermeasure: Do not execute files received from untrusted sources [WEB-EXEC-DATA]</button></h5></div>
<div id="collapse191" class="collapse" aria-labelledby="heading191" data-parent="#parent190"><div class="card-body"><html><body>
<div></div>
                        <div>
                        Untrusted file data sources could contain malicious software, data sources should not be
                        executed even if an anti-malware scanner has been run against the file.  
                        </div>This includes use of pre-processing that may result in execution (e.g. eval of
                        tainted content).
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading192" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse192" aria-expanded="false" aria-controls="collapse192" class="btn btn-light btn-group-toggle">Countermeasure: Do not execute files received from untrusted sources [WEB-EXEC-DATA]</button></h5></div>
<div id="collapse192" class="collapse" aria-labelledby="heading192" data-parent="#parent190"><div class="card-body"><html><body>
<div></div> 
<div>
  Untrusted file data sources could contain malicious software, data sources should not be executed even if an anti-malware scanner has been run against the file.   
</div>This includes use of pre-processing that may result in execution (e.g. eval of tainted content).</body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading193" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse193" aria-expanded="false" aria-controls="collapse193" class="btn btn-light btn-group-toggle">Requirement: Do not use Flash, Active-X, Silverlight, NACL, client-side Java or other client side technologies not supported natively via W3C browser standards. [16.9]</button></h5></div>
<div id="collapse193" class="collapse" aria-labelledby="heading193" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent193"><div class="card border-success">
<div id="heading194" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse194" aria-expanded="false" aria-controls="collapse194" class="btn btn-light btn-group-toggle">Countermeasure: Use W3C browser standards only [ONLY-WITH-W3C]</button></h5></div>
<div id="collapse194" class="collapse" aria-labelledby="heading194" data-parent="#parent193"><div class="card-body"><html><body><p>Do not use Flash, Active-X, Silverlight, NACL, client-side Java or other client side
                        technologies not supported natively by W3C browser standards.
                    </p></body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading195" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse195" aria-expanded="false" aria-controls="collapse195" class="btn btn-light btn-group-toggle">Requirement: Verify that the same encoding style is used between the client and the server. [18.1]</button></h5></div>
<div id="collapse195" class="collapse" aria-labelledby="heading195" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent195"><div class="card border-success">
<div id="heading196" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse196" aria-expanded="false" aria-controls="collapse196" class="btn btn-light btn-group-toggle">Countermeasure: Ensure that the client-side and the server-side are using the same encoding style [SAME-ENCODING-STYLE]</button></h5></div>
<div id="collapse196" class="collapse" aria-labelledby="heading196" data-parent="#parent195"><div class="card-body"><html><body><p>Ensure that the client-side and the server-side are using the same encoding style.</p></body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading197" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse197" aria-expanded="false" aria-controls="collapse197" class="btn btn-light btn-group-toggle">Requirement: Verify that access to administration and management functions within the Web Service Application is limited to web service administrators. [18.2]</button></h5></div>
<div id="collapse197" class="collapse" aria-labelledby="heading197" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent197"><div class="card border-success">
<div id="heading198" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse198" aria-expanded="false" aria-controls="collapse198" class="btn btn-light btn-group-toggle">Countermeasure: Restrict access to administrative functionality [WEB-SRV-ADM-AUTH]</button></h5></div>
<div id="collapse198" class="collapse" aria-labelledby="heading198" data-parent="#parent197"><div class="card-body"><html><body>
<div>
                        If inadequate controls are in place, lower privileged users may be able to access higher
                        privilege or administrative functionality to subvert security within the application.
                        </div>
                        <div>
                        <ul>
                        <li>Restrict administration functions to designated administrators only through robust
                        access controls.</li>
                        <li>Ensure this restriction is applied at the server-side; do not rely on 'secret' areas
                        of the application, menu hiding, or other client-side techniques to protect the functionality.</li>
                        <li>Measures to prevent cross-site request forgery must be present on administrative
                        functions.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading199" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse199" aria-expanded="false" aria-controls="collapse199" class="btn btn-light btn-group-toggle">Requirement: Verify that XML or JSON schema is in place and verified before accepting input. [18.3]</button></h5></div>
<div id="collapse199" class="collapse" aria-labelledby="heading199" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent199"><div class="card border-success">
<div id="heading200" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse200" aria-expanded="false" aria-controls="collapse200" class="btn btn-light btn-group-toggle">Countermeasure: Define and enforce secure validation through an XSD or DSD schema on XML input data [WEB-SRV-XML]</button></h5></div>
<div id="collapse200" class="collapse" aria-labelledby="heading200" data-parent="#parent199"><div class="card-body"><html><body>
<div>
                        The XML standards provide for formal validation criteria to be specified in a schema (XSD or
                        DTD). Defining a schema with security in mind, and enforcing it on input data, will mitigate
                        many attacks.
                        </div>
                        <div>
                        <ul>
                        <li>Define an XSD or DTD schema with secure input validation criteria.</li>
                        <li>Validate all XML input data against the schema before processing it.</li>
                        <li>The acceptance of unvalidated or non compliant data could have unexpected effects
                        behavior of the application, and may facilitate attacks such as SQL injection.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading201" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse201" aria-expanded="false" aria-controls="collapse201" class="btn btn-light btn-group-toggle">Requirement: Verify that all input is limited to an appropriate size limit. [18.4]</button></h5></div>
<div id="collapse201" class="collapse" aria-labelledby="heading201" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent201">
<div class="card border-success">
<div id="heading202" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse202" aria-expanded="false" aria-controls="collapse202" class="btn btn-light btn-group-toggle">Countermeasure: Validate all data received from the client side [DATA-VAL]</button></h5></div>
<div id="collapse202" class="collapse" aria-labelledby="heading202" data-parent="#parent201"><div class="card-body"><html><body>
<div>
                        All data received from the client-side should be considered tainted and a potential risk,
                        regardless of the source or transport method.  For example, while hidden form fields,
                        cookies, or other headers may be obfuscated from a user, along with parameters passed in
                        ViewStates or other encapsulated forms, these can be modified by the user at the client-side in
                        memory, or in transit on the network. Similarly, data passed from binary or compiled components
                        can be modified in situ or in transit. 
                        </div>
                        <div>
                        <i><br></i>
                        </div>
                        <div>
                        <i>Furthermore, encryption only secures the data in transit between the two ends of the
                        encrypted tunnel (one end of which is typically controlled by the client); data passing through
                        the link may still be malicious. </i>
                        </div>
                        <div>
                        <br>
                        </div>
                        <div>
                        As such, all data from the client side must be subjected to strict validation, sanitization, and
                        encoding against expected syntactic and semantic criteria.
                        </div>
                        <div>
                        <ul>
                        <li>Define a specification of the data that is expected at each input; both the syntax
                        (e.g. alphanumeric only) and semantics (e.g. a word of between 1 and 25 characters, or a
                        specific list). As an example of business rule logic, "boat" may be
                        syntactically valid because it only contains alphanumeric characters, but it is not valid if the
                        input is only expected to contain colors such as "red" or "blue."</li>
                        <li>Implement a 'known good' or white-list approach, where only inputs that meet the
                        strict criteria for each input are accepted, and reject, transform, or encapsulate any
                        non-compliant data.</li>
                        <li>While useful for identifying malicious content, do not rely on looking for specific
                        malformed or attack payloads (blacklists). It is almost impossible to maintain a comprehensive
                        and accurate blacklist due to the complexity and evolving nature of attacks, opportunities to
                        obfuscate payloads, and changes to the code's execution environment. As noted, blacklists can be
                        useful for detecting and logging potential attacks, or determining which inputs are so malformed
                        that they should be rejected outright. </li>
                        <li>Validate all data received from the client, including values such as HTTP headers and
                        cookie values if these are used as input on the server side, X- headers, and other platform
                        specific data objects passed between the client and server.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading203" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse203" aria-expanded="false" aria-controls="collapse203" class="btn btn-light btn-group-toggle">Countermeasure: Validate all data received [DATA-VAL]</button></h5></div>
<div id="collapse203" class="collapse" aria-labelledby="heading203" data-parent="#parent201"><div class="card-body"><html><body>
<p>All data received should be considered tainted and a potential risk, regardless of the source or transport method. For example, while hidden form fields, cookies, or other headers may be obfuscated from a user, along with parameters passed in ViewStates or other encapsulated forms, these can be modified by the user at the client-side in memory, or in transit on the network. Similarly, data passed from binary or compiled components can be modified in situ or in transit. 
 <i></i> 
 <i>Furthermore, encryption only secures the data in transit between the two ends of the encrypted tunnel (one end of which is typically controlled by the client); data passing through the link may still be malicious.</i> </p>

 As such, all data from the client side must be subjected to strict validation, sanitization, and encoding against expected syntactic and semantic criteria. 
 – Define a specification of the data that is expected at each input; both the syntax (e.g. alphanumeric only) and semantics (e.g. a word of between 1 and 25 characters, or a specific list). As an example of business rule logic, "boat" may be syntactically valid because it only contains alphanumeric characters, but it is not valid if the input is only expected to contain colors such as "red" or "blue."
 – Implement a ‘known good’ or white-list approach, where only inputs that meet the strict criteria for each input are accepted, and reject, transform, or encapsulate any non-compliant data.
 – While useful for identifying malicious content, do not rely on looking for specific malformed or attack payloads (blacklists). It is almost impossible to maintain a comprehensive and accurate blacklist due to the complexity and evolving nature of attacks, opportunities to obfuscate payloads, and changes to the code’s execution environment. As noted, blacklists can be useful for detecting and logging potential attacks, or determining which inputs are so malformed that they should be rejected outright.
 – Validate all data received from the client, including values such as <span class="caps">HTTP</span> headers and cookie values if these are used as input on the server side, X- headers, and other platform specific data objects passed between the client and server.</body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading204" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse204" aria-expanded="false" aria-controls="collapse204" class="btn btn-light btn-group-toggle">Requirement: Verify that SOAP based web services are compliant with Web Services-Interoperability (WS-I) Basic Profile at minimum. This essentially means TLS encryption.  [18.5]</button></h5></div>
<div id="collapse204" class="collapse" aria-labelledby="heading204" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent204"><div class="card border-success">
<div id="heading205" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse205" aria-expanded="false" aria-controls="collapse205" class="btn btn-light btn-group-toggle">Countermeasure: Encrypt data between the client and server/service [CWE-319-TRANSPORT]</button></h5></div>
<div id="collapse205" class="collapse" aria-labelledby="heading205" data-parent="#parent204"><div class="card-body"><html><body>
<div>
                        Data passed between the client and server should be protected by encryption in transit.
                        </div>
                        <div>
                        <ul>
                        <li>Implement cryptographically strong TLS end-to-end encryption between the client and
                        server, terminating within a secure environment on the server-side.</li>
                        <li>Consider use of client certificates to prevent interception of (or man-in-the-middle
                        attacks on) the encrypted connection.</li>
                        <li>Alternatively, asymmetric (public-key) encryption could be utilized, although a
                        recognized, proven, and tested implementation/library should be used</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading206" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse206" aria-expanded="false" aria-controls="collapse206" class="btn btn-light btn-group-toggle">Requirement: Verify the use of session-based authentication and authorization. Please refer to sections 2, 3 and 4 for further guidance. Avoid the use of static "API keys" and similar. [18.6]</button></h5></div>
<div id="collapse206" class="collapse" aria-labelledby="heading206" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent206"><div class="card border-success">
<div id="heading207" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse207" aria-expanded="false" aria-controls="collapse207" class="btn btn-light btn-group-toggle">Countermeasure: Avoid the usage of static "API keys" and similar [AVOID-API-KEYS]</button></h5></div>
<div id="collapse207" class="collapse" aria-labelledby="heading207" data-parent="#parent206"><div class="card-body"><html><body><p>Avoid to use of static "API keys" or similar when we have to access to
                        external systems. We have to create a mechanisms to generate, manage and delete API keys to
                        grant access to external systems.
                    </p></body></html></div></div>
</div></div></div></div>
</div>
<div class="card border">
<div id="heading208" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse208" aria-expanded="false" aria-controls="collapse208" class="btn btn-light btn-group-toggle">Requirement: Verify that the REST service is protected from Cross-Site Request Forgery via the use of at least one or more of the following: ORIGIN checks, double submit cookie pattern, CSRF nonces, and referrer checks. [18.7]</button></h5></div>
<div id="collapse208" class="collapse" aria-labelledby="heading208" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent208">
<div class="card border-success">
<div id="heading209" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse209" aria-expanded="false" aria-controls="collapse209" class="btn btn-light btn-group-toggle">Countermeasure: Restrict access to administrative functionality [WEB-SRV-ADM-AUTH]</button></h5></div>
<div id="collapse209" class="collapse" aria-labelledby="heading209" data-parent="#parent208"><div class="card-body"><html><body>
<div>
                        If inadequate controls are in place, lower privileged users may be able to access higher
                        privilege or administrative functionality to subvert security within the application.
                        </div>
                        <div>
                        <ul>
                        <li>Restrict administration functions to designated administrators only through robust
                        access controls.</li>
                        <li>Ensure this restriction is applied at the server-side; do not rely on 'secret' areas
                        of the application, menu hiding, or other client-side techniques to protect the functionality.</li>
                        <li>Measures to prevent cross-site request forgery must be present on administrative
                        functions.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading210" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse210" aria-expanded="false" aria-controls="collapse210" class="btn btn-light btn-group-toggle">Countermeasure: Set and verify one time 'Anti CSRF' tokens for sensitive operations [CWE-352-TOKENS]</button></h5></div>
<div id="collapse210" class="collapse" aria-labelledby="heading210" data-parent="#parent208"><div class="card-body"><html><body>
<div>
                        Cross Site Request Forgery (CSRF) attacks exploit users by causing them to unknowingly submit
                        requests to the application while logged in, for example by tricking them in to clicking links
                        or through cross-site scripting (XSS) attacks. These attacks can be deployed where sensitive
                        operations can be accessed through a simple GET request, or a POST form submission and no
                        additional controls are in place. These attacks can be mitigated by requiring a random server
                        generated token be submitted and verified in each request. Requiring re-authentication of
                        sensitive functions is also effective, but intrusive in the user experience.
                        </div>
                        <div>
                        <ul>
                        <li>HTML pages that offer sensitive operations should also include a random one time token
                        as a hidden field with every form. When the form is submitted, the server side should verify
                        that the token received is the same as the token issued.</li>
                        <li>Re-authentication should be required on sensitive functionality such as
                        password-change or user-creation.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
</div></div></div>
</div>
<div class="card border">
<div id="heading211" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse211" aria-expanded="false" aria-controls="collapse211" class="btn btn-light btn-group-toggle">Requirement: All components should be up to date with proper security configuration(s) and version(s). This should include removal of unneeded configurations and folders such as sample applications, platform documentation, and default or example users. [19.1]</button></h5></div>
<div id="collapse211" class="collapse" aria-labelledby="heading211" data-parent="#accordion"><div class="card-body"><div class="accordion" id="parent211">
<div class="card border-success">
<div id="heading212" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse212" aria-expanded="false" aria-controls="collapse212" class="btn btn-light btn-group-toggle">Countermeasure: Apply required security patches [PATCH-SERVER]</button></h5></div>
<div id="collapse212" class="collapse" aria-labelledby="heading212" data-parent="#parent211"><div class="card-body"><html><body>
<div>
                        Vendors and other maintainers of software release patches in response to security flaws and
                        other bugs in their products.
                        </div>
                        <div>
                        <ul>
                        <li>Apply patches and other software updates in a timely manner to prevent unexpected
                        failures or exploitation.</li>
                        <li>Clearly define an approach for testing and applying patches, in particular security
                        patches, with expected timescales.  There is often a small window between release of a
                        patch, and potentially malicious actors reverse-engineering the patch to identify and exploit
                        the flaw.</li>
                        <li>Use a threat intelligence, vulnerability scanning, or other alerting service to ensure
                        the project team is aware of issues within the project or its components promptly.</li>
                        </ul>
                        </div>
                    </body></html></div></div>
</div>
<div class="card border-success">
<div id="heading213" class="card-header"><h5 class="mb-0"><button data-toggle="collapse" data-target="#collapse213" aria-expanded="false" aria-controls="collapse213" class="btn btn-light btn-group-toggle">Countermeasure: Apply required security patches to the service [PATCH-SERVICE]</button></h5></div>
<div id="collapse213" class="collapse" aria-labelledby="heading213" data-parent="#parent211"><div class="card-body"><html><body>
<div>
                        <div>
                        Vendors and other maintainers of software release patches in response to security flaws and
                        other bugs in their products.  The longer a system is exposed with a known security
                        vulnerability, the easier to compromise it is as the exploit became public, they get included
                        into automated exploitation suites like Metasploit and a wider audience is able to exploit them. 
                         
                        </div>
                        <div>
                        <ul>
                        <li>Apply patches and other software updates in a timely manner to prevent unexpected
                        failures or exploitation.</li>
                        <li>Clearly define an approach for testing and applying patches, in particular security
                        patches, with expected timescales.  There is often a small window between release of a
                        patch, and potentially malicious actors reverse-engineering the patch to identify and exploit
                        the flaw.</li>
                        <li>Use a threat intelligence, vulnerability scanning, or other alerting service to ensure
                        the project team is aware of issues within the project or its components promptly.</li>
                        </ul>
                        </div>
                        </div>
                        <div>
                        <br>
                        </div>
                    </body></html></div></div>
</div>
</div></div></div>
</div>
</div>
</body>
</html>
