<!DOCTYPE html><html><head><title>Risk Patterns for Hydras-AWS-Foundation.xml</title><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous"><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script></head><body><center><h2>Risk patterns for Hydras-AWS-Foundation.xml<h2></center><div class="accordion" id="components"><div class="card border-primary"><div class="card-header " id="heading14"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse14" aria-expanded="true" aria-controls="collapse14">Risk pattern: AWS EC2 <span>[HYDRAS-AWS-EC2]</span></button></h5></div><div id="collapse14" class="collapse" aria-labelledby="heading14" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading13"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse13" aria-expanded="true" aria-controls="collapse13">Use case: Amazon Web Services <span>[AMAZON-WEB-SERVICES]</span></button></h5></div><div id="collapse13" class="collapse" aria-labelledby="heading13" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading7"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse7" aria-expanded="true" aria-controls="collapse7">Threat: Attackers gain access to the systems through direct access <span>[UNAUTHORIZED-CONNECTION]</span></button></h5></div><div id="collapse7" class="collapse" aria-labelledby="heading7" data-parent="#threats"><div class="card-body"><div>
                                Attackers gain a unauthorized connection to the system through misconfigured ports or
                                security network configurations.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading2"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse2" aria-expanded="true" aria-controls="collapse2">Weakness: Unauthorised connection attempts are allowed on open ports <span>[AWS-NET-01]</span></button></h5></div><div id="collapse2" class="collapse" aria-labelledby="heading2" data-parent="#weaknesses"><div class="card-body"><div>
                        Receiving unauthorized connections to open ports is most likely to be receiving an attack. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading0"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse0" aria-expanded="true" aria-controls="collapse0">Countermeasure: Use security groups to block ingress to all ports from 0.0.0.0/0 <span>[Hydras-AWS-Network-5.5]</span></button></h5></div><div id="collapse0" class="collapse" aria-labelledby="heading0" data-parent="#controls"><div class="card-body">Security groups are analogous to firewalls and therefore provide stateful filtering of
                        ingress/egress network traffic to AWS resources. It is recommended to limit inbound access to
                        ALL TCP or ALL ports to avoid undue server exposure.
                        <div>
                        <br />
                        <b>Remediation:</b>
                        <br />
                        <ol>
                        <li>Login to the AWS Management Console (with VPC update).</li>
                        <li>Select VPC from the services menu.</li>
                        <li>Select Security Groups.</li>
                        <li>For each security group, perform the following:&nbsp;</li>
                        <ul>
                        <li>Select the security group.</li>
                        <li>Click the Inbound tab.</li>
                        <li>Identify the rules to be removed.</li>
                        <li>Click the x in the Remove column.</li>
                        <li>Click Save.</li>
                        </ul>
                        </ol>Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading1"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse1" aria-expanded="true" aria-controls="collapse1">Countermeasure: Restrict all traffic with the default security group <span>[Hydras-AWS-Network-5.6]</span></button></h5></div><div id="collapse1" class="collapse" aria-labelledby="heading1" data-parent="#controls"><div class="card-body">Security groups are analogous to firewalls and therefore provide stateful filtering of
                        ingress/egress network traffic to AWS resources. It is recommended to limit all traffic
                        (ingress/egress) on the default security group in order to force the use of least privilege via
                        custom created security groups.
                        <div>
                        <br />
                        <b>Remediation:</b>
                        <br />
                        <ol>
                        <li>Identify AWS resources that exist within the default security group.</li>
                        <li>Create a set of least privilege security groups for those resources.</li>
                        <li>Place the resources in those security groups.</li>
                        <li>Remove the resources noted in 1 from the default security group.</li>
                        </ol>Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading4"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse4" aria-expanded="true" aria-controls="collapse4">Weakness: Unauthorised connection attempts are allowed on port 22 <span>[AWS-NET-02]</span></button></h5></div><div id="collapse4" class="collapse" aria-labelledby="heading4" data-parent="#weaknesses"><div class="card-body">Receiving unauthorized connections to port 22 is most likely to be receiving an SSH attack. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading3"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse3" aria-expanded="true" aria-controls="collapse3">Countermeasure: Use security groups to block ingress to port 22 from 0.0.0.0/0 <span>[Hydras-AWS-Network-5.3]</span></button></h5></div><div id="collapse3" class="collapse" aria-labelledby="heading3" data-parent="#controls"><div class="card-body">Security groups are analogous to firewalls and therefore provide stateful filtering of
                        ingress/egress network traffic to AWS resources. It is recommended to limit inbound access to
                        port 22 (SSH) to IP addresses that require this access to avoid undue exposure to risk.
                        <div>
                        <br />
                        <b>Remediation:</b>
                        <br />
                        <ol>
                        <li>Login to the AWS Management Console (with VPC update)&nbsp;</li>
                        <li>Select VPC from the services menu&nbsp;</li>
                        <li>Select Security Groups&nbsp;</li>
                        <li>For each security group, perform the following:&nbsp;</li>
                        <ul>
                        <li>Select the security group.</li>
                        <li>Click the Inbound tab.</li>
                        <li>Identify the rules to be removed.</li>
                        <li>Click the x in the Remove column.</li>
                        <li>Click Save.</li>
                        </ul>
                        </ol> Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading6"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse6" aria-expanded="true" aria-controls="collapse6">Weakness: Unauthorised connection attempts are allowed on port 3389 <span>[AWS-NET-03]</span></button></h5></div><div id="collapse6" class="collapse" aria-labelledby="heading6" data-parent="#weaknesses"><div class="card-body">Receiving unauthorized connections to port 3389 is most likely to be receiving an RDP attack.
                        To avoid this, access to the network must be as restricted as possible, so that only the
                        necessary ports are open and the minimum inbound traffic is accepted.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading5"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse5" aria-expanded="true" aria-controls="collapse5">Countermeasure: Use security groups to block ingress to port 3389 from 0.0.0.0/0 <span>[Hydras-AWS-Network-5.4]</span></button></h5></div><div id="collapse5" class="collapse" aria-labelledby="heading5" data-parent="#controls"><div class="card-body">Security groups are analogous to firewalls and therefore provide stateful filtering of
                        ingress/egress network traffic to AWS resources. It is recommended to limit inbound access to
                        port 3389 (RDP) to IP addresses that require this access to avoid undue exposure to risk.
                        <div>
                        <br />
                        <b>Remediation:</b>
                        <br />
                        <ol>
                        <li>Login to the AWS Management Console (with VPC update).</li>
                        <li>Select VPC from the services menu.</li>
                        <li>Select Security Groups.</li>
                        <li>For each security group, perform the following:</li>
                        <ul>
                        <li>Select the security group.</li>
                        <li>Click the Inbound tab.</li>
                        <li>Identify the rules to be removed.</li>
                        <li>Click the x in the Remove column.</li>
                        <li>Click Save&nbsp;</li>
                        </ul>
                        </ol>Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading12"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse12" aria-expanded="true" aria-controls="collapse12">Threat: Attackers gain unauthorised access to data on EC2 instances <span>[NON-UPDATED-SYSTEMS-AWS]</span></button></h5></div><div id="collapse12" class="collapse" aria-labelledby="heading12" data-parent="#threats"><div class="card-body"><p>Attackers cloud gain access to data on EC2 instances through the weaknesses
                                in non-updated systems.</p>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading9"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse9" aria-expanded="true" aria-controls="collapse9">Weakness: The instances are not patched <span>[AWS-EC2-6.2]</span></button></h5></div><div id="collapse9" class="collapse" aria-labelledby="heading9" data-parent="#weaknesses"><div class="card-body">The instances are not patched with the last updates for the correspondent Operative System
                        (OS), and the instances have got weaknesses which are solved in the last updates.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading8"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse8" aria-expanded="true" aria-controls="collapse8">Countermeasure: Maintain a patch policy and patch EC2 systems regularly  <span>[Hydras-AWS-EC2-6.2]</span></button></h5></div><div id="collapse8" class="collapse" aria-labelledby="heading8" data-parent="#controls"><div class="card-body">Patching instances ensures that packages within the Operating System (OS) are updated to the
                        latest version and/or have security fixes applied. It is recommended to patch EC2 instances
                        every 90 days (or immediately if security patches become available) to avoid undue exposure
                        <br />
                        <br />
                        <b>Remediation:</b>
                        <br />
                        <ol>
                        <li>For linux instances ensure your OS is updated as per:
                        http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/managing-software.html&nbsp;</li>
                        <li>For Windows instances ensure your OS is updated as per:
                        http://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/windows-ami-version-history.html#update-windows-instance</li>
                        </ol>Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading11"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse11" aria-expanded="true" aria-controls="collapse11">Weakness: Unauthorised connection attempts are allowed on Amazon resources <span>[AWS-NET-04]</span></button></h5></div><div id="collapse11" class="collapse" aria-labelledby="heading11" data-parent="#weaknesses"><div class="card-body">Receiving unauthorized connections to Amazon resources is most likely to be receiving an attack. To avoid this, access to the network must be as restricted as possible using Network Access Control Lists for blacklisting.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading10"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse10" aria-expanded="true" aria-controls="collapse10">Countermeasure: Use Network Access Control Lists (NACLs) for blacklisting <span>[Hydras-AWS-Network-5.7]</span></button></h5></div><div id="collapse10" class="collapse" aria-labelledby="heading10" data-parent="#controls"><div class="card-body">Network Access Control Lists (NACLs) act as packet filters across subnets, allowing or deny
                        traffic per pre-created rules. It is recommended to use NACLs as a method of blacklisting IP
                        addresses, denying either inbound or outbound access across your subnets.&nbsp;
                        <div>
                        &nbsp;
                        <br />
                        <b>Remediation:</b>
                        <br />
                        <ol>
                        <li>Login to the AWS Management Console (with VPC update).</li>
                        <li>Select VPC from the services menu.</li>
                        <li>Select Network ACL's.</li>
                        <li>For each Network ACL ID, perform the following:</li>
                        <ul>
                        <li>Select the Inbound Rules tab.</li>
                        <li>Click edit.</li>
                        <li>add a DENY rule that will restrict inbound access from a blacklisted IP address or
                        range to a designated port or IP range.</li>
                        </ul>
                        </ol>Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading50"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse50" aria-expanded="true" aria-controls="collapse50">Risk pattern: AWS ELB <span>[HYDRAS-AWS-ELB]</span></button></h5></div><div id="collapse50" class="collapse" aria-labelledby="heading50" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading49"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse49" aria-expanded="true" aria-controls="collapse49">Use case: Amazon Web Services <span>[AMAZON WEB SERVICES]</span></button></h5></div><div id="collapse49" class="collapse" aria-labelledby="heading49" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading27"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse27" aria-expanded="true" aria-controls="collapse27">Threat: An attacker eavesdrops on the communication between the client and server and decrypts the data. <span>[EAVESDROPPING-COMMUNICATIONS]</span></button></h5></div><div id="collapse27" class="collapse" aria-labelledby="heading27" data-parent="#threats"><div class="card-body">Eavesdropping on communication is a network attack that captures small packets
                                transmitted by other computers and reads the data content. This type of network attack
                                is most effective when weak encryption services are used. An attacker could eavesdrop on
                                the communication between the client and server and decrypt the encrypted data.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading17"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse17" aria-expanded="true" aria-controls="collapse17">Weakness: Improper Certificate Validation <span>[CWE-295]</span></button></h5></div><div id="collapse17" class="collapse" aria-labelledby="heading17" data-parent="#weaknesses"><div class="card-body">The software does not validate, or incorrectly validates, a
                        certificate.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading15"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse15" aria-expanded="true" aria-controls="collapse15">Countermeasure: Add SSL/TLS Certificate to App Tier ELB <span>[aws-tier-1.12]</span></button></h5></div><div id="collapse15" class="collapse" aria-labelledby="heading15" data-parent="#controls"><div class="card-body">When you use HTTPS for your front-end listener, you must deploy an SSL/TLS certificate on your load balancer. The load balancer uses the certificate to terminate the connection and then decrypt requests from clients before sending them to the back-end instances. 
<br /> 
<br /> The SSL\TLS protocol uses an X.509 certificate (SSL\TLS server certificate) to authenticate both the client and the back-end application. An X.509 certificate is a digital form of identification issued by a trusted certificate authority (CA) and contains identification information, a validity period, a public key, a serial number, and the digital signature of the issuer. 
<br /> 
<br /> You can create a certificate using a Third Party Certificate Authority, AWS Certificate Manager or a self signed certificate like OpenSSL. 
<br /> 
<br /> Note: an SSL certificate configured on the ELB is not mandatory if you are terminating SSL connections directly on the App Tier EC2 instances, and using a TCP listener on the ELB (TCP pass-through) 
<br /> 
<br /> All the application traffic between the Web Tier instances and the App Tier ELB nodes should be encrypted using an SSL\TLS certificate. 
<br /> 
<b>Remediation:</b> 
<br />
<br />
Using the Amazon unified command line interface: 
<ul> 
 <li>Adding a HTTPS listener configured with a SSL\TLS certificate (the listener forwards traffic to the backend instances on port 80, but this can be modified by editing InstancePort=80): <br /> 
  <blockquote>
    aws elb create-load-balancer-listeners --load-balancer-name &lt;app_tier_elb&gt; --listeners Protocol=HTTPS,LoadBalancerPort=443,InstanceProtocol=HTTP,InstancePort=80, SSLCertificateId=ssl_certificate_arn 
  </blockquote> </li> 
</ul></div></div></div><div class="card border-success"><div class="card-header " id="heading16"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse16" aria-expanded="true" aria-controls="collapse16">Countermeasure: Add SSL/TLS Certificate to Web Tier ELB <span>[aws-tier-1.9]</span></button></h5></div><div id="collapse16" class="collapse" aria-labelledby="heading16" data-parent="#controls"><div class="card-body"><div>
  When you use HTTPS for your front-end listener, you must deploy an SSL/TLS certificate on your load balancer. The load balancer uses the certificate to terminate the connection and then decrypt requests from clients before sending them to the back-end instances. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  The TLS protocol uses an X.509 certificate (SSL/TLS server certificate) to authenticate both the client and the back-end application. An X.509 certificate is a digital form of identification issued by a trusted certificate authority (CA) and contains identification information, a validity period, a public key, a serial number, and the digital signature of the issuer. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  You can create a certificate using a Third Party Certificate Authority or AWS Certificate Manager. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Note: an SSL certificate configured on the ELB is not mandatory if you are terminating SSL connections directly on the Web Tier EC2 instances, and using a TCP listener on the ELB (TCP pass-through) 
</div> 
<div> 
 <br /> 
</div> 
<div>
  All the application traffic between the clients and the Web Tier ELB nodes should be encrypted using a SSL/TLS certificate. 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style="">
   Using the Amazon unified command line interface: 
 </div> 
 <div style=""> 
  <ul> 
   <li>Adding a HTTPS listener configured with a SSL/TLS certificate (the listener forwards traffic to the backend instances on port 80, but this can be modified by editing InstancePort=80):</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws elb create-load-balancer-listeners --load-balancer-name &lt;web_tier_elb&gt; --listeners Protocol=HTTPS,LoadBalancerPort=443,InstanceProtocol=HTTP,InstancePort=80, SSLCertificateId=ssl_certificate_arn 
   </div> 
  </div> 
 </blockquote> 
</blockquote></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading22"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse22" aria-expanded="true" aria-controls="collapse22">Weakness: Inadequate Encryption Strength <span>[CWE-326]</span></button></h5></div><div id="collapse22" class="collapse" aria-labelledby="heading22" data-parent="#weaknesses"><div class="card-body">The software stores or transmits sensitive data using an encryption scheme that is
                        theoretically sound, but is not strong enough for the level of protection required.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading18"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse18" aria-expanded="true" aria-controls="collapse18">Countermeasure: Use the Perfect Forward Secrecy feature <span>[Hydras-AWS-ELB-01]</span></button></h5></div><div id="collapse18" class="collapse" aria-labelledby="heading18" data-parent="#controls"><div class="card-body">For greater communication privacy Elastic Load Balancing allows the use of Perfect Forward
                        Secrecy. This feature provides additional safeguards against eavesdropping on encrypted data,
                        through the use of a unique random session key, and therefore prevents the decoding of captured
                        data, even if the secret long-term key is compromised.
                        <br />
                        <br />
                        <b>To begin using Perfect Forward Secrecy: <br /></b>Configure your load
                        balancer with the newly added Elliptic Curve Cryptography (ECDHE) cipher suites.
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading19"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse19" aria-expanded="true" aria-controls="collapse19">Countermeasure: Select the Server Order Preference option <span>[Hydras-AWS-ELB-02]</span></button></h5></div><div id="collapse19" class="collapse" aria-labelledby="heading19" data-parent="#controls"><div class="card-body">Within Elastic Load Balancing ensure the use of newer and stronger cipher suites when
                        establishing a new connection supporting the Server Order Preference option. When this option is
                        selected, the load balancer selects the first cipher in its list that is in the client's list of
                        ciphers.
                        <br />
                        <br />
                        <b> <b>Remediation:</b> </b>
                        <br />To enable Server Order Preference:
                        <br />
                        <ul>
                        <li>Open the Amazon EC2 console.&nbsp;</li>
                        <li>Under LOAD BALANCING, choose Load Balancers.<br /></li>
                        <li>Select your Load Balancer.<br /></li>
                        <li>On the Listeners tab, for Cipher, choose Change.<br /></li>
                        <li>On the Select a Cipher page, select Custom Security Policy.<br /></li>
                        <li>For SSL Options, select Server Order Preference.<br /></li>
                        <li>Click Save. </li>
                        </ul>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading20"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse20" aria-expanded="true" aria-controls="collapse20">Countermeasure: Configure the latest SSL Security Policies for Web Tier ELB <span>[aws-tier-1.10]</span></button></h5></div><div id="collapse20" class="collapse" aria-labelledby="heading20" data-parent="#controls"><div class="card-body"><div>
  Elastic Load Balancing uses an Secure Socket Layer (SSL) negotiation configuration, known as a security policy, to negotiate SSL/TLS connections between a client and the load balancer. A security policy is a combination of SSL/TLS protocols, ciphers, and the Server Order Preference option. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Elastic Load Balancing supports configuring your load balancer to use either predefined or custom security policies. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Secure Sockets Layer (SSL) and Transport Layer Security (TLS) are cryptographic protocols that are used to encrypt confidential data over insecure networks such as the Internet. The TLS protocol is a newer version of the SSL protocol. In the Elastic Load Balancing documentation, we refer to both SSL and TLS protocols as the SSL protocol. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Note: an SSL certificate configured on the ELB and an SSL Security Policy is not mandatory if you are terminating SSL connections directly on the Web Tier EC2 instances, and using a TCP listener on the ELB (TCP pass-through) 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Making sure the latest ELB SSL Security Policy is used will ensure the SSL/TLS connection will be negotiated using only the appropriate cryptographic protocols deemed safe with no proven vulnerabilities. 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style="">
   Using the Amazon unified command line interface: 
 </div> 
 <div style="">
   (Note that you should replace &lt;web\_tier\_elb&gt; with your Web-tier ELB name, and _&lt;latest\_ssl\_policy&gt;_ with the proper policy name) 
 </div> 
 <div style=""> 
  <br /> 
 </div> 
</div> 
<blockquote> 
 <div> 
  <div style="">
    aws elb set-load-balancer-policies-of-listener --load-balancer-name &lt;web_tier_elb&gt; --load-balancer-port 443 --policy-names&nbsp; &lt;latest_ssl_policy&gt; 
  </div> 
 </div> 
</blockquote></div></div></div><div class="card border-success"><div class="card-header " id="heading21"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse21" aria-expanded="true" aria-controls="collapse21">Countermeasure: Configure the latest SSL Security Policies for App Tier ELB <span>[aws-tier-1.13]</span></button></h5></div><div id="collapse21" class="collapse" aria-labelledby="heading21" data-parent="#controls"><div class="card-body"><div>
  Elastic Load Balancing uses an Secure Socket Layer (SSL) negotiation configuration, known as a security policy, to negotiate SSL/TLS connections between a client and the load balancer. A security policy is a combination of SSL/TLS protocols, ciphers, and the Server Order Preference option. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Elastic Load Balancing supports configuring your load balancer to use either predefined or custom security policies. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Secure Sockets Layer (SSL) and Transport Layer Security (TLS) are cryptographic protocols that are used to encrypt confidential data over insecure networks such as the Internet. The TLS protocol is a newer version of the SSL protocol. In the Elastic Load Balancing documentation, we refer to both SSL and TLS protocols as the SSL protocol. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Note: an SSL certificate configured on the ELB and an SSL Security Policy is not mandatory if you are terminating SSL connections directly on the App Tier EC2 instances, and using a TCP listener on the ELB (TCP pass-through) 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Making sure the latest ELB SSL Security Policy is used will ensure the SSL/TLS connection will be negotiated using only the appropriate cryptographic protocols deemed safe with no proven vulnerabilities. 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style="">
   Using the Amazon unified command line interface: 
 </div> 
</div> 
<div style=""> 
 <ul> 
  <li>(Note that you should replace &lt;app\_tier\_elb&gt; with your App-tier ELB name, and &lt;latest\_ssl\_policy&gt; with the proper policy name)</li> 
 </ul> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws elb set-load-balancer-policies-of-listener --load-balancer-name &lt;app_tier_elb&gt; --load-balancer-port 443 --policy-names&nbsp; &lt;latest_ssl_policy&gt; 
   </div> 
  </div> 
 </blockquote> 
</blockquote></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading26"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse26" aria-expanded="true" aria-controls="collapse26">Weakness: Missing Encryption of Sensitive Data <span>[CWE-311]</span></button></h5></div><div id="collapse26" class="collapse" aria-labelledby="heading26" data-parent="#weaknesses"><div class="card-body">The software does not encrypt sensitive or critical information
                        before storage or transmission.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading23"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse23" aria-expanded="true" aria-controls="collapse23">Countermeasure: Use HTTPS listener for Web Tier ELB <span>[aws-tier-1.1]</span></button></h5></div><div id="collapse23" class="collapse" aria-labelledby="heading23" data-parent="#controls"><div class="card-body"><div>
  A load balancer takes requests from clients and distributes them across the EC2 instances that are registered with the load balancer (also known as back-end instances). 
</div> 
<div> 
 <br /> 
</div> 
<div>
  A listener is a process that checks for connection requests. It is configured with a protocol and a port for front-end (client to load balancer) connections 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Note: an HTTPS listener configured on the ELB is not mandatory if you are terminating SSL connections directly on the Web Tier EC2 instances, and using a TCP listener on the ELB (TCP pass-through) 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Using an HTTPS Elastic Load Balancer listener will make sure the application traffic between the client and the Web Tier ELB is encrypted over the SSL\TLS channel. 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style=""> 
  <div>
    Using the Amazon unified command line interface: 
  </div> 
  <div> 
   <ul> 
    <li>If the ListenerDescription field is missing, add a new HTTPS listener configured with a SSL\TLS certificate (the listener forwards traffic to the backend instances on port 80, but this can be modified by editing InstancePort=80):</li> 
   </ul> 
  </div> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style=""> 
    <div>
      aws elb create-load-balancer-listeners --load-balancer-name &lt;web_tier_elb&gt; --listeners Protocol=HTTPS,LoadBalancerPort=443,InstanceProtocol=HTTP,InstancePort=80, SSLCertificateId=ssl_certificate_arn 
    </div> 
   </div> 
  </div> 
 </blockquote> 
</blockquote></div></div></div><div class="card border-success"><div class="card-header " id="heading24"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse24" aria-expanded="true" aria-controls="collapse24">Countermeasure: Use HTTPS listener for App Tier ELB <span>[aws-tier-1.14]</span></button></h5></div><div id="collapse24" class="collapse" aria-labelledby="heading24" data-parent="#controls"><div class="card-body"><div>
  A load balancer takes requests from clients and distributes them across the EC2 instances that are registered with the load balancer (also known as back-end instances). 
</div> 
<div> 
 <br /> 
</div> 
<div>
  A listener is a process that checks for connection requests. It is configured with a protocol and a port for front-end (client to load balancer) connections. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Note: an HTTPS listener configured on the ELB is not mandatory if you are terminating SSL connections directly on the App Tier EC2 instances, and using a TCP listener on the ELB (TCP pass-through) 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Using an HTTPS Elastic Load Balancer listener will make sure the application traffic between the client and the App Tier ELB is encrypted over the SSL\TLS channel. 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style="">
   Using the Amazon unified command line interface: 
 </div> 
 <div style=""> 
  <ul> 
   <li>If the ListenerDescription field is missing, add a new HTTPS listener configured with a SSL\TLS certificate (the listener forwards traffic to the backend instances on port 80, but this can be modified by editing InstancePort=80):</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws elb create-load-balancer-listeners --load-balancer-name &lt;app_tier_elb&gt; --listeners Protocol=HTTPS,LoadBalancerPort=443,InstanceProtocol=HTTP,InstancePort=80, SSLCertificateId=ssl_certificate_arn 
   </div> 
  </div> 
 </blockquote> 
</blockquote></div></div></div><div class="card border-success"><div class="card-header " id="heading25"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse25" aria-expanded="true" aria-controls="collapse25">Countermeasure: Set a HTTPS connection from all CloudFront Distributions to the Web Tier ELB origin <span>[aws-tier-3.12]</span></button></h5></div><div id="collapse25" class="collapse" aria-labelledby="heading25" data-parent="#controls"><div class="card-body"><div>
  Configure the Origin Protocol Policy for the Web tier ELB origin either to require that CloudFront fetches objects from your origin by using HTTPS or to require that CloudFront uses the protocol that the viewer used to request the objects. For example, if you choose Match Viewer for the Origin Protocol Policy and the viewer uses HTTPS to request an object from CloudFront, CloudFront also uses HTTPS to forward the request to your origin. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  In order to use HTTPS, an SSL\TLS certificate must be attached. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  To ensure that objects are encrypted from edge locations to the Web-Tier ELB origin according to the data classification policy, use Match Viewer. 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style="">
   Using the Amazon unified command line interface: 
 </div> 
 <div style=""> 
  <ul> 
   <li>For configuring &quot;OriginProtocolPolicy&quot;first save locally the current distribution config:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws cloudfront get-distribution-config --id application_cfn_distribution_id&nbsp; --query &quot;DistributionConfig&quot; &gt; /tmp/cf-distribution.json 
   </div> 
  </div> 
 </blockquote> 
</blockquote> 
<div> 
 <div style=""> 
  <br /> 
 </div> 
 <div style="">
   Edit and replace &quot;OriginProtocolPolicy&quot;element in /tmp/cf-distribution.json with the below section: 
 </div> 
 <div style="">
   &quot;OriginProtocolPolicy&quot;: &quot;https-only&quot;, 
 </div> 
 <div style=""> 
  <ul> 
   <li>Retrieve the current ETag of your CloudFront distribution:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws cloudfront get-distribution-config --id &lt;application_cfn_distribution_id&gt;&nbsp; --query &quot;ETag&quot; 
   </div> 
  </div> 
 </blockquote> 
</blockquote> 
<div> 
 <div style=""> 
  <ul> 
   <li>Update the CloudFront distribution using the edited config and the above Etag:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws cloudfront update-distribution --id &lt;application_cfn_distribution_id&gt; --distribution-config file:///tmp/cf-distribution.json --if-match &lt;application_cfn_distribution_etag&gt; 
   </div> 
  </div> 
 </blockquote> 
</blockquote></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading42"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse42" aria-expanded="true" aria-controls="collapse42">Threat: Attackers gain unauthorized connection to the resources <span>[UNAUTHORIZED-CONECTIONS-AWS]</span></button></h5></div><div id="collapse42" class="collapse" aria-labelledby="heading42" data-parent="#threats"><div class="card-body"><p>Attackers could gain an unauthorized connection to the resources through
                                misconfigured ports or security network configurations.</p>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading34"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse34" aria-expanded="true" aria-controls="collapse34">Weakness: Networks for Amazon resources are not properly segmentated. <span>[AWS-Network-5.2]</span></button></h5></div><div id="collapse34" class="collapse" aria-labelledby="heading34" data-parent="#weaknesses"><div class="card-body"><div>
                        Resources in the same VNet are compromised because when one of them is attacked and the
                        attackers gain access, they also gain access to all resources.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading28"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse28" aria-expanded="true" aria-controls="collapse28">Countermeasure: Associate each Auto-Scaling Group to ELB <span>[aws-tier-3.1]</span></button></h5></div><div id="collapse28" class="collapse" aria-labelledby="heading28" data-parent="#controls"><div class="card-body"><div>
  Elastic Load Balancing automatically distributes incoming application traffic across multiple Amazon EC2 instances within a VPC. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  It enables greater levels of fault tolerance in your applications, seamlessly providing the required amount of load balancing capacity needed to distribute application traffic across 1 or more Availability Zones within a VPC. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Elastic Load Balancing must be integrated with Auto Scaling Groups to ensure that you have availability of compute resources in the event of a failure. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Integrating Auto Scaling Groups with an Elastic Load Balancer will help provide high availability and back-end EC2 instance scaling. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Through Auto-Scaling Group configuration you can define: 
</div> 
<div>
  minimum / maximum number of EC2 instances to be launched by the Auto-Scaling Group 
</div> 
<div>
  Availability Zones / subnets used 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style="">
   Using the Amazon unified command line interface: 
 </div> 
 <div style=""> 
  <ul> 
   <li>List existing load balancers:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws elb describe-load-balancers --query 'LoadBalancerDescriptions[*].{ELBName:LoadBalancerName}' 
   </div> 
  </div> 
 </blockquote> 
</blockquote> 
<div> 
 <div style=""> 
  <br /> 
 </div> 
 <div style="">
   or 
 </div> 
 <div style=""> 
  <ul> 
   <li>Create new load balancer:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws elb create-load-balancer --load-balancer-name &lt;elb_name&gt; --listeners &lt;listener_config&gt; --subnets &lt;application_subnet&gt; --security-groups &lt;application_security_groups&gt; 
   </div> 
  </div> 
 </blockquote> 
</blockquote> 
<div> 
 <div style=""> 
  <ul> 
   <li>Attached load balancer from previous steps to autoscaling group:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws autoscaling attach-load-balancers --load-balancer-names &lt;elb_name&gt; --auto-scaling-group-name &lt;autoscaling_group_name&gt; 
   </div> 
  </div> 
 </blockquote> 
</blockquote></div></div></div><div class="card border-success"><div class="card-header " id="heading29"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse29" aria-expanded="true" aria-controls="collapse29">Countermeasure: Associate Web Tier Auto-Scaling Group to ELB <span>[aws-tier-3.13]</span></button></h5></div><div id="collapse29" class="collapse" aria-labelledby="heading29" data-parent="#controls"><div class="card-body"><div>
  Elastic Load Balancing automatically distributes incoming application traffic across multiple Amazon EC2 instances within a VPC. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  It enables greater levels of fault tolerance in your applications, seamlessly providing the required amount of load balancing capacity needed to distribute application traffic across 1 or more Availability Zones within a VPC. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Elastic Load Balancing must be integrated with Auto Scaling Groups to ensure that you have availability of compute resources in the event of a failure. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Integrating Auto Scaling Groups with an Elastic Load Balancer will help provide high availability and back-end EC2 instance scaling. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Through Auto-Scaling Group configuration you can define: 
</div> 
<div>
  minimum / maximum number of EC2 instances to be launched by the Auto-Scaling Group 
</div> 
<div>
  Availability Zones / subnets used 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style="">
   Using the Amazon unified command line interface: 
 </div> 
 <div style=""> 
  <ul> 
   <li>List existing load balancers:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws elb describe-load-balancers --query 'LoadBalancerDescriptions[*].{ELBName:LoadBalancerName}' 
   </div> 
  </div> 
 </blockquote> 
</blockquote> 
<div> 
 <div style="">
   or 
 </div> 
 <div style=""> 
  <ul> 
   <li>Create new load balancer:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws elb create-load-balancer --load-balancer-name &lt;web_tier_elb&gt; --listeners &lt;listener_config&gt; --subnets &lt;web_tier_elb_subnet1&gt; &lt;web_tier_elb_subnet2&gt; --security-groups &lt;web_tier_elb_security_group&gt; 
   </div> 
  </div> 
 </blockquote> 
</blockquote> 
<div> 
 <div style=""> 
  <ul> 
   <li>Attached load balancer from previous steps to autoscaling group:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws autoscaling attach-load-balancers --load-balancer-names &lt;web_tier_elb&gt; --auto-scaling-group-name &lt;web_tier_autoscaling_group_name&gt; 
   </div> 
  </div> 
 </blockquote> 
</blockquote></div></div></div><div class="card border-success"><div class="card-header " id="heading30"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse30" aria-expanded="true" aria-controls="collapse30">Countermeasure: Associate App Tier Auto-Scaling Group to ELB <span>[aws-tier-3.14]</span></button></h5></div><div id="collapse30" class="collapse" aria-labelledby="heading30" data-parent="#controls"><div class="card-body"><div>
  Elastic Load Balancing automatically distributes incoming application traffic across multiple Amazon EC2 instances within a VPC. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  It enables greater levels of fault tolerance in your applications, seamlessly providing the required amount of load balancing capacity needed to distribute application traffic across 1 or more Availability Zones within a VPC. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Elastic Load Balancing must be integrated with Auto Scaling Groups to ensure that you have availability of compute resources in the event of a failure. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Integrating Auto Scaling Groups with an Elastic Load Balancer will help provide high availability and back-end EC2 instance scaling. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Through Auto-Scaling Group configuration you can define: 
</div> 
<div>
  minimum / maximum number of EC2 instances to be launched by the Auto-Scaling Group 
</div> 
<div>
  Availability Zones / subnets used 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style="">
   Using the Amazon unified command line interface: 
 </div> 
 <div style=""> 
  <ul> 
   <li>List existing load balancers:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws elb describe-load-balancers --query 'LoadBalancerDescriptions[*].{ELBName:LoadBalancerName}' 
   </div> 
  </div> 
 </blockquote> 
</blockquote> 
<div> 
 <div style=""> 
  <br /> 
 </div> 
 <div style="">
   or 
 </div> 
 <div style=""> 
  <ul> 
   <li>Create new load balancer:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws elb create-load-balancer --load-balancer-name &lt;app_tier_elb&gt; --scheme internal --listeners &lt;listener_config&gt; --subnets &lt;app_tier_subnet1&gt; &lt;app_tier_subnet2&gt; --security-groups &lt;app_tier_elb_security_group&gt; 
   </div> 
  </div> 
 </blockquote> 
</blockquote> 
<div> 
 <div style=""> 
  <ul> 
   <li>Attached load balancer from previous steps to autoscaling group:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws autoscaling attach-load-balancers --load-balancer-names &lt;app_tier_elb&gt; --auto-scaling-group-name &lt;app_tier_autoscaling_group_name&gt; 
   </div> 
  </div> 
 </blockquote> 
</blockquote></div></div></div><div class="card border-success"><div class="card-header " id="heading31"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse31" aria-expanded="true" aria-controls="collapse31">Countermeasure: Do not use Web tier ELB Security Group in the Auto Scaling launch configuration of any other tier (Web, App) <span>[aws-tier-6.18]</span></button></h5></div><div id="collapse31" class="collapse" aria-labelledby="heading31" data-parent="#controls"><div class="card-body"><div>
  When you use the AWS Management Console to create a load balancer in a VPC, you can choose an existing security group for the VPC or create a new security group for the VPC. If you choose an existing security group, it must allow traffic in both directions to the listener and health check ports for the load balancer. If you choose to create a security group, the console automatically adds rules to allow all traffic on these ports. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Be sure to review the security group rules to ensure that they allow traffic on the listener and health check ports for the new load balancer. When you delete your load balancer, this security group is not deleted automatically. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  If you add a listener to an existing load balancer, you must review your security groups to ensure they allow traffic on the new listener port in both directions. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  The web-tier ELB is the only one that is public facing and should have rules to allow inbound traffic to the application ports (ex: HTTP and HTTPS) from any IP source (0.0.0.0/0). 
</div> 
<div> 
 <br /> 
</div> 
<div>
  The outbound security group rules for the web-tier ELB should be restricted to only the backend web-server instances for the appropriate application ports. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Associating the web-tier ELB security group to any other instances that shouldn't be publicly accessible exposes them to unauthorized access. 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style="">
   Using the Amazon unified command line interface: 
 </div> 
 <div style=""> 
  <ul> 
   <li>Create new launch configuration using the correct security groups for Web and/or App tier:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws autoscaling create-launch-configuration --launch-configuration-name &lt;web_tier_launch_config&gt; --image-id &lt;web_tier_ami&gt; --key-name &lt;your_key_pair&gt; --security-groups &lt;web_tier_security_group&gt;/&lt;app_tier_security_group --instance-type &lt;desired_instance_type&gt; --iam-instance-profile &lt;web_tier_instance_profile&gt;/&lt;app_tier_instance_profile&gt; 
   </div> 
  </div> 
 </blockquote> 
</blockquote></div></div></div><div class="card border-success"><div class="card-header " id="heading32"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse32" aria-expanded="true" aria-controls="collapse32">Countermeasure: Create the App tier ELB as Internal <span>[aws-tier-6.26]</span></button></h5></div><div id="collapse32" class="collapse" aria-labelledby="heading32" data-parent="#controls"><div class="card-body"><div>
  An internal load balancer routes traffic to your EC2 instances in private subnets using private IP addresses. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Create an internal load balancer and register the database servers with it. The web servers receive requests from the Internet-facing load balancer and send requests for the database servers to the internal load balancer. The database servers receive requests from the internal load balancer. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  When an internal load balancer is created, it receives a public DNS name with the following form: 
</div> 
<div> 
 <br /> 
</div> 
<blockquote> 
 <div>
   internal-name-123456789.region.elb.amazonaws.com 
 </div> 
 <div> 
  <br /> 
 </div> 
</blockquote> 
<div>
  The DNS servers resolve the DNS name of your load balancer to the private IP addresses of the load balancer nodes for your internal load balancer. Each load balancer node is connected to the private IP addresses of the back-end instances that are in its Availability Zone using elastic network interfaces. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Creating the App tier ELB as internal will prevent access to the app tier from the Internet and will allow access from the Web tier instances. 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style="">
   Using the Amazon unified command line interface: 
 </div> 
 <div style=""> 
  <ul> 
   <li>Create new internal ELB for your App tier:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws elb create-load-balancer --load-balancer-name app_tier_elb --scheme internal --listeners listener_config --subnets app_tier_subnet1 app_tier_subnet2 --security-groups app_tier_elb_security_group 
   </div> 
  </div> 
 </blockquote> 
</blockquote> 
<div> 
 <div style=""> 
  <ul> 
   <li>Register App tier instances with the new App tier ELB:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws elb register-instances-with-load-balancer --load-balancer-name app_tier_elb --instances &lt;app_tier_instance1&gt; &lt;app_tier_instance2&gt; &lt;app_tier_instance3&gt; 
   </div> 
  </div> 
 </blockquote> 
</blockquote></div></div></div><div class="card border-success"><div class="card-header " id="heading33"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse33" aria-expanded="true" aria-controls="collapse33">Countermeasure: Create subnets for the Web Tier ELB <span>[aws-tier-6.5]</span></button></h5></div><div id="collapse33" class="collapse" aria-labelledby="heading33" data-parent="#controls"><div class="card-body"><div>
                        You can create a VPC that spans multiple Availability Zones. After creating a VPC, you can add
                        one or more subnets in each Availability Zone. Each subnet must reside entirely within one
                        Availability Zone and cannot span zones. Availability Zones are distinct locations that are
                        engineered to be isolated from failures in other Availability Zones. By launching instances in
                        separate Availability Zones, you can protect your applications from the failure of a single
                        location. AWS assigns a unique ID to each subnet.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        When you create a subnet, you specify the CIDR block for the subnet. The CIDR block of a subnet
                        shouldn't be the same as the CIDR block for the VPC (for a single subnet in the VPC). The
                        allowed block size is between a /28 netmask and /16 netmask. If you create more than one subnet
                        in a VPC, the CIDR blocks of the subnets must not overlap.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        Some AWS regions have more than 2 availability zones and it is recommended to use more than 2
                        where possible.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        At least 2 subnets in 2 different availability zones (AZ) should be created in order to have
                        fault tolerance and high availability from the perspective of resource deployment.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <div style="">
                        Using the Amazon unified command line interface:
                        </div>
                        <div style="">
                        <ul>
                        <li>Create subnets for Web tier ELB, and note the subnet id:</li>
                        </ul>
                        </div>
                        </div>
                        <blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        aws ec2 create-subnet --vpc-id application_vpc
                        --cidr-block desired_cidr
                        </div>
                        </div>
                        </blockquote>
                        </blockquote>
                        <div>
                        <div style="">
                        <ul>
                        <li>Tag the above subnets with the Web tier ELB tags:</li>
                        </ul>
                        </div>
                        </div>
                        <blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        aws ec2 create-tags --resources web_tier_elb_subnet1
                        web_tier_elb_subnet2 --tags Key=public_tier_tag,Value=public_tier_tag_value
                        </div>
                        </div>
                        </blockquote>
                        </blockquote>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading36"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse36" aria-expanded="true" aria-controls="collapse36">Weakness: Non-identify the resources <span>[AWS-Network-5.1]</span></button></h5></div><div id="collapse36" class="collapse" aria-labelledby="heading36" data-parent="#weaknesses"><div class="card-body">Resources are not registered in the safety net systems, and there are more unidentified
                        resources. This can be a problem because these unidentified resources can have unknown
                        weaknesses.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading35"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse35" aria-expanded="true" aria-controls="collapse35">Countermeasure: Set Root Domain Alias Record to ELB <span>[aws-tier-6.1]</span></button></h5></div><div id="collapse35" class="collapse" aria-labelledby="heading35" data-parent="#controls"><div class="card-body"><div>
  Amazon Route 53 translates friendly domains names like www.example.com into IP addresses like 192.0.2.1. Amazon Route 53 responds to DNS queries using a global network of authoritative DNS servers, which reduces latency. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  When someone enters your domain name in a browser, a DNS request is forwarded to the nearest Amazon Route 53 DNS server in a global network of authoritative DNS servers. Amazon Route 53 responds with the IP address that you specified. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Each domain has an associated hosted zone which contains the resource records pointing to each layer of the application. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  A private hosted zone is a container that holds information about how you want to route traffic for a domain and its subdomains within the Amazon Virtual Private Cloud (Amazon VPC). To begin, you create a private hosted zone and specify the Amazon VPCs that you want to associate with the hosted zone. You then create resource record sets that determine how Amazon Route 53 responds to queries for your domain and subdomains within and among your Amazon VPCs. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Route53 provides special record type called Alias that allows creation of an A record for the root domain and points it to the fully qualified domain of the Elastic Load Balancer (ELB) associated with the web-server layer or Amazon CloudFront. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  In the same way records for all other layers should be created in order to allow flexibility in the application design and not hard-code the FQDN of a resource. 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style="">
   Using the Amazon unified command line interface: 
 </div> 
 <div style=""> 
  <ul> 
   <li>Create a hosted zone for YourDomain.com:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws route53 create-hosted-zone --name &lt;your_domain.com&gt; --caller-reference &lt;any_string&gt; 
   </div> 
  </div> 
 </blockquote> 
</blockquote></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading41"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse41" aria-expanded="true" aria-controls="collapse41">Weakness: Unauthorised connection attempts are allowed on open ports <span>[AWS-NET-01]</span></button></h5></div><div id="collapse41" class="collapse" aria-labelledby="heading41" data-parent="#weaknesses"><div class="card-body"><div>
                        Receiving unauthorized connections to open ports is most likely to be receiving an attack. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading37"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse37" aria-expanded="true" aria-controls="collapse37">Countermeasure: Allow connectivity to the VPC Internet Gateway (IGW) and associate the Routing Table with Web tier ELB subnet (by default route (0.0.0.0/0)) <span>[aws-tier-6.13]</span></button></h5></div><div id="collapse37" class="collapse" aria-labelledby="heading37" data-parent="#controls"><div class="card-body"><div>
  A route table contains a set of rules, called routes, that are used to determine where network traffic is directed. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Each subnet in your VPC must be associated with a route table; the table controls the routing for the subnet. A subnet can only be associated with one route table at a time, but you can associate multiple subnets with the same route table. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  The default route (0.0.0.0/0) should be pointing to the Internet Gateway in order to provide internet connectivity for the Web tier ELB. 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style="">
   Using the Amazon unified command line interface: 
 </div> 
 <div style=""> 
  <ul> 
   <li>For the above route tables, if the default route (0.0.0.0/0) exists but it doesn't have an IGW configured as gateway:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws ec2 replace-route --route-table-id &lt;route_table_id&gt; --destination-cidr-block 0.0.0.0/0 --gateway-id &lt;vpc_igw&gt; 
   </div> 
  </div> 
 </blockquote> 
</blockquote> 
<div> 
 <div style=""> 
  <ul> 
   <li>For the above route tables, if the default route (0.0.0.0/0) doesn't exist:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws ec2 create-route --route-table-id &lt;route_table_id&gt; --destination-cidr-block 0.0.0.0/0 --gateway-id &lt;vpc_igw&gt; 
   </div> 
  </div> 
 </blockquote> 
</blockquote></div></div></div><div class="card border-success"><div class="card-header " id="heading38"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse38" aria-expanded="true" aria-controls="collapse38">Countermeasure: Use a Web-Tier ELB Security Group to accept only HTTP/HTTPS  <span>[aws-tier-6.17]</span></button></h5></div><div id="collapse38" class="collapse" aria-labelledby="heading38" data-parent="#controls"><div class="card-body"><div>
  A security group acts as a virtual firewall for your instance to control inbound and outbound traffic. When you launch an instance in the AWS Virtual Private Cloud (VPC), you can assign the instance up to five security groups. Security groups act at the instance level, not the subnet level. Therefore, each instance in a subnet in your VPC could be assigned to a different set of security groups. If you don't specify a particular group at launch time, the instance is automatically assigned to the default security group for the VPC. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  For each security group, you add rules that control the inbound traffic to instances, and a separate set of rules that control the outbound traffic. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  The SG associated with the Web tier ELB should allow connectivity from any source IP (0.0.0.0/0) only for the HTTP (TCP 80) and HTTPS (TCP 443) ports. 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style="">
   Using the Amazon unified command line interface: 
 </div> 
 <div style=""> 
  <ul> 
   <li>First remove all the ingress rules for the security group associated with the Web tier ELB:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws ec2 describe-security-groups --group-id &lt;security_group_id&gt; --query &quot;SecurityGroups[0].IpPermissions&quot; &gt; /tmp/IpPermissions.json 
   </div> 
  </div> 
  <div style=""> 
   <br /> 
  </div> 
 </blockquote> 
</blockquote> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws ec2 revoke-security-group-ingress --group-id &lt;security_group_id&gt; --ip-permissions file:///tmp/IpPermissions.json 
   </div> 
  </div> 
 </blockquote> 
</blockquote> 
<div> 
 <div style=""> 
  <ul> 
   <li>create locally the below json file containing ingress rules for any source IP (0.0.0.0/0) only for the HTTP (TCP 80) and HTTPS (TCP 443) ports and name it IpPermissions.json:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     [ 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; { 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; &nbsp; &nbsp; &quot;PrefixListIds&quot;: [], 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; &nbsp; &nbsp; &quot;FromPort&quot;: 80, 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; &nbsp; &nbsp; &quot;IpRanges&quot;: [ 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; { 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;CidrIp&quot;: &quot;0.0.0.0/0&quot; 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; &nbsp; &nbsp; ], 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; &nbsp; &nbsp; &quot;ToPort&quot;: 80, 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; &nbsp; &nbsp; &quot;IpProtocol&quot;: &quot;tcp&quot;, 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; &nbsp; &nbsp; &quot;UserIdGroupPairs&quot;: [] 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; }, 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; { 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; &nbsp; &nbsp; &quot;PrefixListIds&quot;: [], 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; &nbsp; &nbsp; &quot;FromPort&quot;: 443, 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; &nbsp; &nbsp; &quot;IpRanges&quot;: [ 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; { 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;CidrIp&quot;: &quot;0.0.0.0/0&quot; 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; &nbsp; &nbsp; ], 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; &nbsp; &nbsp; &quot;ToPort&quot;: 443, 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; &nbsp; &nbsp; &quot;IpProtocol&quot;: &quot;tcp&quot;, 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; &nbsp; &nbsp; &quot;UserIdGroupPairs&quot;: [] 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; } 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     ] 
   </div> 
  </div> 
 </blockquote> 
</blockquote> 
<div> 
 <div style=""> 
  <ul> 
   <li>Add to the security group associated with the Web tier ELB the above ingress rules:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws ec2 authorize-security-group-ingress --group-id &lt;security_group_id&gt;&nbsp; --ip-permissions file:///PathTo/IpPermissions.json 
   </div> 
  </div> 
 </blockquote> 
</blockquote></div></div></div><div class="card border-success"><div class="card-header " id="heading39"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse39" aria-expanded="true" aria-controls="collapse39">Countermeasure: Create the App tier ELB Security Group to only accept HTTP/HTTPS <span>[aws-tier-6.21]</span></button></h5></div><div id="collapse39" class="collapse" aria-labelledby="heading39" data-parent="#controls"><div class="card-body"><div>
                        A security group acts as a virtual firewall for your instance to control inbound and outbound
                        traffic. When you launch an instance in the AWS Virtual Private Cloud (VPC), you can assign the
                        instance to up to five security groups. Security groups act at the instance level, not the
                        subnet level. Therefore, each instance in a subnet in your VPC could be assigned to a different
                        set of security groups. If you don't specify a particular group at launch time, the instance is
                        automatically assigned to the default security group for the VPC.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        For each security group, you add rules that control the inbound traffic to instances, and a
                        separate set of rules that control the outbound traffic.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        The SG associated with the App tier ELB should allow connectivity from the security group
                        associated with Web tier instances only for the HTTP (TCP 80) and HTTPS (TCP 443) ports.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        The defaults for HTTP and HTTPS are used as an example, any other ports would apply depending on
                        the application design.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <div style="">
                        Using the Amazon unified command line interface:
                        </div>
                        <div style="">
                        <ul>
                        <li>First remove all the ingress rules for the security group associated with the App tier
                        ELB:</li>
                        </ul>
                        </div>
                        </div>
                        <blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        aws ec2 describe-security-groups --group-id app_tier_elb_security_group
                        --query &quot;SecurityGroups[0].IpPermissions&quot; &gt; /tmp/IpPermissions.json
                        </div>
                        </div>
                        <div style="">
                        <br />
                        </div>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        aws ec2 revoke-security-group-ingress --group-id app_tier_elb_security_group
                        --ip-permissions file:///tmp/IpPermissions.json
                        </div>
                        </div>
                        </blockquote>
                        </blockquote>
                        <div>
                        <div style="">
                        <ul>
                        <li>create locally the below json file containing ingress rules for HTTP (TCP 80) and
                        HTTPS (TCP 443) ports only from and name it IpPermissions.json:</li>
                        </ul>
                        </div>
                        </div>
                        <blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        [
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; {
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; &nbsp; &nbsp; &quot;PrefixListIds&quot;: [],
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; &nbsp; &nbsp; &quot;FromPort&quot;: 80,
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; &nbsp; &nbsp; &quot;IpRanges&quot;: [],
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; &nbsp; &nbsp; &quot;ToPort&quot;: 80,
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; &nbsp; &nbsp; &quot;IpProtocol&quot;: &quot;tcp&quot;,
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; &nbsp; &nbsp; &quot;UserIdGroupPairs&quot;: [
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;UserId&quot;:
                        &quot;&lt;&lt;em&gt;aws_account_number&gt;&lt;/em&gt;&quot;,
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;GroupId&quot;:
                        &quot;&lt;span style=&quot;font-style: italic;&quot;&gt;&lt;&lt;/span&gt;&lt;span
                        style=&quot;font-style: italic;&quot;&gt;web_tier_security_group&quot;
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; &nbsp; &nbsp; ]
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; },
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; {
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; &nbsp; &nbsp; &quot;PrefixListIds&quot;: [],
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; &nbsp; &nbsp; &quot;FromPort&quot;: 443,
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; &nbsp; &nbsp; &quot;IpRanges&quot;: [],
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; &nbsp; &nbsp; &quot;ToPort&quot;: 443,
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; &nbsp; &nbsp; &quot;IpProtocol&quot;: &quot;tcp&quot;,
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; &nbsp; &nbsp; &quot;UserIdGroupPairs&quot;: [
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;UserId&quot;:
                        &quot;&lt;&lt;em&gt;aws_account_number&gt;&lt;/em&gt;&quot;,
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;GroupId&quot;:
                        &quot;&lt;span style=&quot;font-style: italic;&quot;&gt;&lt;&lt;/span&gt;&lt;span
                        style=&quot;font-style: italic;&quot;&gt;web_tier_security_group&lt;/span&gt;&gt;&quot;
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; &nbsp; &nbsp; ]
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        &nbsp; &nbsp; }
                        </div>
                        </div>
                        </blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        ]
                        </div>
                        </div>
                        </blockquote>
                        </blockquote>
                        <div>
                        <div style="">
                        <ul>
                        <li>Add to the security group associated with the App tier ELB the above ingress rules:</li>
                        </ul>
                        </div>
                        </div>
                        <blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        aws ec2 authorize-security-group-ingress --group-id app_tier_elb_security_group&nbsp;
                        --ip-permissions file:///PathTo/IpPermissions.json
                        </div>
                        </div>
                        </blockquote>
                        </blockquote>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading40"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse40" aria-expanded="true" aria-controls="collapse40">Countermeasure: Create the App tier Security Group to allow inbound connections from App tier ELB Security Group for explicit ports <span>[aws-tier-6.22]</span></button></h5></div><div id="collapse40" class="collapse" aria-labelledby="heading40" data-parent="#controls"><div class="card-body"><div>
                        A security group acts as a virtual firewall for your instance to control inbound and outbound
                        traffic. When you launch an instance in the AWS Virtual Private Cloud (VPC), you can assign the
                        instance to up to five security groups. Security groups act at the instance level, not the
                        subnet level. Therefore, each instance in a subnet in your VPC could be assigned to a different
                        set of security groups. If you don't specify a particular group at launch time, the instance is
                        automatically assigned to the default security group for the VPC.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        For each security group, you add rules that control the inbound traffic to instances, and a
                        separate set of rules that control the outbound traffic.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        This is required for both the configured port and protocol for the listener on the back-end
                        instance and the port and protocol used for the health check.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        This protects the App-server tier from unauthorized access, it is recommended to add inbound
                        security group rules that allow traffic for the specific application protocol and ports by
                        referencing as source the security group associated with the App tier ELB.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <div style="">
                        Using the Amazon unified command line interface:
                        </div>
                        <div style="">
                        <ul>
                        <li>First remove all the ingress rules for the App tier security group (use the &quot;AppTierSecurityGroup&quot;
                        element from Audit procedure):</li>
                        </ul>
                        </div>
                        </div>
                        <blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        aws ec2 describe-security-groups --group-id app_tier_security_group
                        --query &quot;SecurityGroups[0].IpPermissions&quot; &gt; /tmp/IpPermissions.json
                        </div>
                        </div>
                        <div style="">
                        <br />
                        </div>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        aws ec2 revoke-security-group-ingress --group-id app_tier_security_group
                        --ip-permissions file:///tmp/IpPermissions.json
                        </div>
                        </div>
                        </blockquote>
                        </blockquote>
                        <div>
                        <div style="">
                        <ul>
                        <li>Add an ingress rule for a specific port, using --source-group option to specify the
                        App tier ELB security group as the source of the connections:</li>
                        </ul>
                        </div>
                        </div>
                        <blockquote>
                        <blockquote>
                        <div>
                        <div style="">
                        aws ec2 authorize-security-group-ingress --group-id app_tier_security_group
                        --protocol tcp --port specific_port
                        --source-group app_tier_elb_security_group
                        </div>
                        </div>
                        </blockquote>
                        </blockquote>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading48"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse48" aria-expanded="true" aria-controls="collapse48">Threat: Attackers make undetected and unaudited changes in the resources <span>[UNAUDITABLE-CHANGES-RESOURCES-AWS]</span></button></h5></div><div id="collapse48" class="collapse" aria-labelledby="heading48" data-parent="#threats"><div class="card-body"><div>
                                If audit trails in the resources are not enabled or not protected, attackers could gain
                                access to the system and modify or delete data from the resources and the changes are
                                not detected.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading44"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse44" aria-expanded="true" aria-controls="collapse44">Weakness: Non-auditable actions in the resources <span>[AWS-Logging-3.4]</span></button></h5></div><div id="collapse44" class="collapse" aria-labelledby="heading44" data-parent="#weaknesses"><div class="card-body">The actions in the resources are not audited and not recorded in the logs.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading43"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse43" aria-expanded="true" aria-controls="collapse43">Countermeasure: Enable the ELB logging <span>[aws-tier-5.2]</span></button></h5></div><div id="collapse43" class="collapse" aria-labelledby="heading43" data-parent="#controls"><div class="card-body"><div>
  Elastic Load Balancing automatically distributes incoming application traffic across multiple Amazon EC2 instances in the a VPC. It enables you to achieve greater levels of fault tolerance in your applications, seamlessly providing the required amount of load balancing capacity needed to distribute application traffic. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  AWS Elastic Load Balancers (ELBs) can record all incoming requests sent to the load balancer and store within logs on S3. This allows for diagnosing application failures and analyzing web traffic and security analysis of incoming traffic 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style="">
   Using the Amazon unified CLI: 
 </div> 
 <div style=""> 
  <ul> 
   <li>Create a JSON file containing the attributes you want to modify and save it locally as /tmp/ElbLogs.json:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     { 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &quot;AccessLog&quot;: { 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; &quot;Enabled&quot;: true, 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; &quot;S3BucketName&quot;: &quot;string&quot;, 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; &quot;EmitInterval&quot;: integer, 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &nbsp; &quot;S3BucketPrefix&quot;: &quot;string&quot; 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; } 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     } 
   </div> 
  </div> 
 </blockquote> 
</blockquote> 
<div> 
 <div style=""> 
  <ul> 
   <li>Update the Load Balancer attributes:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws elb modify-load-balancer-attributes --load-balancer-name &lt;elb_name&gt; --load-balancer-attributes file:///tmp/ElbLogs.json 
   </div> 
  </div> 
 </blockquote> 
</blockquote></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading47"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse47" aria-expanded="true" aria-controls="collapse47">Weakness: Unknown resource status <span>[unknown-resource-status]</span></button></h5></div><div id="collapse47" class="collapse" aria-labelledby="heading47" data-parent="#weaknesses"><div class="card-body">We do not have our resources current status and as a result lose control of some resources,
                        for example, we may believe these resources are inactive when in fact the status has changed and we are unaware. 
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading45"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse45" aria-expanded="true" aria-controls="collapse45">Countermeasure: Configure Health Check for Web Tier ELB <span>[aws-tier-3.8]</span></button></h5></div><div id="collapse45" class="collapse" aria-labelledby="heading45" data-parent="#controls"><div class="card-body"><div>
  By default, an Auto-Scaling Group periodically uses the results of the EC2 instance status checks to determine the health status of each instance. If an instance fails the EC2 instance status checks, Auto-Scaling marks the instance as unhealthy and replaces the instance. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  However, if you have attached one or more Elastic Load Balancing (ELB) load balancers to your Auto-Scaling Group and the instance fails the ELB health checks, Auto-Scaling does not replace the instance. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Amazon ELB will periodically sends pings, attempt connections, or sends requests to test the EC2 instances, these tests are called health checks. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  The status of the instances that are healthy at the time of the health check is InService. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  The status of any instances that are unhealthy at the time of the health check is OutOfService. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  The load balancer performs health checks on all registered instances, whether the instance is in a healthy state or an unhealthy state. The load balancer routes requests only to the healthy instances. When the load balancer determines that an instance is unhealthy, it stops routing requests to that instance. The load balancer resumes routing requests to the instance when it has been restored to a healthy state 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Ensure availability of back-end EC2 instances associated with an Amazon ELB through application layer health check (ex: http) instead of TCP health checks. 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style="">
   Using the Amazon unified CLI: 
 </div> 
 <div style=""> 
  <ul> 
   <li>Create a JSON file containing the attributes you want to modify and save it locally as /tmp/ELBhealthcheck.json:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     { 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &quot;Target&quot;: &quot;&lt;string&gt;&quot;, 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &quot;Interval&quot;: &lt;integer&gt;, 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &quot;Timeout&quot;: &lt;integer&gt;, 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &quot;UnhealthyThreshold&quot;: &lt;integer&gt;, 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &quot;HealthyThreshold&quot;: &lt;integer&gt; 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     } 
   </div> 
  </div> 
 </blockquote> 
</blockquote> 
<div> 
 <div style=""> 
  <ul> 
   <li>Modify Web tier ELB to include appropriate health check:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws elb configure-health-check --load-balancer-name &lt;web_tier_elb&gt; --health-check file:///tmp/ELBhealthcheck.json 
   </div> 
  </div> 
 </blockquote> 
</blockquote></div></div></div><div class="card border-success"><div class="card-header " id="heading46"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse46" aria-expanded="true" aria-controls="collapse46">Countermeasure: Configure Health Check for App Tier ELB <span>[aws-tier-3.9]</span></button></h5></div><div id="collapse46" class="collapse" aria-labelledby="heading46" data-parent="#controls"><div class="card-body"><div>
  By default, an Auto-Scaling Group periodically uses the results of the EC2 instance status checks to determine the health status of each instance. If an instance fails the EC2 instance status checks, Auto-Scaling marks the instance as unhealthy and replaces the instance. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  However, if you have attached one or more Elastic Load Balancing (ELB) load balancers to your Auto-Scaling Group and the instance fails the ELB health checks, Auto-Scaling does not replace the instance. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Amazon ELB will periodically sends pings, attempts connections, or sends requests to test the EC2 instances, these tests are called health checks. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  The status of the instances that are healthy at the time of the health check is InService. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  The status of any instances that are unhealthy at the time of the health check is OutOfService. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  The load balancer performs health checks on all registered instances, whether the instance is in a healthy state or an unhealthy state. The load balancer routes requests only to the healthy instances. When the load balancer determines that an instance is unhealthy, it stops routing requests to that instance. The load balancer resumes routing requests to the instance when it has been restored to a healthy state 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Ensures availability of back-end EC2 instances associated with an Amazon ELB through application layer health check (ex: http) instead of TCP health checks. 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style="">
   Using the Amazon unified CLI: 
 </div> 
 <div style=""> 
  <ul> 
   <li>Create a JSON file containing the attributes you want to modify and save it locally as /tmp/ELBhealthcheck.json:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     { 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &quot;Target&quot;: &quot;&lt;string&gt;&quot;, 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &quot;Interval&quot;: &lt;integer&gt;, 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &quot;Timeout&quot;: &lt;integer&gt;, 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &quot;UnhealthyThreshold&quot;: &lt;integer&gt;, 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     &nbsp; &quot;HealthyThreshold&quot;: &lt;integer&gt; 
   </div> 
  </div> 
 </blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     } 
   </div> 
  </div> 
 </blockquote> 
</blockquote> 
<div> 
 <div style=""> 
  <ul> 
   <li>Modify App tier ELB to include appropriate health check:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws elb configure-health-check --load-balancer-name &lt;app_tier_elb&gt; --health-check file:///tmp/ELBhealthcheck.json 
   </div> 
  </div> 
 </blockquote> 
</blockquote></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading85"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse85" aria-expanded="true" aria-controls="collapse85">Risk pattern: AWS Identity and Access Management <span>[HYDRAS-AWS-IAM]</span></button></h5></div><div id="collapse85" class="collapse" aria-labelledby="heading85" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading69"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse69" aria-expanded="true" aria-controls="collapse69">Use case: Authentication <span>[AUTHENTICATION]</span></button></h5></div><div id="collapse69" class="collapse" aria-labelledby="heading69" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading61"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse61" aria-expanded="true" aria-controls="collapse61">Threat: Attackers gain unauthorized access to the root account due to the lack of configuration of the account <span>[AWS-LOST-ACCESS-ROOT]</span></button></h5></div><div id="collapse61" class="collapse" aria-labelledby="heading61" data-parent="#threats"><div class="card-body"><div>
                                Attackers could gain unauthorized access to the administrator account due to the lack of
                                the account and its security mechanisms, like modifying credentials and adding/removing
                                user accounts.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading53"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse53" aria-expanded="true" aria-controls="collapse53">Weakness: Excessive use of administrator accounts <span>[AWS-IAM-2.2]</span></button></h5></div><div id="collapse53" class="collapse" aria-labelledby="heading53" data-parent="#weaknesses"><div class="card-body"><div>
                        The administrator accounts are used for all actions, not only for administrative actions. This
                        is because these users have not got a personal or a user account to do the daily actions.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading51"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse51" aria-expanded="true" aria-controls="collapse51">Countermeasure: Avoid the use of the root account unless absolutely necessary <span>[Hydras-AWS-IAM-2.1]</span></button></h5></div><div id="collapse51" class="collapse" aria-labelledby="heading51" data-parent="#controls"><div class="card-body">The root account is the one which was used to open the AWS account with Amazon. Therefore it has full unrestricted access to all resources within the account including billing information. Reducing the use of this account and instead using personalized accounts with restricted permissions ensures the principles of least privilege and can help prevent accidental disclosure of credentials or unintended changes. 
<br /> 
<b><br /></b> 
<div> 
 <b>Remediation:</b> 
 <br />Follow the remediation in &quot;Create Individual Accounts&quot;. 
</div> 
<div> 
 <br />Content provided by 
 <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>. 
</div></div></div></div><div class="card border-success"><div class="card-header " id="heading52"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse52" aria-expanded="true" aria-controls="collapse52">Countermeasure: Create Individual Accounts <span>[Hydras-AWS-IAM-2.3]</span></button></h5></div><div id="collapse52" class="collapse" aria-labelledby="heading52" data-parent="#controls"><div class="card-body">By creating individual IAM users for people accessing your account, you can give each IAM user a unique set of security credentials. You can also grant different permissions to each IAM user. If necessary, you can change or revoke an IAM user's permissions any time. (If you give out your AWS root credentials, it can be difficult to revoke them, and it is impossible to restrict their permissions.). 
<div> 
 <br /> 
 <b>Remediation:</b> 
 <br /> 
 <ol> 
  <li>Login to the AWS Management Console as an administrator.</li> 
  <li>Select IAM.</li> 
  <li>Select Users.</li> 
  <li>Click &quot;Create New Users&quot;.</li> 
  <li>Complete the required information.</li> 
  <li>Uncheck &quot;Create access key for users&quot;.</li> 
  <li>Click &quot;Create&quot;.</li> 
  <li>Select the user.</li> 
  <li>Click &quot;Manage Password&quot;.</li> 
  <li>Select the required options and click &quot;apply&quot;.</li> 
  <li>Select &quot;Show User Security Credentials&quot;.</li> 
  <li>Securely supply the password to your user.</li> 
 </ol>Content provided by 
 <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a> 
</div></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading56"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse56" aria-expanded="true" aria-controls="collapse56">Weakness: The Authentication Method for Administrator Accounts is not configured <span>[AWS-IAM-2.1]</span></button></h5></div><div id="collapse56" class="collapse" aria-labelledby="heading56" data-parent="#weaknesses"><div class="card-body"><div>
                        The authentication method &quot;Multi-factor Authentication&quot; for the Administrator
                        accounts are not configured.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading54"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse54" aria-expanded="true" aria-controls="collapse54">Countermeasure: Enable MFA for root accounts <span>[Hydras-AWS-IAM-2.2]</span></button></h5></div><div id="collapse54" class="collapse" aria-labelledby="heading54" data-parent="#controls"><div class="card-body">Root is highly privileged and therefore using a multi-factor authentication (MFA) device enhances the security of the login process. With MFA, users have a device that generates a unique authentication code (a one-time password, or OTP) and users must provide both their normal credentials (like their user name and password) and the OTP. The MFA device can either be a special piece of hardware, or it can be a virtual device. The recommendation for the root account is to use a hardware based device as it has a smaller attack surface and cannot be duplicated. 
<div> 
 <br /> 
 <b>Remediation:</b> 
 <br /> 
 <ol> 
  <li>Login to the AWS Management Console as root.</li> 
  <li>Select &quot;Dashboard&quot; and under &quot;Security Status&quot; choose &quot;Activate MFA&quot; on your root account.</li> 
  <li>Select Activate MFA&quot;.</li> 
  <li>In the wizard, choose &quot;A hardware MFA&quot; device and then select Next Step.</li> 
  <li>In the Serial Number box, enter the serial number that is found on the back of the MFA device.&nbsp;</li> 
  <li>In the Authentication Code 1 box, enter the six-digit number displayed by the MFA device.</li> 
  <li>Wait until the device refreshes the code, and then enter the next six-digit number into the Authentication Code 2 box.</li> 
  <li>Select &quot;Next Step&quot;.&nbsp;</li> 
 </ol>The MFA device is now associated with the AWS account.&nbsp; 
</div> 
<div>
  &nbsp; 
 <br />Content provided by 
 <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a> 
</div></div></div></div><div class="card border-success"><div class="card-header " id="heading55"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse55" aria-expanded="true" aria-controls="collapse55">Countermeasure: Ensure root does not have API keys <span>[Hydras-AWS-IAM-2.5]</span></button></h5></div><div id="collapse55" class="collapse" aria-labelledby="heading55" data-parent="#controls"><div class="card-body">You use an access key (an access key ID and secret access key) to make programmatic requests to AWS. However, do not use your AWS account (root) access key. The access key for your AWS account gives full access to all your resources for all AWS services, including your billing information. You cannot restrict the permissions associated with your AWS account access key.&nbsp; 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
 <br /> 
 <ol> 
  <li>Sign in to the AWS Management Console as Root.</li> 
  <li>Click on Account Name at the top left and select Security Credentials.</li> 
  <li>On the pop up screen Click on Continue to Security Credentials.</li> 
  <li>Click on Access Keys.</li> 
  <li>Under the Status column if there are any Keys which are &quot;Active&quot;.</li> 
  <li>Click on &quot;Make Inactive&quot; and click &quot;Delete&quot;.</li> 
 </ol>Content provided by 
 <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a> 
</div></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading58"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse58" aria-expanded="true" aria-controls="collapse58">Weakness: The Root Account is misconfigured <span>[LOST-ACCESS-ROOT-01]</span></button></h5></div><div id="collapse58" class="collapse" aria-labelledby="heading58" data-parent="#weaknesses"><div class="card-body">The administrator account is misconfigured. The security question to recover or reset the
                        password and the authentication method are not configured.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading57"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse57" aria-expanded="true" aria-controls="collapse57">Countermeasure: Configure the security challenge questions within the AWS Account <span>[Hydras-AWS-Gov-1.1]</span></button></h5></div><div id="collapse57" class="collapse" aria-labelledby="heading57" data-parent="#controls"><div class="card-body">When an AWS account is initially created it is configured with a top level account known as the &quot;root&quot; account that has full administration access to all resources. In the event that the password or MFA device associated with this account is lost AWS support may recover it by asking you to answer the security questions. 
<div> 
 <br /> 
 <b>Remediation:</b> 
 <br /> 
 <ol> 
  <li>Login to the AWS Account as root.</li> 
  <li>Click account name on the top right of the management console.</li> 
  <li>Select &quot;My Account&quot;.</li> 
  <li>Scroll down to &quot;Configure Security Challenge Questions&quot;.</li> 
  <li>Click on Edit.</li> 
  <li>For each question:</li> 
  <ul> 
   <li>Select an appropriate question.</li> 
   <li>Enter an appropriate answer.</li> 
   <li>Follow the above process for all 3 questions.</li> 
  </ul> 
  <li>Click Update when complete.</li> 
  <li>We recommend to store the questions and answers in a secure location such as a safe where they can be used in case recovery is required.</li> 
 </ol>Content provided by 
 <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a> 
</div></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading60"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse60" aria-expanded="true" aria-controls="collapse60">Weakness: The Security Contact details are not configured <span>[LOST-SECURITY-ALERTS]</span></button></h5></div><div id="collapse60" class="collapse" aria-labelledby="heading60" data-parent="#weaknesses"><div class="card-body">The security contact details for the Amazon subscription are not properly configured.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading59"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse59" aria-expanded="true" aria-controls="collapse59">Countermeasure: Register a Security contact for your AWS account. <span>[Hydras-AWS-Gov-1.2]</span></button></h5></div><div id="collapse59" class="collapse" aria-labelledby="heading59" data-parent="#controls"><div class="card-body">AWS will occasionally send security advisories and alerts to the account holder. By default this will go to the email address that the account is registered under. However if a security contact is specified these alerts will be sent here instead. Therefore this provides the means of ensuring these advisories are routed to the security team, especially if a distribution email address is used.&nbsp; 
<div>
  &nbsp; 
 <br /> 
 <b>Remediation:</b> 
 <br /> 
 <ol> 
  <li>Login to the AWS Account as root.</li> 
  <li>Click account name on the top right of the management console.</li> 
  <li>Select &quot;My Account&quot;.</li> 
  <li>Scroll down to &quot;Alternate Contacts&quot; section.</li> 
  <li>Click on Edit.</li> 
  <li>In the &quot;Security&quot; section complete the requested contact information.</li> 
  <li>Click update when complete.</li> 
 </ol>Content provided by 
 <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a> 
</div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading68"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse68" aria-expanded="true" aria-controls="collapse68">Threat: Attackers gain unauthorized access to the user account due to the lack of configuration of the account <span>[AWS-LOST-ACCESS-USER]</span></button></h5></div><div id="collapse68" class="collapse" aria-labelledby="heading68" data-parent="#threats"><div class="card-body"><div>
                                Attackers could gain unauthorized access to the user account due to the lack of
                                configuration of the account, like the security question to reset the password was
                                configured incorrectly.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading63"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse63" aria-expanded="true" aria-controls="collapse63">Weakness: Lack of 2FA <span>[AWS-IAM-2.8]</span></button></h5></div><div id="collapse63" class="collapse" aria-labelledby="heading63" data-parent="#weaknesses"><div class="card-body">Access to sensitive systems without using MFA to log into the systems.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading62"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse62" aria-expanded="true" aria-controls="collapse62">Countermeasure: Enable MFA for IAM console users <span>[Hydras-AWS-IAM-2.4]</span></button></h5></div><div id="collapse62" class="collapse" aria-labelledby="heading62" data-parent="#controls"><div class="card-body">Using a multi-factor authentication (MFA) device enhances the security of the login process.
                        With MFA, users have a device that generates a unique authentication code (a one-time password,
                        or OTP) and users must provide both their normal credentials (like their user name and password)
                        and the OTP.
                        <div>
                        <br />
                        </div>
                        <div>
                        The MFA device can either be a special piece of hardware, or it can be a virtual device. The
                        recommendation for all console login accounts is to use MFA to increase the level of security of
                        the login process.
                        <div>
                        <div>
                        <br />
                        <b>Remediation:</b>
                        <br />
                        <ol>
                        <li>Login to the AWS Management Console as an administrator.</li>
                        <li>Select IAM.</li>
                        <li>Select Users.</li>
                        <li>For each user:</li>
                        <ul>
                        <li>Select the user.</li>
                        <li>Under &quot;Sign-In Credentials&quot; if &quot;Password&quot; is set
                        to &quot;Yes&quot;.</li>
                        <li>Select &quot;Manage MFA Device&quot;.</li>
                        <li>Choose the type of MFA.</li>
                        <li>Either scan the code or enter your device secret key.</li>
                        <li>Enter the Authentication code in &quot;Authentication Code 1&quot; box.</li>
                        <li>Wait for the code to change and enter the next code in &quot;Authentication Code 2&quot;
                        box.</li>
                        <li>Click Activate MFA.</li>
                        </ul>
                        </ol>Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                        </div>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading65"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse65" aria-expanded="true" aria-controls="collapse65">Weakness: The User Account is not configured <span>[AWS-IAM-2.6]</span></button></h5></div><div id="collapse65" class="collapse" aria-labelledby="heading65" data-parent="#weaknesses"><div class="card-body">Key security settings such as resetting the password and other password controls are not
                        configured.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading64"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse64" aria-expanded="true" aria-controls="collapse64">Countermeasure: Create a Password Policy enforcing strong passwords <span>[Hydras-AWS-IAM-2.6]</span></button></h5></div><div id="collapse64" class="collapse" aria-labelledby="heading64" data-parent="#controls"><div class="card-body">Enforcing a strong password policy increases resiliency and reduces the chances of the password
                        being compromised either through brute force attempts, keystroke logging tools or stolen
                        credentials amongst others.
                        <div>
                        <br />
                        <b>Remediation:</b>
                        <br />
                        <ol>
                        <li>Login to AWS Console (ensure you have permissions to update IAM).</li>
                        <li>Go to IAM Service on the AWS Console.</li>
                        <li>Click on Account Settings.</li>
                        <li>Set &quot;Minimum password length&quot; to 8 or greater.</li>
                        <li>Check &quot;Require at least one uppercase letter&quot;.</li>
                        <li>Check &quot;Require at least one lowercase letter&quot;.</li>
                        <li>Check &quot;Require at least one number&quot;.</li>
                        <li>Check &quot;Require at least one non-alphanumeric character&quot;</li>
                        <li>Check &quot;Enable password expiration&quot; and set the period to at least 90
                        days.</li>
                        <li>Check &quot;Prevent password reuse&quot; and set the number to at least 10.</li>
                        </ol>Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading67"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse67" aria-expanded="true" aria-controls="collapse67">Weakness: The security policies are exposed in the resources <span>[AWS-IAM-2.9]</span></button></h5></div><div id="collapse67" class="collapse" aria-labelledby="heading67" data-parent="#weaknesses"><div class="card-body">The security policies are not configured and the security configurations are exposed for the
                        attackers.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading66"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse66" aria-expanded="true" aria-controls="collapse66">Countermeasure: Enforce employee lifecycle policies <span>[Hydras-AWS-IAM-2.9]</span></button></h5></div><div id="collapse66" class="collapse" aria-labelledby="heading66" data-parent="#controls"><div class="card-body">Regular reviews of accounts on the system should be conducted to ensure that stale accounts
                        cannot be abused either by those former employees using them or compromised by attackers.
                        <div>
                        <br />
                        <b>Remediation:</b>&nbsp;&nbsp;
                        <br />At least every 90 days complete the following:
                        </div>
                        <div>
                        <ol>
                        <li>Sign in to the AWS Management Console (with IAM update privileges).</li>
                        <li>Go to IAM Service on the AWS Console.</li>
                        <li>Click on Users.</li>
                        <li>For any user that should no longer exist:</li>
                        <ul>
                        <li>select the user,</li>
                        <li>click &quot;User Actions&quot;,</li>
                        <li>click &quot;Delete&quot;.</li>
                        </ul>
                        </ol>Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading84"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse84" aria-expanded="true" aria-controls="collapse84">Use case: Authorization <span>[AUTHORIZATION]</span></button></h5></div><div id="collapse84" class="collapse" aria-labelledby="heading84" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading83"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse83" aria-expanded="true" aria-controls="collapse83">Threat: Attackers gain unauthorized access to the control of the environment <span>[AWS-LOSS-CONTROL-ENV]</span></button></h5></div><div id="collapse83" class="collapse" aria-labelledby="heading83" data-parent="#threats"><div class="card-body"><div>
                                Attackers could gain unauthorized access to the control of the environment, due of the
                                user accounts or role groups are not well defined and configured. Therefore, attackers
                                can make changes without the root approval.&nbsp;
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading71"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse71" aria-expanded="true" aria-controls="collapse71">Weakness: Lack of 2FA <span>[AWS-IAM-2.8]</span></button></h5></div><div id="collapse71" class="collapse" aria-labelledby="heading71" data-parent="#weaknesses"><div class="card-body">Access to sensitive systems without using MFA to log into the systems.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading70"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse70" aria-expanded="true" aria-controls="collapse70">Countermeasure: Enable setting MFA for sensitive API calls <span>[Hydras-AWS-IAM-2.10]</span></button></h5></div><div id="collapse70" class="collapse" aria-labelledby="heading70" data-parent="#controls"><div class="card-body">To the extent that it is practical consider enforcing MFA access for sensitive API calls. For
                        example, you can require that a user has authenticated with an MFA device in order to be allowed
                        to terminate an Amazon EC2 instance. This ensures that such high level changes to your AWS
                        environment are protected with an extra layer of security thus helping to prevent accidental or
                        malicious damage.
                        <div>
                        <br />
                        <b>Remediation:</b>
                        <br />The following is an example of how to create a policy that enforces MFA to terminate
                        EC2 instances:
                        <br />
                        <ul>
                        <li>Sign in to the AWS Management Console (with IAM update privileges).</li>
                        <li>Go to IAM Service on the AWS Console.</li>
                        <li>Select &quot;Policies&quot;.</li>
                        <li>Select &quot;Create Policy&quot;.</li>
                        <li>Select &quot;Create your own policy&quot;.</li>
                        <li>Provide a policy name and description.</li>
                        <li>In the policy document add the following:&nbsp;</li>
                        </ul>
                        </div>
                        <blockquote>
                        <div>
                        <i> {</i>
                        </div>
                        <div>
                        <i> &quot;Version&quot;: &quot;2012-10-17&quot;,</i>
                        </div>
                        <div>
                        <i> &quot;Statement&quot;: [{</i>
                        </div>
                        <div>
                        <i> &quot;Effect&quot;: &quot;Allow&quot;,</i>
                        </div>
                        <div>
                        <i> &quot;Action&quot;: [</i>
                        </div>
                        <div>
                        <i> &quot;ec2:StopInstances&quot;,</i>
                        </div>
                        <div>
                        <i> &quot;ec2:TerminateInstances&quot;</i>
                        </div>
                        <div>
                        <i> ],</i>
                        </div>
                        <div>
                        <i> &quot;Resource&quot;: [&quot;*&quot;],</i>
                        </div>
                        <div>
                        <i> &quot;Condition&quot;: {&quot;Bool&quot;: {&quot;aws:MultiFactorAuthPresent&quot;:
                        &quot;true&quot;}}</i>
                        </div>
                        <div>
                        <i> }]</i>
                        </div>
                        <div>
                        <i>}</i>
                        </div>
                        </blockquote>
                        <div>
                        <ul>
                        <li>Click &quot;Create policy&quot;.</li>
                        <li>The policy may now be added to a group by following the outlines in &quot;Use RBAC
                        with pre-defined policies added into groups or roles&quot;.</li>
                        </ul> Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading73"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse73" aria-expanded="true" aria-controls="collapse73">Weakness: The access keys are generated when the setup of the users is started <span>[AWS-IAM-1.21]</span></button></h5></div><div id="collapse73" class="collapse" aria-labelledby="heading73" data-parent="#weaknesses"><div class="card-body"><div>
                        The system doesn't require additional steps to create access keys, the access keys are
                        generating when the process to create an user is starting. The problem is that these keys can be
                        in use somewhere in the organization and maybe these keys are not necessary for the user.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading72"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse72" aria-expanded="true" aria-controls="collapse72">Countermeasure: Do not setup access keys during initial user setup for all IAM users that have a console password <span>[Hydras-AWS-IAM-1.21]</span></button></h5></div><div id="collapse72" class="collapse" aria-labelledby="heading72" data-parent="#controls"><div class="card-body">
          AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. 
          <br /> 
          <br /> 
          <b>Remediation: </b> 
          <br />Perform the following to delete access keys that do not pass the audit. 
          <br /> 
          <div> 
           <br /> 
          </div> 
          <ol> 
           <li>Login to the AWS Management Console.Click Services.</li> 
           <li>Click IAM</li> 
           <li>Click on Users.Click on Security Credentials.</li> 
           <li>As an Administrator.</li> 
           <ul> 
            <li>Click on Delete for keys that were created at the same time as the user profile but have not been used.<br /></li> 
           </ul> 
           <li>&nbsp;&nbsp;&nbsp; As an IAM User</li> 
           <ul> 
            <li>Click on Delete for keys that were created at the same time as the user profile but have not been used.</li> 
           </ul> 
           <li>Via CLI:</li> 
           <ul> 
            <li>aws iam delete-access-key</li> 
           </ul> 
          </ol> 
          <span style="font-weight: bold;"></span>
          </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading78"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse78" aria-expanded="true" aria-controls="collapse78">Weakness: The credentials for the groups and roles are not configured <span>[AWS-IAM-2.7]</span></button></h5></div><div id="collapse78" class="collapse" aria-labelledby="heading78" data-parent="#weaknesses"><div class="card-body"><div>
                        The credentials for the groups and roles are not correctly configured and there are user
                        accounts with more privileges than the necessary.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading74"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse74" aria-expanded="true" aria-controls="collapse74">Countermeasure: Apply IAM roles for EC2 instances IAM roles for EC2 instances <span>[Hydras-AWS-EC2-6.3]</span></button></h5></div><div id="collapse74" class="collapse" aria-labelledby="heading74" data-parent="#controls"><div class="card-body">Applications that run on an Amazon EC2 instance need credentials in order to access other AWS
                        services. To provide credentials to the application in a secure way, use IAM roles. A role is an
                        entity that has its own set of permissions, but that isn't a user or group. Roles also don't
                        have their own permanent set of credentials the way IAM users do. In the case of Amazon EC2, IAM
                        dynamically provides temporary credentials to the EC2 instance, and these credentials are
                        automatically rotated for you.
                        <br />
                        <br />When you launch an EC2 instance, you can specify a role for the instance as a launch
                        parameter. Applications that run on the EC2 instance can use the role's credentials when they
                        access AWS resources. The role's permissions determine what the application is allowed to do. It
                        is recommended that all EC2 instances be launched with a role, even if the role has no
                        permissions (as they can be added later if desired).
                        <div>
                        <br />
                        <b>Remediation:</b>
                        <br />
                        <ol>
                        <li>Login to the AWS Management Console.</li>
                        <li>Select EC2 from the services menu.</li>
                        <li>Select &quot;Launch Instance&quot;.</li>
                        <li>Complete the wizard until step 3 at which point ensure an IAM role is selected for the
                        &quot;IAM role&quot; option (note the role must already exist).</li>
                        <li>Complete the wizard to launch the instance.</li>
                        </ol>NB: You cannot add a role to an instance that has been launched without one. In these
                        cases create an AMI from an existing instance and launch a new instance, assigning an IAM role
                        as detailed above.
                        </div>
                        <div>
                        <br />Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        <br />
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading75"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse75" aria-expanded="true" aria-controls="collapse75">Countermeasure: Create an IAM role for managing incidents with AWS <span>[Hydras-AWS-IAM-1.20]</span></button></h5></div><div id="collapse75" class="collapse" aria-labelledby="heading75" data-parent="#controls"><div class="card-body">WS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support. 
          <br /> 
          <br /> 
          <b>Remediation:</b> 
          <br />Using the Amazon unified command line interface, create an IAM role for managing incidents with AWS: 
          <br /> 
          <br />Create a trust relationship policy document that allows &lt;iam_user&gt; to manage AWS incidents, and save it locally as /tmp/TrustPolicy.json: 
          <br /> 
          <br />{ 
          <br />&quot;Version&quot;: &quot;2012-10-17&quot;, 
          <br />&quot;Statement&quot;: [{ 
          <br />&nbsp;&nbsp;&nbsp; &quot;Effect&quot;: &quot;Allow&quot;, 
          <br />&nbsp;&nbsp;&nbsp; &quot;Principal&quot;: { 
          <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;AWS&quot;: &quot;&lt;iam_user&gt;&quot; 
          <br />&nbsp; }, 
          <br />&nbsp; &quot;Action&quot;: &quot;sts:AssumeRole&quot; 
          <br />&nbsp; }] 
          <br />} 
          <br /> 
          <br />Create the IAM role using the above trust policy: 
          <br /> 
          <br />aws iam create-role --role-name &lt;aws_support_iam_role&gt; --assume-role-policy-document file:///tmp/TrustPolicy.json 
          <br /> 
          <br />Attach 'AWSSupportAccess' managed policy to the created IAM role: 
          <br /> 
          <br />aws iam attach-role-policy --policy-arn &lt;iam_policy_arn&gt; --role-name &lt;aws_support_iam_role&gt; 
          <br />
          </div></div></div><div class="card border-success"><div class="card-header " id="heading76"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse76" aria-expanded="true" aria-controls="collapse76">Countermeasure: Enforce Least Privilege <span>[Hydras-AWS-IAM-2.7]</span></button></h5></div><div id="collapse76" class="collapse" aria-labelledby="heading76" data-parent="#controls"><div class="card-body">Granting least privilege ensures that users only have the permissions required to complete
                        their jobs rather than additional privileges that are not required. Following this model ensures
                        that, should an account be compromised, the blast radius of damage is limited.
                        <br />
                        <br />
                        <b>Remediation:</b>
                        <div>
                        <ul>
                        <li>Allocate privileges via groups or roles via the recommendation in &quot;Use RBAC
                        with pre-defined policies added into groups or roles&quot;.</li>
                        </ul>Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading77"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse77" aria-expanded="true" aria-controls="collapse77">Countermeasure: Apply RBAC with pre-defined policies added into groups or roles <span>[Hydras-AWS-IAM-2.8]</span></button></h5></div><div id="collapse77" class="collapse" aria-labelledby="heading77" data-parent="#controls"><div class="card-body">Instead of defining permissions for individual IAM users, it's usually more convenient to
                        create groups that relate to job functions (administrators, developers, accounting, etc.),
                        define the relevant permissions for each group, and then assign IAM users to those groups. All
                        the users in an IAM group inherit the permissions assigned to the group. That way, you can make
                        changes for everyone in a group in just one place. As people move around in your company, you
                        can simply change what IAM group their IAM user belongs to. This method is know as Role Based
                        Access Control (RBAC).
                        <div>
                        <br />
                        <b>Remediation:<br /></b>Remove privilege granted directly to a user:
                        <br />
                        <ol>
                        <li>Sign in to the AWS Management Console (with IAM update privileges).</li>
                        <li>Go to IAM Service on the AWS Console.</li>
                        <li>Click on Users.</li>
                        <li>For each user complete the following:</li>
                        <ul>
                        <li>Select the user.</li>
                        <li>Click on the Permissions tab.</li>
                        <li>Expand &quot;Managed Policies&quot;.</li>
                        <li>Click &quot;Detach Policy&quot;.</li>
                        <li>Expand &quot;Inline Policies&quot;.</li>
                        <li>Click &quot;Remove Policy&quot;.</li>
                        </ul>
                        </ol>Create a Group and add a user:
                        <br />
                        <ol>
                        <li>Sign in to the AWS Management Console (with IAM update privileges).</li>
                        <li>Go to IAM Service on the AWS Console.</li>
                        <li>Select Groups and click Create New Group.&nbsp;</li>
                        <li>In the Group Name box, type the name of the group and click Next Step.&nbsp;</li>
                        <li>In the list of policies, select the check box for each policy that you want to apply
                        to all members of the group. Click Next Step.</li>
                        <li>Click Create Group.</li>
                        <li>Click the new Group and select the &quot;Users&quot; tab.</li>
                        <li>Click &quot;Add Users to Group&quot;.</li>
                        <li>Select the users and click &quot;Add Users&quot;.</li>
                        </ol>Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading80"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse80" aria-expanded="true" aria-controls="collapse80">Weakness: The password expiration is not established <span>[AWS-EXPIRATION-DATE]</span></button></h5></div><div id="collapse80" class="collapse" aria-labelledby="heading80" data-parent="#weaknesses"><div class="card-body">The password expiration is not configured and users are not obliged to change their passwords.
                        Not change frequently the passwords gives facilities to attackers to obtain them.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading79"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse79" aria-expanded="true" aria-controls="collapse79">Countermeasure: Configure password expiration <span>[Hydras-AWS-IAM-2.11]</span></button></h5></div><div id="collapse79" class="collapse" aria-labelledby="heading79" data-parent="#controls"><div class="card-body">Change access keys regularly, and make sure that all IAM users in your account do as well.
                        That way, if an access key is compromised without your knowledge, you limit how long the
                        credentials can be used to access your resources. Credential reports can be used to determine
                        how long access keys have been active for.
                        <div>
                        <br />
                        <b>Remediation:</b>
                        <br />
                        <ol>
                        <li>Sign in to the AWS Management Console (with IAM update privileges).</li>
                        <li>Go to IAM Service on the AWS Console.</li>
                        <li>Click on Users.</li>
                        <li>Select the user you wish to rotate the key for.</li>
                        <li>Under access keys click &quot;Create Access Key&quot; (do not touch the
                        existing key yet).</li>
                        <li>Click &quot;Download credentials&quot; or &quot;Show credentials&quot;
                        so that you have a record of them.</li>
                        <li>Update any applications with the new credentials and test (we recommend to leave a few
                        days or a week for testing).</li>
                        <li>Once complete complete 1-4 above and for the key which needs rotating click &quot;Make
                        Inactive | Delete&quot; and click &quot;Deactive&quot;.</li>
                        <li>Once you are confident you will no longer need the key (wait several more days) repeat
                        1-4 and select &quot;Delete&quot; for the inactive key.</li>
                        </ol>
                        </div>
                        <div>
                        Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading82"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse82" aria-expanded="true" aria-controls="collapse82">Weakness: The rotation keys is not configured <span>[AWS-IAM-2.12]</span></button></h5></div><div id="collapse82" class="collapse" aria-labelledby="heading82" data-parent="#weaknesses"><div class="card-body">The rotation keys are not configured to avoid to use old keys.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading81"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse81" aria-expanded="true" aria-controls="collapse81">Countermeasure: Rotate KMS CMK Keys at least every year <span>[Hydras-AWS-IAM-2.12]</span></button></h5></div><div id="collapse81" class="collapse" aria-labelledby="heading81" data-parent="#controls"><div class="card-body">Rotating keys regularly reduces the impact of a compromised key being used to access data
                        since old keys cannot be used once rotated.&nbsp;
                        <div>
                        &nbsp;
                        <br />
                        <b>Remediation:</b>
                        <br />
                        <ol>
                        <li>List keys with:&nbsp; &quot;aws kms list-keys&quot;.</li>
                        <li>For each key enable rotation: &quot;aws kms enable-key-rotation --key-id &lt;key_id&gt;&quot;.&nbsp;&nbsp;</li>
                        </ol>
                        </div>
                        <div>
                        Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading106"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse106" aria-expanded="true" aria-controls="collapse106">Risk pattern: AWS Logging <span>[HYDRAS-AWS-LOG]</span></button></h5></div><div id="collapse106" class="collapse" aria-labelledby="heading106" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading95"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse95" aria-expanded="true" aria-controls="collapse95">Use case: API Logging and Auditing <span>[API LOGGING AND AUDITING]</span></button></h5></div><div id="collapse95" class="collapse" aria-labelledby="heading95" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading94"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse94" aria-expanded="true" aria-controls="collapse94">Threat: Attackers make undetected and unaudited changes to system configurations <span>[UNAUDITABLE-CHANGES-AWS]</span></button></h5></div><div id="collapse94" class="collapse" aria-labelledby="heading94" data-parent="#threats"><div class="card-body"><div>
                                If audit trails are not properly protected, an attacker could gain access to the system,
                                modify the status of the resources or exfiltrate sensitive data without being noticed.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading88"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse88" aria-expanded="true" aria-controls="collapse88">Weakness: Audit logs are accesible <span>[AWS-Logging-3.3]</span></button></h5></div><div id="collapse88" class="collapse" aria-labelledby="heading88" data-parent="#weaknesses"><div class="card-body"><div>
                        The audit logs are not encrypted and they can be accessed by attackers and obtain sensitive data
                        in clear text.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading86"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse86" aria-expanded="true" aria-controls="collapse86">Countermeasure: Ensure CloudTrail logs are not publically available <span>[Hydras-AWS-Logging-3.3]</span></button></h5></div><div id="collapse86" class="collapse" aria-labelledby="heading86" data-parent="#controls"><div class="card-body">Since cloudtrail logs capture all API calls for the AWS account they should be stored in an S3
                        bucket that is not accessible to the public. Applying the correct bucket policy helps ensure the
                        confidentiality of the data.
                        <div>
                        <br />
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Sign in to the AWS Management Console (with s3 update privileges).</li>
                        <li>Select s3 from the services list.</li>
                        <li>Right-click on the bucket you have used for &quot;cloudtrail&quot; and click
                        &quot;Properties&quot;.</li>
                        <li>In the Properties pane, click the Permissions tab.&nbsp;</li>
                        <li>Select the row that grants permission to &quot;Everyone&quot; or &quot;Any
                        Authenticated User&quot;.</li>
                        <li>Uncheck all the permissions granted to Everyone or Any Authenticated User.</li>
                        <li>Click Save to save the ACL.&nbsp;</li>
                        <li>If the Edit bucket policy button is present, click it.</li>
                        <li>Remove any Statement having an Effect set to Allow and a Principal set to *.&nbsp;</li>
                        </ol>Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading87"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse87" aria-expanded="true" aria-controls="collapse87">Countermeasure: Encrypt CloudTrail logs using KMS <span>[Hydras-AWS-Logging-3.5]</span></button></h5></div><div id="collapse87" class="collapse" aria-labelledby="heading87" data-parent="#controls"><div class="card-body">By default, the log files delivered by CloudTrail to your bucket are encrypted by Amazon
                        server-side encryption with Amazon S3-managed encryption keys (SSE-S3). To provide a security
                        layer that is directly manageable, you can instead use server-side encryption with AWS
                        KMS–managed
                        keys (SSE-KMS) for your CloudTrail log files. This provides several advantages:
                        <br />
                        <ul>
                        <li>You can create and manage the CMK encryption keys yourself.&nbsp;</li>
                        <li>You can use a single CMK to encrypt and decrypt log files for multiple accounts across
                        all regions.&nbsp;</li>
                        <li>You have control over who can use your key for encrypting and decrypting CloudTrail
                        log files.&nbsp;</li>
                        <li>You can assign permissions for the key to the users in your organization according to
                        your requirements.</li>
                        <li>You have enhanced security. With this feature, in order to read log files, you now
                        need to meet two conditions:&nbsp;</li>
                        <ol>
                        <li>you must have S3 read permission on the bucket, and&nbsp;</li>
                        <li>you must be granted decrypt permission by the CMK policy.&nbsp;</li>
                        </ol>
                        </ul>Because S3 automatically decrypts the log files for requests from users authorized to
                        use the CMK, SSE-KMS encryption for CloudTrail log files is backward compatible with existing
                        applications that read CloudTrail log data.&nbsp;
                        <br />
                        <br />
                        <b>Remediation:</b>&nbsp;&nbsp;
                        <br />
                        <ol>
                        <li>Sign in to the AWS Management Console (with cloudtrail update permissions).</li>
                        <li>Select CloudTrail from the services menu.</li>
                        <li>Select &quot;Trails&quot;.</li>
                        <li>Click on a Trail.</li>
                        <li>Under the S3 section click on the edit button.</li>
                        <li>Click Advanced.</li>
                        <li>Set &quot;Encrypt Log Files&quot; to &quot;Yes&quot;.</li>
                        <li>Set &quot;Create a new KMS key&quot; to &quot;Yes&quot;.</li>
                        <li>In &quot;KMS key&quot; type a name for your key.</li>
                        <li>Click &quot;Save&quot;.</li>
                        </ol> Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        <br />
                        <br />
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading90"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse90" aria-expanded="true" aria-controls="collapse90">Weakness: Non-auditable API calls in all regions <span>[AWS-Logging-3.1]</span></button></h5></div><div id="collapse90" class="collapse" aria-labelledby="heading90" data-parent="#weaknesses"><div class="card-body">The API call to the resources is not audited and the actions are not recorded into the logs.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading89"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse89" aria-expanded="true" aria-controls="collapse89">Countermeasure: Enable Cloudtrail in all regions <span>[Hydras-AWS-Logging-3.1]</span></button></h5></div><div id="collapse89" class="collapse" aria-labelledby="heading89" data-parent="#controls"><div class="card-body">Cloudtrail records events of all API calls made within a AWS account. This enables security
                        analysis, resource change tracking, and compliance auditing. Cloudtrail should be enabled in all
                        regions, even if they are not being used, to identify unintended or accidental changes.
                        <br />
                        <br />
                        <b>Remediation</b>:
                        <br />Create a global trail using a previously created S3 bucket:
                        <br />
                        <blockquote>
                        aws cloudtrail create-trail --name &lt;trail_name&gt; --s3-bucket-name &lt;s3-bucket-name&gt;
                        --is-multi-region-trail
                        </blockquote>
                        <br />Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        <br />
                        <br />
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading93"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse93" aria-expanded="true" aria-controls="collapse93">Weakness: Non-auditable actions in the resources <span>[AWS-Logging-3.4]</span></button></h5></div><div id="collapse93" class="collapse" aria-labelledby="heading93" data-parent="#weaknesses"><div class="card-body">The actions in the resources are not audited and not recorded in the logs.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading91"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse91" aria-expanded="true" aria-controls="collapse91">Countermeasure: Enable CloudTrail log file validation <span>[Hydras-AWS-Logging-3.2]</span></button></h5></div><div id="collapse91" class="collapse" aria-labelledby="heading91" data-parent="#controls"><div class="card-body">Enabling log file validation will provide additional integrity checking of CloudTrail as it
                        creates a digest for each log file it writes to S3. These digests can then be used to determine
                        if a log has been modified since being written
                        <br />
                        <br />
                        <b>Remediation:<br /></b>
                        <blockquote>
                        aws cloudtrail update-trail --name &lt;trail_name&gt; --enable-log-file-validation
                        </blockquote>
                        <br />Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading92"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse92" aria-expanded="true" aria-controls="collapse92">Countermeasure: Integrate the CloudTail logs into Cloudwatch logs <span>[Hydras-AWS-Logging-3.4]</span></button></h5></div><div id="collapse92" class="collapse" aria-labelledby="heading92" data-parent="#controls"><div class="card-body">One way to work with cloudtrail logs is to send them to cloudwatch logs which allows you to
                        define metric filters for alerting and monitoring. This allows you to take immediate action if a
                        certain threshold has been met. Enabling this provides the opportunity to monitor for sensitive
                        account activity.
                        <div>
                        <br />
                        <b>Remediation:</b>
                        <br />
                        <ol>
                        <li>Sign in to the AWS Management Console (with cloudtrail update permission).</li>
                        <li>Select Cloudtrail from the services list.</li>
                        <li>Under All Buckets select the target bucket you want to check.</li>
                        <li>Select &quot;Properties&quot; then &quot;Trails&quot;.</li>
                        <li>Click on each trail where no CloudWatch Logs are defined.</li>
                        <li>Go to the &quot;CloudWatch Logs&quot; section and click on &quot;Configure&quot;.</li>
                        <li>Define a new or select an existing log group and click &quot;Continue&quot;.</li>
                        <li>Configure the IAM Role which will deliver CloudTrail events to CloudWatch Logs.</li>
                        <li>Create/Select an IAM Role and Policy Name.</li>
                        <li>Click Allow.</li>
                        </ol>Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        <br />&nbsp;
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading105"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse105" aria-expanded="true" aria-controls="collapse105">Use case: AWS Resource Logging <span>[AWS RESOURCE LOGGING]</span></button></h5></div><div id="collapse105" class="collapse" aria-labelledby="heading105" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading104"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse104" aria-expanded="true" aria-controls="collapse104">Threat: Attackers make undetected and unaudited changes in the resources <span>[UNAUDITABLE-CHANGES-RESOURCES-AWS]</span></button></h5></div><div id="collapse104" class="collapse" aria-labelledby="heading104" data-parent="#threats"><div class="card-body"><div>
                                If audit trails in the resources are not enabled or not protected, attackers could gain
                                access to the system and modify or delete data from the resources and the changes are
                                not detected.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading97"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse97" aria-expanded="true" aria-controls="collapse97">Weakness: Non-auditable actions in the resources <span>[AWS-Logging-3.4]</span></button></h5></div><div id="collapse97" class="collapse" aria-labelledby="heading97" data-parent="#weaknesses"><div class="card-body">The actions in the resources are not audited and not recorded in the logs.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading96"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse96" aria-expanded="true" aria-controls="collapse96">Countermeasure: Enable S3 Bucket logging <span>[Hydras-AWS-Logging-3.6]</span></button></h5></div><div id="collapse96" class="collapse" aria-labelledby="heading96" data-parent="#controls"><div class="card-body">S3 Bucket Access Logging generates log files that contain access records for each request made
                        to an S3 bucket. By enabling this it is possible to capture events relating to the objects
                        within that bucket thus helping to capture potential security issues or identifying threats. It
                        is recommended to enable S3 bucket logging on any S3 bucket that contains sensitive data and
                        stored the logs in a separate bucket for security analysis.
                        <div>
                        <br />
                        <b>Remediation:<br /></b>
                        <ol>
                        <li>Sign in to the AWS Management Console (with S3 update access).</li>
                        <li>Select S3 from the services menu.</li>
                        <li>Under All Buckets click on the S3 bucket you wish to enable logging.</li>
                        <li>Click on Properties in the top right of the console.</li>
                        <li>Under Bucket:&lt;bucket_name&gt; click on Logging.</li>
                        <li>Click on the &quot;Enabled&quot; checkbox.</li>
                        <li>Select a &quot;Target Bucket&quot; to store the logs.</li>
                        <li>Select a &quot;Target Prefix&quot; for the logs.</li>
                        <li>Click &quot;Save&quot;.</li>
                        </ol>Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading99"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse99" aria-expanded="true" aria-controls="collapse99">Weakness: Non-centrality audit logs <span>[AWS-Logging-3.8]</span></button></h5></div><div id="collapse99" class="collapse" aria-labelledby="heading99" data-parent="#weaknesses"><div class="card-body">The audit logs are not stored in a central system. Therefore, the audit logs cannot be
                        exploited correctly by the security personnel.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading98"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse98" aria-expanded="true" aria-controls="collapse98">Countermeasure: Export EC2 OS logs to cloudwatch logs <span>[Hydras-AWS-Logging-3.8]</span></button></h5></div><div id="collapse98" class="collapse" aria-labelledby="heading98" data-parent="#controls"><div class="card-body">Cloudwatch logs is an AWS service that allows you to send logs from an EC2 instance to
                        cloudwatch via an agent installed locally on the machine. The logs are then stored centrally
                        within cloudwatch logs and metric alerts can be configured so that security incidents can be
                        reported to the security team. It is recommended to enable cloudwatch log monitoring on all EC2
                        servers.
                        <br />
                        <br />
                        <b>Remediation:<br /></b>Follow the directions provided in &quot;http://docs.aws.amazon.com/AmazonCloudWatch/latest/DeveloperGuide/EC2NewInstanceCWL.html&quot;
                        to install and enable Cloudwatch Logs on a new EC2 instance.
                        <br />
                        <br />Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading101"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse101" aria-expanded="true" aria-controls="collapse101">Weakness: Unaudited connections with the resources <span>[AWS-Logging-3.7]</span></button></h5></div><div id="collapse101" class="collapse" aria-labelledby="heading101" data-parent="#weaknesses"><div class="card-body">The connections with the applications and with the databases cannot be audited and not
                        detected.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading100"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse100" aria-expanded="true" aria-controls="collapse100">Countermeasure: Enable VPC flow logs <span>[Hydras-AWS-Logging-3.7]</span></button></h5></div><div id="collapse100" class="collapse" aria-labelledby="heading100" data-parent="#controls"><div class="card-body">VPC Flow logs enable the capture of IP traffic that traverses the network interfaces within a
                        VPC. These logs are captured and sent to cloudtrail logs enabling you to detect security
                        incidents that may be occurring across the network.
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        <br />
                        <ol>
                        <li>Sign into the management console.</li>
                        <li>Select VPC from the services menu.</li>
                        <li>In the left pane click &quot;Your VPCs&quot;.</li>
                        <li>Select a VPC.</li>
                        <li>Select the Flow Logs tab from the preview panel.</li>
                        <li>Select &quot;Create Flow Log&quot;.</li>
                        <li>Choose a role (note this must be pre-created. Follow the link provided in the text
                        underneath &quot;Role&quot; for help).</li>
                        <li>Select a &quot;Destination Log Group&quot;.</li>
                        <li>Click &quot;Create flow Log&quot;.</li>
                        </ol>Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        <br />
                        <br />
                        <br />
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading103"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse103" aria-expanded="true" aria-controls="collapse103">Weakness: Unaudited resources changes <span>[AWS-Logging-3.9]</span></button></h5></div><div id="collapse103" class="collapse" aria-labelledby="heading103" data-parent="#weaknesses"><div class="card-body">The changes in the applications and in the databases and these changes are not detected and
                        not audited.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading102"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse102" aria-expanded="true" aria-controls="collapse102">Countermeasure: Enable AWS Config across all regions <span>[Hydras-AWS-Logging-3.9]</span></button></h5></div><div id="collapse102" class="collapse" aria-labelledby="heading102" data-parent="#controls"><div class="card-body">AWS Config tracks configuration changes to resources as they occur and is therefore a good
                        source of identifying whether unintentional or malicious changes have occurred to resources with
                        the AWS account.
                        <div>
                        <br />
                        <b>Remediation:</b>
                        <br />
                        <ol>
                        <li>Sign in to the AWS Management Console (with Config update permissions).</li>
                        <li>Select Config from the services menu.</li>
                        <li>Define which resources you want to record in the selected region.</li>
                        <li>Choose to include global resources (IAM resources).</li>
                        <li>Specify an S3 bucket.</li>
                        <li>Create an SNS Topic&nbsp;&nbsp;</li>
                        </ol>Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        <br />&nbsp;
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading132"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse132" aria-expanded="true" aria-controls="collapse132">Risk pattern: AWS Monitoring <span>[HYDRAS-AWS-MON]</span></button></h5></div><div id="collapse132" class="collapse" aria-labelledby="heading132" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading131"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse131" aria-expanded="true" aria-controls="collapse131">Use case: Cloudwatch Metric Alerts <span>[CLOUDWATCH METRIC ALERTS]</span></button></h5></div><div id="collapse131" class="collapse" aria-labelledby="heading131" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading117"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse117" aria-expanded="true" aria-controls="collapse117">Threat: Attackers access to the systems without being detected <span>[UNAUTHORIZED_ACCESS_SYSTEMS_AWS]</span></button></h5></div><div id="collapse117" class="collapse" aria-labelledby="heading117" data-parent="#threats"><div class="card-body"><div>
                                Attackers gain access to the systems and they are not detected and the changes of the
                                attackers could not be detected and audited.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading108"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse108" aria-expanded="true" aria-controls="collapse108">Weakness: Brute force attempts on the Amazon management console cannot be detected <span>[AWS-Monitoring-4.5]</span></button></h5></div><div id="collapse108" class="collapse" aria-labelledby="heading108" data-parent="#weaknesses"><div class="card-body">The failure connection attempts (brute force) must be audited and monitored and the
                        correspondent personnel must be alerted and informed.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading107"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse107" aria-expanded="true" aria-controls="collapse107">Countermeasure: Create management console login failure alerts <span>[Hydras-AWS-Monitoring-4.5]</span></button></h5></div><div id="collapse107" class="collapse" aria-labelledby="heading107" data-parent="#controls"><div class="card-body">When cloudtrail is configured and sending alerts to cloudwatch logs these logs can be queried
                        to identify suspicious API activity. One such activity that should be monitored is management
                        console login failures. The management console is the AWS account GUI where administration
                        activity is performed and is therefore a primary target for brute force attempts. To identify
                        these attempts alerts for login failures should be enabled as this can highlight suspicious
                        activity.
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:<br /></b>
                        <ol>
                        <li>Create a metric filter that checks for console login failures: aws logs
                        put-metric-filter --log-group-name &lt;group&gt; --filter-name &lt;name&gt;
                        --metric- transformations &lt;value&gt; --filter-pattern '{ ($.eventName = ConsoleLogin)
                        &amp;&amp; ($.errorMessage = &quot;Failed authentication&quot;) }'&nbsp;</li>
                        <li>Create an SNS topic for notifications: aws sns create-topic --name &lt;topic_name&gt;</li>
                        <li>Create an SNS subscription to the topic created above: aws sns subscribe --topic-arn
                        &lt;topic_arn&gt; --protocol email --notification-endpoint &lt;email@example.com&gt;</li>
                        <li>Create an alarm based on the above steps: aws cloudwatch put-metric-alarm --alarm-name
                        &lt;value&gt; --metric-name &lt;metric_filter_name&gt; --statistic Sum --period
                        300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1
                        --namespace &lt;CloudTrailMetrics&gt; --alarm-actions &lt;topic_arn&gt;</li>
                        </ol>Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading112"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse112" aria-expanded="true" aria-controls="collapse112">Weakness: Changes in the security configurations can be not detected <span>[AWS-Monitoring-4.4]</span></button></h5></div><div id="collapse112" class="collapse" aria-labelledby="heading112" data-parent="#weaknesses"><div class="card-body"><div>
                        Monitoring and alerting for security configurations are not configured and changes cannot be
                        detected.&nbsp;
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading109"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse109" aria-expanded="true" aria-controls="collapse109">Countermeasure: Create billing alerts to identify unusual spend <span>[Hydras-AWS-Monitoring-4.1]</span></button></h5></div><div id="collapse109" class="collapse" aria-labelledby="heading109" data-parent="#controls"><div class="card-body">By setting billing alarms you can monitor your AWS spend and be alerted if it exceeds certain
                        thresholds thus protecting you from accruing unnecessary charges.
                        <div>
                        <br />
                        <b>Remediation:</b>
                        <br />
                        <ol>
                        <li>Sign in to the AWS Management Console and open the Billing and Cost Management console
                        at https://console.aws.amazon.com/billing/home#/.&nbsp;</li>
                        <li>On the navigation pane, choose Preferences.&nbsp;</li>
                        <li>Select the Receive Billing Alerts check box.&nbsp;</li>
                        <li>Choose Save preferences.&nbsp;</li>
                        <li>Open the CloudWatch console at https://console.aws.amazon.com/cloudwatch/.&nbsp;</li>
                        <li>If necessary, change the region on the navigation bar to US East (N. Virginia). The
                        billing metric data is stored in this region, even for resources in other regions.&nbsp;</li>
                        <li>On the navigation pane, under &quot;Metrics&quot;, choose &quot;Billing&quot;.&nbsp;</li>
                        <li>In the list of billing metrics, select the check box next to Currency USD, for the
                        metric named EstimatedCharges. Define the alarm as follows:</li>
                        <ul>
                        <li>If you want the alarm to trigger as soon as you go over the free tier, set &quot;When
                        my total AWS charges for the month exceed&quot; to $.01. This means that you'll receive a
                        notification as soon as you incur a charge. Otherwise, set it to the amount you want to trigger
                        the alarm, and you will be notified when you go over that amount.&nbsp;</li>
                        <li>Choose the &quot;New list&quot; link next to the &quot;send a notification
                        to&quot; box.&nbsp;</li>
                        <li>When prompted, enter your email address or choose your Amazon SNS notification from
                        the drop down.&nbsp;</li>
                        <li>Choose &quot;Create Alarm&quot;.&nbsp;</li>
                        </ul>
                        <li>In the &quot;Confirm new email addresses&quot; dialog box, confirm the email
                        address or choose &quot;I will do it later&quot;. If you don't confirm the email address
                        now, the alarm remains in the Pending confirmation status until you do so, and does not send an
                        alert. To view the status of your alarm, choose &quot;Alarms&quot; in the navigation
                        panel.</li>
                        </ol>Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        <br />
                        <br />
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading110"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse110" aria-expanded="true" aria-controls="collapse110">Countermeasure: Create cloudtrail configuration changes alerts <span>[Hydras-AWS-Monitoring-4.4]</span></button></h5></div><div id="collapse110" class="collapse" aria-labelledby="heading110" data-parent="#controls"><div class="card-body">When cloudtrail is configured and sending alerts to cloudwatch logs these logs can be queried
                        to identify suspicious API activity. One such activity that should be monitored is changes to
                        cloudtrail. Since cloudtrail is the actual utility logging API calls it's security is paramount
                        to ensuring that this continues. Therefore alerting on changes to cloudtrail activity can
                        prevent a malicious user switching off the logging in order to carry out untracked activities.
                        <div>
                        <br />
                        <b>Remediation:&nbsp;&nbsp;</b>
                        <br />
                        <ol>
                        <li>Identify the log group name: aws cloudtrail describe-trails</li>
                        <li>Note the &lt;group&gt; value associated with CloudWatchLogsLogGroupArn&nbsp;</li>
                        <li>Get a list of all associated metric filters for this &lt;group&gt;:&nbsp;aws
                        logs describe-metric-filters --log-group-name &quot;&lt;group&gt;&quot;&nbsp;</li>
                        <li>Ensure the output contains the following: &quot;filterPattern&quot;: &quot;{
                        ($.eventName = CreateTrail) || ($.eventName = UpdateTrail) || ($.eventName = DeleteTrail) ||
                        ($.eventName = StartLogging) || ($.eventName = StopLogging) }&quot;&nbsp;</li>
                        <li>Note the metricName value associated with the filterPattern found in step 4.&nbsp;</li>
                        <li>Get a list of CloudWatch alarms and filter on the metricName captured in step 4: aws
                        cloudwatch describe-alarms --query 'MetricAlarms[?MetricName==`&lt;metricName&gt;`]'</li>
                        <li>Note the AlarmActions value - this will provide the SNS topic ARN value.&nbsp;</li>
                        <li>Ensure there is at least one subscriber to the SNS topic: aws sns
                        list-subscriptions-by-topic --topic-arn &lt;topic_arm&gt;&nbsp;</li>
                        </ol>
                        </div>
                        <div>
                        Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        <br />
                        <br />
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading111"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse111" aria-expanded="true" aria-controls="collapse111">Countermeasure: Create AWS Config configuration change alerts <span>[Hydras-AWS-Monitoring-4.9]</span></button></h5></div><div id="collapse111" class="collapse" aria-labelledby="heading111" data-parent="#controls"><div class="card-body">When cloudtrail is configured and sending alerts to cloudwatch logs these logs can be queried
                        to identify suspicious API activity. One such activity that should be monitored is AWS Config
                        changes. AWS config tracks configuration changes within the environment and is a useful change
                        management tool. Therefore alerting on config changes ensures the continued visibility of AWS
                        configuration items.
                        <div>
                        &nbsp;
                        <br />
                        <b>Remediation:</b>
                        <br />
                        <ul>
                        <li>Create a metric filter that checks for AWS Config changes:&nbsp;</li>
                        </ul>
                        </div>
                        <blockquote>
                        <blockquote>
                        <div>
                        aws logs put-metric-filter&nbsp;
                        </div>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        --log-group-name &lt;group&gt;&nbsp;
                        </div>
                        <div>
                        --filter-name &lt;name&gt;&nbsp;
                        </div>
                        <div>
                        --metric- transformations &lt;value&gt;&nbsp;
                        </div>
                        <div>
                        --filter-pattern '{($.eventSource = config.amazonaws.com) &amp;&amp;
                        (($.eventName=StopConfigurationRecorder)||($.eventName=DeleteDeliveryChannel)||($.even
                        tName=PutDeliveryChannel)||($.eventName=PutConfigurationRecorder))}'&nbsp;
                        </div>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        <div>
                        <ul>
                        <li>Create an SNS topic for notifications: aws sns create-topic --name &lt;topic_name&gt;</li>
                        <li>Create an SNS subscription to the topic created above: aws sns subscribe --topic-arn
                        &lt;topic_arn&gt; --protocol email --notification-endpoint &lt;email@example.com&gt;</li>
                        <li>Create an alarm based on the above steps:</li>
                        </ul>
                        </div>
                        <blockquote>
                        <blockquote>
                        <div>
                        aws cloudwatch put-metric-alarm&nbsp;
                        </div>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        --alarm-name &lt;value&gt;&nbsp;
                        </div>
                        <div>
                        --metric-name &lt;metric_filter_name&gt;&nbsp;
                        </div>
                        <div>
                        --statistic Sum&nbsp;
                        </div>
                        <div>
                        --period 300&nbsp;
                        </div>
                        <div>
                        --threshold 1&nbsp;
                        </div>
                        <div>
                        --comparison-operator GreaterThanOrEqualToThreshold&nbsp;
                        </div>
                        <div>
                        --evaluation-periods 1&nbsp;
                        </div>
                        <div>
                        --namespace &lt;CloudTrailMetrics&gt;&nbsp;
                        </div>
                        <div>
                        --alarm-actions &lt;topic_arn&gt;
                        </div>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        <br />
                        </div>
                        </blockquote>
                        </blockquote>
                        <div>
                        Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading114"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse114" aria-expanded="true" aria-controls="collapse114">Weakness: Excessive use of administrator accounts <span>[AWS-Monitoring-4.2]</span></button></h5></div><div id="collapse114" class="collapse" aria-labelledby="heading114" data-parent="#weaknesses"><div class="card-body">The administrator accounts are used for all actions, not only for administrative actions. This
                        is because these users have not got a personal or a user account to do the daily actions.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading113"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse113" aria-expanded="true" aria-controls="collapse113">Countermeasure: Create root account usage alerts <span>[Hydras-AWS-Monitoring-4.2]</span></button></h5></div><div id="collapse113" class="collapse" aria-labelledby="heading113" data-parent="#controls"><div class="card-body">When cloudtrail is configured and sending alerts to cloudwatch logs these logs can be queried
                        to identify suspicious API activity. One such activity that should be monitored is usage of the
                        root account. This account should not be used on a day to day basis due to its full unrestricted
                        privilege therefore usage should be by exception. Monitoring this usage should capture any
                        suspicious activity used on the account.
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        <br />
                        <ol>
                        <li>Identify the log group name: aws cloudtrail describe-trails</li>
                        <li>Note the &lt;group&gt; value associated with CloudWatchLogsLogGroupArn.</li>
                        <li>Get a list of all associated metric filters for this &lt;group&gt;: aws logs
                        describe-metric-filters --log-group-name &quot;&lt;group&gt;&quot;</li>
                        <li>Ensure the output contains the following: &quot;filterPattern&quot;: &quot;{
                        $.userIdentity.type = \&quot;Root\&quot; &amp;&amp; $.userIdentity.invokedBy NOT
                        EXISTS &amp;&amp; $.eventType != \&quot;AwsServiceEvent\&quot; } &quot;</li>
                        <li>Note the metricName value associated with the filterPattern found in step 4.&nbsp;</li>
                        <li>Get a list of CloudWatch alarms and filter on the metricName captured in step 4: aws
                        cloudwatch describe-alarms --query 'MetricAlarms[?MetricName==`&lt;metricName&gt;`]'</li>
                        <li>Note the AlarmActions value - this will provide the SNS topic ARN value.&nbsp;</li>
                        <li>Ensure there is at least one subscriber to the SNS topic: aws sns
                        list-subscriptions-by-topic --topic-arn &lt;topic_arm&gt;&nbsp;</li>
                        </ol>
                        </div>
                        <div>
                        Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading116"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse116" aria-expanded="true" aria-controls="collapse116">Weakness: Lack of 2FA <span>[AWS-Monitoring-4.3]</span></button></h5></div><div id="collapse116" class="collapse" aria-labelledby="heading116" data-parent="#weaknesses"><div class="card-body">Login to the console without using the Multi-factor Authentication (MFA) and they are not
                        detected. The connection without the MFA must be audited and monitored, the correct security
                        group must be informed and they must validate this connection.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading115"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse115" aria-expanded="true" aria-controls="collapse115">Countermeasure: Create management console login alerts when MFA is not used <span>[Hydras-AWS-Monitoring-4.3]</span></button></h5></div><div id="collapse115" class="collapse" aria-labelledby="heading115" data-parent="#controls"><div class="card-body">When cloudtrail is configured and sending alerts to cloudwatch logs these logs can be queried
                        to identify suspicious API activity. One such activity that should be monitored is login on the
                        console without MFA. Since logging on at the console should be restricted to only those users
                        with an active MFA this alert will highlight those with password only access. This helps to
                        capture weaker login procedures (password only) as they occur.
                        <div>
                        <br />
                        <b>Remediation:</b>
                        <br />
                        <ol>
                        <li>Create a metric filter that checks for console login without MFA: aws logs
                        put-metric-filter --log-group-name &lt;cloudwatch-logs-group&gt; --filter-name &lt;name&gt;
                        --metric- transformations &lt;value&gt; --filter-pattern '{
                        $.userIdentity.sessionContext.attributes.mfaAuthenticated != &quot;true&quot; }'</li>
                        <li>Create an SNS topic for notifications: aws sns create-topic --name &lt;topic_name&gt;</li>
                        <li>Create an SNS subscription to the topic created above: aws sns subscribe --topic-arn
                        &lt;topic_arn&gt; --protocol email --notification-endpoint &lt;email@example.com&gt;</li>
                        <li>Create an alarm based on the above steps: aws cloudwatch put-metric-alarm --alarm-name
                        &lt;value&gt; --metric-name &lt;metric_filter_name&gt; --statistic Sum --period
                        300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1
                        --namespace &lt;CloudTrailMetrics&gt; --alarm-actions &lt;topic_arn&gt;</li>
                        </ol>Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading125"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse125" aria-expanded="true" aria-controls="collapse125">Threat: Attackers gain undetected access to the security system configurations <span>[UNAUTHORIZED-ACCESS-SECURITY-SYSTEMS-AWS]</span></button></h5></div><div id="collapse125" class="collapse" aria-labelledby="heading125" data-parent="#threats"><div class="card-body"><div>
                                Attackers could gain undetected access to the security configurations and the changes of
                                the attackers could not be detected and audited.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading119"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse119" aria-expanded="true" aria-controls="collapse119">Weakness: Changes in the data encryption configuration cannot be detected <span>[AWS-Monitoring-4.7]</span></button></h5></div><div id="collapse119" class="collapse" aria-labelledby="heading119" data-parent="#weaknesses"><div class="card-body">The changes on the database encryption must be audited and monitored. When there are changes
                        on the database encryption, the security group must be alerted.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading118"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse118" aria-expanded="true" aria-controls="collapse118">Countermeasure: Create KMS CMK Deletion alerts <span>[Hydras-AWS-Monitoring-4.7]</span></button></h5></div><div id="collapse118" class="collapse" aria-labelledby="heading118" data-parent="#controls"><div class="card-body">When cloudtrail is configured and sending alerts to cloudwatch logs these logs can be queried
                        to identify suspicious API activity. One such activity that should be monitored is KMS CMK
                        deletions or deactivation. KMS CMK can be used as the master keys for encrypting data and these
                        keys are stored within AWS. However if these keys are disabled or deactivated then the data that
                        was encrypted with them cannot be accessed. Therefore any scheduled deletions or deactivation of
                        keys should be monitored.
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        <br />
                        <ol>
                        <li>Create a metric filter that checks for KMS CMK disables or deletions: aws logs
                        put-metric-filter --log-group-name &lt;group&gt; --filter-name &lt;name&gt;
                        --metric- transformations &lt;value&gt; --filter-pattern '{($.eventSource =
                        kms.amazonaws.com) &amp;&amp;
                        (($.eventName=DisableKey)||($.eventName=ScheduleKeyDeletion))}'&nbsp;</li>
                        <li>Create an SNS topic for notifications: aws sns create-topic --name &lt;topic_name&gt;</li>
                        <li>Create an SNS subscription to the topic created above: aws sns subscribe --topic-arn
                        &lt;topic_arn&gt; --protocol email --notification-endpoint &lt;email@example.com&gt;</li>
                        <li>Create an alarm based on the above steps: aws cloudwatch put-metric-alarm --alarm-name
                        &lt;value&gt; --metric-name &lt;metric_filter_name&gt; --statistic Sum --period
                        300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1
                        --namespace &lt;CloudTrailMetrics&gt; --alarm-actions &lt;topic_arn&gt;&nbsp;</li>
                        </ol>Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading122"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse122" aria-expanded="true" aria-controls="collapse122">Weakness: Changes in the security configurations can be not detected <span>[AWS-Monitoring-4.4]</span></button></h5></div><div id="collapse122" class="collapse" aria-labelledby="heading122" data-parent="#weaknesses"><div class="card-body"><div>
                        Monitoring and alerting for security configurations are not configured and changes cannot be
                        detected.&nbsp;
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading120"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse120" aria-expanded="true" aria-controls="collapse120">Countermeasure: Create IAM Policy change alerts <span>[Hydras-AWS-Monitoring-4.6]</span></button></h5></div><div id="collapse120" class="collapse" aria-labelledby="heading120" data-parent="#controls"><div class="card-body">When cloudtrail is configured and sending alerts to cloudwatch logs these logs can be queried
                        to identify suspicious API activity. One such activity that should be monitored is management
                        IAM policy changes. IAM manages authorization and authentication controls with AWS and
                        therefore it is vital that unauthorised changes are detected. Enabling monitoring of these
                        changes ensures that these policies remain intact and as desired.
                        <div>
                        <br />
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Create a metric filter that checks for IAM policy changes: aws logs put-metric-filter
                        --log-group-name &lt;group&gt; --filter-name &lt;name&gt; --metric-
                        transformations &lt;value&gt; --filter-pattern
                        '{($.eventName=DeleteGroupPolicy)||($.eventName=DeleteRolePolicy)||($.eventName=Delete
                        UserPolicy)||($.eventName=PutGroupPolicy)||($.eventName=PutRolePolicy)||($.eventName=P
                        utUserPolicy)||($.eventName=CreatePolicy)||($.eventName=DeletePolicy)||($.eventName=Cr
                        eatePolicyVersion)||($.eventName=DeletePolicyVersion)||($.eventName=AttachRolePolicy)|
                        |($.eventName=DetachRolePolicy)||($.eventName=AttachUserPolicy)||($.eventName=DetachUs
                        erPolicy)||($.eventName=AttachGroupPolicy)||($.eventName=DetachGroupPolicy)}'&nbsp;</li>
                        <li>Create an SNS topic for notifications: aws sns create-topic --name &lt;topic_name&gt;</li>
                        <li>Create an SNS subscription to the topic created above:aws sns subscribe --topic-arn
                        &lt;topic_arn&gt; --protocol email --notification-endpoint &lt;email@example.com&gt;</li>
                        <li>Create an alarm based on the above steps: aws cloudwatch put-metric-alarm --alarm-name
                        &lt;value&gt; --metric-name &lt;metric_filter_name&gt; --statistic Sum --period
                        300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1
                        --namespace &lt;CloudTrailMetrics&gt; --alarm-actions &lt;topic_arn&gt;</li>
                        </ol>Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        <br />
                        <br />
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading121"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse121" aria-expanded="true" aria-controls="collapse121">Countermeasure: Create s3 bucket policy change alerts <span>[Hydras-AWS-Monitoring-4.8]</span></button></h5></div><div id="collapse121" class="collapse" aria-labelledby="heading121" data-parent="#controls"><div class="card-body">When cloudtrail is configured and sending alerts to cloudwatch logs these logs can be queried
                        to identify suspicious API activity. One such activity that should be monitored is S3 bucket
                        policy changes. S3 bucket policies are a resource based policy that provide authorizations on S3
                        buckets.
                        <div>
                        <br />
                        </div>
                        <div>
                        Making sure that their integrity remains intact is vital in ensuring the data within the S3
                        bucket remains secure and authorizations intact. Therefore s3 bucket policy changes should be
                        alerted upon
                        <br />
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        <br />
                        <ul>
                        <li>Create a metric filter that checks for S3 Bucket policy changes:</li>
                        </ul>
                        </div>
                        <blockquote>
                        <blockquote>
                        <div>
                        aws logs put-metric-filter --log-group-name &lt;group&gt; --filter-name &lt;value&gt;
                        --metric- transformations &lt;value&gt; --filter-pattern '{ ($.eventSource =
                        s3.amazonaws.com) &amp;&amp; (($.eventName = PutBucketAcl) || ($.eventName =
                        PutBucketPolicy) || ($.eventName = PutBucketCors) || ($.eventName = PutBucketLifecycle) ||
                        ($.eventName = PutBucketReplication) || ($.eventName = DeleteBucketPolicy) || ($.eventName =
                        DeleteBucketCors) || ($.eventName = DeleteBucketLifecycle) || ($.eventName =
                        DeleteBucketReplication)) }'
                        </div>
                        </blockquote>
                        </blockquote>
                        <div>
                        <ul>
                        <li>Create an SNS topic for notifications:</li>
                        </ul>
                        </div>
                        <blockquote>
                        <blockquote>
                        <div>
                        aws sns create-topic --name &lt;topic_name&gt;
                        </div>
                        </blockquote>
                        </blockquote>
                        <div>
                        <ul>
                        <li>Create an SNS subscription to the topic created above&nbsp;</li>
                        </ul>
                        </div>
                        <blockquote>
                        <blockquote>
                        <div>
                        aws sns subscribe --topic-arn &lt;topic_arn&gt; --protocol email --notification-endpoint
                        &lt;email@example.com&gt;
                        </div>
                        </blockquote>
                        </blockquote>
                        <div>
                        <ul>
                        <li>Create an alarm based on the above steps:</li>
                        </ul>
                        </div>
                        <blockquote>
                        <blockquote>
                        <div>
                        aws cloudwatch put-metric-alarm --alarm-name &lt;value&gt; --metric-name &lt;metric_filter_name&gt;
                        --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold
                        --evaluation-periods 1 --namespace &lt;CloudTrailMetrics&gt; --alarm-actions &lt;topic_arn&gt;
                        </div>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <div>
                        <br />
                        </div>
                        </blockquote>
                        <div>
                        Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading124"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse124" aria-expanded="true" aria-controls="collapse124">Weakness: Changes in the security groups cannot be detected <span>[AWS-Monitoring-4.10]</span></button></h5></div><div id="collapse124" class="collapse" aria-labelledby="heading124" data-parent="#weaknesses"><div class="card-body">The changes in the security groups must be audited and monitored and the correspondent
                        personnel must approve these changes. If the situation is not the correct, attackers can access
                        to security systems.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading123"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse123" aria-expanded="true" aria-controls="collapse123">Countermeasure: Create security group change alerts <span>[Hydras-AWS-Monitoring-4.10]</span></button></h5></div><div id="collapse123" class="collapse" aria-labelledby="heading123" data-parent="#controls"><div class="card-body">When cloudtrail is configured and sending alerts to cloudwatch logs these logs can be queried
                        to identify suspicious API activity. One such activity that should be monitored is security
                        group changes. Security groups are analogous to firewalls and therefore protect inbound and
                        outbound access to &amp; from AWS resources such as ec2 instances and RDS databases (amongst
                        other things. Therefore alerting on changes to security groups helps ensure that the resources
                        protected by them are not exposed.&nbsp;
                        <div>
                        &nbsp;
                        <br />
                        <b>Remediation:</b>
                        <br />
                        <ol>
                        <li>Create a metric filter that checks for security group changes: aws logs
                        put-metric-filter --log-group-name &lt;group&gt; --filter-name &lt;name&gt;
                        --metric- transformations &lt;value&gt; --filter-pattern '{ ($.eventName =
                        AuthorizeSecurityGroupIngress) || ($.eventName = AuthorizeSecurityGroupEgress) || ($.eventName =
                        RevokeSecurityGroupIngress) || ($.eventName = RevokeSecurityGroupEgress) || ($.eventName =
                        CreateSecurityGroup) || ($.eventName = DeleteSecurityGroup)}'&nbsp;</li>
                        <li>Create an SNS topic for notifications: aws sns create-topic --name &lt;topic_name&gt;</li>
                        <li>Create an SNS subscription to the topic created above: aws sns subscribe --topic-arn
                        &lt;topic_arn&gt; --protocol email --notification-endpoint &lt;email@example.com&gt;</li>
                        <li>Create an alarm based on the above steps: aws cloudwatch put-metric-alarm --alarm-name
                        &lt;value&gt; --metric-name &lt;metric_filter_name&gt; --statistic Sum --period
                        300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1
                        --namespace &lt;CloudTrailMetrics&gt; --alarm-actions &lt;topic_arn&gt;</li>
                        </ol>Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading130"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse130" aria-expanded="true" aria-controls="collapse130">Threat: Sensitive data is compromised through undetected network access <span>[UNAUTHORIZED-ACCESS-NETWORK-AWS]</span></button></h5></div><div id="collapse130" class="collapse" aria-labelledby="heading130" data-parent="#threats"><div class="card-body"><div>
                                Attackers gain undetected access to the network systems and the changes of the attackers
                                could not be audited or detected.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading129"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse129" aria-expanded="true" aria-controls="collapse129">Weakness: Changes in the network configuration cannot be detected <span>[AWS-Monitoring-4.12]</span></button></h5></div><div id="collapse129" class="collapse" aria-labelledby="heading129" data-parent="#weaknesses"><div class="card-body"><div>
                        The changes in the network configurations (NACLs, route and gateway tables) are not detected
                        because the monitorization and alerts of the network configuration are not configured to detect
                        these changes.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading126"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse126" aria-expanded="true" aria-controls="collapse126">Countermeasure: Create VPC NACL change alerts <span>[Hydras-AWS-Monitoring-4.11]</span></button></h5></div><div id="collapse126" class="collapse" aria-labelledby="heading126" data-parent="#controls"><div class="card-body">When cloudtrail is configured and sending alerts to cloudwatch logs these logs can be queried
                        to identify suspicious API activity. One such activity that should be monitored is VPC NACL
                        changes. Network Access Control Lists (NACLS) control inbound and outbound access to &amp;
                        from AWS subnets and work like packet filters to protect the network. Therefore alerting on
                        changes to NACLS helps ensure that the subnets protected by them are not exposed.&nbsp;
                        <div>
                        &nbsp;
                        <br />
                        <b>Remediation:</b>
                        <br />
                        <ol>
                        <li>Create a metric filter that checks for NACL changes: aws logs put-metric-filter
                        --log-group-name &lt;group&gt; --filter-name &lt;name&gt; --metric-
                        transformations &lt;value&gt; --filter-pattern '{ ($.eventName = CreateNetworkAcl) ||
                        ($.eventName = CreateNetworkAclEntry) || ($.eventName = DeleteNetworkAcl) || ($.eventName =
                        DeleteNetworkAclEntry) || ($.eventName = ReplaceNetworkAclEntry) || ($.eventName =
                        ReplaceNetworkAclAssociation) }'&nbsp;</li>
                        <li>Create an SNS topic for notifications: aws sns create-topic --name &lt;topic_name&gt;</li>
                        <li>Create an SNS subscription to the topic created above: aws sns subscribe --topic-arn
                        &lt;topic_arn&gt; --protocol email --notification-endpoint &lt;email@example.com&gt;</li>
                        <li>Create an alarm based on the above steps: aws cloudwatch put-metric-alarm --alarm-name
                        &lt;value&gt; --metric-name &lt;metric_filter_name&gt; --statistic Sum --period
                        300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1
                        --namespace &lt;CloudTrailMetrics&gt; --alarm-actions &lt;topic_arn&gt;</li>
                        </ol>Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading127"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse127" aria-expanded="true" aria-controls="collapse127">Countermeasure: Create VPC route table change alerts <span>[Hydras-AWS-Monitoring-4.12]</span></button></h5></div><div id="collapse127" class="collapse" aria-labelledby="heading127" data-parent="#controls"><div class="card-body">When cloudtrail is configured and sending alerts to cloudwatch logs these logs can be queried
                        to identify suspicious API activity. One such activity that should be monitored is VPC route
                        table changes. VPC route tables provide a means of routing network traffic between subnets and
                        via gateways and ensures traffic flows via the correct path. Therefore alerting on changes to
                        route tables ensuring traffic continues to flow as expected.&nbsp;
                        <div>
                        &nbsp;
                        <br />
                        <b>Remediation:<br /></b>
                        <ol>
                        <li>Create a metric filter that checks for VPC route table changes: aws logs
                        put-metric-filter --log-group-name &lt;group&gt; --filter-name &lt;name&gt;
                        --metric- transformations &lt;value&gt; --filter-pattern '{ ($.eventName = CreateRoute)
                        || ($.eventName = CreateRouteTable) || ($.eventName = ReplaceRoute) || ($.eventName =
                        ReplaceRouteTableAssociation) || ($.eventName = DeleteRouteTable) || ($.eventName = DeleteRoute)
                        || ($.eventName = DisassociateRouteTable) }'&nbsp;</li>
                        <li>Create an SNS topic for notifications: aws sns create-topic --name &lt;topic_name&gt;</li>
                        <li>Create an SNS subscription to the topic created above: aws sns subscribe --topic-arn
                        &lt;topic_arn&gt; --protocol email --notification-endpoint &lt;email@example.com&gt;</li>
                        <li>Create an alarm based on the above steps: aws cloudwatch put-metric-alarm --alarm-name
                        &lt;value&gt; --metric-name &lt;metric_filter_name&gt; --statistic Sum --period
                        300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1
                        --namespace &lt;CloudTrailMetrics&gt; --alarm-actions &lt;topic_arn&gt;</li>
                        </ol>Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading128"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse128" aria-expanded="true" aria-controls="collapse128">Countermeasure: Create VPC gateway change alerts <span>[Hydras-AWS-Monitoring-4.13]</span></button></h5></div><div id="collapse128" class="collapse" aria-labelledby="heading128" data-parent="#controls"><div class="card-body">When cloudtrail is configured and sending alerts to cloudwatch logs these logs can be queried
                        to identify suspicious API activity. One such activity that should be monitored is VPC gateway
                        changes. VPC gateways are used as a means of sending traffic outside of a VPC (ie to the
                        internet) and are vital in ensuring traffic flows to the correct destination. Therefore alerting
                        on changes to VPC gateways ensuring traffic continues to flow as expected via the correct
                        gateway.&nbsp;
                        <div>
                        &nbsp;
                        <br />
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Create a metric filter that checks for VPC gateway changes: aws logs put-metric-filter
                        --log-group-name &lt;group&gt; --filter-name &lt;name&gt; --metric-
                        transformations &lt;value&gt; --filter-pattern '{ ($.eventName = CreateCustomerGateway)
                        || ($.eventName = DeleteCustomerGateway) || ($.eventName = AttachInternetGateway) ||
                        ($.eventName = CreateInternetGateway) || ($.eventName = DeleteInternetGateway) || ($.eventName =
                        DetachInternetGateway) }'&nbsp;</li>
                        <li>Create an SNS topic for notifications: aws sns create-topic --name &lt;topic_name&gt;</li>
                        <li>Create an SNS subscription to the topic created above: aws sns subscribe --topic-arn
                        &lt;topic_arn&gt; --protocol email --notification-endpoint &lt;email@example.com&gt;</li>
                        <li>Create an alarm based on the above steps: aws cloudwatch put-metric-alarm --alarm-name
                        &lt;value&gt; --metric-name &lt;metric_filter_name&gt; --statistic Sum --period
                        300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1
                        --namespace &lt;CloudTrailMetrics&gt; --alarm-actions &lt;topic_arn&gt;</li>
                        </ol>
                        </div>
                        <div>
                        Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading142"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse142" aria-expanded="true" aria-controls="collapse142">Risk pattern: AWS Networking <span>[HYDRAS-AWS-NET]</span></button></h5></div><div id="collapse142" class="collapse" aria-labelledby="heading142" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading141"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse141" aria-expanded="true" aria-controls="collapse141">Use case: Virtual Private Cloud (VPC) Network <span>[VIRTUAL PRIVATE CLOUD (VPC) NETWORK]</span></button></h5></div><div id="collapse141" class="collapse" aria-labelledby="heading141" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading140"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse140" aria-expanded="true" aria-controls="collapse140">Threat: Attackers gain unauthorized connection to the resources <span>[UNAUTHORIZED-CONECTIONS-AWS]</span></button></h5></div><div id="collapse140" class="collapse" aria-labelledby="heading140" data-parent="#threats"><div class="card-body"><p>Attackers could gain an unauthorized connection to the resources through
                                misconfigured ports or security network configurations.</p>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading135"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse135" aria-expanded="true" aria-controls="collapse135">Weakness: Networks for Amazon resources are not properly segmentated. <span>[AWS-Network-5.2]</span></button></h5></div><div id="collapse135" class="collapse" aria-labelledby="heading135" data-parent="#weaknesses"><div class="card-body"><div>
                        Resources in the same VNet are compromised because when one of them is attacked and the
                        attackers gain access, they also gain access to all resources.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading133"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse133" aria-expanded="true" aria-controls="collapse133">Countermeasure: Launch EC2 instances into a VPC <span>[Hydras-AWS-EC2-6.1]</span></button></h5></div><div id="collapse133" class="collapse" aria-labelledby="heading133" data-parent="#controls"><div class="card-body">AWS virtual private cloud is the de-facto standard for networking AWS as it provides
                        additional security controls such as Security Groups, Network Access Control Lists (NACL's) and
                        routing. However the use of VPC is not compulsory and resources such as EC2 can be created
                        outside of VPC (usingEC2 Classic). It is the recommendation to make all resources a member of
                        a VPC if possible to benefit from the increased security controls they offer and reduce undue
                        network exposure.&nbsp;
                        <div>
                        &nbsp;
                        <br />
                        <b>Remediation:</b>
                        <br />
                        <ol>
                        <li>Login to the AWS Management Console.</li>
                        <li>Select EC2 from the services menu.</li>
                        <li>Select &quot;Launch Instance&quot;.</li>
                        <li>Complete the wizard until step 3 at which point ensure a VPC ID is selected for the
                        &quot;Network&quot; option, choose an appropriate &quot;Subnet&quot; and &quot;Auto-assign
                        Public IP&quot; option.&nbsp;&nbsp;</li>
                        <li>Complete the wizard to launch the instance.</li>
                        </ol>NB: If you want to migrate an already running instance you will need to convert the
                        image into an AMI and then launch a new instance using the AMI and placing in a VPC as per the
                        steps above
                        <br />
                        <p>Content provided by <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a></p>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading134"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse134" aria-expanded="true" aria-controls="collapse134">Countermeasure: Seperate VPC into zones  by function <span>[Hydras-AWS-Network-5.2]</span></button></h5></div><div id="collapse134" class="collapse" aria-labelledby="heading134" data-parent="#controls"><div class="card-body">AWS virtual private cloud is the de-facto standard for networking AWS as it provides
                        additional security controls such as Security Groups, Network Access Control Lists (NACL's) and
                        routing. It is recommended that resources be placed into VPC's according to use case (ie
                        dev/test/prod) and that appropriate security levels be set on these VPC's. Placing such
                        resources accordingly ensures that a resource of a higher security level is not exposed by the
                        security settings of a lower labeled VPC.&nbsp;
                        <div>
                        &nbsp;
                        <br />
                        <b>Remediation:</b>
                        <br />
                        <ol>
                        <li>Identify the resources that exist within an incorrect VPC.</li>
                        <li>Migrate or move them to the correct VPC.</li>
                        </ol>
                        </div>
                        <div>
                        Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        <br />
                        <br />
                        <br />
                        <br />
                        <br />
                        <br />
                        <br />
                        <br />
                        <br />
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading137"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse137" aria-expanded="true" aria-controls="collapse137">Weakness: Non-identify the resources <span>[AWS-Network-5.1]</span></button></h5></div><div id="collapse137" class="collapse" aria-labelledby="heading137" data-parent="#weaknesses"><div class="card-body">Resources are not registered in the safety net systems, and there are more unidentified
                        resources. This can be a problem because these unidentified resources can have unknown
                        weaknesses.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading136"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse136" aria-expanded="true" aria-controls="collapse136">Countermeasure: Use AWS VPC for networking <span>[Hydras-AWS-Network-5.1]</span></button></h5></div><div id="collapse136" class="collapse" aria-labelledby="heading136" data-parent="#controls"><div class="card-body">AWS virtual private cloud is the de-facto standard for networking AWS as it provides
                        additional security controls such as Security Groups, Network Access Control Lists (NACL's) and
                        routing.
                        <div>
                        <br />
                        </div>
                        <div>
                        However the use of VPC is not compulsory and resources such as EC2 can be created outside of VPC
                        (usingEC2 Classic). It is the recommendation to make all resources a member of a VPC if
                        possible to benefit from the increased security controls they offer and reduce undue network
                        exposure.&nbsp;
                        <div>
                        &nbsp;
                        <br />
                        <b>Remediation:<br /></b>Move or migrate the resources to a VPC.
                        </div>
                        <div>
                        <br /> Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>
                        </div>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading139"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse139" aria-expanded="true" aria-controls="collapse139">Weakness: The access to the routing tables are not restricted <span>[AWS-Network-5.8]</span></button></h5></div><div id="collapse139" class="collapse" aria-labelledby="heading139" data-parent="#weaknesses"><div class="card-body"><div>
                        Being highly selective in peering routing tables is a very effective way of minimizing the
                        impact of breach as resources outside of these routes are inaccessible to the peered VPC.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading138"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse138" aria-expanded="true" aria-controls="collapse138">Countermeasure: Ensure routing tables for VPC peering are "least access" <span>[Hydras-AWS-Network-5.8]</span></button></h5></div><div id="collapse138" class="collapse" aria-labelledby="heading138" data-parent="#controls"><div class="card-body"><div>
                        Once a VPC peering connection is established, routing tables must be updated to establish any
                        connections between the peered VPCs. These routes can be as specific as desired - even peering a
                        VPC to only a single host on the other side of the connection.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b> Rationale: </b>
                        </div>
                        <div>
                        Being highly selective in peering routing tables is a very effective way of minimizing the
                        impact of breach as resources outside of these routes are inaccessible to the peered VPC.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b> Remediation: </b>
                        </div>
                        <div>
                        Remove and add route table entries to ensure that the least number of subnets or hosts as is
                        required to accomplish the purpose for peering are routable.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        Via CLI:
                        </div>
                        <div>
                        <ul>
                        <li>For each &lt;route_table_id&gt; containing routes non compliant with your
                        routing policy (which grants more than desired &quot;&quot;least access&quot;&quot;),
                        delete the non compliant route:</li>
                        </ul>
                        </div>
                        <blockquote>
                        <blockquote>
                        <div>
                        aws ec2 delete-route --route-table-id &lt;route_table_id&gt; --destination-cidr-block
                        &lt;non_compliant_destination_CIDR&gt;
                        </div>
                        </blockquote>
                        </blockquote>
                        <div>
                        <br />
                        </div>
                        <div>
                        <ul>
                        <li>Create a new compliant route:</li>
                        </ul>
                        </div>
                        <blockquote>
                        <blockquote>
                        <div>
                        aws ec2 create-route --route-table-id &lt;route_table_id&gt; --destination-cidr-block
                        &lt;compliant_destination_CIDR&gt; --vpc-peering-connection-id &lt;peering_connection_id&gt;
                        </div>
                        </blockquote>
                        </blockquote>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading169"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse169" aria-expanded="true" aria-controls="collapse169">Risk pattern: AWS RDS <span>[HYDRAS-AWS-RDS]</span></button></h5></div><div id="collapse169" class="collapse" aria-labelledby="heading169" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading168"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse168" aria-expanded="true" aria-controls="collapse168">Use case: Amazon Web Services <span>[AMAZON WEB SERVICES]</span></button></h5></div><div id="collapse168" class="collapse" aria-labelledby="heading168" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading145"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse145" aria-expanded="true" aria-controls="collapse145">Threat: Attackers gain unauthorised access to data on EC2 instances <span>[NON-UPDATED-SYSTEMS-AWS]</span></button></h5></div><div id="collapse145" class="collapse" aria-labelledby="heading145" data-parent="#threats"><div class="card-body"><p>Attackers cloud gain access to data on EC2 instances through the weaknesses
                                in non-updated systems.</p>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading144"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse144" aria-expanded="true" aria-controls="collapse144">Weakness: The instances are not patched <span>[AWS-EC2-6.2]</span></button></h5></div><div id="collapse144" class="collapse" aria-labelledby="heading144" data-parent="#weaknesses"><div class="card-body">The instances are not patched with the last updates for the correspondent Operative System
                        (OS), and the instances have got weaknesses which are solved in the last updates.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading143"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse143" aria-expanded="true" aria-controls="collapse143">Countermeasure: Enable Auto Minor Version Upgrade on RDS <span>[aws-tier-3.6]</span></button></h5></div><div id="collapse143" class="collapse" aria-labelledby="heading143" data-parent="#controls"><div class="card-body"><p>Amazon Relational Database Service (RDS) is a managed relational database service which handles routine database tasks such as provisioning, patching, backup, recovery, failure detection, and repair.</p> 
<p>There are 6 database engines available for customers to run their database workloads on:</p> 
<ul> 
 <li>Amazon Aurora (MySQL Compatible)</li> 
 <li>MySQL</li> 
 <li>MariaDB</li> 
 <li>Oracle</li> 
 <li>Microsoft SQL Server</li> 
 <li>PostgreSQL</li> 
</ul> 
<p>If the database engine used by your application supports it, ensure that the RDS Instances have Auto Minor Version Upgrade Enabled.</p> 
<p><b>Remediation:</b></p> 
<p>Using the Amazon unified command line interface:</p> 
<p></p> 
<ul> 
 <li>Modify each DB instance with auto-minor-version-upgrade set to False, and enable auto-minor-version-upgrade:</li> 
</ul> 
<p></p> 
<blockquote> 
 <blockquote> 
  <p>aws rds modify-db-instance --db-instance-identifier &lt;your_db_instance&gt; --auto-minor-version-upgrade</p> 
 </blockquote> 
</blockquote></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading148"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse148" aria-expanded="true" aria-controls="collapse148">Threat: Attackers gain unauthorized access to the control of the environment <span>[AWS-LOSS-CONTROL-ENV]</span></button></h5></div><div id="collapse148" class="collapse" aria-labelledby="heading148" data-parent="#threats"><div class="card-body"><div>
                                Attackers could gain unauthorized access to the control of the environment, due of the
                                user accounts or role groups are not well defined and configured. Therefore, attackers
                                can make changes without the root approval.&nbsp;
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading147"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse147" aria-expanded="true" aria-controls="collapse147">Weakness: The credentials for the groups and roles are not configured <span>[AWS-IAM-2.7]</span></button></h5></div><div id="collapse147" class="collapse" aria-labelledby="heading147" data-parent="#weaknesses"><div class="card-body"><div>
                        The credentials for the groups and roles are not correctly configured and there are user
                        accounts with more privileges than the necessary.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading146"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse146" aria-expanded="true" aria-controls="collapse146">Countermeasure: Assign to IAM roles the permissions for RDS instances <span>[Hydras-AWS-RDS-02]</span></button></h5></div><div id="collapse146" class="collapse" aria-labelledby="heading146" data-parent="#controls"><div class="card-body">The following AWS managed policies, which you can attach to users in your account, are
                        specific to Amazon RDS:
                        <br />
                        <ul>
                        <li><b>AmazonRDSReadOnlyAccess:</b> Grants read-only access to all Amazon RDS
                        resources for the root AWS account.&nbsp;</li>
                        <li><b>AmazonRDSFullAccess:</b> Grants full access to all Amazon RDS resources
                        for the root AWS account.</li>
                        </ul>You can also create custom IAM policies that allow users to access the required
                        Amazon RDS API actions and resources. You can attach these custom policies to the IAM users or
                        groups that require those permissions.
                        <br />
                        <br />The permissions above shall be assigned to roles or groups:
                        <br />
                        <ul>
                        <li>The roles or groups only do calls to the API to get information, the
                        AmazonRDSReadOnlyAccess permission shall be assigned.&nbsp;</li>
                        <li>The roles or groups who are responsible of managing the RDS instances shall be
                        assigned the AmazonRDSFullAccess permission.</li>
                        </ul>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading155"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse155" aria-expanded="true" aria-controls="collapse155">Threat: Attackers gain unauthorized connection to the resources <span>[UNAUTHORIZED-CONECTIONS-AWS]</span></button></h5></div><div id="collapse155" class="collapse" aria-labelledby="heading155" data-parent="#threats"><div class="card-body"><p>Attackers could gain an unauthorized connection to the resources through
                                misconfigured ports or security network configurations.</p>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading150"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse150" aria-expanded="true" aria-controls="collapse150">Weakness: Database is publically accesible <span>[database-publically-accesible]</span></button></h5></div><div id="collapse150" class="collapse" aria-labelledby="heading150" data-parent="#weaknesses"><div class="card-body">Everyone can access the RDS database and obtain the data.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading149"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse149" aria-expanded="true" aria-controls="collapse149">Countermeasure: Do not allow the  RDS database to be publically accessible <span>[aws-tier-6.30]</span></button></h5></div><div id="collapse149" class="collapse" aria-labelledby="heading149" data-parent="#controls"><div class="card-body"><div>
  Amazon Relational Database Service (RDS) is a managed relational database service which handles routine database tasks such as provisioning, patching, backup, recovery, failure detection, and repair. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  There are 6 database engines available for customer to run their database workloads on: 
</div> 
<div> 
 <ul> 
  <li>Amazon Aurora (MySQL Compatible)</li> 
  <li>MySQL</li> 
  <li>MariaDB</li> 
  <li>Oracle</li> 
  <li>Microsoft SQL Server</li> 
  <li>PostgreSQL</li> 
 </ul>Customers can deploy RDS databases within a VPC through the configuration of: 
</div> 
<div> 
 <ul> 
  <li>Subnet Group for RDS, this group will be used for deployment of single or Multi-AZ RDS instances.</li> 
  <li>Network access through configuration of Security Groups for RDS</li> 
  <li>Access from outside the VPC hosting the DB instance by enabling/disabling a Public IP address</li> 
 </ul> 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style="">
   Using the Amazon unified command line interface: 
 </div> 
 <div style=""> 
  <ul> 
   <li>Modify each publicly accessible DB instance, and make it private:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws rds modify-db-instance --db-instance-identifier &lt;your_db_instance&gt; --no-publicly-accessible 
   </div> 
  </div> 
 </blockquote> 
</blockquote></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading152"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse152" aria-expanded="true" aria-controls="collapse152">Weakness: Networks for Amazon resources are not properly segmentated. <span>[AWS-Network-5.2]</span></button></h5></div><div id="collapse152" class="collapse" aria-labelledby="heading152" data-parent="#weaknesses"><div class="card-body"><div>
                        Resources in the same VNet are compromised because when one of them is attacked and the
                        attackers gain access, they also gain access to all resources.
                        </div>
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading151"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse151" aria-expanded="true" aria-controls="collapse151">Countermeasure: Enable Multi-AZ on RDS <span>[aws-tier-3.5]</span></button></h5></div><div id="collapse151" class="collapse" aria-labelledby="heading151" data-parent="#controls"><div class="card-body"><div>
  Amazon Relational Database Service (RDS) is a managed relational database service which handles routine database tasks such as provisioning, patching, backup, recovery, failure detection, and repair. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  There are 6 database engines available for customer to run their database workloads on: 
</div> 
<div> 
 <ul> 
  <li>Amazon Aurora (MySQL Compatible)</li> 
  <li>MySQL</li> 
  <li>MariaDB</li> 
  <li>Oracle</li> 
  <li>Microsoft SQL Server</li> 
  <li>PostgreSQL</li> 
 </ul> 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <div>
   Provides AWS managed high availability of the Database Tier across 2 availability zones within a region through asynchronous replication at the data layer. 
 </div> 
 <div> 
  <br /> 
 </div> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style="">
   Using the Amazon unified command line interface: 
 </div> 
 <div style=""> 
  <ul> 
   <li>Modify each no-multi-az DB instance, and make it Multi-AZ enabled:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws rds modify-db-instance --db-instance-identifier &lt;your_db_instance&gt; --multi-az 
   </div> 
  </div> 
 </blockquote> 
</blockquote></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading154"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse154" aria-expanded="true" aria-controls="collapse154">Weakness: Not access control on RDS databases <span>[no-access-control-onrds]</span></button></h5></div><div id="collapse154" class="collapse" aria-labelledby="heading154" data-parent="#weaknesses"><div class="card-body">There are no access control mechanisms on the RDS database resources and any user can gain access
                        to them and exfiltrate the data.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading153"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse153" aria-expanded="true" aria-controls="collapse153">Countermeasure: Configure RDS database to leverage the Data Tier Security Group <span>[aws-tier-6.34]</span></button></h5></div><div id="collapse153" class="collapse" aria-labelledby="heading153" data-parent="#controls"><div class="card-body"><div>
  Amazon Relational Database Service (RDS) is a managed relational database service which handles routine database tasks such as provisioning, patching, backup, recovery, failure detection, and repair. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  There are 6 database engines available for customer to run their database workloads on: 
</div> 
<div> 
 <ul> 
  <li>Amazon Aurora (MySQL Compatible)</li> 
  <li>MySQL</li> 
  <li>MariaDB</li> 
  <li>Oracle</li> 
  <li>Microsoft SQL Server</li> 
  <li>PostgreSQL</li> 
 </ul> 
</div> 
<div>
  Customers can deploy RDS databases within a VPC through the configuration of: 
</div> 
<div> 
 <ul> 
  <li>Subnet Group for RDS, this group will be used for deployment of single or Multi-AZ RDS instances.</li> 
  <li>Network access through configuration of Security Groups for RDS</li> 
  <li>Access from outside the VPC hosting the DB instance by enabling/disabling a Public IP address</li> 
  <li>Network access to the managed Data-Tier must be tightly controlled using Security Groups for RDS and non local accessibility of the DB instance.</li> 
 </ul> 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation: </b> 
</div> 
<div> 
 <div style="">
   Using the Amazon unified command line interface: 
 </div> 
 <div style=""> 
  <ul> 
   <li>Modify each non-compliant DB instance, and configure it to use the Data Tier Security Group:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws rds modify-db-instance --db-instance-identifier &lt;your_db_instance&gt; --vpc-security-group-ids &lt;data_tier_security_group&gt; 
   </div> 
  </div> 
 </blockquote> 
</blockquote></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading159"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse159" aria-expanded="true" aria-controls="collapse159">Threat: Attackers gain undetected access to the security system configurations <span>[UNAUTHORIZED-ACCESS-SECURITY-SYSTEMS-AWS]</span></button></h5></div><div id="collapse159" class="collapse" aria-labelledby="heading159" data-parent="#threats"><div class="card-body"><div>
                                Attackers could gain undetected access to the security configurations and the changes of
                                the attackers could not be detected and audited.
                                </div>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading158"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse158" aria-expanded="true" aria-controls="collapse158">Weakness: No notification when an incident occurs <span>[no-notification-incident]</span></button></h5></div><div id="collapse158" class="collapse" aria-labelledby="heading158" data-parent="#weaknesses"><div class="card-body">There are no notifications when a security incident occurs. Therefore, we do not know when an
                        attacker gains access to our systems and/or security systems
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading156"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse156" aria-expanded="true" aria-controls="collapse156">Countermeasure: Enable Event subscriptions for Instance level events on RDS <span>[aws-tier-4.3]</span></button></h5></div><div id="collapse156" class="collapse" aria-labelledby="heading156" data-parent="#controls"><div class="card-body"><div>
  AWS Relational Database Services offers customers a managed database engine solution for hosting customer created databases which can allow for a reduction in operational burden on customers. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  RDS event subscriptions provide notification of selected event changes at DataBase engine level such as: 
</div> 
<div> 
 <ul> 
  <li>Deletion</li> 
  <li>Failure</li> 
  <li>Failover</li> 
  <li>Low Storage</li> 
  <li>Maintenance</li> 
 </ul> 
</div> 
<div>
  Event subscriptions are designed to provide incident notification of events which may affect the availability of a RDS database instance. 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style="">
   Using the Amazon unified CLI: 
 </div> 
 <div style=""> 
  <ul> 
   <li>Create a new event subscription for DB instance level events:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws rds create-event-subscription --subscription-name &lt;rds_event_subscription&gt; --sns-topic-arn sns_topic_arn --source-type &lt;db-instance&gt; --event-categories &lt;rds_events&gt; --source-ids &lt;events_source_ids&gt; --enabled 
   </div> 
  </div> 
 </blockquote> 
</blockquote></div></div></div><div class="card border-success"><div class="card-header " id="heading157"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse157" aria-expanded="true" aria-controls="collapse157">Countermeasure: Enable event subscriptions for DataBase security on RDS <span>[aws-tier-4.4]</span></button></h5></div><div id="collapse157" class="collapse" aria-labelledby="heading157" data-parent="#controls"><div class="card-body"><p>AWS Relational Database Services offers customers a managed database engine solution
                        for hosting customer created databases which can allow for a reduction in operational burden on
                        customers.</p>
                        <p>RDS event subscriptions provide notification of selected event changes at a DB security
                        group level.</p>
                        <p>Event subscriptions are designed to provide incident notification of events which may
                        affect the network availability of the RDS instance.</p>
                        <p><b>Remediation:</b></p>
                        <p>Using the Amazon unified CLI:</p>
                        <p></p>
                        <ul>
                        <li>Create a new event subscription for DB Security Group events:</li>
                        </ul>
                        <p></p>
                        <p></p>
                        <blockquote>
                        <blockquote>
                        <p>aws rds create-event-subscription --subscription-name rds_event_subscription
                        --sns-topic-arn
                        sns_topic_arn
                        --source-type db-security-group --event-categories rds_events
                        --source-ids events_source_ids --enabled</p>
                        </blockquote>
                        </blockquote>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading162"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse162" aria-expanded="true" aria-controls="collapse162">Threat: Data is intentionally or accidentally deleted <span>[DATA-DELETED-EASY-AWS]</span></button></h5></div><div id="collapse162" class="collapse" aria-labelledby="heading162" data-parent="#threats"><div class="card-body"><p>Data can be deleted intentionally or accidentally, and the data cannot be
                                recovered as there are no recovery systems and the data is easy
                                to delete it.</p>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading161"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse161" aria-expanded="true" aria-controls="collapse161">Weakness: Not backup retention policies <span>[NOT_BACKUP_POLICIES]</span></button></h5></div><div id="collapse161" class="collapse" aria-labelledby="heading161" data-parent="#weaknesses"><div class="card-body">There are no data backup retention policies.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading160"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse160" aria-expanded="true" aria-controls="collapse160">Countermeasure: Set Backup retention policy on RDS <span>[aws-tier-3.7]</span></button></h5></div><div id="collapse160" class="collapse" aria-labelledby="heading160" data-parent="#controls"><div class="card-body"><div>
  Amazon Relational Database Service (RDS) is a managed relational database service which handles routine database tasks such as provisioning, patching, backup, recovery, failure detection, and repair. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  There are 6 database engines available for customer to run their database workloads on: 
</div> 
<div> 
 <ul> 
  <li>Amazon Aurora (MySQL Compatible)</li> 
  <li>MySQL</li> 
  <li>MariaDB</li> 
  <li>Oracle</li> 
  <li>Microsoft SQL Server</li> 
  <li>PostgreSQL</li> 
 </ul> 
</div> 
<div> 
 <div>
   Provides a managed backup function of the RDS Database, it is possible to define the backup window and retention period of the backup. Each customer should have a retention policy set for the type of data being stored. It is recommended to set this to at least 7. 
 </div> 
 <div> 
  <br /> 
 </div> 
 <div>
   Possible values are from 0 to 35 days. 
 </div> 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style="">
   Using the Amazon unified command line interface: 
 </div> 
 <div style=""> 
  <ul> 
   <li>Modify each DB instance with a Backup Retention Period of 0, and set a desired Backup Retention Period in days (recommended value = 7):</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws rds modify-db-instance --db-instance-identifier &lt;your_db_instance&gt; --backup-retention-period &lt;backup_retention_period&gt; 
   </div> 
  </div> 
 </blockquote> 
</blockquote> 
<div> 
 <br /> 
</div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading167"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse167" aria-expanded="true" aria-controls="collapse167">Threat: Sensitive data is compromised through unauthorized access to data <span>[ACCESS-TO-DATA-AWS]</span></button></h5></div><div id="collapse167" class="collapse" aria-labelledby="heading167" data-parent="#threats"><div class="card-body">Attackers can gain access to sensitive data when the data is in transit in clear text,
                                or when the data is stored without encryption.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading164"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse164" aria-expanded="true" aria-controls="collapse164">Weakness: Sensitive data is accessible <span>[AWS-S3-7.4]</span></button></h5></div><div id="collapse164" class="collapse" aria-labelledby="heading164" data-parent="#weaknesses"><div class="card-body">Sensitive data is not encrypted and is exposed.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading163"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse163" aria-expanded="true" aria-controls="collapse163">Countermeasure: Enable encryption at rest for Databases running on RDS <span>[aws-tier-1.4]</span></button></h5></div><div id="collapse163" class="collapse" aria-labelledby="heading163" data-parent="#controls"><div class="card-body"><div>
                        Amazon RDS instances and snapshots can be encrypted at rest by enabling the encryption option on
                        the Amazon RDS DB instance. Data that is encrypted at rest includes the underlying storage for a
                        DB instance, its automated backups, read replicas, and snapshots. Encryption at rest should
                        be enabled.
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        Using the Amazon unified CLI:
                        </div>
                        <div>
                        <ul>
                        <li>Perform a snapshot of the DB instance:</li>
                        </ul>
                        </div>
                        <blockquote>
                        <blockquote>
                        <div>
                        aws rds create-db-snapshot --db-snapshot-identifier db_snapshot
                        --db-instance-identifier your_db_instance
                        </div>
                        </blockquote>
                        </blockquote>
                        <div>
                        <ul>
                        <li>Confirm created snapshot is available (once snapshot process has completed):</li>
                        </ul>
                        </div>
                        <blockquote>
                        <blockquote>
                        <div>
                        aws rds describe-db-snapshots --query
                        'DBSnapshots[*].{DBSnapshotIdentifier:DBSnapshotIdentifier,
                        DBInstanceIdentifier:DBInstanceIdentifier, Snapshotstatus:Status}'
                        </div>
                        </blockquote>
                        </blockquote>
                        <div>
                        <ul>
                        <li>List all KMS Customer Managed Keys:</li>
                        </ul>
                        </div>
                        <blockquote>
                        <blockquote>
                        <div>
                        aws kms list-aliases
                        </div>
                        </blockquote>
                        </blockquote>
                        <div>
                        <ul>
                        <li>Copy to source RDS snapshot (from previous step) to a destination snapshot which will
                        be encrypted:</li>
                        </ul>
                        </div>
                        <blockquote>
                        <blockquote>
                        aws rds copy-db-snapshot --source-db-snapshot-identifier db_snapshot&nbsp;
                        --target-db-snapshot-identifier encrypted_db_snapshot
                        --kms-key-id data_tier_kms_key
                        </blockquote>
                        </blockquote>
                        <ul>
                        <li>Restore a snapshot to the target DB instance(from previous step) with the same values as
                        original db instance with additional encrypted storage values:</li>
                        </ul>
                        <blockquote>
                        <blockquote>
                        <div>
                        aws rds restore-db-instance-from-db-snapshot --db-instance-identifier your_db_instance
                        --db-snapshot-identifier encrypted_db_snapshot
                        </div>
                        </blockquote>
                        </blockquote>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading166"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse166" aria-expanded="true" aria-controls="collapse166">Weakness: Sensitive data is exposed in transit <span>[AWS-S3-7.3]</span></button></h5></div><div id="collapse166" class="collapse" aria-labelledby="heading166" data-parent="#weaknesses"><div class="card-body">Sensitive data is not encrypted in transit with HTTPS or SSL, and this data is accessible
                        whilst traversing the network.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading165"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse165" aria-expanded="true" aria-controls="collapse165">Countermeasure: Use SSL to Encrypt the connection to a DB Instance <span>[Hydras-AWS-RDS-01]</span></button></h5></div><div id="collapse165" class="collapse" aria-labelledby="heading165" data-parent="#controls"><div class="card-body">Use SSL from your application to encrypt a connection to a DB instance running MySQL, MariaDB,
                        Amazon Aurora, SQL Server, Oracle, or PostgreSQL. Each DB engine has its own process for
                        implementing SSL. To learn how to implement SSL for your particular DB instance, please see link
                        provided in &quot;References&quot; section.
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading181"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse181" aria-expanded="true" aria-controls="collapse181">Risk pattern: AWS S3 <span>[HYDRAS-AWS-S3]</span></button></h5></div><div id="collapse181" class="collapse" aria-labelledby="heading181" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading180"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse180" aria-expanded="true" aria-controls="collapse180">Use case: Amazon Web Services <span>[AMAZON-WEB-SERVICES]</span></button></h5></div><div id="collapse180" class="collapse" aria-labelledby="heading180" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading174"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse174" aria-expanded="true" aria-controls="collapse174">Threat: Data is intentionally or accidentally deleted <span>[DATA-DELETED-EASY-AWS]</span></button></h5></div><div id="collapse174" class="collapse" aria-labelledby="heading174" data-parent="#threats"><div class="card-body"><p>Data can be deleted intentionally or accidentally, and the data cannot be
                                recovered as there are no recovery systems and the data is easy
                                to delete it.</p>
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading171"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse171" aria-expanded="true" aria-controls="collapse171">Weakness: Backup is not created <span>[AWS-S3-7.1]</span></button></h5></div><div id="collapse171" class="collapse" aria-labelledby="heading171" data-parent="#weaknesses"><div class="card-body">The sensitive data cannot be recovered because there is not any method to do a backup or to do
                        versions of the data.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading170"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse170" aria-expanded="true" aria-controls="collapse170">Countermeasure: Configure S3 bucket versioning for sensitive data <span>[Hydras-AWS-S3-7.1]</span></button></h5></div><div id="collapse170" class="collapse" aria-labelledby="heading170" data-parent="#controls"><div class="card-body">Amazon Simple Storage Service is storage for the Internet. It is designed to make web-scale
                        computing easier for developers.
                        <br />
                        <br />Amazon S3 has a simple web services interface that you can use to store and retrieve
                        any amount of data, at any time, from anywhere on the web. It gives any developer access to the
                        same highly scalable, reliable, fast, inexpensive data storage infrastructure that Amazon uses
                        to run its own global network of web sites.
                        <br />
                        <br />To add an extra layer of security to data stored within S3 it is possible to enable
                        object versioning. Object versioning enables the recovery of objects from accidental overwrite
                        or accidental deletion. If an object is deleted, instead of being removed, S3 write a delete
                        marker which becomes the current version that means previous versions can always be recovered.
                        It is recommended that versioning be enabled for buckets storing sensitive data.
                        <div>
                        <br />
                        <b>Remediation:<br /></b>
                        </div>
                        <blockquote>
                        <div>
                        aws s3api put-bucket-versioning --bucket my-bucket --versioning-configuration Status=Enabled
                        </div>
                        </blockquote>
                        <div>
                        <p>Content provided by <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a></p>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading173"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse173" aria-expanded="true" aria-controls="collapse173">Weakness: Data is easily removed <span>[AWS-S3-7.2]</span></button></h5></div><div id="collapse173" class="collapse" aria-labelledby="heading173" data-parent="#weaknesses"><div class="card-body">Someone without credentials can remove sensitive data, the remove function is not protected
                        for an MFA.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading172"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse172" aria-expanded="true" aria-controls="collapse172">Countermeasure: Use S3 MFA to delete sensitive information <span>[Hydras-AWS-S3-7.2]</span></button></h5></div><div id="collapse172" class="collapse" aria-labelledby="heading172" data-parent="#controls"><div class="card-body">Amazon Simple Storage Service is storage for the Internet. It is designed to make web-scale
                        computing easier for developers.
                        <br />
                        <br />Amazon S3 has a simple web services interface that you can use to store and retrieve
                        any amount of data, at any time, from anywhere on the web. It gives any developer access to the
                        same highly scalable, reliable, fast, inexpensive data storage infrastructure that Amazon uses
                        to run its own global network of web sites.
                        <br />
                        <br />To add an extra layer of security to data stored within S3 the account owner (root)
                        can enable MFA Delete which means that buckets and the objects within them can only be deleted
                        with the use of Multi-factor authentication device. It is recommended to enable MFA Delete on
                        any buckets containing sensitive data to protect against accidental deletion
                        <br />Remediation
                        <br />1. aws s3api put-bucket-versioning --bucket my-bucket --versioning-configuration
                        Status=Enabled,MFADelete=Enabled
                        <br />
                        <p>Content provided by <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a></p>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading179"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse179" aria-expanded="true" aria-controls="collapse179">Threat: Sensitive data is compromised through unauthorized access to data <span>[ACCESS-TO-DATA-AWS]</span></button></h5></div><div id="collapse179" class="collapse" aria-labelledby="heading179" data-parent="#threats"><div class="card-body">Attackers can gain access to sensitive data when the data is in transit in clear text,
                                or when the data is stored without encryption.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading176"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse176" aria-expanded="true" aria-controls="collapse176">Weakness: Sensitive data is accessible <span>[AWS-S3-7.4]</span></button></h5></div><div id="collapse176" class="collapse" aria-labelledby="heading176" data-parent="#weaknesses"><div class="card-body">Sensitive data is not encrypted and is exposed.<div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading175"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse175" aria-expanded="true" aria-controls="collapse175">Countermeasure: Encrypt sensitive data at rest with KMS <span>[Hydras-AWS-S3-7.4]</span></button></h5></div><div id="collapse175" class="collapse" aria-labelledby="heading175" data-parent="#controls"><div class="card-body">Amazon Simple Storage Service is storage for the Internet. It is designed to make web-scale
                        computing easier for developers.
                        <br />
                        <br />Amazon S3 has a simple web services interface that you can use to store and retrieve
                        any amount of data, at any time, from anywhere on the web. It gives any developer access to the
                        same highly scalable, reliable, fast, inexpensive data storage infrastructure that Amazon uses
                        to run its own global network of web sites.
                        <br />
                        <br />To ensure that sensitive data is encrypted at rest you can use AWS KMS–managed
                        keys (SSE-KMS). This provides several advantages:&nbsp;
                        <ul>
                        <li>You can create and manage the CMK encryption keys yourself.&nbsp;</li>
                        <li>You can use a single CMK to encrypt and decrypt log files for multiple accounts across
                        all regions.&nbsp;</li>
                        <li>You have control over who can use your key for encrypting and decrypting CloudTrail
                        log files. You can assign permissions for the key to the users in your organization according to
                        your requirements.&nbsp;</li>
                        <li>You have enhanced security. With this feature, in order to read log files, you now
                        need to meet two conditions: 1) you must have S3 read permission on the bucket, and 2) you must
                        be granted decrypt permission by the CMK policy.&nbsp;</li>
                        </ul>
                        <br />It is recommended to encrypt all sensitive data with SSE-KMS to avoid undue
                        disclosure of information and provide an extra layer of security.
                        <div>
                        <br />
                        <b>Remediation:</b>
                        <br />The following example shows how to upload data using AWS KMS Encryption:
                        <br />
                        </div>
                        <blockquote>
                        <div>
                        aws s3api put-object --bucket &lt;my_bucket&gt; --server-side-encryption aws:kms
                        --ssekms-key-id &lt;kms_key_id&gt; --key &lt;object_to_upload&gt;
                        </div>
                        </blockquote>
                        <div>
                        <p>Content provided by <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a></p>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading178"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse178" aria-expanded="true" aria-controls="collapse178">Weakness: Sensitive data is exposed in transit <span>[AWS-S3-7.3]</span></button></h5></div><div id="collapse178" class="collapse" aria-labelledby="heading178" data-parent="#weaknesses"><div class="card-body">Sensitive data is not encrypted in transit with HTTPS or SSL, and this data is accessible
                        whilst traversing the network.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading177"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse177" aria-expanded="true" aria-controls="collapse177">Countermeasure: Enforce HTTPS for sensitive information <span>[Hydras-AWS-S3-7.3]</span></button></h5></div><div id="collapse177" class="collapse" aria-labelledby="heading177" data-parent="#controls"><div class="card-body">Amazon Simple Storage Service is storage for the Internet. It is designed to make web-scale
                        computing easier for developers.
                        <br />
                        <br />Amazon S3 has a simple web services interface that you can use to store and retrieve
                        any amount of data, at any time, from anywhere on the web. It gives any developer access to the
                        same highly scalable, reliable, fast, inexpensive data storage infrastructure that Amazon uses
                        to run its own global network of web sites.
                        <br />
                        <br />To ensure that data is only accessible via HTTPS (as opposed to both HTTP and HTTPS)
                        it is possible to add a condition to the S3 bucket policy. It is recommended to enable this for
                        any bucket containing sensitive data to ensure that data is encrypted in transit.
                        <div>
                        <br />
                        <b>Remediation:<br /></b>The following is an example of how to create an S3
                        bucket policy that enforces HTTPS/SSL only
                        <br />
                        <ul>
                        <li>Sign in to the AWS Management Console (with S3 update privileges)&nbsp;</li>
                        <li>Go to the S3 Service on the AWS Console&nbsp;</li>
                        <li>Select a bucket under &quot;All buckets&quot;&nbsp;</li>
                        <li>Click the properties tab&nbsp;</li>
                        <li>Under the permissions select &quot;Add a bucket policy&quot;&nbsp;</li>
                        <li>Add the following policy to ensure all objects are accessed via https only&nbsp;</li>
                        </ul>
                        </div>
                        <blockquote>
                        <blockquote>
                        <div>
                        <i> {</i>
                        </div>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        <i> &quot;Statement&quot;:[</i>
                        <i>{</i>
                        </div>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        <i> &quot;Action&quot;: &quot;s3:*&quot;,</i>
                        </div>
                        <div>
                        <i>&quot;Effect&quot;:&quot;Allow&quot;,</i>
                        </div>
                        <div>
                        <i>&quot;Principal&quot;: &quot;*&quot;,</i>
                        </div>
                        <div>
                        <i>&quot;Resource&quot;:&quot;arn:aws:s3:::bucketname/*&quot;,</i>
                        </div>
                        <div>
                        <i>&quot;Condition&quot;:{</i>
                        </div>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        <i>&quot;Bool&quot;:</i>
                        </div>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        <i>{&nbsp;</i>
                        </div>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        <i>&quot;aws:SecureTransport&quot;: true&nbsp;</i>
                        </div>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        <i>}</i>
                        </div>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <i>}</i>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        <i> }</i>
                        <i>]</i>
                        </div>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        <i>} </i>
                        </div>
                        </blockquote>
                        </blockquote>
                        <div>
                        <ul>
                        <li>Click &quot;&quot;Save&quot;&nbsp;</li>
                        </ul>
                        <p>Content provided by <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a></p>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading197"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse197" aria-expanded="true" aria-controls="collapse197">Risk pattern: AWS SNS <span>[HYDRAS-AWS-SNS]</span></button></h5></div><div id="collapse197" class="collapse" aria-labelledby="heading197" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading188"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse188" aria-expanded="true" aria-controls="collapse188">Use case: Cloudwatch Metric Alerts <span>[CLOUDWATCH-METRIC-ALERTS]</span></button></h5></div><div id="collapse188" class="collapse" aria-labelledby="heading188" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading187"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse187" aria-expanded="true" aria-controls="collapse187">Threat: Sensitive data is compromised through notifications <span>[AWS-LOST-CONTROL-NOTIFICATION]</span></button></h5></div><div id="collapse187" class="collapse" aria-labelledby="heading187" data-parent="#threats"><div class="card-body">Attackers can gain access to the resources sensitive data if the system notifications
                                and alerts are not configured properly and the notifications are not received by the
                                appropriate personnel.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading184"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse184" aria-expanded="true" aria-controls="collapse184">Weakness: Log the actions to send out notifications <span>[log-actions-sending-out-notifications]</span></button></h5></div><div id="collapse184" class="collapse" aria-labelledby="heading184" data-parent="#weaknesses"><div class="card-body">The sensitive data is not encrypted in transit with HTTPS or SSL, and the data is accessible
                        in the canal.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading182"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse182" aria-expanded="true" aria-controls="collapse182">Countermeasure: Create a SNS topic for sending out notifications from Cloudtwatch Alarms <span>[aws-tier-4.1]</span></button></h5></div><div id="collapse182" class="collapse" aria-labelledby="heading182" data-parent="#controls"><div class="card-body"><div>
  For the Cloudwatch alarms and Auto-Scaling Groups to be able to send out notifications, a SNS topic should be created. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Amazon Simple Notification Service (Amazon SNS) is a web service that coordinates and manages the delivery or sending of messages to subscribing endpoints or clients. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  When using Amazon SNS, you (as the owner) create a topic and control access to it by defining policies that determine which publishers and subscribers can communicate with the topic. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Cloudwatch alarms and certain actions inside Auto-Scaling Groups needs to be sent out to administrators, in order to be acted upon. 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style="">
   Using the Amazon unified CLI: 
 </div> 
 <div style=""> 
  <ul> 
   <li>Create a new topic, and note the topic-arn value:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws sns create-topic --name &lt;sns_topic_name&gt; 
   </div> 
  </div> 
 </blockquote> 
</blockquote> 
<div> 
 <div style=""> 
  <ul> 
   <li>Create a subscription to the new topic:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws sns subscribe --topic-arn &lt;sns_topic_arn&gt; --protocol &lt;protocol_for_sns&gt; --notification-endpoint &lt;sns_subscription_endpoints&gt; 
   </div> 
  </div> 
 </blockquote> 
</blockquote></div></div></div><div class="card border-success"><div class="card-header " id="heading183"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse183" aria-expanded="true" aria-controls="collapse183">Countermeasure: Create a SNS topic for sending out notifications from RDS events <span>[aws-tier-4.2]</span></button></h5></div><div id="collapse183" class="collapse" aria-labelledby="heading183" data-parent="#controls"><div class="card-body"><div>
  For the RDS event subscriptions to be able to send out notifications, a SNS topic should be created. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  Amazon Simple Notification Service (Amazon SNS) is a web service that coordinates and manages the delivery or sending of messages to subscribing endpoints or clients. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  When using Amazon SNS, you (as the owner) create a topic and control access to it by defining policies that determine which publishers and subscribers can communicate with the topic. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  RDS events generated through defined RDS event subscriptions needs to be sent out to administrators, in order to be acted upon. 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style="">
   Using the Amazon unified CLI: 
 </div> 
 <div style=""> 
  <ul> 
   <li>Create a new topic, and note the topic-arn value:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws sns create-topic --name &lt;sns_topic_name&gt; 
   </div> 
  </div> 
 </blockquote> 
</blockquote> 
<div> 
 <div style=""> 
  <ul> 
   <li>Create a subscription to the new topic:</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws sns subscribe --topic-arn &lt;sns_topic_arn&gt; --protocol &lt;protocol_for_sns&gt; --notification-endpoint &lt;sns_subscription_endpoints&gt; 
   </div> 
  </div> 
 </blockquote> 
</blockquote> 
<div> 
 <br /> 
</div></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading186"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse186" aria-expanded="true" aria-controls="collapse186">Weakness: Notifications are not centralized <span>[AWS-SNS-01]</span></button></h5></div><div id="collapse186" class="collapse" aria-labelledby="heading186" data-parent="#weaknesses"><div class="card-body">The notifications are not centralized; therefore, the control of these notifications and who
                        receives them is not easily managed.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading185"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse185" aria-expanded="true" aria-controls="collapse185">Countermeasure: Use Amazon SNS to centralize notifications <span>[Hydras-AWS-SNS-01]</span></button></h5></div><div id="collapse185" class="collapse" aria-labelledby="heading185" data-parent="#controls"><div class="card-body">Configure all alerts from the Amazon environment with the Amazon Simple Notification Service
                        (SNS) to have centralized notifications and control over who receives these notifications, in
                        the same place.
                        <br />
                        <br />
                        <b> <b>Remediation:</b> </b>
                        <br />
                        <ol>
                        <li>Go to CoudWatch alarms.</li>
                        <li>Edit each alarm and change the notification configuration to the SNS service.</li>
                        </ol>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading196"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse196" aria-expanded="true" aria-controls="collapse196">Use case: Virtual Private Cloud (VPC) Network <span>[VIRTUAL-PRIVATE-CLOUD-VPC-NETWORK]</span></button></h5></div><div id="collapse196" class="collapse" aria-labelledby="heading196" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading195"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse195" aria-expanded="true" aria-controls="collapse195">Threat: Sensitive data is compromised through unauthorized access to data <span>[ACCESS-TO-DATA-AWS]</span></button></h5></div><div id="collapse195" class="collapse" aria-labelledby="heading195" data-parent="#threats"><div class="card-body">Attackers can gain access to sensitive data when the data is in transit in clear text,
                                or when the data is stored without encryption.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading190"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse190" aria-expanded="true" aria-controls="collapse190">Weakness: No access control to publish on SNS topics <span>[no-access-control-publish-sns-topics]</span></button></h5></div><div id="collapse190" class="collapse" aria-labelledby="heading190" data-parent="#weaknesses"><div class="card-body">The notifications are not centralized; therefore, the control of these notifications and who
                        receives them is not easily managed.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading189"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse189" aria-expanded="true" aria-controls="collapse189">Countermeasure: Do not permit 'Everyone' to publish SNS topics <span>[aws-tier-2.9]</span></button></h5></div><div id="collapse189" class="collapse" aria-labelledby="heading189" data-parent="#controls"><div class="card-body"><div>
  Amazon Simple Notification Service (Amazon SNS) is a web service that coordinates and manages the delivery or sending of messages to subscribing endpoints or clients. In Amazon SNS, there are two types of clients - publishers and subscribers - also referred to as producers and consumers. Publishers communicate asynchronously with subscribers by producing and sending a message to a topic, which is a logical access point and communication channel. Subscribers (i.e., web servers, email addresses, Amazon SQS queues, AWS Lambda functions) consume or receive the message or notification over one of the supported protocols (i.e., Amazon SQS, HTTP/S, email, SMS, Lambda) when they are subscribed to the topic. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  The entities who can publish messages to a SNS topic can be controlled by modifying the topic policy, and they can be: 
</div> 
<div> 
 <ul> 
  <li>The topic owner</li> 
  <li>Everyone</li> 
  <li>Specific AWS users or resources</li> 
 </ul>From the above message publisher options you should make sure that &quot;Everyone&quot; is not used with any SNS topic in the AWS account. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  If an SNS topic policy allows &quot;Everyone&quot; to publish messages to a specific topic, this could pose a security risk as any unauthenticated entity could send malicious messages to all the topic subscribers. 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style="">
   Edit your existing policy by deleting the above snippet or replacing &quot;Principal&quot;:{&quot;AWS&quot; : &quot;*&quot;} with &quot;Principal&quot;:{&quot;AWS&quot; : &quot;&quot;}, and save it locally as a .json file named policy.json. 
 </div> 
 <div style=""> 
  <br /> 
 </div> 
 <div style="">
   Using the Amazon unified command line interface: 
 </div> 
 <div style=""> 
  <ul> 
   <li>Set the new policy to the SNS topic</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws sns set-topic-attributes --topic-arn sns_topic_arn --attribute-name Policy --attribute-value file://policy.json 
   </div> 
  </div> 
 </blockquote> 
</blockquote> 
<div> 
 <b><br /></b> 
</div></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading192"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse192" aria-expanded="true" aria-controls="collapse192">Weakness: No access control to subscribe on SNS topics <span>[no-access-control-subscribe-sns-topics]</span></button></h5></div><div id="collapse192" class="collapse" aria-labelledby="heading192" data-parent="#weaknesses"><div class="card-body">The notifications are not centralized; therefore, the control of these notifications and who
                        receives them is not easily managed.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading191"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse191" aria-expanded="true" aria-controls="collapse191">Countermeasure: Do not permit 'Everyone' to subscribe on SNS topics <span>[aws-tier-2.10]</span></button></h5></div><div id="collapse191" class="collapse" aria-labelledby="heading191" data-parent="#controls"><div class="card-body"><div>
  Amazon Simple Notification Service (Amazon SNS) is a web service that coordinates and manages the delivery or sending of messages to subscribing endpoints or clients. In Amazon SNS, there are two types of clients - publishers and subscribers - also referred to as producers and consumers. Publishers communicate asynchronously with subscribers by producing and sending a message to a topic, which is a logical access point and communication channel. Subscribers (i.e., web servers, email addresses, Amazon SQS queues, AWS Lambda functions) consume or receive the message or notification over one of the supported protocols (i.e., Amazon SQS, HTTP/S, email, SMS, Lambda) when they are subscribed to the topic. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  The entities who can subscribe to a SNS topic can be controlled by modifying the topic policy, and they can be: 
</div> 
<div> 
 <ul> 
  <li>The topic owner</li> 
  <li>Everyone</li> 
  <li>Specific AWS users or resources</li> 
  <li>Users whose endpoint URL,protocol, email address, or ARN from a Subscribe request match a specified value</li> 
 </ul> 
</div> 
<div>
  From the above topic subscribers, you should make sure that &quot;Everyone&quot; is not used with any SNS topic in the AWS account. 
</div> 
<div> 
 <br /> 
</div> 
<div>
  If a SNS topic policy allows &quot;Everyone&quot; to subscribe to a specific topic, this could pose a security risk as any unauthenticated entity could subscribe and receive messages from the topic publishers, messages that should be destined only to specific, known subscribers. 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b> 
</div> 
<div> 
 <div style="">
   Edit your existing policy by deleting the above snippet or replacing &quot;Principal&quot;:{&quot;AWS&quot; : &quot;*&quot;} with &quot;Principal&quot;:{&quot;AWS&quot; : &quot;&quot;}, and save it locally as a .json file named policy.json. 
 </div> 
 <div style=""> 
  <br /> 
 </div> 
 <div style="">
   Using the Amazon unified command line interface: 
 </div> 
 <div style=""> 
  <ul> 
   <li>Set the new policy to the SNS topic</li> 
  </ul> 
 </div> 
</div> 
<blockquote> 
 <blockquote> 
  <div> 
   <div style="">
     aws sns set-topic-attributes --topic-arn sns_topic_arn --attribute-name Policy --attribute-value file://policy.json 
   </div> 
  </div> 
 </blockquote> 
</blockquote></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading194"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse194" aria-expanded="true" aria-controls="collapse194">Weakness: Sensitive data is exposed in transit <span>[AWS-S3-7.3]</span></button></h5></div><div id="collapse194" class="collapse" aria-labelledby="heading194" data-parent="#weaknesses"><div class="card-body">Sensitive data is not encrypted in transit with HTTPS or SSL, and this data is accessible
                        whilst traversing the network.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading193"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse193" aria-expanded="true" aria-controls="collapse193">Countermeasure: Enforce HTTPS to encrypt notifications <span>[Hydras-AWS-SNS-02]</span></button></h5></div><div id="collapse193" class="collapse" aria-labelledby="heading193" data-parent="#controls"><div class="card-body">To send messages to an HTTPS endpoint through a topic, you must subscribe the endpoint to the
                        Amazon SNS topic. You specify the endpoint using its URL. To subscribe to a topic, you can use
                        the Amazon SNS console, the sns-subscribe command, or the Subscribe API action.
                        <br />
                        <br />
                        <b> <b>Remediation:</b> </b>
                        <br />
                        <ol>
                        <li>Sign in to the AWS Management Console and open the Amazon SNS console at
                        https://console.aws.amazon.com/sns/v2/home.&nbsp;</li>
                        <li>In the left navigation pane, click Topics and then select the topic.&nbsp;</li>
                        <li>Click the Other actions drop-down list and select Subscribe to topic.&nbsp;</li>
                        <li>In the Protocol drop-down list, select HTTPS.&nbsp;</li>
                        <li>In the Endpoint box, paste in the URL for the endpoint that you want the topic to send
                        messages to and then click Create subscription.&nbsp;</li>
                        <li>For the Subscription request received! message, click Close.&nbsp;</li>
                        <li>Your new subscription's Subscription ID displays PendingConfirmation. When you confirm
                        the subscription, Subscription ID will display the subscription ID.&nbsp;</li>
                        </ol>Content provided by
                        <a href="https://hydrasit.com" target="_blank"> Hydras IT LTD</a>.
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>