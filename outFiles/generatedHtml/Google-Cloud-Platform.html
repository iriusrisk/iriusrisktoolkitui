<!DOCTYPE html><html><head><title>Risk Patterns for Google-Cloud-Platform.xml</title><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous"><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script></head><body><center><h2>Risk patterns for Google-Cloud-Platform.xml<h2></center><div class="accordion" id="components"><div class="card border-primary"><div class="card-header " id="heading20"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse20" aria-expanded="true" aria-controls="collapse20">Risk pattern: Google Cloud Identity and Access <span>[GOOGLE-CLOUD-IAM]</span></button></h5></div><div id="collapse20" class="collapse" aria-labelledby="heading20" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading10"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse10" aria-expanded="true" aria-controls="collapse10">Use case: Authentication <span>[AUTHENTICATION]</span></button></h5></div><div id="collapse10" class="collapse" aria-labelledby="heading10" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading6"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse6" aria-expanded="true" aria-controls="collapse6">Threat: Attackers gain unauthorized access to the root account due to lack of configuration of the account <span>[GOOGLE-LOST-ACCESS-ROOT]</span></button></h5></div><div id="collapse6" class="collapse" aria-labelledby="heading6" data-parent="#threats"><div class="card-body">Attackers could gain unauthorized access to the administrator account due to lack of
                                configuration of the account and its security mechanisms, such as modifying credentials
                                and adding/removing user accounts.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading1"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse1" aria-expanded="true" aria-controls="collapse1">Weakness: Excessive use of administrator accounts <span>[GOOGLE-MON02]</span></button></h5></div><div id="collapse1" class="collapse" aria-labelledby="heading1" data-parent="#weaknesses"><div class="card-body">The administrator accounts are used for all actions, not only for administrative actions..
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading0"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse0" aria-expanded="true" aria-controls="collapse0">Countermeasure: Create Individual Accounts for the administrator users <span>[GOOGLE-IAM05]</span></button></h5></div><div id="collapse0" class="collapse" aria-labelledby="heading0" data-parent="#controls"><div class="card-body">Create individual accounts for administrator users and with these new accounts perform the necessary administrative actions. By creating service accounts for people accessing your account, you can give each Google user a unique set of security credentials and roles.&nbsp; 
<div> 
 <br /> 
</div> 
<div>
  The administrator accounts shall be used for administrative actions and for giving or revoking credentials to users' accounts. The administrator account shall be not used as a normal user account. 
</div> 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:&nbsp;</b> 
</div> 
<div> 
 <ol> 
  <li>Open the Service Accounts page in the Cloud Platform Console and open the IAM page.&nbsp;</li> 
  <li>Click Select a project.</li> 
  <li>Select your project and click Open.&nbsp;</li> 
  <li>Click Create Service Account.&nbsp;</li> 
  <li>Enter a service account name, select a role you wish to grant to the service account and click Create.</li> 
 </ol> 
</div></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading3"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse3" aria-expanded="true" aria-controls="collapse3">Weakness: Misconfigured Security contact details <span>[LOST-SECURITY-ALERTS]</span></button></h5></div><div id="collapse3" class="collapse" aria-labelledby="heading3" data-parent="#weaknesses"><div class="card-body">The security contact details for the Google subscription are not properly configured.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading2"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse2" aria-expanded="true" aria-controls="collapse2">Countermeasure: Configure the reset security challenge questions for Administrator accounts <span>[GOOGLE-GOV01]</span></button></h5></div><div id="collapse2" class="collapse" aria-labelledby="heading2" data-parent="#controls"><div class="card-body">Ensure configuration of the security challenge questions for the Administrator accounts recover or reset password process are secure.&nbsp; 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:</b>&nbsp; 
</div> 
<div> 
 <ol> 
  <li>Go to <a href="https://myaccount.google.com/security#signin">Google Cloud Account</a>.</li> 
  <li>Fill in the fields from the &quot;Recover Account Options&quot; sections and click &quot;Save&quot;.</li> 
 </ol> 
</div></div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading5"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse5" aria-expanded="true" aria-controls="collapse5">Weakness: Misconfigured authentication method for administrator accounts <span>[GOOGLE-IAM-01]</span></button></h5></div><div id="collapse5" class="collapse" aria-labelledby="heading5" data-parent="#weaknesses"><div class="card-body">The authentication method "Multi-factor Authentication" for the Administrator accounts is not
                        configured.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading4"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse4" aria-expanded="true" aria-controls="collapse4">Countermeasure: Use Security Key for 2-Step Verification for administrator or co-administrator accounts <span>[GOOGLE-IAM06]</span></button></h5></div><div id="collapse4" class="collapse" aria-labelledby="heading4" data-parent="#controls"><div class="card-body">Ensure that the users with administrator and co-administrator accounts activate and configure the second factor authentication provided by Google. With 2-Step Verification, you can log into Google with a security key.&nbsp; 
<div> 
 <br /> 
</div> 
<div> 
 <b>Remediation:&nbsp;</b> 
</div> 
<div>
  To activate and configure 2 Factor Authentication, you shall follow the following steps: 
</div> 
<div> 
 <ol> 
  <li>Go to the 2-Step Verification page section of <a href="https://myaccount.google.com/signinoptions/two-step-verification">My Account</a>.&nbsp;</li> 
  <li>Click Add security key.</li> 
  <li>Follow the on-screen instructions.</li> 
 </ol> 
</div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading9"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse9" aria-expanded="true" aria-controls="collapse9">Threat: Attackers gain unauthorized access to the user account due to lack of configuration of the account <span>[GOOGLE-LOST-ACCESS-USER]</span></button></h5></div><div id="collapse9" class="collapse" aria-labelledby="heading9" data-parent="#threats"><div class="card-body">Attackers could gain unauthorized access to the user account due to lack of
                                configuration of the account, for example, the security question to reset the password
                                is configured incorrectly.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading8"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse8" aria-expanded="true" aria-controls="collapse8">Weakness: Misconfigured User Account <span>[GOOGLE-IAM03]</span></button></h5></div><div id="collapse8" class="collapse" aria-labelledby="heading8" data-parent="#weaknesses"><div class="card-body">Key security settings such as resetting the password, and other password controls are not
                        configured.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading7"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse7" aria-expanded="true" aria-controls="collapse7">Countermeasure: Recertify user access <span>[GOOGLE-IAM01]</span></button></h5></div><div id="collapse7" class="collapse" aria-labelledby="heading7" data-parent="#controls"><div class="card-body">Do regular reviews of service accounts on the system and verify they do not contain stolen or
                        fake accounts. This process ensures there are not any compromised accounts by former employees
                        or attackers.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>&nbsp;
                        </div>
                        <div>
                        At least every 90 days complete the following:&nbsp;
                        </div>
                        <div>
                        <ol>
                        <li>Open the Service Accounts page in the Cloud Platform Console.&nbsp;</li>
                        <li>Click Select a project.&nbsp;</li>
                        <li>Select your project and click Open. All service accounts are listed in the Service
                        Accounts page.</li>
                        <li>For any user that should not exist, select the user and click the Delete button.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-black"><div class="card-header " id="heading19"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse19" aria-expanded="true" aria-controls="collapse19">Use case: Authorization <span>[AUTHORIZATION]</span></button></h5></div><div id="collapse19" class="collapse" aria-labelledby="heading19" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading18"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse18" aria-expanded="true" aria-controls="collapse18">Threat: Attackers gain unauthorized access to the control of the environment <span>[LOSS-CONTROL_ENV]</span></button></h5></div><div id="collapse18" class="collapse" aria-labelledby="heading18" data-parent="#threats"><div class="card-body">Attackers could gain unauthorized access to the control of the environment, due to
                                improper definition and configuration of user accounts or role groups. Therefore,
                                attackers can make changes without root approval.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading15"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse15" aria-expanded="true" aria-controls="collapse15">Weakness: Misconfigured credentials for groups and roles <span>[GOOGLE_IAM-02]</span></button></h5></div><div id="collapse15" class="collapse" aria-labelledby="heading15" data-parent="#weaknesses"><div class="card-body">The credentials for the groups and roles are incorrectly configured and there are user
                        accounts with more privileges than necessary.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading11"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse11" aria-expanded="true" aria-controls="collapse11">Countermeasure: Define roles for the Google Service Accounts <span>[GOOGLE-IAM02]</span></button></h5></div><div id="collapse11" class="collapse" aria-labelledby="heading11" data-parent="#controls"><div class="card-body">Define and create the roles for the Google Cloud. For each role, you can use one of the
                        predefined roles or create a new custom role to ensure that each role has got the least minimum
                        permissions.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>&nbsp;
                        </div>
                        <div>
                        <ol>
                        <li>List all predefined roles and review them.&nbsp;</li>
                        <li>If it's necessary, create new custom roles to ensure users have the least privileges.</li>
                        </ol>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading12"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse12" aria-expanded="true" aria-controls="collapse12">Countermeasure: Apply RBAC with pre-defined policies added into groups and roles <span>[GOOGLE-IAM03]</span></button></h5></div><div id="collapse12" class="collapse" aria-labelledby="heading12" data-parent="#controls"><div class="card-body">Define and create groups that relate to job functions (administrators, developers, accounting,
                        etc.) and assign the relevant permissions for each group, and then assign IAM users to those
                        groups. All the users in an IAM group inherit the permissions assigned to the group. That way,
                        you can make changes for everyone in a group in just one place. As people move around in your
                        company, you can simply change what IAM group their IAM user belongs to. This method is known as
                        Role Based Access Control (RBAC).&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        To add a team member and grant an IAM role to the member:
                        </div>
                        <div>
                        <ol>
                        <li>Open the IAM page in the Cloud Platform Console and open the IAM page.</li>
                        <li>Click Select a project.</li>
                        <li>Select a project and click Open.</li>
                        <li>Click Add to add new members to the project and set their permissions. In the Select a
                        role drop-down menu, click on a service name to find the roles that belong to that service.&nbsp;</li>
                        </ol>To grant more than one role to the same project member:
                        </div>
                        <div>
                        <ol>
                        <li>Open the IAM page in the Cloud Platform Console and open the IAM page.</li>
                        <li>Click Select a project.</li>
                        <li>Select a project and click Open.</li>
                        <li>Enter the email address of the member and select all the roles that you want to grant
                        to the member. Click Add.&nbsp;</li>
                        </ol>To grant a role to a member for more than one project:
                        </div>
                        <div>
                        <ol>
                        <li>Open the IAM and Admin Projects page in the Cloud Platform Console and open the IAM
                        &amp; ADMIN PROJECTS page.</li>
                        <li>Select all the projects for which you want to grant permissions.</li>
                        <li>In the IAM tab on the right pane, add the new member and select a role to grant the
                        role for all selected projects.</li>
                        </ol>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading13"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse13" aria-expanded="true" aria-controls="collapse13">Countermeasure: Create mechanisms to ensure Least Privilege is applied <span>[GOOGLE-IAM04]</span></button></h5></div><div id="collapse13" class="collapse" aria-labelledby="heading13" data-parent="#controls"><div class="card-body">Create mechanisms to periodically review the group and user permissions to ensure the least
                        privilege for the user accounts. Granting least privilege ensures that users only have the
                        permissions required to complete their tasks rather than additional privileges that are not
                        required. Following this model ensures that, should an account be compromised, the blast radius
                        of damage is limited.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        Allocate privileges via groups or roles via the recommendation in &quot;Use RBAC with
                        pre-defined policies added into groups or roles&quot;.
                        </div>
                        <div>
                        <ol>
                        <li>Open the IAM page in the Google Cloud Platform Console and open the IAM page.&nbsp;</li>
                        <li>Click Select a project.&nbsp;</li>
                        <li>Select a project and click Open.&nbsp;</li>
                        <li>Review the groups and users with access to the project and their permissions.&nbsp;</li>
                        <li>If there is a user with more privileges, revoke the access as following:</li>
                        <ul>
                        <li>Select the user to revoke privileges.</li>
                        <li>In the Roles(s) drop-down menu in the member's row, uncheck the roles you want to
                        revoke and click Save.</li>
                        </ul>
                        </ol>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading14"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse14" aria-expanded="true" aria-controls="collapse14">Countermeasure: Create a process to create and manage the Google Service Keys <span>[GOOGLE-IAM07]</span></button></h5></div><div id="collapse14" class="collapse" aria-labelledby="heading14" data-parent="#controls"><div class="card-body">Create a process or mechanism to create, manage, or revoke the assignment of keys to users and
                        give them the least necessary access to resources. There are two types of service account keys:&nbsp;
                        <div>
                        <ul>
                        <li><b>GCP-managed keys:</b>&nbsp;These keys are used by Cloud Platform
                        services such as the App Engine and Compute Engine. These keys cannot be downloaded. Google will
                        keep the keys and automatically rotate them daily.&nbsp;</li>
                        <li><b>User-managed keys:&nbsp;</b>These keys are created, downloadable,
                        and managed by users. For user-managed keys, you need to ensure you have processes in place to
                        address key management requirements such as:&nbsp;</li>
                        <ul>
                        <li>Key storage&nbsp;</li>
                        <li>Key distribution&nbsp;</li>
                        <li>Key revocation&nbsp;</li>
                        <li>Key rotation&nbsp;</li>
                        <li>Protecting the keys from unauthorized users.</li>
                        </ul>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading17"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse17" aria-expanded="true" aria-controls="collapse17">Weakness: Misconfigured security key expirations <span>[GOOGLE-EXPIRATION-DATE]</span></button></h5></div><div id="collapse17" class="collapse" aria-labelledby="heading17" data-parent="#weaknesses"><div class="card-body">The password and security key expiration is not configured and users are not obliged to change
                        their security credentials. Not frequently changing passwords, gives attackers the chance to
                        obtain credentials and gain access to the systems.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading16"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse16" aria-expanded="true" aria-controls="collapse16">Countermeasure: Automatically rotate Google Service account keys <span>[GOOGLE-IAM08]</span></button></h5></div><div id="collapse16" class="collapse" aria-labelledby="heading16" data-parent="#controls"><div class="card-body">The Google Service Keys shall be rotated to avoid unauthorized access.
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>&nbsp;
                        </div>
                        <div>
                        To enable automatic rotation of a key, set the rotation schedule with the following gcloud
                        command-line syntax:&nbsp;
                        </div>
                        <div>
                        gcloud kms keys update KEY_NAME \&nbsp;
                        </div>
                        <blockquote>
                        <div>
                        --location LOCATION \&nbsp;
                        </div>
                        <div>
                        --keyring KEYRING_NAME \&nbsp;
                        </div>
                        <div>
                        --rotation-period ROTATION_PERIOD \&nbsp;
                        </div>
                        <div>
                        --next-rotation-time NEXT_ROTATION_TIME&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        </blockquote>For example:&nbsp;
                        <div>
                        gcloud kms keys update KEY_NAME&nbsp;
                        </div>
                        <blockquote>
                        <div>
                        --rotation-period=30d&nbsp;
                        </div>
                        <div>
                        --next-rotation-time=2016-10-12T12:34:56.1234Z
                        </div>
                        </blockquote>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading35"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse35" aria-expanded="true" aria-controls="collapse35">Risk pattern: Google Cloud Kubernetes <span>[GOOGLE-CLOUD-KUB]</span></button></h5></div><div id="collapse35" class="collapse" aria-labelledby="heading35" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading34"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse34" aria-expanded="true" aria-controls="collapse34">Use case: Google Cloud Platform <span>[GOOGLE CLOUD PLATFORM]</span></button></h5></div><div id="collapse34" class="collapse" aria-labelledby="heading34" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading23"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse23" aria-expanded="true" aria-controls="collapse23">Threat: Attackers gain unauthorized access to the control of the environment <span>[LOSS-CONTROL_ENV]</span></button></h5></div><div id="collapse23" class="collapse" aria-labelledby="heading23" data-parent="#threats"><div class="card-body">Attackers could gain unauthorized access to the control of the environment, due to
                                user accounts or role groups not being well defined and configured. Therefore, attackers
                                can make changes without root approval.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading22"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse22" aria-expanded="true" aria-controls="collapse22">Weakness: Misconfigured credentials for groups and roles <span>[GOOGLE_IAM-02]</span></button></h5></div><div id="collapse22" class="collapse" aria-labelledby="heading22" data-parent="#weaknesses"><div class="card-body">The credentials for the groups and roles are not correctly configured and there are user
                        accounts with more privileges than necessary.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading21"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse21" aria-expanded="true" aria-controls="collapse21">Countermeasure: Assign IAM roles to grant access to the Container Builder <span>[GOOGLE-CONT04]</span></button></h5></div><div id="collapse21" class="collapse" aria-labelledby="heading21" data-parent="#controls"><div class="card-body">Manage and assign roles with the corresponding permissions for access to the Container Builder
                        systems. In this process, the assignment of roles shall adhere to the Principle of Least
                        Privilege.
                        <div>
                        <br />
                        </div>
                        <div>
                        Therefore, each role with access to the containers shall be assigned only with the permissions
                        the user needs for their specific tasks.&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>&nbsp;
                        </div>
                        <div>
                        To grant IAM roles for a new team member or service account:&nbsp;
                        </div>
                        <div>
                        <ol>
                        <li>Open the Identity and Access Management page in the Google Cloud Platform Console.&nbsp;</li>
                        <li>Select your project, and click Continue.</li>
                        <li>Click Add.&nbsp;</li>
                        <li>Enter the team member's or service account's email address.</li>
                        <li>Select the desired Role Title from the drop-down menu. Container Builder roles are
                        found under Container Builder.&nbsp;</li>
                        <li>Click Add.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading26"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse26" aria-expanded="true" aria-controls="collapse26">Threat: Attackers make undetected and unaudited changes to system configurations <span>[UNAUDITABLE-CHANGES-GOOGLE]</span></button></h5></div><div id="collapse26" class="collapse" aria-labelledby="heading26" data-parent="#threats"><div class="card-body">If audit trails are not properly protected, an attacker could gain access to the
                                system, modify the status of resources or exfiltrate sensitive data without being
                                detected.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading25"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse25" aria-expanded="true" aria-controls="collapse25">Weakness: Undetected changes in the Google Container Builder <span>[GOOGLE-LOGS01]</span></button></h5></div><div id="collapse25" class="collapse" aria-labelledby="heading25" data-parent="#weaknesses"><div class="card-body">Changes in the Google Cloud Container Builder are not detected and audited, because the Google
                        Cloud mechanisms that are used to notify about changes are disabled.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading24"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse24" aria-expanded="true" aria-controls="collapse24">Countermeasure: Enable the logs for Google Container Builder <span>[GOOGLE-CONT05]</span></button></h5></div><div id="collapse24" class="collapse" aria-labelledby="heading24" data-parent="#controls"><div class="card-body">The Admin activity logs are enabled and logged by default but the Data access logs for
                        Container Builder operations are not recorded by default. You shall enable the Data Access audit
                        logs in the project to follow the access to the Google Cloud Container.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>&nbsp;
                        </div>
                        <div>
                        To enable the audit logs for the containers, you shall go to the file auditConfigs and add the
                        following code:&nbsp;
                        </div>
                        <div>
                        <ul>
                        <li>In JSON:&nbsp;</li>
                        </ul>
                        </div>
                        <blockquote>
                        <blockquote>
                        <div>
                        &quot;auditConfigs&quot;: [ {&nbsp;
                        </div>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        &quot;service&quot;: &quot;[SERVICE]&quot;,&nbsp;
                        </div>
                        <div>
                        &quot;auditLogConfigs&quot;: [&nbsp;
                        </div>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        { &quot;logType&quot;: &quot;ADMIN_READ&quot; },&nbsp;
                        </div>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        { &quot;logType&quot;: &quot;DATA_READ&quot; },&nbsp;
                        </div>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        { &quot;logType&quot;: &quot;DATA_WRITE&quot; },&nbsp;
                        </div>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        ]
                        </div>
                        </blockquote>}, ]&nbsp;
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        <br />
                        </div>
                        </blockquote>
                        </blockquote>
                        <ul>
                        <li>In YAML:&nbsp;</li>
                        </ul>
                        <blockquote>
                        <blockquote>
                        auditConfigs:&nbsp;
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        - auditLogConfigs:&nbsp;
                        </blockquote>
                        <blockquote>
                        - logType: ADMIN_READ&nbsp;
                        </blockquote>
                        <blockquote>
                        - logType: DATA_WRITE&nbsp;
                        </blockquote>
                        <blockquote>
                        - logType: DATA_READ service: [SERVICE]&nbsp;
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <br />
                        </blockquote>
                        </blockquote>Note: the param [SERVICE] shall be replaced with each service of the
                        containers, the services are the following: projects.builds.get, projects.builds.list,
                        projects.triggers.list, projects.triggers.get
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading33"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse33" aria-expanded="true" aria-controls="collapse33">Threat: Sensitive data is compromised  thorough unauthorized access to data storage <span>[ACCESS-TO-DATA]</span></button></h5></div><div id="collapse33" class="collapse" aria-labelledby="heading33" data-parent="#threats"><div class="card-body"><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading28"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse28" aria-expanded="true" aria-controls="collapse28">Weakness: Container Builder has no access to the CryptoKey <span>[GOOGLE-KEY-ACCESS]</span></button></h5></div><div id="collapse28" class="collapse" aria-labelledby="heading28" data-parent="#weaknesses"><div class="card-body">The Container Builder has no access to the CryptoKey in order to create and view the keys.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading27"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse27" aria-expanded="true" aria-controls="collapse27">Countermeasure: Grant the Container Builder service account access to the CryptoKey <span>[GOOGLE-CONT02]</span></button></h5></div><div id="collapse27" class="collapse" aria-labelledby="heading27" data-parent="#controls"><div class="card-body">To decrypt your resource during your build, you must grant the Container Builder service
                        account the permissions to access your CryptoKey. If it only needs to decrypt the file, you need
                        only grant decrypt permission.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>&nbsp;
                        </div>
                        <div>
                        To grant permission:&nbsp;
                        </div>
                        <div>
                        <ul>
                        <li>Google Cloud Console:&nbsp;</li>
                        <ol>
                        <li>Visit the GCP Console IAM menu.&nbsp;</li>
                        <li>Copy the Container Builder service account email address, which contains
                        @cloudbuild.gserviceaccount.com.&nbsp;</li>
                        <li>Visit the GCP Console Encryption Keys menu.&nbsp;</li>
                        <li>Select your KeyRing from the list, then click Permission.&nbsp;</li>
                        <li>Fill the Add members field with the service account email address.&nbsp;</li>
                        <li>From the Roles drop-down menu, choose Cloud KMS CryptoKey Decrypter.&nbsp;</li>
                        <li>Click Add.</li>
                        </ol>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading30"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse30" aria-expanded="true" aria-controls="collapse30">Weakness: Credentials are not securely stored <span>[GOOGLE-USECURE-CREDENTIALS]</span></button></h5></div><div id="collapse30" class="collapse" aria-labelledby="heading30" data-parent="#weaknesses"><div class="card-body">The credentials that are used to access the resources are not securely stored and they can be
                        accessed by unauthorized personnel.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading29"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse29" aria-expanded="true" aria-controls="collapse29">Countermeasure: Encrypt the files using the CryptoKey <span>[GOOGLE-CONT03]</span></button></h5></div><div id="collapse29" class="collapse" aria-labelledby="heading29" data-parent="#controls"><div class="card-body">The files shall be encrypted before their storage into a repository or datastore.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>&nbsp;
                        </div>
                        <div>
                        To encrypt a file, run the following command in your shell or terminal window:&nbsp;
                        </div>
                        <div>
                        gcloud kms encrypt \&nbsp;
                        </div>
                        <blockquote>
                        <div>
                        --plaintext-file=secrets.json \&nbsp;
                        </div>
                        <div>
                        --ciphertext-file=secrets.json.enc \&nbsp;
                        </div>
                        <div>
                        --location=global \&nbsp;
                        </div>
                        <div>
                        --keyring=[KEYRING-NAME] \&nbsp;
                        </div>
                        <div>
                        --key=[KEY-NAME]&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        </blockquote>This produces an encrypted file named secrets.json.enc, which contains the
                        contents of secrets.json.
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading32"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse32" aria-expanded="true" aria-controls="collapse32">Weakness: Keys for encryption are not created <span>[GOOGLE-KEY-CREATE]</span></button></h5></div><div id="collapse32" class="collapse" aria-labelledby="heading32" data-parent="#weaknesses"><div class="card-body">There are no keys to encrypt the communication between the users and the Google Container.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading31"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse31" aria-expanded="true" aria-controls="collapse31">Countermeasure: Create a Cloud KMS KeyRing and CryptoKey <span>[GOOGLE-CONT01]</span></button></h5></div><div id="collapse31" class="collapse" aria-labelledby="heading31" data-parent="#controls"><div class="card-body">Create the Cryptokey or the KeyRing to create the keys to connect to the Google Cloud
                        Containers.
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        You can create KeyRings and CryptoKeys using the gcloud kms keyrings create and gcloud kms keys
                        create commands.&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        To create a KeyRing, run the following command in your shell or terminal window: gcloud kms
                        keyrings create [KEYRING-NAME] \&nbsp;
                        </div>
                        <blockquote>
                        <div>
                        --location=global&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        </blockquote>To create a CryptoKey:&nbsp;
                        <div>
                        gcloud kms keys create [KEY-NAME] \&nbsp;
                        </div>
                        <blockquote>
                        <div>
                        --location=global \&nbsp;
                        </div>
                        <div>
                        --keyring=[KEYRING-NAME] \&nbsp;
                        </div>
                        <div>
                        --purpose=encryption&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        </blockquote>where: [KEYRING-NAME] is the name of the KeyRing to create [KEY-NAME] is the
                        name of the CryptoKey to create.
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading42"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse42" aria-expanded="true" aria-controls="collapse42">Risk pattern: Google Cloud Logging <span>[GOOGLE-CLOUD-LOGS]</span></button></h5></div><div id="collapse42" class="collapse" aria-labelledby="heading42" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading41"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse41" aria-expanded="true" aria-controls="collapse41">Use case: API Logging and Auditing <span>[API LOGGING AND AUDITING]</span></button></h5></div><div id="collapse41" class="collapse" aria-labelledby="heading41" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading40"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse40" aria-expanded="true" aria-controls="collapse40">Threat: Attackers make undetected and unaudited changes to system configurations <span>[UNAUDITABLE-CHANGES-GOOGLE]</span></button></h5></div><div id="collapse40" class="collapse" aria-labelledby="heading40" data-parent="#threats"><div class="card-body">If audit trails are not properly protected, an attacker could gain access to the
                                system, modify the status of resources or exfiltrate sensitive data without being
                                noticed.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading37"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse37" aria-expanded="true" aria-controls="collapse37">Weakness: Audit logs can be deleted <span>[GOOGLE-LOGS03]</span></button></h5></div><div id="collapse37" class="collapse" aria-labelledby="heading37" data-parent="#weaknesses"><div class="card-body">There is no external backups of log records. If logs are deleted, there is no way to recover
                        them.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading36"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse36" aria-expanded="true" aria-controls="collapse36">Countermeasure: Create mechanisms to periodically export the Audit Logs <span>[GOOGLE-LOG02]</span></button></h5></div><div id="collapse36" class="collapse" aria-labelledby="heading36" data-parent="#controls"><div class="card-body">Enable the exporting of information from the Audit Logs to save them in a storage account.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>&nbsp;
                        </div>
                        <div>
                        <ol>
                        <li>Go to the Logs Viewer and pick a project.&nbsp;</li>
                        <li>Select Exports in the left-side navigation panel.&nbsp;</li>
                        <li>We want to export all audit logs, therefore select the All logs checkbox.&nbsp;</li>
                        <li>Select the corresponding Storage bucket in the section &quot;Save to Cloud Storage
                        bucket&quot;.&nbsp;</li>
                        <li>Click &quot;Save&quot; button.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading39"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse39" aria-expanded="true" aria-controls="collapse39">Weakness: Non-auditable resource changes <span>[GOOGLE-LOGS01]</span></button></h5></div><div id="collapse39" class="collapse" aria-labelledby="heading39" data-parent="#weaknesses"><div class="card-body">The Diagnostic Logs are not activated and configured. Therefore, the changes or access to the
                        resources are not recorded in the logs.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading38"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse38" aria-expanded="true" aria-controls="collapse38">Countermeasure: Enable all access logs <span>[GOOGLE-LOG01]</span></button></h5></div><div id="collapse38" class="collapse" aria-labelledby="heading38" data-parent="#controls"><div class="card-body">Enable all audit logs in the Google Cloud Platform to control and monitor the access of users
                        and the configuration changes in the systems.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        First, you have to know there are two types of audit logs in the Google Cloud Platform:&nbsp;
                        </div>
                        <div>
                        <ul>
                        <li>Admin Activity audit logs that are enabled for all services and cannot be configured.</li>
                        <li>Data Access audit logs that are not enabled by default and they shall be configured.&nbsp;</li>
                        </ul>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        To enable all audit logs, you shall enable and configure the Data Access audit logs. To
                        configure these logs, you shall write the following configurations in the auditConfigs section:&nbsp;
                        </div>
                        <div>
                        <ul>
                        <li>JSON:&nbsp;</li>
                        </ul>
                        </div>
                        <blockquote>
                        <blockquote>
                        <div>
                        &quot;auditConfigs&quot;: [ {&nbsp;
                        </div>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        &quot;service&quot;: &quot;allServices&quot;,&nbsp;
                        </div>
                        <div>
                        &quot;auditLogConfigs&quot;: [&nbsp;
                        </div>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        { &quot;logType&quot;: &quot;ADMIN_READ&quot; },&nbsp;
                        </div>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        { &quot;logType&quot;: &quot;DATA_READ&quot; },&nbsp;
                        </div>
                        <div>
                        { &quot;logType&quot;: &quot;DATA_WRITE&quot; },&nbsp;
                        </div>
                        <div>
                        ]&nbsp;
                        </div>
                        <div>
                        }, ]&nbsp;
                        </div>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        <ul>
                        <li>YAML:&nbsp;</li>
                        </ul>
                        <blockquote>
                        <blockquote>
                        auditConfigs:&nbsp;
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        - auditLogConfigs:&nbsp;
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        - logType: ADMIN_READ&nbsp;
                        </blockquote>
                        <blockquote>
                        - logType: DATA_WRITE&nbsp;
                        </blockquote>
                        <blockquote>
                        - logType: DATA_READ service: allServices
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading67"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse67" aria-expanded="true" aria-controls="collapse67">Risk pattern: Google Cloud Monitoring <span>[GOOGLE-CLOUD-MON]</span></button></h5></div><div id="collapse67" class="collapse" aria-labelledby="heading67" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading66"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse66" aria-expanded="true" aria-controls="collapse66">Use case: Activity Logs alerts <span>[ACTIVITY LOGS ALERTS]</span></button></h5></div><div id="collapse66" class="collapse" aria-labelledby="heading66" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading55"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse55" aria-expanded="true" aria-controls="collapse55">Threat: Attackers access the systems without being detected <span>[UNAUTHORIZED-ACCESS-SYSTEMS]</span></button></h5></div><div id="collapse55" class="collapse" aria-labelledby="heading55" data-parent="#threats"><div class="card-body">Attackers gain access to the systems and are not detected and changes made by the
                                attackers couldn't be audited or detected.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading44"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse44" aria-expanded="true" aria-controls="collapse44">Weakness: Excessive use of administrator accounts <span>[GOOGLE-MON02]</span></button></h5></div><div id="collapse44" class="collapse" aria-labelledby="heading44" data-parent="#weaknesses"><div class="card-body">The administrator accounts are used for all actions, not only for the administrative ones.
                        This is because these users do not have a personal or user account to perform their daily
                        actions.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading43"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse43" aria-expanded="true" aria-controls="collapse43">Countermeasure: Create alerts to notify about improper usage of the root account <span>[GOOGLE-MON02A]</span></button></h5></div><div id="collapse43" class="collapse" aria-labelledby="heading43" data-parent="#controls"><div class="card-body">Create alerts to monitor, audit and notify about usage of the root account when this account
                        is used frequently. It's vital that monitoring of root account usage detects and reports
                        unauthorized or improper usage.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to the <a href="https://app.google.stackdriver.com/">Stackdriver Monitoring
                        Console</a>.&nbsp;</li>
                        <li>Find on the panel the Create Alerting Policy and click on it.&nbsp;</li>
                        <li>Fill in the sections as follows:&nbsp;</li>
                        <ul>
                        <li>The Conditions section is already set up. Fill the condition correctly.</li>
                        <li>In the Notifications section, click Add Notification and fill in your email address or
                        another notification method.</li>
                        <li>In the Name this policy section, you can accept the default.&nbsp;</li>
                        </ul>
                        <li>Click Save Policy.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading46"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse46" aria-expanded="true" aria-controls="collapse46">Weakness: Lack of 2FA <span>[GOOGLE-MON03]</span></button></h5></div><div id="collapse46" class="collapse" aria-labelledby="heading46" data-parent="#weaknesses"><div class="card-body">Login to the console without using Multi-factor Authentication (MFA) is considered as
                        suspicious activity. Therefore connection without MFA must be audited and monitored and the
                        corresponding security group must be informed and must validate this connection.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading45"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse45" aria-expanded="true" aria-controls="collapse45">Countermeasure: Create alerts to be notified about console login without 2FA <span>[GOOGLE-MON05]</span></button></h5></div><div id="collapse45" class="collapse" aria-labelledby="heading45" data-parent="#controls"><div class="card-body">Create alerts to monitor, audit and notify when users log into the console without a Second
                        Factor of Authentication. It's vital that monitoring of authentication to systems detects and
                        reports any unauthorized access to them.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>&nbsp;
                        </div>
                        <div>
                        <ol>
                        <li>Go to the <a href="https://app.google.stackdriver.com/">Stackdriver Monitoring
                        Console</a>.&nbsp;</li>
                        <li>Find on the panel the Create Alerting Policy and click on it.&nbsp;</li>
                        <li>Fill in the sections as follows:&nbsp;</li>
                        <ul>
                        <li>The Conditions section is already set up. Fill the condition correctly.&nbsp;</li>
                        <li>In the Notifications section, click Add Notification and fill in your email address or
                        another notification method.&nbsp;</li>
                        <li>In the Name this policy section, you can accept the default.&nbsp;</li>
                        </ul>
                        <li>Click Save Policy.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading48"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse48" aria-expanded="true" aria-controls="collapse48">Weakness: Undetected Resources status changes <span>[GOOGLE-RESOURCES-STATUS]</span></button></h5></div><div id="collapse48" class="collapse" aria-labelledby="heading48" data-parent="#weaknesses"><div class="card-body">Changes to the system status are not controlled with the consequence of system failure.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading47"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse47" aria-expanded="true" aria-controls="collapse47">Countermeasure: Create an uptime check to alert when the server is down <span>[GOOGLE-MON01]</span></button></h5></div><div id="collapse47" class="collapse" aria-labelledby="heading47" data-parent="#controls"><div class="card-body">Create an uptime check to verify your web server is always accessible. The alerting policy
                        controls who is notified when the uptime check fails.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to the <a href="https://app.google.stackdriver.com/">Stackdriver Monitoring
                        Console</a>.&nbsp;</li>
                        <li>Click Create an Uptime Check on the dashboard. Otherwise, go to Uptime Checks in the
                        left-hand menu, then select Uptime Checks Overview and then click Create an Uptime Check in the
                        new page.&nbsp;</li>
                        <li>Fill in the following fields for the new uptime:</li>
                        <ul>
                        <li>Title: Lamp Uptime Check.&nbsp;</li>
                        <li>Check type: HTTP.&nbsp;</li>
                        <li>Resource Type: Instance&nbsp;</li>
                        <li>Applies To: Single, lamp-1-vm&nbsp;</li>
                        <li>Leave the other fields with their default values.&nbsp;</li>
                        </ul>
                        <li>Click Test to verify your uptime check is working. If you see a Connection error -
                        refused message, you might not have installed the Apache HTTP Server.&nbsp;</li>
                        <li>&nbsp;Click Save.&nbsp;</li>
                        <li>Find on the panel the Create Alerting Policy and click on it.&nbsp;</li>
                        <li>Fill in the sections as follows:&nbsp;</li>
                        <ul>
                        <li>The Conditions section is already set up. You don't have to change it.&nbsp;</li>
                        <li>In the Notifications section, click Add Notification and fill in your email address or
                        another notification method.&nbsp;</li>
                        <li>In the Documentation section, click Add Documentation and enter: Stackdriver LAMP
                        quickstart example.</li>
                        <li>In the Name this policy section, you can accept the default Uptime Check Policy.&nbsp;</li>
                        </ul>
                        <li>Click Save Policy.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading50"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse50" aria-expanded="true" aria-controls="collapse50">Weakness: Undetected brute force attempts on the Google Cloud console <span>[GOOGLE-MON06]</span></button></h5></div><div id="collapse50" class="collapse" aria-labelledby="heading50" data-parent="#weaknesses"><div class="card-body">Failed connection attempts (brute force) must be audited and monitored and the corresponding
                        personnel must be alerted and informed.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading49"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse49" aria-expanded="true" aria-controls="collapse49">Countermeasure: Create alerts to be notified about console login failure attempts <span>[GOOGLE-MON08]</span></button></h5></div><div id="collapse49" class="collapse" aria-labelledby="heading49" data-parent="#controls"><div class="card-body">Create alerts to monitor, audit and to be notified when there are several console login
                        failure attempts. It's vital that monitoring of these connection attempts detects and reports
                        any unauthorized access to the systems.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to the <a href="https://app.google.stackdriver.com/">Stackdriver Monitoring
                        Console</a>.&nbsp;</li>
                        <li>Find on the panel the Create Alerting Policy and click on it.&nbsp;</li>
                        <li>Fill in the sections as follows:</li>
                        <ul>
                        <li>The Conditions section is already set up. Fill the condition correctly.&nbsp;</li>
                        <li>In the Notifications section, click Add Notification and fill in your email address or
                        another notification method.&nbsp;</li>
                        <li>In the Name this policy section, you can accept the default.</li>
                        </ul>
                        <li>Click Save Policy.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading52"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse52" aria-expanded="true" aria-controls="collapse52">Weakness: Undetected changes in the data encryption configuration <span>[GOOGLE-MON05]</span></button></h5></div><div id="collapse52" class="collapse" aria-labelledby="heading52" data-parent="#weaknesses"><div class="card-body">Changes to the database encryption must be audited and monitored. When there are changes to
                        the database encryption, the security group must be alerted.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading51"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse51" aria-expanded="true" aria-controls="collapse51">Countermeasure: Create alerts when the data encryption changes <span>[GOOGLE-MON07]</span></button></h5></div><div id="collapse51" class="collapse" aria-labelledby="heading51" data-parent="#controls"><div class="card-body">Create alerts to monitor, audit and notify when the data encryption changes. It's vital that
                        monitoring of data encryption detects and reports any unauthorized changes in the system
                        configurations.
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to the <a href="https://app.google.stackdriver.com/">Stackdriver Monitoring
                        Console</a>.&nbsp;</li>
                        <li>Find on the panel the Create Alerting Policy and click on it.&nbsp;</li>
                        <li>Fill in the sections as follows:&nbsp;</li>
                        <ul>
                        <li>The Conditions section is already set up. Fill the condition correctly.&nbsp;</li>
                        <li>In the Notifications section, click Add Notification and fill in your email address or
                        another notification method.&nbsp;</li>
                        <li>In the Name this policy section, you can accept the default.&nbsp;</li>
                        </ul>
                        <li>Click Save Policy.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading54"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse54" aria-expanded="true" aria-controls="collapse54">Weakness: Undetected changes in the security groups <span>[GOOGLE-MON04]</span></button></h5></div><div id="collapse54" class="collapse" aria-labelledby="heading54" data-parent="#weaknesses"><div class="card-body">Changes in the security groups must be traced and monitored and the corresponding personnel
                        must approve these changes. If the configuration is not appropriate, attackers can gain access
                        to security systems.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading53"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse53" aria-expanded="true" aria-controls="collapse53">Countermeasure: Create alerts for changes in the security groups and in the security group configurations <span>[GOOGLE-MON06]</span></button></h5></div><div id="collapse53" class="collapse" aria-labelledby="heading53" data-parent="#controls"><div class="card-body">Create alerts to monitor, audit and notify about changes to the Security Groups or the
                        Security Groups configuration. It's vital that monitoring of Security Groups detects and reports
                        any unauthorized changes in the security systems.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>&nbsp;
                        </div>
                        <div>
                        <ol>
                        <li>Go to the <a href="https://app.google.stackdriver.com/">Stackdriver Monitoring
                        Console</a>.&nbsp;</li>
                        <li>Find on the panel the Create Alerting Policy and click on it.&nbsp;</li>
                        <li>Fill in the sections as follows:</li>
                        <ul>
                        <li>The Conditions section is already set up. Fill the condition correctly.&nbsp;</li>
                        <li>In the Notifications section, click Add Notification and fill in your email address or
                        another notification method.&nbsp;</li>
                        <li>In the Name this policy section, you can accept the default.&nbsp;</li>
                        </ul>
                        <li>Click Save Policy.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading60"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse60" aria-expanded="true" aria-controls="collapse60">Threat: Attackers gain undetected access to the security system configurations <span>[UNAUTHORIZED-ACCESS-SECURITY-SYSTEMS]</span></button></h5></div><div id="collapse60" class="collapse" aria-labelledby="heading60" data-parent="#threats"><div class="card-body">Attackers could gain undetected access to the security system configurations and
                                changes made by attackers couldn't be audited or detected.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading59"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse59" aria-expanded="true" aria-controls="collapse59">Weakness: Undetected changes in the security configurations <span>[GOOGLE-MON01]</span></button></h5></div><div id="collapse59" class="collapse" aria-labelledby="heading59" data-parent="#weaknesses"><div class="card-body">Monitoring and alerting for security configurations are not configured and changes cannot be
                        detected.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading56"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse56" aria-expanded="true" aria-controls="collapse56">Countermeasure: Create alerts for security policy changes <span>[GOOGLE-MON03]</span></button></h5></div><div id="collapse56" class="collapse" aria-labelledby="heading56" data-parent="#controls"><div class="card-body">Create alerts to monitor, audit and notify about changes to the Security Policy. It's vital
                        that monitoring of the Security Policy detects and reports any unauthorized changes in the
                        security configurations.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to the <a href="https://app.google.stackdriver.com/">Stackdriver Monitoring
                        Console</a>.</li>
                        <li>Find on the panel the Create Alerting Policy and click on it.&nbsp;</li>
                        <li>Fill in the sections as follows:</li>
                        <ul>
                        <li>The Conditions section shall be set up. In this case, you have to add the condition
                        for the these methods: projects.getIamPolicy, projects.setIamPolicy, organizations.getIamPolicy
                        and organizations.setIamPolicy&nbsp;</li>
                        <li>In the Notifications section, click Add Notification and fill in your email address or
                        another notification method.&nbsp;</li>
                        <li>In the Name this policy section, you can accept the default.&nbsp;</li>
                        </ul>
                        <li>Click Save Policy.</li>
                        </ol>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading57"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse57" aria-expanded="true" aria-controls="collapse57">Countermeasure: Create alerts to detect the changes of activity alerts <span>[GOOGLE-MON04]</span></button></h5></div><div id="collapse57" class="collapse" aria-labelledby="heading57" data-parent="#controls"><div class="card-body">Create alerts to monitor, audit and notify about the changes of Monitoring alerts. It's vital
                        that the monitoring of alerts detects and reports any unauthorized changes in the Monitoring
                        systems.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to the <a href="https://app.google.stackdriver.com/">Stackdriver Monitoring
                        Console</a>.&nbsp;</li>
                        <li>Find on the panel the Create Alerting Policy and click on it.&nbsp;</li>
                        <li>Fill in the sections as follows:&nbsp;</li>
                        <ul>
                        <li>The Conditions section is already set up. You don't have to change it.&nbsp;</li>
                        <li>In the Notifications section, click Add Notification and fill in your email address or
                        another notification method.&nbsp;</li>
                        <li>In the Name this policy section, you can accept the default.&nbsp;</li>
                        </ul>
                        <li>Click Save Policy.</li>
                        </ol>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading58"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse58" aria-expanded="true" aria-controls="collapse58">Countermeasure: Create alerts for the Logging of configuration changes <span>[GOOGLE-MON13]</span></button></h5></div><div id="collapse58" class="collapse" aria-labelledby="heading58" data-parent="#controls"><div class="card-body">Create alerts for Logging changes to monitor, audit and notify about changes in this section
                        by the corresponding personnel. It's vital that any unauthorized changes are detected and
                        reported.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to the <a href="https://app.google.stackdriver.com/">Stackdriver Monitoring
                        Console</a>.&nbsp;</li>
                        <li>Find on the panel the Create Alerting Policy and click on it.&nbsp;</li>
                        <li>Fill in the sections as follows:&nbsp;</li>
                        <ul>
                        <li>The Conditions section is already set up. You don't have to change it.&nbsp;</li>
                        <li>In the Notifications section, click Add Notification and fill in your email address or
                        another notification method.&nbsp;</li>
                        <li>In the Name this policy section, you can accept the default.&nbsp;</li>
                        </ul>
                        <li>Click Save Policy.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading65"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse65" aria-expanded="true" aria-controls="collapse65">Threat: Sensitive data is compromised through network access <span>[UNAUTHORIZED-ACCESS-NETWORK]</span></button></h5></div><div id="collapse65" class="collapse" aria-labelledby="heading65" data-parent="#threats"><div class="card-body">Attackers gain undetected access to the network systems and changes made by the
                                attackers couldn't be audited or detected.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading64"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse64" aria-expanded="true" aria-controls="collapse64">Weakness: Undetected changes in the network configuration <span>[GOOGLE-MON07]</span></button></h5></div><div id="collapse64" class="collapse" aria-labelledby="heading64" data-parent="#weaknesses"><div class="card-body">Changes in network configurations (NACLs, route and gateway tables) are not detected because
                        monitoring and alerts of network configuration changes are not in place.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading61"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse61" aria-expanded="true" aria-controls="collapse61">Countermeasure: Create alerts for VPC NACL changes <span>[GOOGLE-MON09]</span></button></h5></div><div id="collapse61" class="collapse" aria-labelledby="heading61" data-parent="#controls"><div class="card-body">Create alerts to monitor, audit and notify when the VPC NACL (Network Access Control List)
                        changes. It's vital that monitoring of VPC NACL detects and reports any unauthorized access to
                        the security network systems.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to the <a href="https://app.google.stackdriver.com/">Stackdriver Monitoring
                        Console</a>.&nbsp;</li>
                        <li>Find on the panel the Create Alerting Policy and click on it.&nbsp;</li>
                        <li>Fill in the sections as follows:&nbsp;</li>
                        <ul>
                        <li>The Conditions section is already set up. Fill the condition correctly.&nbsp;</li>
                        <li>In the Notifications section, click Add Notification and fill in your email address or
                        another notification method.&nbsp;</li>
                        <li>In the Name this policy section, you can accept the default.&nbsp;</li>
                        </ul>
                        <li>Click Save Policy.</li>
                        </ol>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading62"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse62" aria-expanded="true" aria-controls="collapse62">Countermeasure: Create alerts for the VPC route table changes <span>[GOOGLE-MON10]</span></button></h5></div><div id="collapse62" class="collapse" aria-labelledby="heading62" data-parent="#controls"><div class="card-body">Create alerts to monitor, audit and notify when the VPC Route Table changes. It's vital that
                        monitoring of the VPC Route Table detects and reports any unauthorized access to the security
                        network systems.
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>&nbsp;
                        </div>
                        <div>
                        <ol>
                        <li>Go to the <a href="https://app.google.stackdriver.com/">Stackdriver Monitoring
                        Console</a>.&nbsp;</li>
                        <li>Find on the panel the Create Alerting Policy and click on it.&nbsp;</li>
                        <li>Fill in the sections as follows:&nbsp;</li>
                        <ul>
                        <li>The Conditions section is already set up. Fill the condition correctly.&nbsp;</li>
                        <li>In the Notifications section, click Add Notification and fill in your email address or
                        another notification method.&nbsp;</li>
                        <li>In the Name this policy section, you can accept the default.&nbsp;</li>
                        </ul>
                        <li>Click Save Policy.</li>
                        </ol>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading63"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse63" aria-expanded="true" aria-controls="collapse63">Countermeasure: Create alerts for VPC gateway changes <span>[GOOGLE-MON11]</span></button></h5></div><div id="collapse63" class="collapse" aria-labelledby="heading63" data-parent="#controls"><div class="card-body">Create alerts to monitor, audit and notify when the VPC Gateway changes. It's vital that
                        monitoring of the VPC Gateway detects and reports any unauthorized access to the security
                        network systems.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to the <a href="https://app.google.stackdriver.com/">Stackdriver Monitoring
                        Console</a>.&nbsp;</li>
                        <li>Find on the panel the Create Alerting Policy and click on it.&nbsp;</li>
                        <li>Fill in the sections as follows:&nbsp;</li>
                        <ul>
                        <li>The Conditions section is already set up. Fill the condition correctly.&nbsp;</li>
                        <li>In the Notifications section, click Add Notification and fill in your email address or
                        another notification method.&nbsp;</li>
                        <li>In the Name this policy section, you can accept the default.&nbsp;</li>
                        </ul>
                        <li>Click Save Policy.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading73"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse73" aria-expanded="true" aria-controls="collapse73">Risk pattern: Google Cloud Networking VNets <span>[GOOGLE-CLOUD-VNETS]</span></button></h5></div><div id="collapse73" class="collapse" aria-labelledby="heading73" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading72"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse72" aria-expanded="true" aria-controls="collapse72">Use case: Networking <span>[NETWORKING]</span></button></h5></div><div id="collapse72" class="collapse" aria-labelledby="heading72" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading71"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse71" aria-expanded="true" aria-controls="collapse71">Threat: Attackers gain unauthorized connection to the resources <span>[UNAUTHORISED-CONNECTION]</span></button></h5></div><div id="collapse71" class="collapse" aria-labelledby="heading71" data-parent="#threats"><div class="card-body">Attackers could gain unauthorized connection to the resources through misconfigured
                                ports or security network configurations.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading70"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse70" aria-expanded="true" aria-controls="collapse70">Weakness: Networks for Google Cloud resources are not properly segmented <span>[GOOGLE-VNET01]</span></button></h5></div><div id="collapse70" class="collapse" aria-labelledby="heading70" data-parent="#weaknesses"><div class="card-body">Resources in the same VNet are compromised because when one of them is attacked and the
                        attackers gain access, they also gain access to all resources.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading68"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse68" aria-expanded="true" aria-controls="collapse68">Countermeasure: Isolate groups of VM instances <span>[GOOGLE-NET01]</span></button></h5></div><div id="collapse68" class="collapse" aria-labelledby="heading68" data-parent="#controls"><div class="card-body">Use networks within projects to isolate groups of VM instances.

                        Each project supports up to five isolated networks. Each network constitutes a global IP address
                        space. This means that you can create resources, such as Google Compute Engine Virtual Machine
                        (VM) instances, in multiple geographic regions, and the resources will share the same IP address
                        space because they are on the same virtual network. Note that, despite the flat network address
                        space, you still incur normal egress charges when you leave your zone. You can request a quota
                        increase to support up to 15 isolated networks in each project.
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading69"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse69" aria-expanded="true" aria-controls="collapse69">Countermeasure: Isolate Google Cloud resources into separate VNets by function <span>[GOOGLE-NET02]</span></button></h5></div><div id="collapse69" class="collapse" aria-labelledby="heading69" data-parent="#controls"><div class="card-body">Place the resources into separate VNets according to their use or function (production,
                        development, test). Placing such resources accordingly ensures that a resource of a high
                        security level is not exposed by the security settings of a lower labeled VNet.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>&nbsp;
                        </div>
                        <div>
                        <ol>
                        <li>Identify the resources that exist in an incorrect VNet.&nbsp;</li>
                        <li>Migrate or move it to the correct VNet.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading85"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse85" aria-expanded="true" aria-controls="collapse85">Risk pattern: Google Cloud SQL <span>[GOOGLE-CLOUD-SQL]</span></button></h5></div><div id="collapse85" class="collapse" aria-labelledby="heading85" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading84"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse84" aria-expanded="true" aria-controls="collapse84">Use case: Google Cloud Platform <span>[GOOGLE CLOUD PLATFORM]</span></button></h5></div><div id="collapse84" class="collapse" aria-labelledby="heading84" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading76"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse76" aria-expanded="true" aria-controls="collapse76">Threat: Attackers destroy the data and the data cannot be recovered <span>[LOSS-DATA-REMOVED]</span></button></h5></div><div id="collapse76" class="collapse" aria-labelledby="heading76" data-parent="#threats"><div class="card-body">Attackers gain access to the systems and data with excessive permissions and they
                                remove all the information from the system, which might lead to permanent loss of data,
                                including sensitive or personal data.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading75"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse75" aria-expanded="true" aria-controls="collapse75">Weakness: There is not a recover or backup mechanism <span>[GOOGLE-BACKUP]</span></button></h5></div><div id="collapse75" class="collapse" aria-labelledby="heading75" data-parent="#weaknesses"><div class="card-body">There are not any processes or mechanisms to regularly save the data to another place in order
                        to have an older version of the data to restore in case of loss. Consequently the data cannot be
                        easily recovered or they cannot be recovered at all.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading74"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse74" aria-expanded="true" aria-controls="collapse74">Countermeasure: Create a plan for backups and perform backups regularly <span>[GOOGLE-SQL04]</span></button></h5></div><div id="collapse74" class="collapse" aria-labelledby="heading74" data-parent="#controls"><div class="card-body">Create a mechanism to do regularly backups from the SQL database and save it into another
                        place.
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading79"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse79" aria-expanded="true" aria-controls="collapse79">Threat: Attackers make undetected and unaudited changes to system configurations <span>[UNAUDITABLE-CHANGES-GOOGLE]</span></button></h5></div><div id="collapse79" class="collapse" aria-labelledby="heading79" data-parent="#threats"><div class="card-body">If audit trails are not properly protected, an attacker could gain access to the
                                system, modify the status of resources or exfiltrate sensitive data without being
                                noticed.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading78"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse78" aria-expanded="true" aria-controls="collapse78">Weakness: Undetected changes in the SQL database information and configuration <span>[GOOGLE-LOGS01]</span></button></h5></div><div id="collapse78" class="collapse" aria-labelledby="heading78" data-parent="#weaknesses"><div class="card-body">Changes in the SQL database information and configuration are not detected and audited,
                        because the Google Cloud mechanisms that are used to notify about these changes are disabled.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading77"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse77" aria-expanded="true" aria-controls="collapse77">Countermeasure: Use Stackdriver Monitoring. <span>[GOOGLE-SQL05]</span></button></h5></div><div id="collapse77" class="collapse" aria-labelledby="heading77" data-parent="#controls"><div class="card-body">Install the beta Stackdriver Monitoring agent for Microsoft Windows to send several monitoring
                        data points into the Stackdriver system.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>&nbsp;
                        </div>
                        <div>
                        To install the agent on a VM instance running Windows, perform the following steps after you
                        have established an RDP or similar connection to your instance and have logged into Windows:&nbsp;
                        </div>
                        <div>
                        <ol>
                        <li>If you use an HTTP proxy, run the following command from an administrator command
                        prompt to set the http_proxy environment variable so that the agent can send data to Stackdriver
                        Monitoring using outbound HTTPS: setx http_proxy http://YOUR-PROXY /m&nbsp;</li>
                        <li>Browse to the following URL.&nbsp;</li>
                        <ul>
                        <li>Download and run the agent's installer:
                        https://repo.stackdriver.com/windows/StackdriverMonitoring-GCM-45.exe&nbsp;</li>
                        <li>This can also be done via the following PowerShell commands: cd C:\Users\[USERNAME]
                        invoke-webrequest https://repo.stackdriver.com/windows/StackdriverMonitoring-GCM-45.exe -OutFile
                        StackdriverMonitoring-GCM-45.exe; .\StackdriverMonitoring-GCM-45.exe&nbsp;</li>
                        </ul>
                        <li>Your agent installation is now complete.&nbsp;</li>
                        </ol>To install the agent on a VM instance running Linux, these instructions work for both
                        Google Compute Engine instances and Amazon EC2 instances:&nbsp;
                        </div>
                        <div>
                        <ol>
                        <li>Run the following commands on your VM instance to install the monitoring agent: curl
                        -sSO https://dl.google.com/cloudagents/install-monitoring-agent.sh sudo bash
                        install-monitoring-agent.sh At the end of the installation, you should see something like the
                        following message. Restarting services [ ok ] Restarting stackdriver-agent (via systemctl):
                        stackdriver-agent.service.&nbsp;</li>
                        <li>If you use an HTTP proxy, do the following: a. Edit the Monitoring agent's
                        system-defaults file to set PROXY_URL to the URL of your HTTP proxy. This URL comes from your
                        configuration, not from a value Google provides. The name of the configuration file depends on
                        your version of Linux: For Debian and Ubuntu, edit /etc/default/stackdriver-agent For Amazon
                        Linux, Red Hat, and CentOS, edit /etc/sysconfig/stackdriver b. Restart the Monitoring agent by
                        running the following command on your VM instance. sudo service stackdriver-agent restart You
                        have finished installing the agent.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading83"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse83" aria-expanded="true" aria-controls="collapse83">Threat: Sensitive data is compromised by unauthorized access to Virtual Machines <span>[UNAUTHORISED-CONNECTION]</span></button></h5></div><div id="collapse83" class="collapse" aria-labelledby="heading83" data-parent="#threats"><div class="card-body">Attackers can gain unauthorized connection to the Virtual Machines through
                                misconfigured ports or security network configurations.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading82"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse82" aria-expanded="true" aria-controls="collapse82">Weakness: Unauthorized connection between the client and the SQL database <span>[GOOGLE-NET-21]</span></button></h5></div><div id="collapse82" class="collapse" aria-labelledby="heading82" data-parent="#weaknesses"><div class="card-body">All connections to SQL Database are allowed and the firewall and other security networks
                        methods are not configured to deny connections.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading80"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse80" aria-expanded="true" aria-controls="collapse80">Countermeasure: Enable SSL channel encryption to connect to the database <span>[GOOGLE-SQL01]</span></button></h5></div><div id="collapse80" class="collapse" aria-labelledby="heading80" data-parent="#controls"><div class="card-body">Enable and configure SSL encryption with the certificates to connect to the SQL database. This
                        way only users with the appropriate certificate can connect to the SQL database. Remediation:
                        You can create up to 10 client certificates for each instance. If you lose the private key for a
                        certificate, you must create a new one; the private key cannot be recovered.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to the Cloud SQL Instances page in the <a
                        href="https://console.cloud.google.com/sql/instances">Google Cloud Platform Console</a>.&nbsp;</li>
                        <li>Click the instance name to open its Instance details page.&nbsp;</li>
                        <li>Select the SSL tab.&nbsp;</li>
                        <li>In the SSL Connections section, click Allow only SSL connection to enforce that only
                        SSL connections can connect to the instances. (This step is not required. However, if you do not
                        require SSL for all connections, any issue with your SSL configuration can cause all connections
                        to default silently to unencrypted.)&nbsp;</li>
                        <li>In the Client Certificates section, click Create a Client Certificate.&nbsp;</li>
                        <li>In the New client certificate dialog box, give the certificate a name unique for this
                        instance and click Add.&nbsp;</li>
                        <li>In the first section of the New SSL certificate created dialog box, click the link to
                        download the private key to a file named client-key.pem. (Important: Store this private key
                        securely. If you lose it, you must create a new client certificate.)&nbsp;</li>
                        <li>In the second section, click the link to download the client certificate to a file
                        named client-cert.pem.&nbsp;</li>
                        <li>In the third section, click the link to download the server certificate to a file
                        named server-ca.pem.&nbsp;</li>
                        <li>Click Close.</li>
                        </ol>
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading81"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse81" aria-expanded="true" aria-controls="collapse81">Countermeasure: Restrict network access to the database <span>[GOOGLE-SQL02]</span></button></h5></div><div id="collapse81" class="collapse" aria-labelledby="heading81" data-parent="#controls"><div class="card-body">Use the Windows Server Advanced Firewall, and specify the IP addresses of your client
                        computers. The Windows Advanced Firewall is an important security component in Windows Server.
                        When you set up your SQL Server environment to be able to connect to the database from other
                        client machines, configure the firewall to allow incoming traffic:&nbsp;
                        <div>
                        netsh advfirewall firewall add rule name=&quot;SQL Access&quot; ^ dir=in action=allow ^
                        program=&quot;%programfiles%\Microsoft SQL
                        Server\MSSQL12.MSSQLSERVER\MSSQL\Binn\sqlservr.exe&quot; ^ remoteip=[LOCAL_SUBNET]
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        When you use this firewall rule, it is a good practice to specify the IP address of your client
                        machines. Specify a comma-delimited list of IP addresses with no whitespaces for the remoteip
                        parameter in place of [LOCAL_SUBNET]. Also, note that the path for the program parameter might
                        change depending on the version of SQL Server that you use. The SQL Server application image
                        includes an SQL Server Windows firewall rule. This rule is fairly unrestricted, so consider
                        disabling it before your system goes to production.
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading98"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse98" aria-expanded="true" aria-controls="collapse98">Risk pattern: Google Cloud Storage <span>[GOOGLE-CLOUD-STORAGE]</span></button></h5></div><div id="collapse98" class="collapse" aria-labelledby="heading98" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading97"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse97" aria-expanded="true" aria-controls="collapse97">Use case: Google Cloud Platform <span>[GOOGLE CLOUD PLATFORM]</span></button></h5></div><div id="collapse97" class="collapse" aria-labelledby="heading97" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading88"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse88" aria-expanded="true" aria-controls="collapse88">Threat: Attackers destroy the data and the data cannot be recovered <span>[LOSS-DATA-REMOVED]</span></button></h5></div><div id="collapse88" class="collapse" aria-labelledby="heading88" data-parent="#threats"><div class="card-body">Attackers gain access to the systems and data with excessive permissions and they
                                remove all the information from the system, which might lead to permanent loss of data,
                                including sensitive or personal data.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading87"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse87" aria-expanded="true" aria-controls="collapse87">Weakness: There is no recover or backup mechanism. <span>[GOOGLE-BACKUP]</span></button></h5></div><div id="collapse87" class="collapse" aria-labelledby="heading87" data-parent="#weaknesses"><div class="card-body">There are no processes or mechanisms to regularly save the data to another place in order to
                        have an older version of the data to restore in case of loss. Consequently the data cannot be
                        easily recovered or they cannot be recovered at all.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading86"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse86" aria-expanded="true" aria-controls="collapse86">Countermeasure: Enable Data Storage versioning <span>[GOOGLE-STO04]</span></button></h5></div><div id="collapse86" class="collapse" aria-labelledby="heading86" data-parent="#controls"><div class="card-body">Enable data storage versioning to make data backups and avoid accidental or intentional
                        removal of the data.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>&nbsp;
                        </div>
                        <div>
                        To enable Object Versioning on a bucket:&nbsp;
                        </div>
                        <div>
                        <ul>
                        <li>Using GSUTIL: Use the gsutil versioning set on command, replacing [VALUES_IN_BRACKETS]
                        with the appropriate values: gsutil versioning set on gs://[BUCKET_NAME]&nbsp;</li>
                        <li>Using REST APIS:&nbsp;</li>
                        <ul>
                        <li>JSON API:&nbsp;</li>
                        </ul>
                        </ul>
                        </div>
                        <div>
                        <ol>
                        <ol>
                        <ol>
                        <li>Get an authorization access token from the OAuth 2.0 Playground. Configure the
                        playground to use your own OAuth credentials.&nbsp;</li>
                        <li>Create a .json file that contains the following information: {&quot;versioning&quot;:
                        { &quot;enabled&quot;: true }}&nbsp;</li>
                        <li>Use cURL to call the JSON API with a PATCH Bucket request, replacing
                        [VALUES_IN_BRACKETS] with the appropriate values:&nbsp;</li>
                        </ol>
                        </ol>
                        </ol>
                        </div>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        curl -X PATCH --data-binary @[JSON_FILE_NAME].json \&nbsp;
                        </div>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        -H &quot;Authorization: Bearer [OAUTH2_TOKEN]&quot; \&nbsp;
                        </div>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        -H &quot;Content-Type: application/json&quot; \ &quot;https://www.googleapis.com/storage/v1/b/[BUCKET_NAME]?fields=versioning&quot;
                        </div>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        <ul>
                        <ul>
                        <li>XML API:&nbsp;</li>
                        </ul>
                        </ul>
                        <div>
                        <ol>
                        <ol>
                        <ol>
                        <li>Get an authorization access token from the OAuth 2.0 Playground. Configure the
                        playground to use your own OAuth credentials.&nbsp;</li>
                        <li>Create an .xml file that contains the following information, replacing
                        [VALUES_IN_BRACKETS] with the appropriate values: Enabled&nbsp;</li>
                        <li>Use cURL to call the XML API, with a PUT Bucket request and versioning query string
                        parameter, replacing [VALUES_IN_BRACKETS] with the appropriate values:&nbsp;</li>
                        </ol>
                        </ol>
                        </ol>
                        </div>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        curl -X PUT --data-binary @[XML_FILE_NAME].xml \
                        </div>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        -H &quot;Authorization: Bearer [OAUTH2_TOKEN]&quot; \
                        </div>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <blockquote>
                        <div>
                        &quot;https://storage.googleapis.com/[BUCKET_NAME]?versioning&quot;
                        </div>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                        </blockquote>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading91"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse91" aria-expanded="true" aria-controls="collapse91">Threat: Attackers gain access to the resources <span>[ACCESS-TO-RESOURCES]</span></button></h5></div><div id="collapse91" class="collapse" aria-labelledby="heading91" data-parent="#threats"><div class="card-body"><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading90"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse90" aria-expanded="true" aria-controls="collapse90">Weakness: Resources are exposed <span>[GOOGLE-EASY-FIND-RESOURCES]</span></button></h5></div><div id="collapse90" class="collapse" aria-labelledby="heading90" data-parent="#weaknesses"><div class="card-body">When you are into a VNet, you can search its resources, but that shall be used only when you
                        know the resource name. The problem occurs when you don't know these names and you can easily
                        find the resources. Therefore anyone with access to the system could easily find all the
                        resources and gain access, regardless of having any information about them.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading89"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse89" aria-expanded="true" aria-controls="collapse89">Countermeasure: Use apropriate names for the buckets <span>[GOOGLE-STO03]</span></button></h5></div><div id="collapse89" class="collapse" aria-labelledby="heading89" data-parent="#controls"><div class="card-body">Google Cloud Storage requests refer to buckets and objects by their names. As a result, even
                        though ACLs will prevent unauthorized third parties from operating on buckets or objects, a
                        third party can attempt requests with bucket or object names and determine their existence by
                        observing the error responses.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        It can then be possible for information in bucket or object names to be leaked. If you are
                        concerned about the privacy of your bucket or object names, you should take appropriate
                        precautions, such as:
                        </div>
                        <div>
                        <ul>
                        <li>Choosing bucket and object names that are difficult to guess. For example, a bucket
                        named mybucket-gtbytul3 is random enough that unauthorized third parties cannot feasibly guess
                        it or enumerate other bucket names from it.&nbsp;</li>
                        <li>Avoiding use of sensitive information as part of bucket or object names. For example,
                        instead of naming your bucket mysecretproject-prodbucket, name it somemeaninglesscodename-prod.
                        In some applications, you may want to keep sensitive metadata in custom Google Cloud Storage
                        headers such as x-goog-meta, rather than encoding the metadata in object names.</li>
                        </ul>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading96"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse96" aria-expanded="true" aria-controls="collapse96">Threat: Sensitive data is compromised through unauthorized access to data storage <span>[ACCESS-TO-DATA]</span></button></h5></div><div id="collapse96" class="collapse" aria-labelledby="heading96" data-parent="#threats"><div class="card-body"><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading93"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse93" aria-expanded="true" aria-controls="collapse93">Weakness: Credentials are not securely stored <span>[GOOGLE-USECURE-CREDENTIALS]</span></button></h5></div><div id="collapse93" class="collapse" aria-labelledby="heading93" data-parent="#weaknesses"><div class="card-body">The credentials that are used to access the resources are not securely stored and can be
                        accessed by unauthorized personnel.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading92"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse92" aria-expanded="true" aria-controls="collapse92">Countermeasure: Securely store your credentials <span>[GOOGLE-STO02]</span></button></h5></div><div id="collapse92" class="collapse" aria-labelledby="heading92" data-parent="#controls"><div class="card-body">Make sure that you securely store your credentials. This can be done differently depending on
                        your environment and where you store your credentials. For example, if you store your
                        credentials in a configuration file, make sure that you set appropriate permissions on that file
                        to prevent unwanted access. If you are using Google App Engine, consider using StorageByKeyName
                        to store your credentials.
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading95"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse95" aria-expanded="true" aria-controls="collapse95">Weakness: Obsolete applications have access to the resources <span>[GOOGLE-OBSOLETE-APPS-ACCESS]</span></button></h5></div><div id="collapse95" class="collapse" aria-labelledby="heading95" data-parent="#weaknesses"><div class="card-body">There are obsolete applications that no one uses, with permissions to access the resources.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading94"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse94" aria-expanded="true" aria-controls="collapse94">Countermeasure: Revoke access to Storage for unnecessary applications <span>[GOOGLE-STO01]</span></button></h5></div><div id="collapse94" class="collapse" aria-labelledby="heading94" data-parent="#controls"><div class="card-body">Create a mechanism or process to review all applications with access to the Data Storage and
                        verify that these applications should have access. If an application should not have access to
                        the data storage, you have to revoke the access from this application.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        <ol>
                        <li>To revoke the access from an application, go to the <a
                        href="https://www.google.com/accounts/ManageAccount">Google Account</a>.&nbsp;</li>
                        <li>Click in to Authorizing applications and sites.</li>
                        <li>In the next page, you can revoke access for applications by clicking Revoke Access
                        next to the application.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="card border-primary"><div class="card-header " id="heading119"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse119" aria-expanded="true" aria-controls="collapse119">Risk pattern: Google Cloud Virtual Machines <span>[GOOGLE-CLOUD-VM]</span></button></h5></div><div id="collapse119" class="collapse" aria-labelledby="heading119" data-parent="#components"><div class="card-body"><div class="accordion" id="usecases"><div class="card border-black"><div class="card-header " id="heading118"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse118" aria-expanded="true" aria-controls="collapse118">Use case: Google Cloud Platform <span>[GOOGLE CLOUD PLATFORM]</span></button></h5></div><div id="collapse118" class="collapse" aria-labelledby="heading118" data-parent="#usecases"><div class="card-body"><div class="accordion" id="threats"><div class="card border-danger"><div class="card-header " id="heading101"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse101" aria-expanded="true" aria-controls="collapse101">Threat: Attackers gain access to the system by exploiting weak security configurations <span>[UNCONFIGURED-SECURITY]</span></button></h5></div><div id="collapse101" class="collapse" aria-labelledby="heading101" data-parent="#threats"><div class="card-body"><div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading100"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse100" aria-expanded="true" aria-controls="collapse100">Weakness: Exposed security policies <span>[GOOGLE-VM01]</span></button></h5></div><div id="collapse100" class="collapse" aria-labelledby="heading100" data-parent="#weaknesses"><div class="card-body">The security policies are not configured and the security configurations are exposed to the
                        attackers.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading99"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse99" aria-expanded="true" aria-controls="collapse99">Countermeasure: Create alerts for security policy changes <span>[GOOGLE-MON03]</span></button></h5></div><div id="collapse99" class="collapse" aria-labelledby="heading99" data-parent="#controls"><div class="card-body">Create alerts to monitor, audit and notify when the Security Policy changes. It's vital that
                        monitoring of the Security Policy detects and reports any unauthorized changes in the security
                        configurations.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to the <a href="https://app.google.stackdriver.com/">Stackdriver Monitoring
                        Console</a>.</li>
                        <li>Find on the panel the Create Alerting Policy and click on it.&nbsp;</li>
                        <li>Fill in the sections as follows:&nbsp;</li>
                        <ul>
                        <li>The Conditions section shall be set up. In this case, you have to add the condition
                        for the next methods: projects.getIamPolicy, projects.setIamPolicy, organizations.getIamPolicy
                        and organizations.setIamPolicy&nbsp;</li>
                        <li>In the Notifications section, click Add Notification and fill in your email address or
                        another notification method.&nbsp;</li>
                        <li>In the Name this policy section, you can accept the default.&nbsp;</li>
                        </ul>
                        <li>Click Save Policy.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading110"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse110" aria-expanded="true" aria-controls="collapse110">Threat: Attackers gain access to the system through direct access to Virtual Machines <span>[UNAUTHORISED-CONNECTION]</span></button></h5></div><div id="collapse110" class="collapse" aria-labelledby="heading110" data-parent="#threats"><div class="card-body">Attackers can gain unauthorized connection to the Virtual Machines through
                                misconfigured ports or security network configurations
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading103"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse103" aria-expanded="true" aria-controls="collapse103">Weakness: Communication is not allowed from/to Virtual Machines <span>[GOOGLE-NET-05]</span></button></h5></div><div id="collapse103" class="collapse" aria-labelledby="heading103" data-parent="#weaknesses"><div class="card-body">IP allocation of Virtual Machines, DNS resolution, and node monitoring is performed by a host
                        node. It is necessary to allow the communication with this virtual IP to be able to make the
                        communication from/to the Virtual Machine of Google Cloud.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading102"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse102" aria-expanded="true" aria-controls="collapse102">Countermeasure: Allow Virtual IP of the Microsoft host node <span>[GOOGLE-VM01]</span></button></h5></div><div id="collapse102" class="collapse" aria-labelledby="heading102" data-parent="#controls"><div class="card-body">Allow the inbound access in the Network Security Groups from the IP address 168.63.129.16 to
                        communicate with the Google Cloud Service. This IP belongs to Microsoft and acts as DHCP server,
                        DNS server and monitors the host node hosting the Google Cloud Virtual Machine.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:</b>&nbsp;
                        </div>
                        <div>
                        <ol>
                        <li>Go to the Firewall rules page in the <a
                        href="https://console.cloud.google.com//networking/firewalls/list">Google Cloud Platform
                        Console</a>.</li>
                        <li>Click Create firewall rule.&nbsp;</li>
                        <li>Enter a Name for the firewall rule. This name must be unique for the project.&nbsp;</li>
                        <li>Specify the Network where the firewall rule is implemented.&nbsp;</li>
                        <li>Specify the Priority of the rule. If this rule will not conflict with any other rules,
                        you can leave the priority on the default of 1000. If you want to give it a higher or lower
                        priority than other rules, give it a lower number to have it evaluated earlier or a higher
                        number to have it evaluated later.&nbsp;</li>
                        <li>Indicate the Direction of traffic to which you want the rule to apply. In your case
                        ingress.&nbsp;</li>
                        <li>Indicate the Action as Allow.&nbsp;</li>
                        <li>Specify the Targets of the rule.&nbsp;</li>
                        <li>Select IP ranges if you want the rule to apply to packets from certain source IP
                        ranges only, then specify those ranges in the Source IP ranges field. In your case, the IP
                        traffic is 168.63.129.16.</li>
                        <li>Click Create.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading105"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse105" aria-expanded="true" aria-controls="collapse105">Weakness: Unauthorized connection attempts on open ports <span>[GOOGLE-NET-01]</span></button></h5></div><div id="collapse105" class="collapse" aria-labelledby="heading105" data-parent="#weaknesses"><div class="card-body">Receiving unauthorized connections to open ports is most likely an attack. To avoid this,
                        access to the network must be as restricted as possible, so that only the necessary ports are
                        open and the minimum inbound traffic is accepted.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading104"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse104" aria-expanded="true" aria-controls="collapse104">Countermeasure: Block all inbound port traffic from 0.0.0.0/0 <span>[GOOGLE-VM04]</span></button></h5></div><div id="collapse104" class="collapse" aria-labelledby="heading104" data-parent="#controls"><div class="card-body">Create a Firewall rule to filter the ingress/egress network traffic to Google Cloud resources
                        and deny the access to the resources by default. Set the limit inbound access to all TCP or all
                        ports to avoid undue exposure to risk.
                        <b>&nbsp;</b>
                        <div>
                        <b><br /></b>
                        </div>
                        <div>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to the Firewall rules page in the <a
                        href="https://console.cloud.google.com//networking/firewalls/list">Google Cloud Platform
                        Console</a>.&nbsp;</li>
                        <li>Click Create firewall rule.&nbsp;</li>
                        <li>Enter a Name for the firewall rule. This name must be unique for the project.&nbsp;</li>
                        <li>Specify the Network where the firewall rule is implemented.&nbsp;</li>
                        <li>Specify the Priority of the rule. If this rule will not conflict with any other rules,
                        you can leave the priority on the default of 1000. This rules shall have the highest priority,
                        because the other rules modify this rule.</li>
                        <li>Indicate the Direction of traffic to which you want the rule to apply. In your case
                        ingress.&nbsp;</li>
                        <li>Indicate the Action as Deny.&nbsp;</li>
                        <li>Specify the Targets of the rule.&nbsp;</li>
                        <li>Select IP ranges if you want the rule to apply to packets from certain source IP
                        ranges only, then specify those ranges in the Source IP ranges field. In your case, the IP
                        traffic is 0.0.0.0/0.&nbsp;</li>
                        <li>Specify which Protocols and ports the rule should apply to. In your case, deny all
                        traffic ports.&nbsp;</li>
                        <li>Click Create.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading107"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse107" aria-expanded="true" aria-controls="collapse107">Weakness: Unauthorized connection attempts on port 22 <span>[GOOGLE-NET-02]</span></button></h5></div><div id="collapse107" class="collapse" aria-labelledby="heading107" data-parent="#weaknesses"><div class="card-body">Receiving unauthorized connections to port 22 is most likely an SSH attack. To avoid this,
                        access to the network must be as restricted as possible, so that only the necessary ports are
                        open and the minimum inbound traffic is accepted.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading106"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse106" aria-expanded="true" aria-controls="collapse106">Countermeasure: Use Network Security Groups to restrict ingress to port 22 <span>[GOOGLE-VM03]</span></button></h5></div><div id="collapse106" class="collapse" aria-labelledby="heading106" data-parent="#controls"><div class="card-body">Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Google Cloud
                        resources. Set the limit inbound access to port 22 (Secure Desk) to IP addresses that require
                        this access to avoid undue exposure to risk.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        <b>Remediation:&nbsp;</b>
                        </div>
                        <div>
                        <ol>
                        <li>Go to the Firewall rules page in the <a
                        href="https://console.cloud.google.com//networking/firewalls/list">Google Cloud Platform
                        Console</a>.</li>
                        <li>Click Create firewall rule.&nbsp;</li>
                        <li>Enter a Name for the firewall rule. This name must be unique for the project.&nbsp;</li>
                        <li>Specify the Network where the firewall rule is implemented.&nbsp;</li>
                        <li>Specify the Priority of the rule. If this rule will not conflict with any other rules,
                        you can leave the priority on the default of 1000. If you want to give it a higher or lower
                        priority than other rules, give it a lower number to have it evaluated earlier or a higher
                        number to have it evaluated later.&nbsp;</li>
                        <li>Indicate the Direction of traffic to which you want the rule to apply. In your case
                        ingress.&nbsp;</li>
                        <li>Indicate the Action as Allow.&nbsp;</li>
                        <li>Specify the Targets of the rule.&nbsp;</li>
                        <li>Select the IP ranges you want the &quot;allow&quot; rule to apply to from
                        certain source IP ranges only, then specify those ranges in the Source IP ranges field.&nbsp;</li>
                        <li>Specify which Protocols and ports the rule should apply to. In your case, port 22.&nbsp;</li>
                        <li>Click Create.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div><div class="card border-warning"><div class="card-header " id="heading109"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse109" aria-expanded="true" aria-controls="collapse109">Weakness: Unauthorized connection attempts on port 3389 <span>[GOOGLE-NET-03]</span></button></h5></div><div id="collapse109" class="collapse" aria-labelledby="heading109" data-parent="#weaknesses"><div class="card-body">Receiving unauthorized connections to port 3389 is most likely experiencing an RDP attack. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading108"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse108" aria-expanded="true" aria-controls="collapse108">Countermeasure: Use Network Security Groups to restrict ingress to port 3389 <span>[GOOGLE-VM02]</span></button></h5></div><div id="collapse108" class="collapse" aria-labelledby="heading108" data-parent="#controls"><div class="card-body">Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Google Cloud
                        resources. Set the limit inbound access to port 3389 (Remote Desk Protocol) to IP addresses that
                        require this access in order to avoid undue exposure to risk.

                        Remediation:
                        1. Go to the Firewall rules page in the Google Cloud Platform Console.
                        (https://console.cloud.google.com//networking/firewalls/list)
                        2. Click Create firewall rule.
                        3. Enter a Name for the firewall rule. This name must be unique for the project.
                        4. Specify the Network where the firewall rule is implemented.
                        5. Specify the Priority of the rule. If this rule will not conflict with any other rules, you
                        can leave the priority on the default of 1000. If you want to give it a higher or lower priority
                        than other rules, give it a lower number to have it evaluated earlier or a higher number to have
                        it evaluated later.
                        6. Indicate the Direction of traffic to which you want the rule to apply. In your case ingress.
                        7. Indicate the Action as Allow.
                        8. Specify the Targets of the rule.
                        9. Select the IP ranges you want the "allow" rule to apply to from certain source IP ranges
                        only, then specify those ranges in the Source IP ranges field.
                        10. Specify which Protocols and ports the rule should apply to. In your case, port 3389
                        11. Click Create.
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading113"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse113" aria-expanded="true" aria-controls="collapse113">Threat: Attackers gain undetected access to the system by changing Virtual Machine configurations  <span>[UNAUTHORIZED-ACCESS-VIRTUAL-MACHINES]</span></button></h5></div><div id="collapse113" class="collapse" aria-labelledby="heading113" data-parent="#threats"><div class="card-body">Attackers can gain undetected access to the virtual machine configurations and these
                                changes couldn't be audited or detected.
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading112"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse112" aria-expanded="true" aria-controls="collapse112">Weakness: Undetected changes in the Virtual Machine configurations  <span>[GOOGLE-VM02]</span></button></h5></div><div id="collapse112" class="collapse" aria-labelledby="heading112" data-parent="#weaknesses"><div class="card-body">Changes in the Virtual Machines configurations are not detected because the monitoring and
                        alerts of the security configuration are not configured.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading111"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse111" aria-expanded="true" aria-controls="collapse111">Countermeasure: Create alerts for the Virtual Machines <span>[GOOGLE-VM05]</span></button></h5></div><div id="collapse111" class="collapse" aria-labelledby="heading111" data-parent="#controls"><div class="card-body">Create alerts to monitor, audit and notify when the following cases occur. It's vital that the
                        monitoring of the different Virtual Machines measures, detects and reports any errors or attack
                        mechanisms that force changes to the Virtual Machine.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        To avoid this you have to create alerts based on specific performance metrics:&nbsp;
                        </div>
                        <div>
                        <ol>
                        <li>Notify the corresponding personnel when the average CPU usage exceeds a certain
                        threshold.&nbsp;</li>
                        <li>Notify the corresponding personnel when the available free disk space drops below a
                        certain amount.&nbsp;</li>
                        <li>Notify the corresponding personnel when the security configuration of the Virtual
                        Machines changes.&nbsp;</li>
                        </ol>
                        <b>Remediation:</b>&nbsp;
                        </div>
                        <div>
                        <ol>
                        <li>Go to the <a href="https://app.google.stackdriver.com/">Stackdriver Monitoring
                        Console</a>.&nbsp;</li>
                        <li>Find on the panel the Create Alerting Policy and click on it.&nbsp;</li>
                        <li>Fill in the sections as follows:&nbsp;</li>
                        <ul>
                        <li>The Conditions section, you have to add a new condition for each metric in this
                        section.&nbsp;</li>
                        <li>In the Notifications section, click Add Notification and fill in your email address or
                        another notification method.</li>
                        <li>In the Name this policy section, you can accept the default.&nbsp;</li>
                        </ul>
                        <li>Click Save Policy.</li>
                        </ol>
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div><div class="card border-danger"><div class="card-header " id="heading117"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse117" aria-expanded="true" aria-controls="collapse117">Threat: The data is exposed through the transmission channel <span>[DATA-EXPOSED-CHANNEL]</span></button></h5></div><div id="collapse117" class="collapse" aria-labelledby="heading117" data-parent="#threats"><div class="card-body">Attackers can obtain the data through the transmitted channel because this does not
                                have the security measures in place to protect the data
                            <div class="accordion" id="weaknesses"><div class="card border-warning"><div class="card-header " id="heading116"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse116" aria-expanded="true" aria-controls="collapse116">Weakness: Data is transmitted in clear text <span>[DATA-TRANSMIT-CLEAR]</span></button></h5></div><div id="collapse116" class="collapse" aria-labelledby="heading116" data-parent="#weaknesses"><div class="card-body">The data is not protected when transmitted to applications or customers. The data can be
                        accessed and stolen from external sources.
                    <div class="accordion" id="controls"><div class="card border-success"><div class="card-header " id="heading114"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse114" aria-expanded="true" aria-controls="collapse114">Countermeasure: Configure and set up HTTPS/SSL for production environment  <span>[GOOGLE-VM06]</span></button></h5></div><div id="collapse114" class="collapse" aria-labelledby="heading114" data-parent="#controls"><div class="card-body">For production web systems, you should configure HTTPS/SSL. HTTPS/SSL can be set up either by
                        setting up an instance to terminate HTTPS or by configuring HTTPS load balancing. HTTPS/SSL does
                        involve some initial complexity, requiring you to perform the following tasks: Register a domain
                        name. Acquire an SSL certificate from a certificate authority.
                        <div>
                        <br />
                        </div>
                        <div>
                        Register the certificate with your HTTPS load balancer and its connected instances, or configure
                        an SSL-terminated web server or proxy on one or more Compute Engine instances. If you have set
                        up SSL-serving domains before, it should be straightforward to do the same with Google Compute
                        Engine. If not, you might find it easier to use a different security method, such as port
                        forwarding or SOCKS proxy.
                        </div>
                    </div></div></div><div class="card border-success"><div class="card-header " id="heading115"\><h5 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse115" aria-expanded="true" aria-controls="collapse115">Countermeasure: Configure the SSH encryption protocol to connect to the VM <span>[GOOGLE-VM07]</span></button></h5></div><div id="collapse115" class="collapse" aria-labelledby="heading115" data-parent="#controls"><div class="card-body">Configure ports 2222 and 8888 to connect to the Virtual Machine with the SSH transport
                        encryption protocol. Remediation: Use the gcloud command-line tool to start a server on a given
                        local port that forwards all traffic to a remote host over an SSH connection.&nbsp;
                        <div>
                        <br />
                        </div>
                        <div>
                        First, take a note of the instance and port that are providing the service to which you would
                        like to establish a secure connection. Next, run the following command:&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        <div>
                        gcloud compute ssh example-instance \&nbsp;
                        </div>
                        <blockquote>
                        <div>
                        --project my-project \&nbsp;
                        </div>
                        <div>
                        --zone us-central1-a \&nbsp;
                        </div>
                        <div>
                        --ssh-flag=&quot;-L&quot; \&nbsp;
                        </div>
                        <div>
                        --ssh-flag=&quot;2222:localhost:8888&quot;&nbsp;
                        </div>
                        <div>
                        <br />
                        </div>
                        </blockquote>In the above command, the parameters are defined as follows:&nbsp;
                        <div>
                        <ul>
                        <li>example-instance is the name of the instance to which you'd like to connect.&nbsp;</li>
                        <li>my-project is your Google Cloud Platform project ID.&nbsp;</li>
                        <li>us-central1-a is the zone in which your instance is running.&nbsp;</li>
                        <li>2222 is the local port you're listening on.&nbsp;</li>
                        <li>8888 is the remote port you're connecting to.&nbsp;</li>
                        </ul>With these example settings, if you open http://localhost:2222/ in your browser, the
                        HTTP connection will go over the SSH tunnel you have just created over to your remote host and
                        connect to the specified instance via SSH and then connect to port 8888 on the same machine, but
                        over an encrypted, secure SSH connection. The gcloud command creates and maintains an SSH
                        connection, and this approach only works while the SSH session is active. As soon as you exit
                        the SSH session that gcloud creates, the port forwarded via http://localhost:2222/ will stop
                        working.
                        </div>
                    </div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></body></html>