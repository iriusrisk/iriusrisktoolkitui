<control ref='AZ-Q05' name='Enable SQL Database threat detection' platform='' cost='0' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>&lt;div&gt;
                        Enable SQL Database Threat Detection to provide a new layer of security, which enables customers
                        to detect and respond to potential threats as they occur by providing security alerts on
                        anomalous activities. Users can explore the suspicious events using SQL Database Auditing to
                        determine if the results from an attempt to access, breach or exploit data in the database.
                        Threat Detection makes it simple to address potential threats to the database without the need
                        to be a security expert or manage advanced security monitoring systems. For example, Threat
                        Detection detects certain anomalous database activities indicating potential SQL injection
                        attempts. SQL injection is one of the common Web application security issues on the Internet,
                        used to attack data-driven applications. Attackers take advantage of application vulnerabilities
                        to inject malicious SQL statements into application entry fields, for breaching or modifying
                        data in the database.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Navigate to the configuration blade of the SQL database you want to monitor. In the
                        Settings blade, select Auditing &amp;amp; Threat Detection.&lt;/li&gt;
                        &lt;li&gt;In the Auditing &amp;amp; Threat Detection configuration blade turn ON auditing, which
                        will display the threat detection settings.&lt;/li&gt;
                        &lt;li&gt;Turn ON threat detection.&lt;/li&gt;
                        &lt;li&gt;Configure the list of emails that will receive security alerts upon detection of
                        anomalous database activities.&lt;/li&gt;
                        &lt;li&gt;Click Save in the Auditing &amp;amp; Threat detection blade to save the new or updated
                        auditing and threat detection policy.&lt;/li&gt;
                        &lt;li&gt;In the email, click on the Azure SQL Auditing Log link, which will launch the Azure
                        portal and show the relevant auditing records around the time of the suspicious event.&lt;/li&gt;
                        &lt;li&gt;Click on the audit records to view more details on the suspicious database activities
                        such as SQL statement, failure reason, and client IP.&lt;/li&gt;
                        &lt;li&gt;In the Auditing Records blade, click Open in Excel to open a pre-configured excel
                        template to import and run a deeper analysis of the audit log around the time of the suspicious
                        event.&lt;/li&gt;
                        &lt;li&gt;To configure the Fast Combine setting - In the POWER QUERY ribbon tab, select Options
                        to display the Options dialog. Select the Privacy section and choose the second option - 'Ignore
                        the Privacy Levels and potentially improve performance'.&lt;/li&gt;
                        &lt;li&gt;To load SQL audit logs, ensure that the parameters in the settings tab are set
                        correctly and then select the 'Data' ribbon and click the 'Refresh All' button.&lt;/li&gt;
                        &lt;li&gt;The results appear in the SQL Audit Logs sheet which enables you to run a deeper
                        analysis of the anomalous activities that were detected, and mitigate the impact of the security
                        event in your application.&amp;quot;&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='MS Azure - SQL Database Threat Detection' url='https://docs.microsoft.com/en-us/azure/sql-database/sql-database-threat-detection' />
          </references>
          <standards />
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Select SQL databases from the left-hand menu, and click your database on the SQL
                            databases page.&lt;/li&gt;
                            &lt;li&gt;In the Settings blade, select Auditing &amp;amp; Threat Detection.&lt;/li&gt;
                            &lt;li&gt;Check that the Database Threat Detection is enabled and correct configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2017-06-12T10:16:31.412'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control>