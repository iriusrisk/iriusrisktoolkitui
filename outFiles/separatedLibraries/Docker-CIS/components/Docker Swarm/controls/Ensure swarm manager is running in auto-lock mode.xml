<control ref='D7.6' name='Ensure swarm manager is running in auto-lock mode' platform='' cost='1' risk='0' state='Recommended' owner='' library='' source='MANUAL'>
          <desc>Run Docker swarm manager in auto-lock mode.&amp;nbsp;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Rationale:&lt;/b&gt;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        When Docker restarts, both the TLS key used to encrypt communication among swarm nodes, and the
                        key used to encrypt and decrypt Raft logs on disk, are loaded into each manager node's memory.
                        You should protect the mutual TLS encryption key and the key used to encrypt and decrypt Raft
                        logs at rest. This protection could be enabled by initializing swarm with the --autolock flag.
                        With --autolock enabled, when Docker restarts, you must unlock the swarm first, using a key
                        encryption key generated by Docker when the swarm was initialized.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        If you are initializing swarm, use the below command. docker swarm init --autolock If you want
                        to set --autolock on an existing swarm manager node, use the below command.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        docker swarm update --autolock&amp;nbsp;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Impact:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        A swarm in auto-lock mode won't recover from a re-start without manual intervention from a user
                        to enter the unlock key. In some deployments, this might not be good for availability.
                        &lt;/div&gt;
                    </desc>
          <implementations />
          <references>
            <reference name='Docker docs: Swarm manager locking' url='https://docs.docker.com/engine/swarm/swarm_manager_locking/' />
          </references>
          <standards>
            <standard ref='7.6' supportedStandardRef='Level 1 - Docker' />
          </standards>
          <udts />
          <test expiryDate='' expiryPeriod='0'>
            <steps>Run the below command. If it outputs the key, it means swarm was initialized with the
                            --autolock flag. If the output is no unlock key is set, it means that swarm was NOT
                            initialized with the --autolock flag and is non-compliant with respect to this
                            recommendation.&amp;nbsp;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            docker swarm unlock-key
                            &lt;/div&gt;
                            &lt;/blockquote&gt;
                        </steps>
            <notes />
            <source filename='' args='' type='Manual' result='Not Tested' enabled='true' timestamp='2016-08-02T10:21:32.718'>
              <output></output>
            </source>
            <references />
            <udts />
          </test>
        </control>